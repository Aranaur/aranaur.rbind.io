<!DOCTYPE html>
<html lang="en"><head>
<script src=".06_files/libs/clipboard/clipboard.min.js"></script>
<script src=".06_files/libs/quarto-html/tabby.min.js"></script>
<script src=".06_files/libs/quarto-html/popper.min.js"></script>
<script src=".06_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href=".06_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href=".06_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href=".06_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href=".06_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src=".06_files/libs/quarto-contrib/iconify-1.0.7/iconify-icon.min.js"></script><meta charset="utf-8">
  <meta name="generator" content="quarto-1.5.57">

  <meta name="author" content="Ihor Miroshnychenko">
  <title>Statistical criteria</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href=".06_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href=".06_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #24292e;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #24292e; } /* Normal */
    code span.al { color: #ff5555; font-weight: bold; } /* Alert */
    code span.an { color: #6a737d; } /* Annotation */
    code span.at { color: #d73a49; } /* Attribute */
    code span.bn { color: #005cc5; } /* BaseN */
    code span.bu { color: #d73a49; } /* BuiltIn */
    code span.cf { color: #d73a49; } /* ControlFlow */
    code span.ch { color: #032f62; } /* Char */
    code span.cn { color: #005cc5; } /* Constant */
    code span.co { color: #6a737d; } /* Comment */
    code span.cv { color: #6a737d; } /* CommentVar */
    code span.do { color: #6a737d; } /* Documentation */
    code span.dt { color: #d73a49; } /* DataType */
    code span.dv { color: #005cc5; } /* DecVal */
    code span.er { color: #ff5555; text-decoration: underline; } /* Error */
    code span.ex { color: #d73a49; font-weight: bold; } /* Extension */
    code span.fl { color: #005cc5; } /* Float */
    code span.fu { color: #6f42c1; } /* Function */
    code span.im { color: #032f62; } /* Import */
    code span.in { color: #6a737d; } /* Information */
    code span.kw { color: #d73a49; } /* Keyword */
    code span.op { color: #24292e; } /* Operator */
    code span.ot { color: #6f42c1; } /* Other */
    code span.pp { color: #d73a49; } /* Preprocessor */
    code span.re { color: #6a737d; } /* RegionMarker */
    code span.sc { color: #005cc5; } /* SpecialChar */
    code span.ss { color: #032f62; } /* SpecialString */
    code span.st { color: #032f62; } /* String */
    code span.va { color: #e36209; } /* Variable */
    code span.vs { color: #032f62; } /* VerbatimString */
    code span.wa { color: #ff5555; } /* Warning */
  </style>
  <link rel="stylesheet" href=".06_files/libs/revealjs/dist/theme/quarto.css">
  <link href=".06_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href=".06_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href=".06_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href=".06_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href=".06_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href=".06_files/libs/revealjs/plugin/verticator/verticator.css" rel="stylesheet">
  <link href=".06_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <meta name="mermaid-theme" content="forest">
  <script src=".06_files/libs/quarto-diagram/mermaid.min.js"></script>
  <script src=".06_files/libs/quarto-diagram/mermaid-init.js"></script>
  <link href=".06_files/libs/quarto-diagram/mermaid.css" rel="stylesheet">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-iframe=".06_files/libs/colored-particles/index.html" class="quarto-title-block center">
  <h1 class="title">Statistical criteria</h1>
  <p class="subtitle">Descriptive Statistics</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Ihor Miroshnychenko 
</div>
        <p class="quarto-title-affiliation">
            Kyiv School of Economics
          </p>
    </div>
</div>

</section><section id="TOC">
<nav role="doc-toc"> 
<h2 id="toc-title">Table of contents</h2>
<ul>
<li><a href="#/statistical-criterion" id="/toc-statistical-criterion">Statistical criterion</a></li>
<li><a href="#/statistical-criterion-and-r" id="/toc-statistical-criterion-and-r">Statistical criterion and R</a></li>
<li><a href="#/p-value" id="/toc-p-value"><span class="math inline">\(p\)</span>-value</a></li>
<li><a href="#/two-way-criterion" id="/toc-two-way-criterion">Two-way criterion</a></li>
<li><a href="#/power-of-statistical-test" id="/toc-power-of-statistical-test">Power of statistical test</a></li>
<li><a href="#/minimum-detectable-effect-mde" id="/toc-minimum-detectable-effect-mde">Minimum detectable effect <em>(MDE)</em></a></li>
<li><a href="#/confidence-intervals" id="/toc-confidence-intervals">Confidence intervals</a></li>
</ul>
</nav>
</section>
<section>
<section id="statistical-criterion" class="title-slide slide level1 center" data-background-iframe=".06_files/libs/colored-particles/index.html">
<h1>Statistical criterion</h1>

</section>
<section id="startup-idea" class="slide level2">
<h2>Startup idea</h2>
<p><iconify-icon inline="" icon="emojione:department-store"></iconify-icon> We deliver goods from stores to your home</p>
<p><iconify-icon inline="" icon="mdi:courier-check"></iconify-icon> Delivery cost — 100₴</p>
<p><iconify-icon inline="" icon="mdi:courier-fast"></iconify-icon> The cost of the courier’s work is 50₴</p>
<div class="fragment">
<p><br>
</p>
<p>But users can cancel the order.</p>
</div>
<div class="fragment">
<p><br>
</p>
<p>Investors are ready to help if the chance of failure is <strong>&lt; 50%</strong>.</p>
<p>What should I do?</p>
</div>
<div class="fragment">
<center>
<span class="hi">Conduct an experiment!</span>
</center>
</div>
</section>
<section id="we-are-conducting-an-experiment" class="slide level2">
<h2>We are conducting an experiment</h2>
<ul>
<li>Found 30 customers</li>
<li>19 paid for the order</li>
</ul>
<div class="fragment">
<p><br>
</p>
<center>
<strong>But is this enough to prove the success of our business?</strong>
</center>
</div>
</section>
<section id="model-and-observations" class="slide level2">
<h2>Model and observations</h2>
<p>We can’t test the product on everyone, but we can collect a sample from the general population and observe the success rate.</p>
<div class="fragment">
<ol type="1">
<li>The audience that will use our service — <strong>general population</strong>, <span class="math inline">\(\xi \sim \text{Bernoulli}(\mu)\)</span>.</li>
<li>The share of successful transactions is <span class="math inline">\(\mu\)</span>.</li>
<li>Sample from the population — <span class="math inline">\(\xi_1, \xi_2, \ldots, \xi_{30}\)</span>.</li>
</ol>
</div>
</section>
<section id="problem-statement" class="slide level2 tiny">
<h2>Problem statement</h2>
<div class="columns">
<div class="column" style="width:“50%”;">
<ol type="1">
<li>Define the hypotheses:
<ul>
<li><span class="math inline">\(H_0: \mu = 50%\)</span></li>
<li><span class="math inline">\(H_1: \mu &gt; 50%\)</span>.</li>
</ul></li>
<li>Determine the criterion statistics:</li>
</ol>
<p><span class="math inline">\(Q = \xi_1 + \xi_2 + \ldots + \xi_{30} \underset{H_0}{\sim} \text{Binomial}(30, 0.5)\)</span></p>
<ol start="3" type="1">
<li>Define the criterion:</li>
</ol>
<div class="border">
<ul>
<li>if <span class="math inline">\(Q \geq 21\)</span>: <span class="green">reject <span class="math inline">\(H_0\)</span></span></li>
<li>otherwise: <span class="red">do not reject <span class="math inline">\(H_0\)</span></span></li>
</ul>
</div>
</div><div class="column fragment" data-fragment-index="2" style="width:50%;">
<p>But why 21?</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src=".06_files/figure-revealjs/pmf-q-plot-1.svg"></p>
</figure>
</div>
</div>
</div>
<ol start="4" type="1">
<li>Determine the statistical significance:</li>
</ol>
<ul>
<li><span class="math inline">\(\alpha\)</span> — statistical significance of the criterion, 5%.</li>
<li><strong>FPR</strong> (False Positive Rate) — the probability of rejecting <span class="math inline">\(H_0\)</span> if it is true.</li>
</ul>
<p><span class="math inline">\(FPR \leq \alpha\)</span></p>
</div></div>
<div class="fragment">
<p><span class="math display">\[FPR = 1.3\% + 0.5\% + 0.2\% + 0.1\% \approx 2.1\% &lt; 5\%\]</span></p>
</div>
</section>
<section id="vs.-20" class="slide level2 smaller">
<h2>21 vs.&nbsp;20</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src=".06_files/figure-revealjs/pmf-q-plot-21-1.svg"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src=".06_files/figure-revealjs/pmf-q-plot-20-1.svg"></p>
</figure>
</div>
</div>
</div>
</div></div>
<p><span class="math inline">\(FPR_{21} = 1.3\% + 0.5\% + 0.2\% + 0.1\% \approx 2.1\% &lt; 5\%\)</span></p>
<p><span class="math inline">\(FPR_{20} = 2.8\% + 1.3\% + 0.5\% + 0.2\% + 0.1\% \approx 4.9\% &lt; 5\%\)</span></p>
<div class="fragment">
<div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Solution.</strong></p>
</div>
<div class="callout-content">
<ul>
<li>if <span class="math inline">\(Q \geq 20\)</span>: <span class="green">reject <span class="math inline">\(H_0\)</span></span></li>
<li>otherwise: <span class="red">do not reject <span class="math inline">\(H_0\)</span></span></li>
</ul>
</div>
</div>
</div>
</div>
</section>
<section id="so-whats-the-solution" class="slide level2">
<h2>So what’s the solution?</h2>
<p><iconify-icon inline="" icon="emojione:department-store"></iconify-icon> We deliver goods from stores to your home</p>
<p><iconify-icon inline="" icon="mdi:courier-check"></iconify-icon> Delivery cost — 100₴</p>
<p><iconify-icon inline="" icon="mdi:courier-fast"></iconify-icon> The cost of the courier’s work is 50₴</p>
<div class="fragment">
<ul>
<li>Found 30 customers</li>
<li>19 paid for the order</li>
</ul>
</div>
<div class="fragment">
<p><br>
</p>
<center>
<span class="hi">We don’t have enough evidence to reject <span class="math inline">\(H_0\)</span>.</span>
</center>
</div>
</section></section>
<section>
<section id="statistical-criterion-and-r" class="title-slide slide level1 center" data-background-iframe=".06_files/libs/colored-particles/index.html">
<h1>Statistical criterion and R</h1>

</section>
<section id="binomial-distribution" class="slide level2">
<h2>Binomial distribution</h2>
<ol type="1">
<li>The statistic <span class="math inline">\(Q\)</span> has a binomial distribution: <span class="math inline">\(Q \sim \text{Binomial}(30, 0.5)\)</span>.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span>  <span class="co"># кількість випробувань</span></span>
<span id="cb1-2"><a href="" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="co"># ймовірність успіху</span></span>
<span id="cb1-3"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Приклад розрахунків ймовірності для кількості успіхів</span></span>
<span id="cb1-5"><a href="" aria-hidden="true" tabindex="-1"></a>probs <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">size =</span> n, <span class="at">prob =</span> p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li>The probability function of a discrete distribution <span class="math inline">\(p_{\xi}(x)\)</span> is the probability that a random variable <span class="math inline">\(\xi\)</span> takes the value <span class="math inline">\(x\)</span>.</li>
</ol>
<div class="columns">
<div class="column" style="width:25%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="dv">10</span>, n, p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0279816</code></pre>
</div>
</div>
</div><div class="column" style="width:25%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="dv">15</span>, n, p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1444644</code></pre>
</div>
</div>
</div><div class="column" style="width:25%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="dv">14</span>, n, p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1354354</code></pre>
</div>
</div>
</div><div class="column" style="width:25%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="dv">16</span>, n, p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1354354</code></pre>
</div>
</div>
</div></div>
</section>
<section class="slide level2">

<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Параметри розподілу</span></span>
<span id="cb10-2"><a href="" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb10-3"><a href="" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb10-4"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Визначаємо координати та ймовірності</span></span>
<span id="cb10-6"><a href="" aria-hidden="true" tabindex="-1"></a>x_grid <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>n</span>
<span id="cb10-7"><a href="" aria-hidden="true" tabindex="-1"></a>probs <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(x_grid, <span class="at">size =</span> n, <span class="at">prob =</span> p)</span>
<span id="cb10-8"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Критична область</span></span>
<span id="cb10-10"><a href="" aria-hidden="true" tabindex="-1"></a>crit_reg <span class="ot">&lt;-</span> x_grid <span class="sc">&gt;=</span> <span class="dv">20</span></span>
<span id="cb10-11"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Створюємо дані для графіка</span></span>
<span id="cb10-13"><a href="" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb10-14"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> x_grid,</span>
<span id="cb10-15"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="at">probs =</span> probs,</span>
<span id="cb10-16"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="at">crit_reg =</span> crit_reg</span>
<span id="cb10-17"><a href="" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-18"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-19"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Побудова графіка</span></span>
<span id="cb10-20"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> probs)) <span class="sc">+</span></span>
<span id="cb10-21"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> x, <span class="at">yend =</span> <span class="dv">0</span>, <span class="at">color =</span> crit_reg), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb10-22"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb10-23"><a href="" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"TRUE"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"FALSE"</span> <span class="ot">=</span> <span class="st">"lightblue"</span>),</span>
<span id="cb10-24"><a href="" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"TRUE"</span> <span class="ot">=</span> <span class="st">"Critical region for S"</span>, <span class="st">"FALSE"</span> <span class="ot">=</span> <span class="st">"PMF, Binom(0.5, 30)"</span>)</span>
<span id="cb10-25"><a href="" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb10-26"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb10-27"><a href="" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Біноміальний розподіл"</span>,</span>
<span id="cb10-28"><a href="" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Кількість успіхів"</span>,</span>
<span id="cb10-29"><a href="" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Ймовірність"</span>,</span>
<span id="cb10-30"><a href="" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="cn">NULL</span></span>
<span id="cb10-31"><a href="" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb10-32"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb10-33"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb10-34"><a href="" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb10-35"><a href="" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb10-36"><a href="" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>)</span>
<span id="cb10-37"><a href="" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</section>
<section id="" class="slide level2 output-location-slide"><div class="cell output-location-slide" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src=".06_files/figure-revealjs/pmf-q-plot-r-1.svg" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</div></section><section id="probability-of-the-critical-area" class="slide level2">
<h2>Probability of the critical area</h2>
<p>Calculate the sum of the probabilities of success in the critical area.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(probs[crit_reg])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.04936857</code></pre>
</div>
</div>
<p><br>
</p>
<p>What if <span class="math inline">\(Q \geq 19\)</span>?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="" aria-hidden="true" tabindex="-1"></a>crit_reg <span class="ot">&lt;-</span> x_grid <span class="sc">&gt;=</span> <span class="dv">19</span></span>
<span id="cb13-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(probs[crit_reg])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1002442</code></pre>
</div>
</div>
<p><br>
</p>
<p>Then the probability of error is even higher than 10%, which is not good for us at all.</p>
</section>
<section id="cumulative-distribution-function" class="slide level2">
<h2>Cumulative distribution function</h2>
<p>The cumulative distribution function <span class="math inline">\(F_{\xi}(x) = P(\xi \leq x)\)</span> is the probability that a random variable <span class="math inline">\(\xi\)</span> will take a value no greater than <span class="math inline">\(x\)</span>.</p>
<p>In R it is calculated as <code>pbinom(x, size, prob)</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">19</span>, <span class="at">size =</span> <span class="dv">30</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9506314</code></pre>
</div>
</div>
<p><br>
</p>
<p>The probability of getting 19 or fewer successes in our task is <span class="math inline">\(\geq 95\)</span>. And since <span class="math inline">\(P(\xi \leq 19) + P(\xi \geq 21) = 1\)</span>, we can calculate the level of significance of our criterion.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pbinom</span>(<span class="dv">19</span>, <span class="at">size =</span> <span class="dv">30</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.04936857</code></pre>
</div>
</div>
</section>
<section id="quantile" class="slide level2 smaller">
<h2>Quantile</h2>
<p>To select the critical region for the criterion, we would like to find the point where the area of the columns to the right of which is <span class="math inline">\(5\%\)</span>. That is, the area of the columns on the left is <span class="math inline">\(95\%\)</span>. This point is called a <em>quantile</em>. <span class="math display">\[u_p(\xi) = \{x | F_{\xi}(x) = p\}\]</span></p>
<p>But with <span class="math inline">\(p = 0.95\)</span> and our binomial distribution, there is no such point. We found out that there is a point to the right of which the area is <span class="math inline">\(0.494\)</span>, and the next one is <span class="math inline">\(0.1\)</span>. To determine the quantile in this case, we modify the definition:</p>
<p><br>
</p>
<p>The quantile <span class="math inline">\(u_p(\xi) = \{x | F_{\xi}(x) \geq p\}\)</span> is a value that <span class="math inline">\(\xi\)</span> does not exceed with probability at least <span class="math inline">\(p\)</span>.</p>
</section>
<section id="quantile-example" class="slide level2 smaller">
<h2>Quantile: example</h2>
<p>For the value <span class="math inline">\(\xi \sim Bin(30, 0.5)\)</span>, let’s calculate the <span class="math inline">\(0.95\)</span>-quantile. We will solve the problem simply by selection.</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><span class="math display">\[P(\xi \leq 18) \approx 0.9\]</span></p>
<p><span class="math display">\[P(\xi \leq 19) \approx 0.951\]</span></p>
<p><span class="math display">\[P(\xi \leq 20) \approx 0.97\]</span></p>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">18</span>, <span class="at">size =</span> <span class="dv">30</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8997558</code></pre>
</div>
</div>
<p><br>
</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">19</span>, <span class="at">size =</span> <span class="dv">30</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9506314</code></pre>
</div>
</div>
<p><br>
</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">20</span>, <span class="at">size =</span> <span class="dv">30</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.978613</code></pre>
</div>
</div>
</div></div>
<p><br>
</p>
<p>In R we can use the <code>qbinom(p, size, prob)</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">qbinom</span>(<span class="fl">0.95</span>, <span class="at">size =</span> <span class="dv">30</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 19</code></pre>
</div>
</div>
</section>
<section id="custom-criterion-function" class="slide level2 smaller">
<h2>Custom criterion function</h2>
<div class="columns">
<div class="column" style="width:“50%”;">
<p>Now how do we find <span class="math inline">\(C\)</span> for any <span class="math inline">\(n, \mu\)</span> and any level of significance <span class="math inline">\(\alpha\)</span>?</p>
<ol type="1">
<li>Find <span class="math inline">\(C\)</span> such that <span class="math inline">\(P(Q \geq C) \leq \alpha\)</span>.</li>
<li>That is, you need <span class="math inline">\(P(Q &lt; C) \geq 1 - \alpha\)</span>.</li>
<li><span class="math inline">\(Q\)</span> takes only integer values: <span class="math inline">\(P(Q \leq C - 1) \geq 1 - \alpha\)</span>, or <span class="math inline">\(P(Q \leq C) \geq 1 - \alpha\)</span>.</li>
<li>So, from the definition of quantile, <span class="math inline">\(C - 1 = u_{1 - \alpha}\)</span></li>
<li>So <span class="math inline">\(C = u_{1 - \alpha} + 1\)</span></li>
</ol>
</div><div class="column fragment" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="" aria-hidden="true" tabindex="-1"></a>make_binom_criterion <span class="ot">&lt;-</span> <span class="cf">function</span>(n, <span class="at">mu =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>) {</span>
<span id="cb27-2"><a href="" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-3"><a href="" aria-hidden="true" tabindex="-1"></a>  q <span class="ot">&lt;-</span> <span class="fu">qbinom</span>(<span class="dv">1</span> <span class="sc">-</span> alpha, <span class="at">size =</span> n, <span class="at">prob =</span> mu)</span>
<span id="cb27-4"><a href="" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-5"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(q <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb27-6"><a href="" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-7"><a href="" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div></div>
</section>
<section id="custom-criterion-function-example" class="slide level2">
<h2>Custom criterion function: example</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="" aria-hidden="true" tabindex="-1"></a>make_binom_criterion <span class="ot">&lt;-</span> <span class="cf">function</span>(n, <span class="at">mu =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>) {</span>
<span id="cb28-2"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Find the quantile for the criterion</span></span>
<span id="cb28-3"><a href="" aria-hidden="true" tabindex="-1"></a>  q <span class="ot">&lt;-</span> <span class="fu">qbinom</span>(<span class="dv">1</span> <span class="sc">-</span> alpha, <span class="at">size =</span> n, <span class="at">prob =</span> mu)</span>
<span id="cb28-4"><a href="" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-5"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return C for the criterion S = {Q &gt;= C}</span></span>
<span id="cb28-6"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(q <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb28-7"><a href="" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"If Q &gt;="</span>,</span>
<span id="cb29-2"><a href="" aria-hidden="true" tabindex="-1"></a>    <span class="fu">make_binom_criterion</span>(<span class="dv">30</span>, <span class="fl">0.5</span>, <span class="fl">0.05</span>),</span>
<span id="cb29-3"><a href="" aria-hidden="true" tabindex="-1"></a>    <span class="st">"reject the null hypothesis"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>If Q &gt;= 20 reject the null hypothesis</code></pre>
</div>
</div>
</div></div>
<p><br>
</p>
<p>The critical value of <span class="math inline">\(C = 20\)</span>, then the criterion looks like this:</p>
<p><span class="math display">\[S = \{Q \geq 20\}\]</span></p>
</section>
<section id="additional-example" class="slide level2">
<h2>Additional example</h2>
<ul>
<li>Number of deliveries — 50</li>
<li>Sufficient probability of success — 0.1, i.e.&nbsp;if the courier’s work costs 100₴, then the delivery cost is 1000₴.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2024</span>)  <span class="co"># Встановлюємо початкове значення для генератора випадкових чисел</span></span>
<span id="cb31-2"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Кількість випробувань та ймовірність успіху</span></span>
<span id="cb31-4"><a href="" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb31-5"><a href="" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb31-6"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Генерація 3 випадкових значень</span></span>
<span id="cb31-8"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">size =</span> n, <span class="at">prob =</span> p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7 4 6</code></pre>
</div>
</div>
</section>
<section class="slide level2">


<img data-src=".06_files/figure-revealjs/binom-50-plot-1.svg" class="r-stretch"></section>
<section class="slide level2">

<div class="smaller">
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Якщо Q &gt;="</span>, <span class="fu">make_binom_criterion</span>(<span class="at">n =</span> <span class="dv">50</span>, <span class="at">mu =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>), <span class="st">"тоді відхиляємо H0</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Якщо Q &gt;= 10 тоді відхиляємо H0</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src=".06_files/figure-revealjs/custom-crit-func-50-plot-1.svg" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># визначаємо критичну область</span></span>
<span id="cb35-2"><a href="" aria-hidden="true" tabindex="-1"></a>crit_reg <span class="ot">&lt;-</span> x_grid <span class="sc">&gt;=</span> <span class="dv">10</span></span>
<span id="cb35-3"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># обчислюємо суму ймовірностей у критичній області</span></span>
<span id="cb35-5"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(probs[crit_reg])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.02453794</code></pre>
</div>
</div>
</div>
</section></section>
<section>
<section id="p-value" class="title-slide slide level1 center" data-background-iframe=".06_files/libs/colored-particles/index.html">
<h1><span class="math inline">\(p\)</span>-value</h1>

</section>
<section id="p-value-1" class="slide level2 smaller">
<h2><span class="math inline">\(p\)</span>-value</h2>
<p>The <span class="math inline">\(p\)</span>-value is the probability of obtaining a result that is more extreme than our observations, provided that the null hypothesis <span class="math inline">\(H_0\)</span> is true.</p>
<div class="columns">
<div class="column" style="width:40%;">
<div class="cell" data-reveal="true" data-layout-align="center">
<div class="cell-output-display">
<div id="mermaid-binom">
<div>
<pre class="mermaid mermaid-js" data-label="mermaid-binom">graph TD
    A["n = 30 \n H0: μ = 0.5 \n H1: μ &gt; 0.5 \n α = 0.05"] --&gt; B["Якщо Q &gt;= 20: \n відхиляємо H0"]

</pre>
</div>
</div>
</div>
</div>
</div><div class="column fragment" style="width:60%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src=".06_files/figure-revealjs/p-value-new-1.svg"></p>
</figure>
</div>
</div>
</div>
</div></div>
<div class="fragment">
<ul>
<li><span class="math inline">\(p &gt; \alpha \equiv\)</span> <span class="math inline">\(q\)</span> outside the critical region <span class="math inline">\(\equiv\)</span> does not reject <span class="math inline">\(H_0\)</span>.</li>
<li><span class="math inline">\(p \leq \alpha \equiv\)</span> <span class="math inline">\(q\)</span> in the critical region <span class="math inline">\(\equiv\)</span> reject <span class="math inline">\(H_0\)</span>.</li>
</ul>
</div>
</section>
<section class="slide level2">

<div class="callout callout-important no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Statistical criterion for everyone!</strong></p>
</div>
<div class="callout-content">
<center>
If <span class="math inline">\(p\)</span>-value is <span class="math inline">\(\leq \alpha\)</span>: reject <span class="math inline">\(H_0\)</span>.<br><br> Otherwise: do not reject <span class="math inline">\(H_0\)</span>.
</center>
</div>
</div>
</div>
</section>
<section class="slide level2">


<img data-src=".06_files/figure-revealjs/p-value-calc-1.svg" class="r-stretch"></section>
<section id="p-value-in-r" class="slide level2 smaller">
<h2><span class="math inline">\(p\)</span>-value in R</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="" aria-hidden="true" tabindex="-1"></a>pvalue_binom <span class="ot">&lt;-</span> <span class="cf">function</span>(n, mu, q) {</span>
<span id="cb37-2"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Обчислює p-значення для біноміального розподілу</span></span>
<span id="cb37-3"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Параметри:</span></span>
<span id="cb37-4"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   n: кількість випробувань</span></span>
<span id="cb37-5"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   mu: ймовірність успіху в нульовій гіпотезі</span></span>
<span id="cb37-6"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   q: кількість успіхів</span></span>
<span id="cb37-7"><a href="" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-8"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Обчислення p-значення</span></span>
<span id="cb37-9"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pbinom</span>(q <span class="sc">-</span> <span class="dv">1</span>, <span class="at">size =</span> n, <span class="at">prob =</span> mu))</span>
<span id="cb37-10"><a href="" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br>
</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="" aria-hidden="true" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="fu">pvalue_binom</span>(<span class="dv">30</span>, <span class="fl">0.5</span>, <span class="dv">19</span>)</span>
<span id="cb38-2"><a href="" aria-hidden="true" tabindex="-1"></a>message <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(p_value <span class="sc">&lt;=</span> <span class="fl">0.05</span>, </span>
<span id="cb38-3"><a href="" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">paste0</span>(<span class="st">"p-значення = "</span>, <span class="fu">round</span>(p_value, <span class="dv">3</span>), <span class="st">" &lt;= 0.05"</span>), </span>
<span id="cb38-4"><a href="" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">paste0</span>(<span class="st">"p-значення = "</span>, <span class="fu">round</span>(p_value, <span class="dv">3</span>), <span class="st">" &gt;= 0.05"</span>))</span>
<span id="cb38-5"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(message)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "p-значення = 0.1 &gt;= 0.05"</code></pre>
</div>
</div>
<p><br>
</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="" aria-hidden="true" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="fu">pvalue_binom</span>(<span class="dv">50</span>, <span class="fl">0.1</span>, <span class="dv">11</span>)</span>
<span id="cb40-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"p-значення = "</span>, <span class="fu">round</span>(p_value, <span class="dv">3</span>), <span class="fu">ifelse</span>(p_value <span class="sc">&lt;=</span> <span class="fl">0.05</span>, <span class="st">" &lt;= 0.05"</span>, <span class="st">" &gt;= 0.05"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "p-значення = 0.009 &lt;= 0.05"</code></pre>
</div>
</div>
</section></section>
<section>
<section id="two-way-criterion" class="title-slide slide level1 center" data-background-iframe=".06_files/libs/colored-particles/index.html">
<h1>Two-way criterion</h1>

</section>
<section id="two-way-criterion-1" class="slide level2">
<h2>Two-way criterion</h2>
<div class="columns">
<div class="column" style="width:60%;">
<p>Does the color of the car affect compliance with traffic rules?</p>
</div><div class="column" style="width:40%;">
<ul>
<li><span class="math inline">\(Q = \xi_1 + \xi_2 + \ldots + \xi_{n}\)</span></li>
<li><span class="math inline">\(H_0: \mu = 0.5\)</span></li>
<li><span class="hi"><span class="math inline">\(H_1: \mu \neq 0.5\)</span></span></li>
<li><span class="math inline">\(\alpha = 0.05\)</span></li>
</ul>
</div></div>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src=".06_files/figure-revealjs/binom-two-sided-1.svg" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>If <span class="math inline">\(q \geq 21\)</span> or <span class="math inline">\(q \leq 9\)</span>, then we reject <span class="math inline">\(H_0\)</span>.</p>
</div></div>
</section>
<section id="p-value-for-the-two-way-criterion" class="slide level2 smaller">
<h2><span class="math inline">\(p\)</span>-value for the Two-way criterion</h2>
<p>The criterion is <span class="math display">\[S = \{|Q(\xi) - 15|\ \geq C\}\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="" aria-hidden="true" tabindex="-1"></a>pvalue_two_sided_sum <span class="ot">&lt;-</span> <span class="cf">function</span>(n, q) {</span>
<span id="cb42-2"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate p-value for two-sided test with mu = 0.5</span></span>
<span id="cb42-3"><a href="" aria-hidden="true" tabindex="-1"></a>  binom_h0 <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">size =</span> n, <span class="at">prob =</span> <span class="fl">0.5</span>)</span>
<span id="cb42-4"><a href="" aria-hidden="true" tabindex="-1"></a>  diff <span class="ot">&lt;-</span> <span class="fu">abs</span>(q <span class="sc">-</span> <span class="dv">15</span>)</span>
<span id="cb42-5"><a href="" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-6"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate the right side of the two-tailed test (more extreme values on the right)</span></span>
<span id="cb42-7"><a href="" aria-hidden="true" tabindex="-1"></a>  right_sq <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">sum</span>(binom_h0[<span class="dv">1</span><span class="sc">:</span>(<span class="dv">15</span> <span class="sc">+</span> diff <span class="sc">-</span> <span class="dv">1</span>)])</span>
<span id="cb42-8"><a href="" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-9"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate the left side of the two-tailed test (more extreme values on the left)</span></span>
<span id="cb42-10"><a href="" aria-hidden="true" tabindex="-1"></a>  left_sq <span class="ot">&lt;-</span> <span class="fu">sum</span>(binom_h0[<span class="dv">1</span><span class="sc">:</span>(<span class="dv">15</span> <span class="sc">-</span> diff)])</span>
<span id="cb42-11"><a href="" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-12"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return the total p-value for the two-sided test</span></span>
<span id="cb42-13"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(left_sq <span class="sc">+</span> right_sq) <span class="co"># or 2 * right_sq for symmetric distribution</span></span>
<span id="cb42-14"><a href="" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br>
</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">pvalue_two_sided_sum</span>(<span class="dv">30</span>, <span class="dv">21</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.04277395</code></pre>
</div>
</div>
</section>
<section id="asymmetric-distribution" class="slide level2 smaller">
<h2>Asymmetric distribution</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb45-2"><a href="" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.8</span></span>
<span id="cb45-3"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the binomial distribution data</span></span>
<span id="cb45-5"><a href="" aria-hidden="true" tabindex="-1"></a>binom_h0_nonsym <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb45-6"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span>n,</span>
<span id="cb45-7"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="at">pmf =</span> <span class="fu">dbinom</span>(x, <span class="at">size =</span> n, <span class="at">prob =</span> p)</span>
<span id="cb45-8"><a href="" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

<img data-src=".06_files/figure-revealjs/binom-asym-plot-1.svg" class="quarto-figure quarto-figure-center r-stretch"><p>In order to construct a two-sided criterion, you need to find regions on the left and right whose area is no more than <span class="math inline">\(\frac{\alpha}{2}\)</span>.</p>
</section>
<section id="asymmetric-distribution-critical-region" class="slide level2 smaller">
<h2>Asymmetric distribution: critical region</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="" aria-hidden="true" tabindex="-1"></a>two_sided_criterion_nonsym <span class="ot">&lt;-</span> <span class="cf">function</span>(n, mu, alpha) {</span>
<span id="cb46-2"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Будує двосторонній критерій для несиметричної задачі з доставкою</span></span>
<span id="cb46-3"><a href="" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-4"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Параметри:</span></span>
<span id="cb46-5"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   n: кількість доставок в експерименті</span></span>
<span id="cb46-6"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   mu: ймовірність успіху в нульовій гіпотезі</span></span>
<span id="cb46-7"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   alpha: рівень значущості критерію</span></span>
<span id="cb46-8"><a href="" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-9"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Повертає:</span></span>
<span id="cb46-10"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   C1, C2 для критерію S = {Q &lt;= C1 або Q &gt;= C2}</span></span>
<span id="cb46-11"><a href="" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-12"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Створення об'єкту для біноміального розподілу</span></span>
<span id="cb46-13"><a href="" aria-hidden="true" tabindex="-1"></a>  binom_h0 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, mu)</span>
<span id="cb46-14"><a href="" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-15"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Аналогічно односторонньому критерію</span></span>
<span id="cb46-16"><a href="" aria-hidden="true" tabindex="-1"></a>  c2 <span class="ot">&lt;-</span> <span class="fu">qbinom</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>, <span class="at">size =</span> n, <span class="at">prob =</span> mu) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb46-17"><a href="" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-18"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co"># За викладками вище</span></span>
<span id="cb46-19"><a href="" aria-hidden="true" tabindex="-1"></a>  c1 <span class="ot">&lt;-</span> <span class="fu">qbinom</span>(alpha<span class="sc">/</span><span class="dv">2</span>, <span class="at">size =</span> n, <span class="at">prob =</span> mu) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb46-20"><a href="" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-21"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(c1, c2))</span>
<span id="cb46-22"><a href="" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br>
</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="" aria-hidden="true" tabindex="-1"></a>c1_c2 <span class="ot">&lt;-</span> <span class="fu">two_sided_criterion_nonsym</span>(<span class="dv">30</span>, <span class="fl">0.8</span>, <span class="fl">0.05</span>)</span>
<span id="cb47-2"><a href="" aria-hidden="true" tabindex="-1"></a>c1_c2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 18 29</code></pre>
</div>
</div>
</section>
<section id="asymmetric-distribution-criterion" class="slide level2 smaller">
<h2>Asymmetric distribution: criterion</h2>
<p>So, our criterion for testing the hypothesis is</p>
<p><span class="math display">\[H_0: \mu = 0.8\]</span> <span class="math display">\[H_1: \mu \neq 0.8\]</span></p>
<p>is as follows:</p>
<p><span class="math display">\[S = \{Q(\xi) \leq 18\} \cup \{Q(\xi) \geq 29\}\]</span></p>

<img data-src=".06_files/figure-revealjs/binom-asym-crit-plot-1.svg" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="asymmetric-distribution-p-value" class="slide level2 smaller">
<h2>Asymmetric distribution: <span class="math inline">\(p\)</span>-value</h2>
<p>This criterion is a combination of two significance level criteria <span class="math inline">\(\frac{\alpha}{2}\)</span>, for each of which <span class="math inline">\(p\)</span>-values can be calculated.</p>
<p>We denote them as <span class="math inline">\(p_1, p_2\)</span>.</p>
<p>The first criterion is rejected when <span class="math inline">\(p_1 \leqslant \frac{\alpha}{2}\)</span>, the second when <span class="math inline">\(p_2 \leqslant \frac{\alpha}{2}\)</span>.</p>
<p>And ours is unified when one of these conditions is met, i.e.</p>
<p><span class="math display">\[ 2p_1 \leqslant \alpha \vee 2p_2 \leqslant \alpha \Leftrightarrow 2 \cdot \min(p_1, p_2) \leqslant \alpha \]</span></p>
</section>
<section id="asymmetric-distribution-p-value-r" class="slide level2 smaller">
<h2>Asymmetric distribution: <span class="math inline">\(p\)</span>-value R</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="" aria-hidden="true" tabindex="-1"></a>pvalue_two_sided <span class="ot">&lt;-</span> <span class="cf">function</span>(n, q, <span class="at">mu =</span> <span class="fl">0.5</span>) {</span>
<span id="cb49-2"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Обчислює pvalue для двосторонньої альтернативи в задачі з доставкою</span></span>
<span id="cb49-3"><a href="" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-4"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Параметри:</span></span>
<span id="cb49-5"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co"># n: кількість доставок в експерименті</span></span>
<span id="cb49-6"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co"># q: кількість успішних доставок</span></span>
<span id="cb49-7"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co"># mu: ймовірність успіху при H0</span></span>
<span id="cb49-8"><a href="" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-9"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Розподіл біноміальний для H0</span></span>
<span id="cb49-10"><a href="" aria-hidden="true" tabindex="-1"></a>  binom_h0 <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">0</span><span class="sc">:</span>q, <span class="at">size =</span> n, <span class="at">prob =</span> mu)</span>
<span id="cb49-11"><a href="" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-12"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Рахуємо для лівої частини</span></span>
<span id="cb49-13"><a href="" aria-hidden="true" tabindex="-1"></a>  pvalue_left <span class="ot">&lt;-</span> <span class="fu">pbinom</span>(q, <span class="at">size =</span> n, <span class="at">prob =</span> mu)</span>
<span id="cb49-14"><a href="" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-15"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Рахуємо для правої частини</span></span>
<span id="cb49-16"><a href="" aria-hidden="true" tabindex="-1"></a>  pvalue_right <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pbinom</span>(q <span class="sc">-</span> <span class="dv">1</span>, <span class="at">size =</span> n, <span class="at">prob =</span> mu)</span>
<span id="cb49-17"><a href="" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-18"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Обчислюємо формулу</span></span>
<span id="cb49-19"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">2</span> <span class="sc">*</span> <span class="fu">min</span>(pvalue_left, pvalue_right))</span>
<span id="cb49-20"><a href="" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br>
</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">pvalue_two_sided</span>(<span class="dv">30</span>, <span class="dv">28</span>, <span class="at">mu =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.08835797</code></pre>
</div>
</div>
<p>It can be seen that the <span class="math inline">\(p\)</span>-value is <span class="math inline">\(&gt; 0.05\)</span>, so at a significance level of <span class="math inline">\(0.05\)</span>, even <span class="math inline">\(28\)</span> successes are not enough to reject the probability of success of <span class="math inline">\(80\%\)</span>.</p>
</section></section>
<section>
<section id="power-of-statistical-test" class="title-slide slide level1 center" data-background-iframe=".06_files/libs/colored-particles/index.html">
<h1>Power of statistical test</h1>

</section>
<section id="false-negative-error" class="slide level2 smaller">
<h2>False negative error</h2>
<p>Previously, we paid attention only to <span class="math inline">\(\alpha\)</span> — <strong>significance level</strong>.</p>
<p>This parameter controls the probability of detecting a <strong>type I error</strong> (<em>FPR, false positive rate</em>): a deviation of <span class="math inline">\(H_0\)</span> when it is actually true.</p>
<p><strong>In business terms</strong>, how many inefficient projects are we willing to invest resources in?</p>
<div class="fragment">
<center>
<span class="hi">Can we minimize this error??</span>
</center>
</div>
<div class="fragment">
<p>Yes!!! To do this, it is enough to never discard <span class="math inline">\(H_0\)</span></p>
<p><span class="math display">\[
S \equiv 0, \alpha = 0
\]</span></p>
</div>
<div class="fragment">
<p>If there is a Type I error, there is also a <strong>Type II error</strong> — <strong>False Negative Rate</strong> (<em>FNR</em>): accepting <span class="math inline">\(H_0\)</span> when <span class="math inline">\(H_1\)</span> is actually true.</p>
<p><strong>In business terms:</strong> how many effective projects are we willing to miss?</p>
<p><span class="math display">\[
\beta = \text{FNR} = \mathbb{P}(S=0|H_1)
\]</span></p>
</div>
</section>
<section id="criterion-for-time-of-year" class="slide level2 tiny">
<h2>Criterion for time of year ❄️☀️</h2>
<p><span class="math display">\[
H_0: \text{it's summer outside}
\]</span></p>
<p><span class="math display">\[
H_1: \text{it's not summer outside}
\]</span></p>
<div class="fragment">
<p><span class="math display">\[
\begin{equation}
Q = \begin{cases}
1, &amp; \text{if it is snowing outside} \\
0, &amp; \text{otherwise}
\end{cases}
\end{equation}
\]</span></p>
</div>
<div class="fragment">
<p><span class="math display">\[
\begin{equation}
S = Q = \begin{cases}
1, &amp; \text{if }Q = 1, \text{ reject } H_0 \\
0, &amp; \text{if }Q = 0, \text{ do not reject } H_0
\end{cases}
\end{equation}
\]</span></p>
</div>
<div class="fragment">
<p><span class="math display">\[
\alpha = \text{FPR} = \mathbb{P}(\text{it's snowing}|\text{it's summer}) &lt; 0.001
\]</span></p>
<p><span class="math display">\[
\beta = \text{FNR} = \mathbb{P}(\text{it is not snowing}|\text{it is not summer}) &gt; 0.9
\]</span></p>
</div>
<div class="fragment">
<p>As you can see, the criterion is quite useless.</p>
</div>
<div class="fragment">
<p>The <span class="hi">power of a statistical test</span> (<em>power, True Positive Rate</em>) is the probability of correctly rejecting <span class="math inline">\(H_0\)</span> when it is truly false, i.e., the ability to detect an effect if it really exists.</p>
<p><span class="math display">\[
\text{Power} = 1 - \beta = \mathbb{P}(S=1|H_1)
\]</span></p>
</div>
<div class="fragment">
<p>In our example: <span class="math inline">\(\text{Power} = 1 - 0.9 = 0.1\)</span>.</p>
</div>
</section>
<section id="power" class="slide level2 tiny">
<h2>Power</h2>
<div class="columns">
<div class="column" style="width:65%;">
<p>Let’s recall the delivery task:</p>
<p><span class="math inline">\(H_0: \mu = 0.5 \\H_1: \mu &gt; 0.5 \\Q = \text{number of confirmed orders} \\\alpha = 0.05 \\ S = \{Q \geq 20\}\)</span></p>
</div><div class="column fragment" style="width:35%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src=".06_files/figure-revealjs/power-h0-1.svg"></p>
</figure>
</div>
</div>
</div>
</div></div>
<div class="fragment">
<div class="columns">
<div class="column" style="width:65%;">
<p>Suppose that <span class="math inline">\(H_1\)</span> is true: <span class="math inline">\(\mu = 0.6\)</span>.</p>
</div><div class="column fragment" style="width:35%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src=".06_files/figure-revealjs/power-h1-1.svg"></p>
</figure>
</div>
</div>
</div>
</div></div>
</div>
<div class="fragment">
<p><span class="math display">\[\text{Power} = \mathbb{P}(Q \geq 20|\mu = 0.6)\]</span></p>
</div>
</section>
<section class="slide level2">

<p><span class="math display">\[\text{Power} = \mathbb{P}(Q \geq 20|\mu = 0.6)\]</span></p>

<img data-src=".06_files/figure-revealjs/power-1.svg" class="quarto-figure quarto-figure-center r-stretch"><div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>False Positive Rate is 4.9%</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Power is 29.1%</code></pre>
</div>
</div>
<p><span class="tiny">You can see that the power is about <span class="math inline">\(30\%\)</span>. This is quite a small value, because if our product is profitable, we will only see it with a probability of <span class="math inline">\(30\)</span> percent using our test. <strong>We can easily miss the effect.</strong></span></p>
</section>
<section id="r-and-the-power" class="slide level2 smaller">
<h2>R and the power</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="" aria-hidden="true" tabindex="-1"></a>get_stat_power <span class="ot">&lt;-</span> <span class="cf">function</span>(N, mu_h0, mu_alternative, alpha) {</span>
<span id="cb54-2"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Обчислення статистичної потужності для біноміального розподілу</span></span>
<span id="cb54-3"><a href="" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb54-4"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Створення біноміальних розподілів</span></span>
<span id="cb54-5"><a href="" aria-hidden="true" tabindex="-1"></a>  binom_h0 <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">0</span><span class="sc">:</span>N, <span class="at">size =</span> N, <span class="at">prob =</span> mu_h0)</span>
<span id="cb54-6"><a href="" aria-hidden="true" tabindex="-1"></a>  binom_alternative <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">0</span><span class="sc">:</span>N, <span class="at">size =</span> N, <span class="at">prob =</span> mu_alternative)</span>
<span id="cb54-7"><a href="" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb54-8"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Обчислення критичного значення</span></span>
<span id="cb54-9"><a href="" aria-hidden="true" tabindex="-1"></a>  critical_value <span class="ot">&lt;-</span> <span class="fu">qbinom</span>(<span class="dv">1</span> <span class="sc">-</span> alpha, <span class="at">size =</span> N, <span class="at">prob =</span> mu_h0) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb54-10"><a href="" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb54-11"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Обчислення потужності</span></span>
<span id="cb54-12"><a href="" aria-hidden="true" tabindex="-1"></a>  power <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pbinom</span>(critical_value <span class="sc">-</span> <span class="dv">1</span>, <span class="at">size =</span> N, <span class="at">prob =</span> mu_alternative)</span>
<span id="cb54-13"><a href="" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb54-14"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(power)</span>
<span id="cb54-15"><a href="" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br>
</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">get_stat_power</span>(<span class="at">N =</span> <span class="dv">30</span>, <span class="at">mu_h0 =</span> <span class="fl">0.5</span>, <span class="at">mu_alternative =</span> <span class="fl">0.6</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2914719</code></pre>
</div>
</div>
<p>Let’s see what happens if we conduct an experiment with 300 customers.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">get_stat_power</span>(<span class="at">N =</span> <span class="dv">300</span>, <span class="at">mu_h0 =</span> <span class="fl">0.5</span>, <span class="at">mu_alternative =</span> <span class="fl">0.6</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9655327</code></pre>
</div>
</div>
</section>
<section id="r-and-the-power-1" class="slide level2 smaller">
<h2>R and the power</h2>
<p>It is generally accepted that <span class="math inline">\(80\%\)</span> of power is considered acceptable for work.</p>
<p>Let’s see how the power changes as the sample size increases, and how many experiments are needed to detect the effect at <span class="math inline">\(\mu=0.6\)</span> in <span class="math inline">\(80\%\)</span> of cases.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="" aria-hidden="true" tabindex="-1"></a>n_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">600</span>, <span class="at">by =</span> <span class="dv">10</span>)</span>
<span id="cb59-2"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Обчислення потужності для різних розмірів вибірки</span></span>
<span id="cb59-4"><a href="" aria-hidden="true" tabindex="-1"></a>power <span class="ot">&lt;-</span> <span class="fu">sapply</span>(n_grid, <span class="cf">function</span>(N) <span class="fu">get_stat_power</span>(N, <span class="at">mu_h0 =</span> <span class="fl">0.5</span>, <span class="at">mu_alternative =</span> <span class="fl">0.6</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>))</span>
<span id="cb59-5"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-6"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Побудова графіку</span></span>
<span id="cb59-7"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">n =</span> n_grid, <span class="at">power =</span> power), <span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> power)) <span class="sc">+</span></span>
<span id="cb59-8"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb59-9"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb59-10"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">min</span>(n_grid[power <span class="sc">&gt;=</span> <span class="fl">0.8</span>]), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"turquoise"</span>) <span class="sc">+</span></span>
<span id="cb59-11"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb59-12"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb59-13"><a href="" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb59-14"><a href="" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span></span>
<span id="cb59-15"><a href="" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src=".06_files/figure-revealjs/power-example-80-1.svg" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="r-and-the-power-2" class="slide level2 smaller">
<h2>R and the power</h2>
<p>What if we want to detect an even smaller effect? For example, if we want to reject the hypothesis at <span class="math inline">\(\mu = 0.51\)</span>. Often, an improvement in the probability of success by <span class="math inline">\(1\%\)</span> can be significant for a product, so this question is not without meaning.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="" aria-hidden="true" tabindex="-1"></a>n_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">30000</span>, <span class="at">by =</span> <span class="dv">59</span>)</span>
<span id="cb60-2"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Обчислення потужності для різних розмірів вибірки</span></span>
<span id="cb60-4"><a href="" aria-hidden="true" tabindex="-1"></a>power <span class="ot">&lt;-</span> <span class="fu">sapply</span>(n_grid, <span class="cf">function</span>(N) <span class="fu">get_stat_power</span>(N, <span class="at">mu_h0 =</span> <span class="fl">0.5</span>, <span class="at">mu_alternative =</span> <span class="fl">0.51</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>))</span>
<span id="cb60-5"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-6"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Побудова графіку</span></span>
<span id="cb60-7"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">n =</span> n_grid, <span class="at">power =</span> power), <span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> power)) <span class="sc">+</span></span>
<span id="cb60-8"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb60-9"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb60-10"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">min</span>(n_grid[power <span class="sc">&gt;=</span> <span class="fl">0.8</span>]), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"turquoise"</span>) <span class="sc">+</span></span>
<span id="cb60-11"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb60-12"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb60-13"><a href="" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb60-14"><a href="" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span></span>
<span id="cb60-15"><a href="" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src=".06_files/figure-revealjs/power-example-51-1.svg" class="quarto-figure quarto-figure-center r-stretch"></section>
<section class="slide level2">

<p>Before each experiment, the analyst should think about <span class="hi">test duration</span> and <span class="hi-slate">number of participants</span>.</p>
<p><br>
</p>
<p>To do this, you need to understand:</p>
<ul>
<li>What effect is practically significant for the task?</li>
<li>How many subjects will it take to detect this effect more often than <span class="math inline">\(80\%\)</span> of the time?</li>
</ul>
</section>
<section id="r-and-the-power-3" class="slide level2 smaller">
<h2>R and the power</h2>
<p>The graphs show that a larger sample size is required to detect a smaller effect.</p>
<p>Let’s see how the power changes for different parameters <span class="math inline">\(\mu\)</span> for a fixed <span class="math inline">\(N = 30\)</span>.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="" aria-hidden="true" tabindex="-1"></a>mu_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">500</span>)</span>
<span id="cb61-2"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Обчислення потужності для різних значень mu</span></span>
<span id="cb61-4"><a href="" aria-hidden="true" tabindex="-1"></a>power <span class="ot">&lt;-</span> <span class="fu">sapply</span>(mu_grid, <span class="cf">function</span>(mu) <span class="fu">get_stat_power</span>(<span class="dv">30</span>, <span class="at">mu_h0 =</span> <span class="fl">0.5</span>, <span class="at">mu_alternative =</span> mu, <span class="at">alpha =</span> <span class="fl">0.05</span>))</span>
<span id="cb61-5"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-6"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Побудова графіку</span></span>
<span id="cb61-7"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">mu =</span> mu_grid, <span class="at">power =</span> power), <span class="fu">aes</span>(<span class="at">x =</span> mu, <span class="at">y =</span> power)) <span class="sc">+</span></span>
<span id="cb61-8"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb61-9"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb61-10"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">min</span>(mu_grid[power <span class="sc">&gt;=</span> <span class="fl">0.8</span>]), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"turquoise"</span>) <span class="sc">+</span></span>
<span id="cb61-11"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb61-12"><a href="" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Power for $N = 30$"</span>,</span>
<span id="cb61-13"><a href="" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"$</span><span class="sc">\\</span><span class="st">mu$"</span>,</span>
<span id="cb61-14"><a href="" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Потужність"</span></span>
<span id="cb61-15"><a href="" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb61-16"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb61-17"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb61-18"><a href="" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb61-19"><a href="" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span></span>
<span id="cb61-20"><a href="" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src=".06_files/figure-revealjs/power-example-mu-1.svg" class="quarto-figure quarto-figure-center r-stretch"><p>In our experiment, we detect an effect well only if the probability of success in the population is at least <span class="math inline">\(72\%\)</span>.</p>
</section></section>
<section>
<section id="minimum-detectable-effect-mde" class="title-slide slide level1 center" data-background-iframe=".06_files/libs/colored-particles/index.html">
<h1>Minimum detectable effect <em>(MDE)</em></h1>

</section>
<section id="minimum-detectable-effect" class="slide level2 smaller">
<h2>Minimum detectable effect</h2>
<p><span class="hi">Minimal Detectable Effect</span> (<em>MDE, Minimal Detectable Effect</em>) — this is the smallest effect that we can detect with an experiment (usually at <span class="math inline">\(80\%\)</span> power).</p>

<img data-src=".06_files/figure-revealjs/power-example-mu-2-1.svg" class="quarto-figure quarto-figure-center r-stretch"><p>In our example, <span class="math inline">\(\text{MDE} = +0.22\)</span></p>
<p><br>
</p>
<div class="callout callout-warning no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>More formally</strong></p>
</div>
<div class="callout-content">
<p><span class="math inline">\(\text{MDE}\)</span> for the hypothesis <span class="math inline">\(\mathsf{H}_0: \mu = \mu_0\)</span> — this is the minimum effect of <span class="math inline">\(\delta\)</span> at which the significance level criterion <span class="math inline">\(\alpha\)</span> for testing this hypothesis, given the true parameter <span class="math inline">\(\mu = \mu_0 + \delta\)</span> and sample size <span class="math inline">\(N\)</span>, will reject <span class="math inline">\(\mathsf{H}_0\)</span> with power greater than <span class="math inline">\(1 - \beta\)</span>.</p>
</div>
</div>
</div>
</section>
<section id="r-та-mde" class="slide level2 smaller">
<h2>R та MDE</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="" aria-hidden="true" tabindex="-1"></a>binom_test_mde_one_sided <span class="ot">&lt;-</span> <span class="cf">function</span>(N, mu0, <span class="at">alpha =</span> <span class="fl">0.05</span>, <span class="at">min_power =</span> <span class="fl">0.8</span>) {</span>
<span id="cb62-2"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Генеруємо сітку можливих ефектів (delta)</span></span>
<span id="cb62-3"><a href="" aria-hidden="true" tabindex="-1"></a>  delta_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span> <span class="sc">-</span> mu0, <span class="at">length.out =</span> <span class="dv">500</span>)</span>
<span id="cb62-4"><a href="" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-5"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Обчислюємо потужність для кожного delta</span></span>
<span id="cb62-6"><a href="" aria-hidden="true" tabindex="-1"></a>  power <span class="ot">&lt;-</span> <span class="fu">sapply</span>(delta_grid, <span class="cf">function</span>(delta) {</span>
<span id="cb62-7"><a href="" aria-hidden="true" tabindex="-1"></a>    <span class="fu">get_stat_power</span>(N, mu0, mu0 <span class="sc">+</span> delta, alpha)</span>
<span id="cb62-8"><a href="" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb62-9"><a href="" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-10"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Знаходимо перший delta, для якого потужність &gt;= min_power</span></span>
<span id="cb62-11"><a href="" aria-hidden="true" tabindex="-1"></a>  fit_delta <span class="ot">&lt;-</span> delta_grid[power <span class="sc">&gt;=</span> min_power]</span>
<span id="cb62-12"><a href="" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-13"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(fit_delta[<span class="dv">1</span>])</span>
<span id="cb62-14"><a href="" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br>
</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">binom_test_mde_one_sided</span>(<span class="at">N=</span><span class="dv">30</span>, <span class="at">mu0=</span><span class="fl">0.5</span>, <span class="at">alpha=</span><span class="fl">0.05</span>, <span class="at">min_power=</span><span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2184369</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="smaller">
<p>Usually, <span class="math inline">\(\text{MDE}\)</span> is calculated for a reason, and the question of determining the sample size goes hand in hand with it.</p>
<p><br>
</p>
<p><strong>Determining the sample size</strong></p>
<p><br>
</p>
<p>In our task, we found <span class="math inline">\(30\)</span> customers without first calculating how many of them we would need. But what if the resulting <span class="math inline">\(\text{MDE}\)</span> is too large and you need to make it smaller because the expected changes are much smaller? Then the opposite problem is solved: given the required <span class="math inline">\(\text{MDE}\)</span>, determine the sample size. If we say that we want to detect <span class="math inline">\(+10\)</span> pp, i.e.&nbsp;<span class="math inline">\(60\%\)</span> of successful deliveries, then we need to find 160 test customers, as you can see from the previous graphs. If we search for 30 people for a month, for example, such a test can take almost six months. Therefore, it is worth considering allocating additional resources to find customers, for example, by engaging marketers.</p>
</div>
</section></section>
<section>
<section id="confidence-intervals" class="title-slide slide level1 center" data-background-iframe=".06_files/libs/colored-particles/index.html">
<h1>Confidence intervals</h1>

</section>
<section id="confidence-interval" class="slide level2">
<h2>Confidence interval</h2>
<p><span class="hi">Confidence interval</span> (<em>CI, confidence interval</em>) — the set of values of the parameter <span class="math inline">\(\mu_0,\)</span> for which the hypothesis <span class="math inline">\(\mu = \mu_0\)</span> is not rejected by the significance level criterion <span class="math inline">\(\alpha\)</span> with a known probability <span class="math inline">\(\geq 1 - \alpha\)</span>.</p>
<p>The definition implies that different criteria can give rise to different confidence intervals. In this section, we will consider what intervals are generated by a two-sided criterion.</p>
<p>To do this, we will use <span class="math inline">\(\mu \in [0, 1]\)</span> in increments of <span class="math inline">\(0.001\)</span> and test the hypotheses.</p>
</section>
<section id="r-and-confidence-interval" class="slide level2 tiny">
<h2>R and confidence interval</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="" aria-hidden="true" tabindex="-1"></a>two_sided_criterion_nonsym <span class="ot">&lt;-</span> <span class="cf">function</span>(n, mu, alpha) {</span>
<span id="cb65-2"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Створюємо біноміальний розподіл для H0</span></span>
<span id="cb65-3"><a href="" aria-hidden="true" tabindex="-1"></a>  binom_h0 <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">0</span><span class="sc">:</span>n, <span class="at">size =</span> n, <span class="at">prob =</span> mu)</span>
<span id="cb65-4"><a href="" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-5"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Аналогічно односторонньому критерію</span></span>
<span id="cb65-6"><a href="" aria-hidden="true" tabindex="-1"></a>  c2 <span class="ot">&lt;-</span> <span class="fu">qbinom</span>(<span class="dv">1</span> <span class="sc">-</span> alpha <span class="sc">/</span> <span class="dv">2</span>, <span class="at">size =</span> n, <span class="at">prob =</span> mu) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb65-7"><a href="" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-8"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co"># За викладками вище</span></span>
<span id="cb65-9"><a href="" aria-hidden="true" tabindex="-1"></a>  c1 <span class="ot">&lt;-</span> <span class="fu">qbinom</span>(alpha <span class="sc">/</span> <span class="dv">2</span>, <span class="at">size =</span> n, <span class="at">prob =</span> mu) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb65-10"><a href="" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-11"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(c1, c2))</span>
<span id="cb65-12"><a href="" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column fragment" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="" aria-hidden="true" tabindex="-1"></a>success_cnt <span class="ot">&lt;-</span> <span class="dv">19</span></span>
<span id="cb66-2"><a href="" aria-hidden="true" tabindex="-1"></a>mu_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.001</span>)</span>
<span id="cb66-3"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="" aria-hidden="true" tabindex="-1"></a>mu_no_rejection <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">mu_h0 =</span> mu_grid) <span class="sc">%&gt;%</span></span>
<span id="cb66-5"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb66-6"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>({</span>
<span id="cb66-7"><a href="" aria-hidden="true" tabindex="-1"></a>    crit <span class="ot">&lt;-</span> <span class="fu">two_sided_criterion_nonsym</span>(<span class="dv">30</span>, mu_h0, <span class="at">alpha =</span> <span class="fl">0.05</span>)</span>
<span id="cb66-8"><a href="" aria-hidden="true" tabindex="-1"></a>    success_cnt <span class="sc">&gt;</span> crit[<span class="dv">1</span>] <span class="sc">&amp;&amp;</span> success_cnt <span class="sc">&lt;</span> crit[<span class="dv">2</span>]</span>
<span id="cb66-9"><a href="" aria-hidden="true" tabindex="-1"></a>  }) <span class="sc">%&gt;%</span></span>
<span id="cb66-10"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(mu_h0)</span>
<span id="cb66-11"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-12"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"95%% confidence interval: %.3f -- %.3f"</span>, <span class="fu">min</span>(mu_no_rejection), <span class="fu">max</span>(mu_no_rejection)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>95% confidence interval: 0.439 -- 0.800</code></pre>
</div>
</div>
<p>Не відхиляємо <span class="math inline">\(H_0\)</span>!</p>
<p><br>
</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="" aria-hidden="true" tabindex="-1"></a>success_cnt <span class="ot">&lt;-</span> <span class="dv">28</span></span>
<span id="cb68-2"><a href="" aria-hidden="true" tabindex="-1"></a>mu_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.001</span>)</span>
<span id="cb68-3"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-4"><a href="" aria-hidden="true" tabindex="-1"></a>mu_no_rejection <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">mu_h0 =</span> mu_grid) <span class="sc">%&gt;%</span></span>
<span id="cb68-5"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb68-6"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>({</span>
<span id="cb68-7"><a href="" aria-hidden="true" tabindex="-1"></a>    crit <span class="ot">&lt;-</span> <span class="fu">two_sided_criterion_nonsym</span>(<span class="dv">30</span>, mu_h0, <span class="at">alpha =</span> <span class="fl">0.05</span>)</span>
<span id="cb68-8"><a href="" aria-hidden="true" tabindex="-1"></a>    success_cnt <span class="sc">&gt;</span> crit[<span class="dv">1</span>] <span class="sc">&amp;&amp;</span> success_cnt <span class="sc">&lt;</span> crit[<span class="dv">2</span>]</span>
<span id="cb68-9"><a href="" aria-hidden="true" tabindex="-1"></a>  }) <span class="sc">%&gt;%</span></span>
<span id="cb68-10"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(mu_h0)</span>
<span id="cb68-11"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-12"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"95%% confidence interval: %.3f -- %.3f"</span>, <span class="fu">min</span>(mu_no_rejection), <span class="fu">max</span>(mu_no_rejection)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>95% confidence interval: 0.780 -- 0.991</code></pre>
</div>
</div>
<p>We reject <span class="math inline">\(H_0\)</span>!</p>
</div></div>
</section>
<section class="slide level2">

<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="" aria-hidden="true" tabindex="-1"></a>mus_h0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.438</span>, <span class="fl">0.439</span>, <span class="fl">0.8</span>, <span class="fl">0.81</span>, <span class="fl">0.9</span>)</span>
<span id="cb70-2"><a href="" aria-hidden="true" tabindex="-1"></a>success_cnt <span class="ot">&lt;-</span> <span class="dv">19</span></span>
<span id="cb70-3"><a href="" aria-hidden="true" tabindex="-1"></a>x_grid <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">30</span></span>
<span id="cb70-4"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-5"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an empty data frame to store all plots</span></span>
<span id="cb70-6"><a href="" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">rep</span>(x_grid, <span class="fu">length</span>(mus_h0)),</span>
<span id="cb70-7"><a href="" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mu_h0 =</span> <span class="fu">rep</span>(mus_h0, <span class="at">each =</span> <span class="fu">length</span>(x_grid)),</span>
<span id="cb70-8"><a href="" aria-hidden="true" tabindex="-1"></a>                    <span class="at">prob =</span> <span class="fu">dbinom</span>(x, <span class="at">size =</span> <span class="dv">30</span>, <span class="at">prob =</span> mu_h0),</span>
<span id="cb70-9"><a href="" aria-hidden="true" tabindex="-1"></a>                    <span class="at">c1 =</span> <span class="fu">qbinom</span>(<span class="fl">0.025</span>, <span class="at">size =</span> <span class="dv">30</span>, <span class="at">prob =</span> mu_h0),</span>
<span id="cb70-10"><a href="" aria-hidden="true" tabindex="-1"></a>                    <span class="at">c2 =</span> <span class="fu">qbinom</span>(<span class="fl">0.975</span>, <span class="at">size =</span> <span class="dv">30</span>, <span class="at">prob =</span> mu_h0),</span>
<span id="cb70-11"><a href="" aria-hidden="true" tabindex="-1"></a>                    <span class="at">reject =</span> <span class="fu">if_else</span>(x <span class="sc">&lt;</span> c1 <span class="sc">|</span> x <span class="sc">&gt;</span> c2, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>))</span>
<span id="cb70-12"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-13"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb70-14"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> prob, <span class="at">group =</span> mu_h0)) <span class="sc">+</span></span>
<span id="cb70-15"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> reject), <span class="at">width =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb70-16"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">19</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb70-17"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="fu">filter</span>(plot_data, x <span class="sc">==</span> <span class="dv">19</span>), <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">if_else</span>(reject, <span class="st">"Reject"</span>, <span class="st">"Do not reject"</span>)), <span class="at">y =</span> <span class="fl">0.1</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb70-18"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb70-19"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb70-20"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"turquoise"</span>, <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb70-21"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> mu_h0, <span class="at">scales =</span> <span class="st">"free_y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src=".06_files/figure-revealjs/ci-fig-6-1.svg" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="one-sided-confidence-intervals" class="slide level2">
<h2>One-sided confidence intervals</h2>
<p>In the last part, we used a <strong>two-sided criterion</strong> and derived a confidence interval from it.</p>
<p>But in the last lecture, we said that the two-sided criterion is needed <strong>extremely rarely</strong>.</p>
<p>We need to control the <em>False Positive</em> error only for deviations in the direction that is useful for the business.</p>
<p>In the case of a delivery task, this is getting a <em>larger</em> conversion to success.</p>
<p><br>
</p>
<p>Let’s try to use a one-sided criterion to build a confidence interval.</p>
</section>
<section id="r-and-one-way-spacing" class="slide level2 smaller">
<h2>R and one-way spacing</h2>
<div class="columns">
<div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="" aria-hidden="true" tabindex="-1"></a>make_binom_criterion <span class="ot">&lt;-</span> <span class="cf">function</span>(n, <span class="at">mu =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>) {</span>
<span id="cb71-2"><a href="" aria-hidden="true" tabindex="-1"></a>  binom_h0 <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">0</span><span class="sc">:</span>n, <span class="at">size =</span> n, <span class="at">prob =</span> mu)</span>
<span id="cb71-3"><a href="" aria-hidden="true" tabindex="-1"></a>  q <span class="ot">&lt;-</span> <span class="fu">qbinom</span>(<span class="dv">1</span> <span class="sc">-</span> alpha, <span class="at">size =</span> n, <span class="at">prob =</span> mu)</span>
<span id="cb71-4"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(q <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb71-5"><a href="" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:60%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="" aria-hidden="true" tabindex="-1"></a>success_cnt <span class="ot">&lt;-</span> <span class="dv">19</span></span>
<span id="cb72-2"><a href="" aria-hidden="true" tabindex="-1"></a>mu_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.001</span>)</span>
<span id="cb72-3"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-4"><a href="" aria-hidden="true" tabindex="-1"></a>mu_no_rejection <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">mu_h0 =</span> mu_grid) <span class="sc">%&gt;%</span></span>
<span id="cb72-5"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb72-6"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>({</span>
<span id="cb72-7"><a href="" aria-hidden="true" tabindex="-1"></a>    crit_vals <span class="ot">&lt;-</span> <span class="fu">two_sided_criterion_nonsym</span>(<span class="at">n =</span> <span class="dv">30</span>, <span class="at">mu =</span> mu_h0, <span class="at">alpha =</span> <span class="fl">0.1</span>)</span>
<span id="cb72-8"><a href="" aria-hidden="true" tabindex="-1"></a>    success_cnt <span class="sc">&gt;</span> crit_vals[<span class="dv">1</span>] <span class="sc">&amp;</span> success_cnt <span class="sc">&lt;</span> crit_vals[<span class="dv">2</span>]</span>
<span id="cb72-9"><a href="" aria-hidden="true" tabindex="-1"></a>  }) <span class="sc">%&gt;%</span></span>
<span id="cb72-10"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(mu_h0)</span>
<span id="cb72-11"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-12"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Two-sided 90%% confidence interval: %.3f -- %.3f"</span>, <span class="fu">min</span>(mu_no_rejection), <span class="fu">max</span>(mu_no_rejection)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Two-sided 90% confidence interval: 0.467 -- 0.778</code></pre>
</div>
</div>
</div></div>
<p>When we used a two-sided interval, we got a left-handed bound of <span class="math inline">\(0.439 &lt; 0.467\)</span>.</p>
<p>It turns out that the one-sided interval gives us more information from the point of view of the left bound. At the same time, from the point of view of the right bound, we lose information completely. It is equal to 1 simply because the probability cannot be greater.</p>
<p>In fact, the right-hand side is usually not looked at in an analysis when we are looking for a positive effect.</p>
</section>
<section id="r-and-one-way-ci" class="slide level2 tiny">
<h2>R and one-way CI</h2>
<p>Let’s say we got <span class="math inline">\(22\)</span> instead of <span class="math inline">\(19\)</span> of successes. Let’s plot 2 types of intervals.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="" aria-hidden="true" tabindex="-1"></a>success_cnt <span class="ot">&lt;-</span> <span class="dv">22</span></span>
<span id="cb74-2"><a href="" aria-hidden="true" tabindex="-1"></a>mu_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.001</span>)</span>
<span id="cb74-3"><a href="" aria-hidden="true" tabindex="-1"></a>mu_no_rejection <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb74-4"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-5"><a href="" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (mu_h0 <span class="cf">in</span> mu_grid) {</span>
<span id="cb74-6"><a href="" aria-hidden="true" tabindex="-1"></a>  c1_c2 <span class="ot">&lt;-</span> <span class="fu">two_sided_criterion_nonsym</span>(<span class="at">n =</span> <span class="dv">30</span>, <span class="at">mu =</span> mu_h0, <span class="at">alpha =</span> <span class="fl">0.05</span>)</span>
<span id="cb74-7"><a href="" aria-hidden="true" tabindex="-1"></a>  c1 <span class="ot">&lt;-</span> c1_c2[<span class="dv">1</span>]</span>
<span id="cb74-8"><a href="" aria-hidden="true" tabindex="-1"></a>  c2 <span class="ot">&lt;-</span> c1_c2[<span class="dv">2</span>]</span>
<span id="cb74-9"><a href="" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb74-10"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (success_cnt <span class="sc">&gt;</span> c1 <span class="sc">&amp;&amp;</span> success_cnt <span class="sc">&lt;</span> c2) {</span>
<span id="cb74-11"><a href="" aria-hidden="true" tabindex="-1"></a>    mu_no_rejection <span class="ot">&lt;-</span> <span class="fu">c</span>(mu_no_rejection, mu_h0)</span>
<span id="cb74-12"><a href="" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb74-13"><a href="" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb74-14"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-15"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Two-sided 95%% confidence interval: %.3f -- %.3f"</span>, <span class="fu">min</span>(mu_no_rejection), <span class="fu">max</span>(mu_no_rejection)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Two-sided 95% confidence interval: 0.542 -- 0.877</code></pre>
</div>
</div>
<p><br>
</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="" aria-hidden="true" tabindex="-1"></a>success_cnt <span class="ot">&lt;-</span> <span class="dv">22</span></span>
<span id="cb76-2"><a href="" aria-hidden="true" tabindex="-1"></a>mu_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.001</span>)</span>
<span id="cb76-3"><a href="" aria-hidden="true" tabindex="-1"></a>mu_no_rejection <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb76-4"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-5"><a href="" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (mu_h0 <span class="cf">in</span> mu_grid) {</span>
<span id="cb76-6"><a href="" aria-hidden="true" tabindex="-1"></a>  crit_val <span class="ot">&lt;-</span> <span class="fu">make_binom_criterion</span>(<span class="at">n =</span> <span class="dv">30</span>, <span class="at">mu =</span> mu_h0, <span class="at">alpha =</span> <span class="fl">0.05</span>)</span>
<span id="cb76-7"><a href="" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb76-8"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (success_cnt <span class="sc">&lt;</span> crit_val) {</span>
<span id="cb76-9"><a href="" aria-hidden="true" tabindex="-1"></a>    mu_no_rejection <span class="ot">&lt;-</span> <span class="fu">c</span>(mu_no_rejection, mu_h0)</span>
<span id="cb76-10"><a href="" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb76-11"><a href="" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb76-12"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-13"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"One-sided 95%% confidence interval: %.2f -- %.3f"</span>, <span class="fu">min</span>(mu_no_rejection), <span class="fu">max</span>(mu_no_rejection)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>One-sided 95% confidence interval: 0.57 -- 1.000</code></pre>
</div>
</div>
</section>
<section id="r-and-one-way-ci-1" class="slide level2 smaller">
<h2>R and one-way CI</h2>
<p>So why do we use two-sided spacing at all? To understand this, let’s see what the borders look like for a one-sided spacing.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb78-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb78-3"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-4"><a href="" aria-hidden="true" tabindex="-1"></a>mus_h0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.438</span>, <span class="fl">0.439</span>, <span class="fl">0.8</span>, <span class="fl">0.81</span>, <span class="fl">0.9</span>)</span>
<span id="cb78-5"><a href="" aria-hidden="true" tabindex="-1"></a>success_cnt <span class="ot">&lt;-</span> <span class="dv">19</span></span>
<span id="cb78-6"><a href="" aria-hidden="true" tabindex="-1"></a>x_grid <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">30</span></span>
<span id="cb78-7"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-8"><a href="" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb78-9"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">rep</span>(x_grid, <span class="fu">length</span>(mus_h0)),</span>
<span id="cb78-10"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="at">mu_h0 =</span> <span class="fu">rep</span>(mus_h0, <span class="at">each =</span> <span class="fu">length</span>(x_grid)),</span>
<span id="cb78-11"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="at">prob =</span> <span class="fu">dbinom</span>(x, <span class="at">size =</span> <span class="dv">30</span>, <span class="at">prob =</span> mu_h0),</span>
<span id="cb78-12"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="at">c =</span> <span class="fu">qbinom</span>(<span class="fl">0.05</span>, <span class="at">size =</span> <span class="dv">30</span>, <span class="at">prob =</span> mu_h0, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>),</span>
<span id="cb78-13"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="at">reject =</span> <span class="fu">if_else</span>(x <span class="sc">&gt;=</span> c, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>)</span>
<span id="cb78-14"><a href="" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb78-15"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-16"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> prob, <span class="at">group =</span> mu_h0)) <span class="sc">+</span></span>
<span id="cb78-17"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> reject), <span class="at">width =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb78-18"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">19</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb78-19"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="fu">filter</span>(plot_data, x <span class="sc">==</span> <span class="dv">19</span>), <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">if_else</span>(reject, <span class="st">"Reject"</span>, <span class="st">"Do not reject"</span>)), <span class="at">y =</span> <span class="fl">0.1</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb78-20"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb78-21"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb78-22"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"turquoise"</span>, <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb78-23"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> mu_h0, <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src=".06_files/figure-revealjs/ci-fig-6-one-sided-1.svg" class="quarto-figure quarto-figure-center r-stretch"></section>
<section class="slide level2">

<p>The critical region has become <strong>larger</strong> because it now contains not <span class="math inline">\(2.5\%\)</span>, but <span class="math inline">\(5\%\)</span> by construction. At the same time, the <strong>left</strong> critical region simply does not exist, so at large <span class="math inline">\(\mu\)</span> <span class="math inline">\(19\)</span> does not fall into it, and thus we do not reject the hypothesis.</p>
<p><br>
</p>
<p>Note that if we were to construct a two-sided interval, but with twice the <span class="math inline">\(\alpha\)</span>, hits in the right critical region would occur at the same <span class="math inline">\(\mu\)</span> as in the one-sided criterion. Therefore, often <strong>to find a one-sided</strong> limit, a two-sided confidence interval with a <strong>larger</strong> <span class="math inline">\(\alpha\)</span> is constructed, ignoring the right-hand side. This is convenient because you can use only one function for a criterion.</p>
</section>
<section id="r-and-one-way-ci-2" class="slide level2 smaller">
<h2>R and one-way CI</h2>
<p>Let’s check what happens when <span class="math inline">\(\alpha = 0.1\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="" aria-hidden="true" tabindex="-1"></a>success_cnt <span class="ot">&lt;-</span> <span class="dv">19</span></span>
<span id="cb79-2"><a href="" aria-hidden="true" tabindex="-1"></a>mu_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.001</span>)</span>
<span id="cb79-3"><a href="" aria-hidden="true" tabindex="-1"></a>mu_no_rejection <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb79-4"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-5"><a href="" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (mu_h0 <span class="cf">in</span> mu_grid) {</span>
<span id="cb79-6"><a href="" aria-hidden="true" tabindex="-1"></a>  crit_vals <span class="ot">&lt;-</span> <span class="fu">two_sided_criterion_nonsym</span>(<span class="at">n =</span> <span class="dv">30</span>, <span class="at">mu =</span> mu_h0, <span class="at">alpha =</span> <span class="fl">0.1</span>)</span>
<span id="cb79-7"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (success_cnt <span class="sc">&gt;</span> crit_vals[<span class="dv">1</span>] <span class="sc">&amp;</span> success_cnt <span class="sc">&lt;</span> crit_vals[<span class="dv">2</span>]) {</span>
<span id="cb79-8"><a href="" aria-hidden="true" tabindex="-1"></a>    mu_no_rejection <span class="ot">&lt;-</span> <span class="fu">c</span>(mu_no_rejection, mu_h0)</span>
<span id="cb79-9"><a href="" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb79-10"><a href="" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb79-11"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-12"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Two-sided 90%% confidence interval: %.3f -- %.3f"</span>, <span class="fu">min</span>(mu_no_rejection), <span class="fu">max</span>(mu_no_rejection)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Two-sided 90% confidence interval: 0.467 -- 0.778</code></pre>
</div>
</div>
</section>
<section id="confidence-interval-property" class="slide level2">
<h2>Confidence interval property</h2>
<p>Whatever the true value of <span class="math inline">\(\mu = \mu_0\)</span>, the probability that it is between <span class="math inline">\(\mathcal{L}(Q)\)</span> and <span class="math inline">\(\mathcal{R}(Q)\)</span> is at least <span class="math inline">\(1 - \alpha\)</span>.</p>
<p>The value <span class="math inline">\(1 - \alpha\)</span> is called the <span class="hi">confidence level</span> of the confidence interval.</p>
<p><span class="math display">\[ P(\mathcal{L}(Q) &lt; \mu_0 &lt; \mathcal{R}(Q)) \geqslant 1 - \alpha \]</span></p>
<p>It is important that the randomness here is hidden in <span class="math inline">\(\mathcal{L}\)</span> and <span class="math inline">\(\mathcal{R}\)</span>, not in <span class="math inline">\(\mu_0\)</span>.</p>
<p>The parameter <span class="math inline">\(\mu_0\)</span> is unknown, but we assume it to be constant and not random.</p>
</section>
<section id="checking-the-property" class="slide level2 tiny">
<h2>Checking the property</h2>
<div class="columns">
<div class="column" style="width:40%;">
<p>To do this, we fix <span class="math inline">\(\mu_0\)</span> and conduct a set of experiments:</p>
<ul>
<li>Draw a sample from the distribution with parameter <span class="math inline">\(\mu_0\)</span>.</li>
<li>Calculate the statistic <span class="math inline">\(q\)</span>.</li>
<li>Calculate the confidence interval for <span class="math inline">\(\alpha = 0.05\)</span>.</li>
</ul>
<p>Check that the proportion of cases when the parameter <span class="math inline">\(\mu_0\)</span> is inside the interval is at least <span class="math inline">\(95\%\)</span></p>
</div><div class="column" style="width:60%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="" aria-hidden="true" tabindex="-1"></a>my_binomial_confint <span class="ot">&lt;-</span> <span class="cf">function</span>(n, alpha, q) {</span>
<span id="cb81-2"><a href="" aria-hidden="true" tabindex="-1"></a>  mu_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.001</span>)</span>
<span id="cb81-3"><a href="" aria-hidden="true" tabindex="-1"></a>  mu_no_rejection <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb81-4"><a href="" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb81-5"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (mu_h0 <span class="cf">in</span> mu_grid) {</span>
<span id="cb81-6"><a href="" aria-hidden="true" tabindex="-1"></a>    crit_vals <span class="ot">&lt;-</span> <span class="fu">two_sided_criterion_nonsym</span>(<span class="at">n =</span> <span class="dv">30</span>, <span class="at">mu =</span> mu_h0, <span class="at">alpha =</span> <span class="fl">0.05</span>)</span>
<span id="cb81-7"><a href="" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (q <span class="sc">&gt;</span> crit_vals[<span class="dv">1</span>] <span class="sc">&amp;</span> q <span class="sc">&lt;</span> crit_vals[<span class="dv">2</span>]) {</span>
<span id="cb81-8"><a href="" aria-hidden="true" tabindex="-1"></a>      mu_no_rejection <span class="ot">&lt;-</span> <span class="fu">c</span>(mu_no_rejection, mu_h0)</span>
<span id="cb81-9"><a href="" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb81-10"><a href="" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb81-11"><a href="" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb81-12"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(<span class="fu">min</span>(mu_no_rejection), <span class="fu">max</span>(mu_no_rejection)))</span>
<span id="cb81-13"><a href="" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb81-14"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-15"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2024</span>)</span>
<span id="cb81-16"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-17"><a href="" aria-hidden="true" tabindex="-1"></a>N_EXPERIMENTS <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb81-18"><a href="" aria-hidden="true" tabindex="-1"></a>SAMPLE_SIZE <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb81-19"><a href="" aria-hidden="true" tabindex="-1"></a>latent_mu <span class="ot">&lt;-</span> <span class="fl">0.5</span>  <span class="co"># "True" value of the parameter</span></span>
<span id="cb81-20"><a href="" aria-hidden="true" tabindex="-1"></a>binom_true <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(N_EXPERIMENTS, SAMPLE_SIZE, latent_mu)  <span class="co"># Generate binomial samples</span></span>
<span id="cb81-21"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-22"><a href="" aria-hidden="true" tabindex="-1"></a>confint_fail_cases <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb81-23"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-24"><a href="" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N_EXPERIMENTS) {</span>
<span id="cb81-25"><a href="" aria-hidden="true" tabindex="-1"></a>  q <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">rbinom</span>(<span class="dv">1</span>, SAMPLE_SIZE, latent_mu))  <span class="co"># Generate sum of elements</span></span>
<span id="cb81-26"><a href="" aria-hidden="true" tabindex="-1"></a>  confint_vals <span class="ot">&lt;-</span> <span class="fu">my_binomial_confint</span>(<span class="at">n =</span> SAMPLE_SIZE, <span class="at">alpha =</span> <span class="fl">0.05</span>, <span class="at">q =</span> q)</span>
<span id="cb81-27"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (confint_vals[<span class="dv">1</span>] <span class="sc">&lt;</span> latent_mu <span class="sc">&amp;</span> latent_mu <span class="sc">&lt;</span> confint_vals[<span class="dv">2</span>]) {</span>
<span id="cb81-28"><a href="" aria-hidden="true" tabindex="-1"></a>    <span class="co"># All good</span></span>
<span id="cb81-29"><a href="" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb81-30"><a href="" aria-hidden="true" tabindex="-1"></a>    confint_fail_cases <span class="ot">&lt;-</span> confint_fail_cases <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb81-31"><a href="" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb81-32"><a href="" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb81-33"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-34"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="dv">1</span> <span class="sc">-</span> confint_fail_cases <span class="sc">/</span> N_EXPERIMENTS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.962</code></pre>
</div>
</div>
</div></div>
<p>But it takes a long time! This is because during each experiment you need to build a confidence interval, and therefore test 1000 possible parameters <span class="math inline">\(\mu_0\)</span>.</p>
</section>
<section id="wilson-confidence-interval" class="slide level2 tiny">
<h2>Wilson confidence interval</h2>
<p>The algorithm for building a confidence interval that we have just discussed takes too long. R has functions that allow you to calculate the interval faster. For example, you can use the Wilson method and the <code>prop.test(correct = FALSE)</code> function</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1111</span>)</span>
<span id="cb83-2"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3"><a href="" aria-hidden="true" tabindex="-1"></a>N_EXPERIMENTS <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb83-4"><a href="" aria-hidden="true" tabindex="-1"></a>SAMPLE_SIZE <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb83-5"><a href="" aria-hidden="true" tabindex="-1"></a>latent_mu <span class="ot">&lt;-</span> <span class="fl">0.5</span>  <span class="co"># "True" value of the parameter</span></span>
<span id="cb83-6"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-7"><a href="" aria-hidden="true" tabindex="-1"></a>confint_fail_cases <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-8"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-9"><a href="" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N_EXPERIMENTS) {</span>
<span id="cb83-10"><a href="" aria-hidden="true" tabindex="-1"></a>  q <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">rbinom</span>(<span class="dv">1</span>, SAMPLE_SIZE, latent_mu))  <span class="co"># Generate sum of elements</span></span>
<span id="cb83-11"><a href="" aria-hidden="true" tabindex="-1"></a>  confint_vals <span class="ot">&lt;-</span> <span class="fu">prop.test</span>(q, SAMPLE_SIZE, <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">correct =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>conf.int</span>
<span id="cb83-12"><a href="" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-13"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (confint_vals[<span class="dv">1</span>] <span class="sc">&lt;</span> latent_mu <span class="sc">&amp;</span> latent_mu <span class="sc">&lt;</span> confint_vals[<span class="dv">2</span>]) {</span>
<span id="cb83-14"><a href="" aria-hidden="true" tabindex="-1"></a>    <span class="co"># All good</span></span>
<span id="cb83-15"><a href="" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb83-16"><a href="" aria-hidden="true" tabindex="-1"></a>    confint_fail_cases <span class="ot">&lt;-</span> confint_fail_cases <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb83-17"><a href="" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb83-18"><a href="" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb83-19"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-20"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="dv">1</span> <span class="sc">-</span> confint_fail_cases <span class="sc">/</span> N_EXPERIMENTS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.948</code></pre>
</div>
</div>
<center>
😢
</center>
</section>
<section id="wilsons-ci-vs.-n" class="slide level2 smaller">
<h2>Wilson’s CI vs.&nbsp;N</h2>
<p>The dependence of the proportion of successful hits <span class="math inline">\(\mu\)</span> in the confidence interval on the sample size is shown in the graph.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb85-2"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-3"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20231212</span>)</span>
<span id="cb85-4"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-5"><a href="" aria-hidden="true" tabindex="-1"></a>N_EXPERIMENTS <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb85-6"><a href="" aria-hidden="true" tabindex="-1"></a>latent_mu <span class="ot">&lt;-</span> <span class="fl">0.5</span>  <span class="co"># "True" value of the parameter</span></span>
<span id="cb85-7"><a href="" aria-hidden="true" tabindex="-1"></a>n_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">1000</span>, <span class="at">by =</span> <span class="dv">25</span>)</span>
<span id="cb85-8"><a href="" aria-hidden="true" tabindex="-1"></a>interval_success_rate <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(n_grid))</span>
<span id="cb85-9"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-10"><a href="" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n_grid)) {</span>
<span id="cb85-11"><a href="" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> n_grid[j]</span>
<span id="cb85-12"><a href="" aria-hidden="true" tabindex="-1"></a>  confint_fail_cases <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb85-13"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N_EXPERIMENTS) {</span>
<span id="cb85-14"><a href="" aria-hidden="true" tabindex="-1"></a>    binom_true <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, latent_mu)</span>
<span id="cb85-15"><a href="" aria-hidden="true" tabindex="-1"></a>    confint_vals <span class="ot">&lt;-</span> <span class="fu">prop.test</span>(binom_true, n, <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">correct =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>conf.int</span>
<span id="cb85-16"><a href="" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb85-17"><a href="" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (confint_vals[<span class="dv">1</span>] <span class="sc">&lt;</span> latent_mu <span class="sc">&amp;</span> latent_mu <span class="sc">&lt;</span> confint_vals[<span class="dv">2</span>]) {</span>
<span id="cb85-18"><a href="" aria-hidden="true" tabindex="-1"></a>      <span class="co"># All good</span></span>
<span id="cb85-19"><a href="" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb85-20"><a href="" aria-hidden="true" tabindex="-1"></a>      confint_fail_cases <span class="ot">&lt;-</span> confint_fail_cases <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb85-21"><a href="" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb85-22"><a href="" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb85-23"><a href="" aria-hidden="true" tabindex="-1"></a>  interval_success_rate[j] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> confint_fail_cases <span class="sc">/</span> N_EXPERIMENTS</span>
<span id="cb85-24"><a href="" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb85-25"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-26"><a href="" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n =</span> n_grid, <span class="at">success_rate =</span> interval_success_rate)</span>
<span id="cb85-27"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-28"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> success_rate)) <span class="sc">+</span></span>
<span id="cb85-29"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb85-30"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.95</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb85-31"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb85-32"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src=".06_files/figure-revealjs/ci-wilson-plot-1.svg" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="summary" class="slide level2 smaller">
<h2>Summary</h2>
<h4 id="hypothesis-testing-algorithm">Hypothesis testing algorithm</h4>
<ol type="1">
<li>Business problem / hypothesis</li>
<li>Formulation of the null and alternative hypotheses:
<ul>
<li><span class="math inline">\(\mathsf{H}_0: \mu = 0.5\)</span></li>
<li><span class="math inline">\(\mathsf{H}_1: \mu &gt; 0.5\)</span>.</li>
</ul></li>
<li>Statistics of the criterion <span class="math inline">\(Q = \sum_{i=1}^n \text{Bernoulli}(\mu)\)</span>, <span class="math inline">\(q = 19\)</span>.</li>
<li>The distribution of <span class="math inline">\(Q\)</span> at <span class="math inline">\(\mathsf{H}_0\)</span> and the critical region (<span class="math inline">\(p\)</span>-value) at <span class="math inline">\(\alpha = 0.05\)</span>.</li>
<li><span class="math inline">\(\text{MDE} (n, \text{power}, \alpha)\)</span>.</li>
<li>Confidence interval for <span class="math inline">\(\mu\)</span>.</li>
</ol>
</section></section>
<section id="questions" class="title-slide slide level1 unnumbered unlisted center" data-background-iframe=".06_files/libs/colored-particles/index.html">
<h1>Questions?</h1>
<p><iconify-icon inline="" icon="solar:book-bold"></iconify-icon> <a href="https://teaching.kse.org.ua/course/view.php?id=2554">Course materials</a></p>
<p><iconify-icon inline="" icon="mdi:envelope"></iconify-icon> imiroshnychenko@kse.org.ua</p>
<p><iconify-icon inline="" icon="ic:baseline-telegram"></iconify-icon> <a href="https://t.me/araprof"><span class="citation" data-cites="araprof">@araprof</span></a></p>
<p><iconify-icon inline="" icon="mdi:youtube"></iconify-icon> <a href="https://www.youtube.com/@datamirosh"><span class="citation" data-cites="datamirosh">@datamirosh</span></a></p>
<p><iconify-icon inline="" icon="mdi:linkedin"></iconify-icon> <a href="https://www.linkedin.com/in/ihormiroshnychenko/">@ihormiroshnychenko</a></p>
<p><iconify-icon inline="" icon="mdi:github"></iconify-icon> <a href="https://github.com/Aranaur">@aranaur</a></p>
<p><iconify-icon inline="" icon="ion:home"></iconify-icon> <a href="https://aranaur.rbind.io">aranaur.rbind.io</a></p>
<div class="quarto-auto-generated-content">
<p><img src="img/kse.png" class="slide-logo"></p>
<div class="footer footer-default">
<p><a href="https://teaching.kse.org.ua/course/view.php?id=2554">🔗Descriptive Statistics (AI27)</a></p>
</div>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src=".06_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src=".06_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src=".06_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src=".06_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src=".06_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src=".06_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src=".06_files/libs/revealjs/plugin/verticator/verticator.js"></script>
  <script src=".06_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src=".06_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src=".06_files/libs/revealjs/plugin/search/search.js"></script>
  <script src=".06_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src=".06_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'verticator': {"themetag":"h1","color":"","inversecolor":"","skipuncounted":false,"clickable":true,"position":"auto","offset":"3vmin","autogenerate":true,"tooltip":false,"scale":1},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'h.v',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'default',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: true,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: true,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'fade',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1350,

        height: 759.375,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, Verticator, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    

    <script>

      // htmlwidgets need to know to resize themselves when slides are shown/hidden.

      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current

      // slide changes (different for each slide format).

      (function () {

        // dispatch for htmlwidgets

        function fireSlideEnter() {

          const event = window.document.createEvent("Event");

          event.initEvent("slideenter", true, true);

          window.document.dispatchEvent(event);

        }

    

        function fireSlideChanged(previousSlide, currentSlide) {

          fireSlideEnter();

    

          // dispatch for shiny

          if (window.jQuery) {

            if (previousSlide) {

              window.jQuery(previousSlide).trigger("hidden");

            }

            if (currentSlide) {

              window.jQuery(currentSlide).trigger("shown");

            }

          }

        }

    

        // hookup for slidy

        if (window.w3c_slidy) {

          window.w3c_slidy.add_observer(function (slide_num) {

            // slide_num starts at position 1

            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);

          });

        }

    

      })();

    </script>

    

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>