---
title: "Assignment 03: Time Series Decomposition"
subtitle: "MATH840: Time Series"
author: "Ihor Miroshnychenko"
institute: Kyiv School of Economics
format:
  html: 
    highlight-style: github
    theme: [default, custom.scss]
execute: 
  echo: true
  warning: false
editor_options: 
  chunk_output_type: console
---

## üéØ Goals

The goal of this assignment is to apply time series decomposition techniques to the datasets you have collected and analyzed. You will learn to separate a time series into its fundamental components: trend, seasonality, and remainder. This will allow you to analyze seasonally adjusted data and better understand the underlying patterns in your series.

## üìö Prerequisites

Before starting, ensure you have completed Assignment 01 and Assignment 02. You will use the same 3-5 datasets. All data should be cleaned and prepared in a pandas DataFrame with correctly formatted time/date columns.

## üìù Instructions

For each of your chosen time series datasets, perform the steps below. Your analysis should be supported by both generated plots and detailed interpretations of your findings.

### Part 1: Data Transformation (If Necessary)

Before decomposition, it is crucial to stabilize the variance in your time series.

1. **Assess the Need for Transformation**:
    + Based on the time plots from Assignment 02, determine if the magnitude of the seasonal fluctuations or the variance changes as the level of the series changes.
    + **Interpretation**: State whether a transformation is needed for each series and why. If the seasonal variation is relatively constant, you may not need a transformation (or can use an additive model). If the variation grows with the level, a transformation is likely necessary.
2. **Apply a Transformation**:
    + If a transformation is needed, apply a **logarithm** or **Box-Cox** transformation. The Box-Cox transformation is preferred as it can often find an optimal transformation.
    + Generate a time plot of the transformed series.
    + **Interpretation**: Does the plot of the transformed data show a more stable variance over time? Compare it to the original plot.

### Part 2: STL Decomposition

Next, apply the more robust STL (Seasonal and Trend decomposition using Loess) method.

1. Perform STL Decomposition:
    + Use a library function (e.g., `statsmodels.tsa.seasonal.STL`) to perform an STL decomposition. You can start with the default parameters.
    + Plot the observed, trend, seasonal, and residual components from the STL decomposition.
2. **Interpretation**:
    + Analyze each component:
        * **Trend**: Describe the long-term movement in the series. Is it increasing, decreasing, or stable?
        * **Seasonal**: Discuss the seasonal patterns. Are they consistent over time? Do they align with your findings from Assignment 02?
        * **Remainder**: Evaluate the residuals. Are they randomly distributed? Do they show any patterns or autocorrelation?

### Part 3: Seasonal Adjustment

Using the seasonal component obtained from the STL decomposition, create a seasonally adjusted version of your time series.

1. **Create Seasonally Adjusted Series**:
    + Subtract the seasonal component from the original (or transformed) series to obtain the seasonally adjusted series.
    + Plot the seasonally adjusted series.
2. **Interpretation**:
    + Compare the seasonally adjusted series to the original series. How has the removal of seasonality affected the series? Is the trend more apparent now?

## üì§ Submission Requirements

Submit a Quarto document (`.qmd`) or Jupyter Notebook (`.ipynb`), along with the rendered HTML file, containing:

*   The code used to create all the plots for each of your datasets.
*   The plots themselves, as generated by your code.
*   Markdown cells with your detailed interpretations and conclusions for each step.
*   A final synthesis of your findings for each dataset.

::: {.callout-tip}
Structure your report clearly, using headings for each dataset and for each part of the analysis. This will make it easier to review and will demonstrate the logic of your investigation.
:::