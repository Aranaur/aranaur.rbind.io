---
title: "Assignment 07: Spatial analysis in R"
subtitle: "STAT 150: R for Data Science"
author: "Ihor Miroshnychenko"
institute: Kyiv School of Economics
format:
  html: 
    highlight-style: github
    theme: [default, custom.scss]
execute: 
  echo: true
  warning: false
editor_options: 
  chunk_output_type: console
---

::: {.callout-tip}
I highly recommend checking out the channel [â–¶ï¸ Milos Makes Maps](https://www.youtube.com/@milos-makes-maps/videos) on YouTube and his [ğŸ˜º GitHub](https://github.com/milos-agathon) for tutorials on spatial data analysis and mapping in R!
:::

## ğŸ¯ Learning Objectives

By the end of this assignment, you will be able to:

*   Understand and work with spatial data in R using the `sf` package.
*   Read and manipulate shapefiles.
*   Create choropleth maps to visualize spatial patterns.
*   Combine tabular data with spatial data for thematic mapping.
*   Customize map aesthetics, including projections and color schemes.
*   Document your spatial analysis process in a Quarto report.

## ğŸ“‚ Datasets

For this assignment, you will need two types of data:

1.  **Spatial Data**: A shapefile with the administrative boundaries of Ukraine's oblasts.
2.  **Tabular Data**: A dataset containing some variable to visualize across the oblasts.

::: {.callout-note}
You can use any other country or region if you prefer, but make sure to adjust the instructions accordingly.
:::

For the tabular data, you have three options. Choose **one**:

*   **Option A: Air Raid Sirens Data**: Use the dataset on air raid sirens in Ukraine from [this source](https://alerts.in.ua/). You will need to aggregate the data by oblast.
*   **Option B: State Statistics Service of Ukraine**: Find a dataset of your choice on the [State Statistics Service of Ukraine](https://stat.gov.ua/en).
*   **Option C: Your Own Data**: Find or create your own dataset with data for each of Ukraine's oblasts.

## ğŸ“ Tasks

### âš™ï¸ Step 1: Set Up Your Project

1.  Create a new Quarto document (`.qmd`) for your assignment.
2.  Load the necessary libraries: `sf`, `tidyverse`, and any others you might need.
3.  Download the shapefile of Ukraine's oblasts and place it in a `data` subdirectory within your project.

### ğŸ”„ Step 2: Load and Prepare Data

1.  **Load the Spatial Data**: Read the shapefile into R using `sf::read_sf()`.
2.  **Load the Tabular Data**: Load the tabular dataset you chose.
3.  **Data Cleaning and Preparation**:
    *   Clean both datasets as needed. Pay special attention to the names of the oblasts to ensure they are consistent between the two datasets for a successful join.
    *   If you chose the air raid sirens data, you will need to aggregate it to the oblast level (e.g., total number of alerts, total duration).
4.  **Join the Datasets**: Perform a join (e.g., `left_join()`) to merge your tabular data with the spatial data based on the oblast names.

### ğŸ“Š Step 3: Create a Choropleth Map

1.  **Create a Basic Map**: Use `ggplot2` and `geom_sf()` to create a basic choropleth map of Ukraine, where the fill color of each oblast represents the value of the variable you are analyzing.
2.  **Customize the Map**:
    *   Add a title, subtitle, and caption.
    *   Customize the color scale using `scale_fill_*()`.
    *   Experiment with different map projections using `coord_sf()`.
    *   Adjust the theme for a cleaner look (`theme_void()` is a good starting point).
3.  **Interpret Your Map**: Write a brief interpretation of the patterns you observe in your map. What does the map reveal about your chosen variable?

## ğŸ’¡ Bonus Challenge (Optional)

*   Create an additional map that visualizes a different variable or uses a different mapping technique (e.g., a point map, a line map).
*   Add labels to the oblasts on your map.
*   Find and add major cities as points on your map.

## ğŸ“¤ Submission

Submit a Quarto report (`.qmd` and the rendered PDF or HTML document) that includes:

*   A description of your chosen dataset.
*   All the code for loading, cleaning, and joining the data.
*   The final choropleth map.
*   Your interpretation of the map.

If you render to HTML, please publish your report on Quarto Pub or GitHub Pages and include the link in your submission.