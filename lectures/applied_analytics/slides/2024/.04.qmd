---
title: "–ü—Ä–∏—Å–∫–æ—Ä–µ–Ω–Ω—è A/B-—Ç–µ—Å—Ç—ñ–≤"
subtitle: "–ü—Ä–∏–∫–ª–∞–¥–Ω–∞ –∞–Ω–∞–ª—ñ—Ç–∏–∫–∞ –ø—Ä–∏ —Ä–æ–∑—Ä–æ–±—Ü—ñ IT"
author: "–Ü–≥–æ—Ä –ú—ñ—Ä–æ—à–Ω–∏—á–µ–Ω–∫–æ"
institute: –ö–ù–£ —ñ–º–µ–Ω—ñ –¢–∞—Ä–∞—Å–∞ –®–µ–≤—á–µ–Ω–∫–∞, –§–Ü–¢
from: markdown+emoji
title-slide-attributes:
    data-background-iframe: .04_files/libs/colored-particles/index.html
language: _language-ua.yml
footer: <a href="https://aranaur.rbind.io/lectures/applied_analytics/">üîó–ü—Ä–∏–∫–ª–∞–¥–Ω–∞ –∞–Ω–∞–ª—ñ—Ç–∏–∫–∞ –ø—Ä–∏ —Ä–æ–∑—Ä–æ–±—Ü—ñ IT</a>
format:
  revealjs: 
    # center: true
    navigation-mode: vertical
    transition: fade
    background-transition: fade
    # controls-layout: bottom-right
    chalkboard: true
    logo: fit.png
    slide-number: true
    toc: false
    toc-depth: 1
    mouse-wheel: true
    width: 1350  
    height: 759.375
    highlight-style: github
    # fig-width: 9
    # fig-height: 5
    fig-format: svg
    theme: [default, custom.scss]
    mermaid:
      theme: forest
  # gfm:
  #   mermaid-format: png
preload-iframes: true
jupyter: python3
execute: 
  echo: true
  warning: false
editor_options: 
  chunk_output_type: console

revealjs-plugins:
  - verticator
---

```{python}
#| label: setup
#| include: false

# Import libraries
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

from IPython.display import Markdown
from tabulate import tabulate

# Set seaborn default style
sns.set_style('whitegrid')
sns.set_palette('colorblind')

# Define colors
red_pink   = "#e64173"
turquoise  = "#20B2AA"
orange     = "#FFA500"
red        = "#fb6107"
blue       = "#181485"
navy       = "#150E37FF"
green      = "#8bb174"
yellow     = "#D8BD44"
# grey_light = "grey70"
# grey_mid   = "grey50"
# grey_dark  = "grey20"
purple     = "#6A5ACD"
slate      = "#314f4f"
```

# –°—Ç—Ä–∞—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è  {background-iframe=".04_files/libs/colored-particles/index.html"}

## –ó–º—ñ—â–µ–Ω–Ω—è —Ç–∞ –¥–∏—Å–ø–µ—Ä—Å—ñ—è {.smaller}

:::: {.columns}

::: {.column width="60%"}
### –î–∏—Å–ø–µ—Ä—Å—ñ—è: –≤–ø–ª–∏–≤ –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö —Ñ–∞–∫—Ç–æ—Ä—ñ–≤

- –ú–∞–ª–µ–Ω—å–∫–∞ –≤–∏–±—ñ—Ä–∫–∞ $\rightarrow$ –Ω–∏–∑—å–∫–∞ —Ä–µ–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ç–∏–≤–Ω—ñ—Å—Ç—å
- –í–ø–ª–∏–≤ —Ç–∏–∂–Ω–µ–≤–æ—ó/–º—ñ—Å—è—á–Ω–æ—ó —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç—ñ

### –ó–º—ñ—â–µ–Ω–Ω—è: –≤–ø–ª–∏–≤ –æ—Ü—ñ–Ω—é–≤–∞—á–∞ 

- –°–∏–ª—å–Ω–µ –∑–º—ñ—â–µ–Ω–Ω—è –º–æ–∂–ª–∏–≤–µ –ø—Ä–∏ –ø–µ—Ä–µ–≤—ñ—Ä—Ü—ñ –≥—ñ–ø–æ—Ç–µ–∑ $t$-–∫—Ä–∏—Ç–µ—Ä—ñ—î–º –Ω–∞ —Ä–æ–∑–ø–æ–¥—ñ–ª—ñ –∑ "—Å–∏–ª—å–Ω–∏–º–∏" —Ö–≤–æ—Å—Ç–∞–º–∏
- –°–∏–ª—å–Ω–µ –∑–º—ñ—â–µ–Ω–Ω—è –º–æ–∂–ª–∏–≤–µ —É —Ä–∞–∑—ñ (–Ω–µ–ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–Ω–æ–≥–æ) –±—É—Ç—Å—Ç—Ä–µ–ø—É –º–µ–¥—ñ–∞–Ω $\rightarrow$ —Å–µ—Ä–µ–¥–Ω—è –æ—Ü—ñ–Ω–∫–∏ boot-–º–µ–¥—ñ–∞–Ω –º–æ–∂–µ –Ω–µ –∑–±—ñ–≥–∞—Ç–∏—Å—è –∑ –º–µ–¥—ñ–∞–Ω–æ—é –ø–æ—á–∞—Ç–∫–æ–≤–æ–≥–æ —Ä–æ–∑–ø–æ–¥—ñ–ª—É
:::

::: {.column width="40%"}
![](img/bias_variance.jpg){fig-align="center"}
:::

::::

## –ó–±—ñ–ª—å—à–µ–Ω–Ω—è —á—É—Ç–ª–∏–≤–æ—Å—Ç—ñ –º–µ—Ç—Ä–∏–∫–∏

–î–ª—è –Ω–µ–ø–µ—Ä–µ—Ä–≤–Ω–∏—Ö –º–µ—Ç—Ä–∏–∫ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –º–µ—Ç–æ–¥–∏ –ø—ñ–¥–≤–∏—â–µ–Ω–Ω—è —á—É—Ç–ª–∏–≤–æ—Å—Ç—ñ —à–ª—è—Ö–æ–º –∑–º–µ–Ω—à–µ–Ω–Ω—è –¥–∏—Å–ø–µ—Ä—Å—ñ—ó

![](img/variance.jpg){fig-align="center"}

## –°—Ç—Ä–∞—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è {.smaller}

<center>–°–∫–æ—Ä–æ—á–µ–Ω–Ω—è –¥–∏—Å–ø–µ—Ä—Å—ñ—ó $\rightarrow$ –ü—ñ–¥–≤–∏—â–µ–Ω–Ω—è —á—É—Ç–ª–∏–≤–æ—Å—Ç—ñ $\rightarrow$ –ü—Ä–∏—Å–∫–æ—Ä–µ–Ω–Ω—è –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—É</center>

```{mermaid}
%%| echo: false
%%| fig-align: center

graph TD
    A[–°—Ç—Ä–∞—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è] --> B["`–°—Ç—Ä–∞—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è
    (stratified sample)`"]
    A --> C["`–ü–æ—Å—Ç-—Å—Ç—Ä–∞—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è
    (post-stratification)`"]
```

:::: {.columns}

::: {.column width="50%"}
<center>–ù–∞ –µ—Ç–∞–ø—ñ –¥–∏–∑–∞–π–Ω—É –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—É, —Ä–æ–∑–±–∏–≤–∞—î–º–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –Ω–∞ –≥—Ä—É–ø–∏ (—Å—Ç—Ä–∞—Ç–∏), –≤–∏–∑–Ω–∞—á–∞—î—Ç—å—Å—è –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å –ø–æ—Ç—Ä–∞–ø–ª—è–Ω–Ω—è –≤ —Å—Ç—Ä–∞—Ç—É</center>
:::

::: {.column width="50%"}
<center>–û—Ç—Ä–∏–º–∞–≤—à–∏ –≤–∏–ø–∞–¥–∫–æ–≤—É –≤–∏–±—ñ—Ä–∫—É, –∑–∞—Å—Ç–æ—Å–æ–≤—É—î—Ç—å—Å—è —Å—Ç—Ä–∞—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è –Ω–∞ –æ—Å–Ω–æ–≤—ñ –∑–∞–∑–¥–∞–ª–µ–≥—ñ–¥—å –≤—ñ–¥–æ–º–∏—Ö –π–º–æ–≤—ñ—Ä–Ω–æ—Å—Ç–µ–π –ø–æ—Ç—Ä–∞–ø–ª—è–Ω–Ω—è –≤ —Å—Ç—Ä–∞—Ç—É</center>
:::

::::

## –°–µ—Ä–µ–¥–Ω—î –∑–≤–∞–∂–µ–Ω–µ {.smaller}


–Ø–∫–∞ —Å–µ—Ä–µ–¥–Ω—è –ø–æ–∑–∏—Ü—ñ—è —É –±–∞–Ω–µ—Ä–∞?

–ë–∞–Ω–µ—Ä –ø–æ–∫–∞–∑—É–≤–∞–≤—Å—è –≤ —Å–ø–∏—Å–∫—É –Ω–∞ 1-5 –ø–æ–∑–∏—Ü—ñ—è—Ö. –ê–ª–µ –≤–∑—è—Ç–∏ —Å–µ—Ä–µ–¥–Ω—î –ø–æ –≤—Å—ñ—Ö –ø–æ–∑–∏—Ü—ñ—è—Ö --- –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ. –©–æ–± –¥—ñ–∑–Ω–∞—Ç–∏—Å—è —Ä–µ–∞–ª—å–Ω–µ —Å–µ—Ä–µ–¥–Ω—î, –±—É–¥–µ–º–æ —Ä–∞—Ö—É–≤–∞—Ç–∏ —Å–µ—Ä–µ–¥–Ω—î –∑–≤–∞–∂–µ–Ω–µ

\

:::: {.columns}

::: {.column width="60%"}

### –°–ø–æ—Å—ñ–± 1

+------------------+-----------------+
| –ü–æ–∑–∏—Ü—ñ—è          | –ü–æ–∫–∞–∑–∏          |
+==================+=================+
| 1                | 300             |
+------------------+-----------------+
| 2                | 150             |
+------------------+-----------------+
| 3                | 200             |
+------------------+-----------------+
| 4                | 50              |
+------------------+-----------------+
| 5                | 30              |
+------------------+-----------------+
:::

::: {.column width="40%"}

:::

::::

## –°–µ—Ä–µ–¥–Ω—î –∑–≤–∞–∂–µ–Ω–µ {.smaller}

–Ø–∫–∞ —Å–µ—Ä–µ–¥–Ω—è –ø–æ–∑–∏—Ü—ñ—è —É –±–∞–Ω–µ—Ä–∞?

–ë–∞–Ω–µ—Ä –ø–æ–∫–∞–∑—É–≤–∞–≤—Å—è –≤ —Å–ø–∏—Å–∫—É –Ω–∞ 1-5 –ø–æ–∑–∏—Ü—ñ—è—Ö. –ê–ª–µ –≤–∑—è—Ç–∏ —Å–µ—Ä–µ–¥–Ω—î –ø–æ –≤—Å—ñ—Ö –ø–æ–∑–∏—Ü—ñ—è—Ö --- –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ. –©–æ–± –¥—ñ–∑–Ω–∞—Ç–∏—Å—è —Ä–µ–∞–ª—å–Ω–µ —Å–µ—Ä–µ–¥–Ω—î, –±—É–¥–µ–º–æ —Ä–∞—Ö—É–≤–∞—Ç–∏ —Å–µ—Ä–µ–¥–Ω—î –∑–≤–∞–∂–µ–Ω–µ

\

:::: {.columns}

::: {.column width="60%"}

### –°–ø–æ—Å—ñ–± 1

+------------------+-----------------+------------------+
| –ü–æ–∑–∏—Ü—ñ—è          | –ü–æ–∫–∞–∑–∏          | –ü–æ–∑–∏—Ü—ñ—è * –ü–æ–∫–∞–∑–∏ |
+==================+=================+==================+
| 1                | 300             | 1 * 300 = 300    |
+------------------+-----------------+------------------+
| 2                | 150             | 2 * 150 = 300    |
+------------------+-----------------+------------------+
| 3                | 200             | 3 * 200 = 600    |
+------------------+-----------------+------------------+
| 4                | 50              | 4 * 50 = 200     |
+------------------+-----------------+------------------+
| 5                | 30              | 5 * 30 = 150     |
+------------------+-----------------+------------------+
| **–°—É–º–∞**         | **730**         | **1550**         |
+------------------+-----------------+------------------+
:::

::: {.column width="40%" .fragment fragment-index=1}
**–°–µ—Ä–µ–¥–Ω—è –∑–≤–∞–∂–µ–Ω–∞ –ø–æ–∑–∏—Ü—ñ—è**

$$ = \frac{\sum{(\text{–ü–æ–∫–∞–∑–∏} \times \text{–ü–æ–∑–∏—Ü—ñ—è})}}{\sum{\text{–ü–æ–∑–∏—Ü—ñ—è}}} $$

$$ = \frac{1550}{730} \approx 2.12 $$
:::

::::

## –°–µ—Ä–µ–¥–Ω—î –∑–≤–∞–∂–µ–Ω–µ {.smaller}


–Ø–∫–∞ —Å–µ—Ä–µ–¥–Ω—è –ø–æ–∑–∏—Ü—ñ—è —É –±–∞–Ω–µ—Ä–∞?

–ë–∞–Ω–µ—Ä –ø–æ–∫–∞–∑—É–≤–∞–≤—Å—è –≤ —Å–ø–∏—Å–∫—É –Ω–∞ 1-5 –ø–æ–∑–∏—Ü—ñ—è—Ö. –ê–ª–µ –≤–∑—è—Ç–∏ —Å–µ—Ä–µ–¥–Ω—î –ø–æ –≤—Å—ñ—Ö –ø–æ–∑–∏—Ü—ñ—è—Ö --- –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ. –©–æ–± –¥—ñ–∑–Ω–∞—Ç–∏—Å—è —Ä–µ–∞–ª—å–Ω–µ —Å–µ—Ä–µ–¥–Ω—î, –±—É–¥–µ–º–æ —Ä–∞—Ö—É–≤–∞—Ç–∏ —Å–µ—Ä–µ–¥–Ω—î –∑–≤–∞–∂–µ–Ω–µ

\

:::: {.columns}

::: {.column width="60%"}

### –°–ø–æ—Å—ñ–± 2

+------------------+-----------------+
| –ü–æ–∑–∏—Ü—ñ—è          | –ü–æ–∫–∞–∑–∏          |
+==================+=================+
| 1                | 300             |
+------------------+-----------------+
| 2                | 150             |
+------------------+-----------------+
| 3                | 200             |
+------------------+-----------------+
| 4                | 50              |
+------------------+-----------------+
| 5                | 30              |
+------------------+-----------------+
:::

::: {.column width="40%"}

:::

::::

## –°–µ—Ä–µ–¥–Ω—î –∑–≤–∞–∂–µ–Ω–µ {.smaller}


–Ø–∫–∞ —Å–µ—Ä–µ–¥–Ω—è –ø–æ–∑–∏—Ü—ñ—è —É –±–∞–Ω–µ—Ä–∞?

–ë–∞–Ω–µ—Ä –ø–æ–∫–∞–∑—É–≤–∞–≤—Å—è –≤ —Å–ø–∏—Å–∫—É –Ω–∞ 1-5 –ø–æ–∑–∏—Ü—ñ—è—Ö. –ê–ª–µ –≤–∑—è—Ç–∏ —Å–µ—Ä–µ–¥–Ω—î –ø–æ –≤—Å—ñ—Ö –ø–æ–∑–∏—Ü—ñ—è—Ö --- –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ. –©–æ–± –¥—ñ–∑–Ω–∞—Ç–∏—Å—è —Ä–µ–∞–ª—å–Ω–µ —Å–µ—Ä–µ–¥–Ω—î, –±—É–¥–µ–º–æ —Ä–∞—Ö—É–≤–∞—Ç–∏ —Å–µ—Ä–µ–¥–Ω—î –∑–≤–∞–∂–µ–Ω–µ

\

:::: {.columns}

::: {.column width="60%"}

### –°–ø–æ—Å—ñ–± 2

+------------------+-----------------+-----------------------+
| –ü–æ–∑–∏—Ü—ñ—è          | –ü–æ–∫–∞–∑–∏          | –ü–æ–∫–∞–∑–∏ / –°—É–º–∞ –ø–æ–∫–∞–∑—ñ–≤ |
+==================+=================+=======================+
| 1                | 300             | 300 / 730 = 0.411     |
+------------------+-----------------+-----------------------+
| 2                | 150             | 150 / 730 = 0.205     |
+------------------+-----------------+-----------------------+
| 3                | 200             | 200 / 730 = 0.274     |
+------------------+-----------------+-----------------------+
| 4                | 50              | 50 / 730 = 0.068      |
+------------------+-----------------+-----------------------+
| 5                | 30              | 30 / 730 = 0.041      |
+------------------+-----------------+-----------------------+
|                  | $\sum$ = 730    | $\sum$ = 1            |
+------------------+-----------------+-----------------------+
:::

::: {.column width="40%" .fragment fragment-index=2}
–ú–Ω–æ–∂–∏–º–æ –ø–æ–∑–∏—Ü—ñ—é –Ω–∞ –≤–∞–≥—É —Ç–∞ –¥–æ–¥–∞—î–º–æ

$$
\begin{aligned}
& = 1 \times 0.411 \\
& + 2 \times 0.205 \\
& + 3 \times 0.274 \\
& + 4 \times 0.068 \\
& + 5 \times 0.041 \approx 2.12
\end{aligned}
$$
:::

::::

## –ü–æ—Å—Ç-—Å—Ç—Ä–∞—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è {.smaller}

:::: {.columns}

::: {.column width="60%"}
–°–ø–æ—Å—ñ–± —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É –ø–æ–≤—Ç–æ—Ä—é—î –ª–æ–≥—ñ–∫—É —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É –±—É–¥—å-—è–∫–æ—ó –∑–≤–∞–∂–µ–Ω–æ—ó –æ—Ü—ñ–Ω–∫–∏:

1. –í–∏–±–∏—Ä–∞—î–º–æ –∑–º—ñ–Ω–Ω—ñ, —â–æ –Ω–∞–π–±—ñ–ª—å—à–µ –≤–ø–ª–∏–≤–∞—é—Ç—å –Ω–∞ –º–µ—Ç—Ä–∏–∫—É. –°—Ç—Ä–∞—Ç–∞ (–∞–±–æ –≥—Ä—É–ø–∞) –≤–∏–∑–Ω–∞—á–∞—î—Ç—å—Å—è $k$-–≥—Ä–∞–¥–∞—Ü—ñ—î—é —Ü—ñ—î—ó –∑–º—ñ–Ω–Ω–æ—ó.
2. –†–∞—Ö—É—î–º–æ –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å –ø–æ—Ç—Ä–∞–ø–ª—è–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤ –≥—Ä—É–ø—É –∑–∞ –∞–Ω–∞–ª–æ–≥—ñ—î—é –∑ —Ç–∏–º, —è–∫ –º–∏ —Ä–∞—Ö—É–≤–∞–ª–∏ —á–∞—Å—Ç–∫–∏ –¥–æ —Ü—å–æ–≥–æ –≤ –ø—Ä–∏–∫–ª–∞–¥—ñ
3. –†–∞—Ö—É—î–º–æ –¥–∏—Å–ø–µ—Ä—Å—ñ—é –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –≥—Ä—É–ø–∏ (—Å—Ç—Ä–∞—Ç–∏)
4. –†–∞—Ö—É—î–º–æ –∑–≤–∞–∂–µ–Ω—É –æ—Ü—ñ–Ω–∫—É $\text{var}_{\text{strat}}$
5. –î–æ—Å—è–≥–∞—î–º–æ —Å–∫–æ—Ä–æ—á–µ–Ω–Ω—è –¥–∏—Å–ø–µ—Ä—Å—ñ—ó
:::

::: {.column width="40%"}
–í—ñ–¥–º—ñ–Ω–Ω—ñ—Å—Ç—å –ø—Ä–µ-—Å—Ç—Ä–∞—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –≤—ñ–¥ –ø–æ—Å—Ç-—Å—Ç—Ä–∞—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –≤ —Ç–æ–º—É, —â–æ –≤–∞–≥–∏ –≤–∏–∑–Ω–∞—á–∞—é—Ç—å—Å—è –Ω–∞ –µ—Ç–∞–ø—ñ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó

$$
\text{var}_{\text{strat}}(\hat{Y}_{\text{strat}}) = \frac{1}{n} \sum_{k=1}^{K} p_k \sigma_k^2
$$

–¥–µ $p_k$ --- –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å –ø–æ—Ç—Ä–∞–ø–ª—è–Ω–Ω—è –≤ $k$-—Ç—É —Å—Ç—Ä–∞—Ç—É (–≤–∞–≥–∞),

$\sigma_k^2$ --- –¥–∏—Å–ø–µ—Ä—Å—ñ—è –≤ $k$-—Ç—ñ–π —Å—Ç—Ä–∞—Ç—ñ
:::

::::

---

–°–µ—Ä–µ–¥–Ω—è —Å—Ç—Ä–∞—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∞ –∑–∞ –≤–∏–±—ñ—Ä–∫–æ—é –±—É–¥–µ —Ç–∞–∫–æ—é —Å–∞–º–æ—é, —è–∫ —ñ —Å–µ—Ä–µ–¥–Ω—è –∑–∞ –ì–°, —Ç–æ–º—É —â–æ —Ä–∞—Ö—É—î—Ç—å—Å—è —Å–µ—Ä–µ–¥–Ω—è –∑–≤–∞–∂–µ–Ω–∞ –∑–∞ —Å—Ç—Ä–∞—Ç–∞–º–∏.

–ú–æ–∂–Ω–∞ –æ—Å–æ–±–ª–∏–≤–æ –Ω–µ –∑–∞–≥–ª–∏–±–ª—é–≤–∞—Ç–∏—Å—è:

$$\mathbb{E}_{\text{strat}}(\hat{Y}_{\text{strat}}) = \sum_{k=1}^{K} p_k \mathbb{E}_{\text{strat}}(\bar{Y}_k) = \sum_{k=1}^{K} p_k \mu_k = \mu$$

–¥–µ $Y$ --- –º–µ—Ç—Ä–∏–∫–∞, \
$\mu$ --- —Å–µ—Ä–µ–¥–Ω—î –º–µ—Ç—Ä–∏–∫–∏ —É –ì–°, \
$\mu_k$ --- —Å–µ—Ä–µ–¥–Ω—î –º–µ—Ç—Ä–∏–∫–∏ —É $k$-—Ç—ñ–π —Å—Ç—Ä–∞—Ç—ñ, \
$p_k$ --- —á–∞—Å—Ç–∫–∞ $k$-—Ç–æ—ó —Å—Ç—Ä–∞—Ç–∏ –≤ –ì–° (–π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å –ø–æ—Ç—Ä–∞–ø–ª—è–Ω–Ω—è –≤ —Å—Ç—Ä–∞—Ç—É)

---

–°—Ç—Ä–∞—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∞ –¥–∏—Å–ø–µ—Ä—Å—ñ—è –∑–∞ –≤–∏–±—ñ—Ä–∫–æ—é —Ä–∞—Ö—É—î—Ç—å—Å—è –∑–≤–∞–∂–µ–Ω–æ –∑–∞ –∫–æ–∂–Ω–æ—é —Å—Ç—Ä–∞—Ç–æ—é. 

–í–∞–≥–∞ –≤–∏–∑–Ω–∞—á–∞—î—Ç—å—Å—è –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—é –ø–æ—Ç—Ä–∞–ø–ª—è–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤ —Å—Ç—Ä–∞—Ç—É.

–ù–∞–ø—Ä–∏–∫–ª–∞–¥, —è–∫—â–æ –∑–∞ —Å—Ç—Ä–∞—Ç–∏ –º–∏ –±–µ—Ä–µ–º–æ —Ä–µ–≥—ñ–æ–Ω–∏ —ñ —ó—Ö —É –Ω–∞—Å 3 –∑ –∞—É–¥–∏—Ç–æ—Ä—ñ—î—é, —Ä–æ–∑–±–∏—Ç—ñ –∑–∞ —á–∞—Å—Ç–∫–∞–º–∏ 30%, 50%, 20%, —Ç–æ –≤–∞–≥–∏ –¥–ª—è –Ω–∏—Ö $p_{k1} = 0.3$, $p_{k2} = 0.5$, $p_{k3} = 0.2$.

$$\text{var}_{\text{strat}}(\hat{Y}_{\text{strat}}) = \frac{1}{n} \sum_{k=1}^{K} p_k \sigma_k^2$$

## –ú—ñ–∂–≥—Ä—É–ø–æ–≤–∞ —Ç–∞ –≤–Ω—É—Ç—Ä—ñ—à–Ω—å–æ–≥—Ä—É–ø–æ–≤–∞ –¥–∏—Å–ø–µ—Ä—Å—ñ—è {.tiny}

$$
\text{var}(\hat{Y}) = \sum_{k=1}^{K} \frac{w_k}{n} \sigma_k^2 + \sum_{k=1}^{K} w_k (\mu_k - \mu)^2
$$

<center>9, 7, 8, 6, 9, 6, 7, 5, 4</center>

\

. . .

<center>–í–∏–±—ñ—Ä–∫–æ–≤–µ —Å–µ—Ä–µ–¥–Ω—î: $\bar{Y} = 6.777778$</center>

<center>–î–∏—Å–ø–µ—Ä—Å—ñ—è: $\sigma^2 = 2.617284$</center>

## –ú—ñ–∂–≥—Ä—É–ø–æ–≤–∞ —Ç–∞ –≤–Ω—É—Ç—Ä—ñ—à–Ω—å–æ–≥—Ä—É–ø–æ–≤–∞ –¥–∏—Å–ø–µ—Ä—Å—ñ—è {.tiny}

$$
\text{var}(\hat{Y}) = \sum_{k=1}^{K} \frac{w_k}{n} \sigma_k^2 + \sum_{k=1}^{K} w_k (\mu_k - \mu)^2
$$

<center>[9, 7,]{.green} [8, 6, 9, 6,]{.red} [7, 5, 4]{.blue}</center>

\

<center>–í–∏–±—ñ—Ä–∫–æ–≤–µ —Å–µ—Ä–µ–¥–Ω—î: $\bar{Y} = 6.777778$</center>

<center>–î–∏—Å–ø–µ—Ä—Å—ñ—è: $\sigma^2 = 2.617284$</center>

\

:::: {.columns}

::: {.column .fragment fragment-index=1 width="33%"}

::: {.green}
$\bar{Y} = 8$ \
$\sigma^2 = 1$ \
$w = 0.22$
:::
:::

::: {.column .fragment fragment-index=2 width="33%"}

::: {.red}
$\bar{Y} = 7.25$ \
$\sigma^2 = 1.6874$ \
$w = 0.44$

:::

:::

::: {.column .fragment fragment-index=3 width="34%"}

::: {.blue}
$\bar{Y} = 5.33$ \
$\sigma^2 = 1.555556$ \
$w = 0.33$

:::

:::

::::

. . .

\

:::: {.columns}

::: {.column width="50%"}
**–í–Ω—É—Ç—Ä—ñ—à–Ω—å–æ–≥—Ä—É–ø–æ–≤–∞ –¥–∏—Å–ø–µ—Ä—Å—ñ—è** \
[0.22 * 1]{.green} + [0.44 * 1.6874]{.red} + [0.33 * 1.555556]{.blue} = 1.490741
:::

::: {.column width="50%"}
**–ú—ñ–∂–≥—Ä—É–ø–æ–≤–∞ –¥–∏—Å–ø–µ—Ä—Å—ñ—è** \
[0.22 * (8 - 6.777778)^2^]{.green} + [0.44 * (7.25 - 6.777778)^2^]{.red} + [0.33 * (5.33 - 6.777778)^2^]{.blue} = 1.126543
:::

::::

. . .

\ 

$$\text{var}(\hat{Y}) = 1.490741 + 1.126543 = 2.617284$$

## –í–∏—Å–Ω–æ–≤–∫–∏

- –°—Ç—Ä–∞—Ç–∏ –º–∞—é—Ç—å –±—É—Ç–∏ —Å—Ç–∞–±—ñ–ª—å–Ω–∏–º–∏ —ñ –Ω–µ –∑–º—ñ–Ω—é–≤–∞—Ç–∏—Å—è –≤ —á–∞—Å—ñ --- —ñ–Ω–∞–∫—à–µ –≤–∞–≥–∞ —Å—Ç—Ä–∞—Ç–∏ –±—É–¥–µ –Ω–µ—Å—Ç–∞–±—ñ–ª—å–Ω–æ—é —ñ —Ü–µ –ø—Ä–∏–∑–≤–µ–¥–µ –¥–æ –Ω–µ–ø–µ—Ä–µ–¥–±–∞—á—É–≤–∞–Ω–æ—ó –∑–º—ñ–Ω–∏ –¥–∏—Å–ø–µ—Ä—Å—ñ—ó
- –ü–æ–≥–∞–Ω–æ –ø—ñ–¥—ñ–±—Ä–∞–Ω—ñ –∑–º—ñ–Ω–Ω—ñ –¥–ª—è —Å—Ç—Ä–∞—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —Ç—è–≥–Ω—É—Ç—å –∑–∞ —Å–æ–±–æ—é –∑–±—ñ–ª—å—à–µ–Ω–Ω—è –¥–∏—Å–ø–µ—Ä—Å—ñ—ó
- –°—Ç—Ä–∞—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—é –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏, –∫–æ–ª–∏ —î –ø—Ä–æ–±–ª–µ–º–∏ –∑ –±–∞–ª–∞–Ω—Å–æ–º –≤–∏–±—ñ—Ä–æ–∫. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –∞–Ω–æ–º–∞–ª—å–Ω–∏–π —Å–ø–ª–µ—Å–∫ –ø–æ–∫—É–ø–æ–∫ –∑ –æ–¥–Ω—ñ—î—ó —Å—Ç—Ä–∞—Ç–∏ –∑ –≤–µ–ª–∏–∫–æ—é –¥–∏—Å–ø–µ—Ä—Å—ñ—î—é –º–æ–∂–Ω–∞ –ø—Ä–∏–≥–ª—É—à–∏—Ç–∏ —Å—Ç—Ä–∞—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—î—é
- –†—ñ–∑–Ω—ñ –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è –ø–æ–∫–∞–∑—É—é—Ç—å, —â–æ —Å—Ç—Ä–∞—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è –º–æ–∂–µ —Å–∫–æ—Ä–æ—Ç–∏—Ç–∏ –¥–∏—Å–ø–µ—Ä—Å—ñ—é –≤—ñ–¥ 1% –¥–æ 40%

::: footer
[{{< iconify devicon googlecolab >}} Google Colab: –°—Ç—Ä–∞—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è](https://colab.research.google.com/drive/1SkGYHRxQQcLz5mlMdzh7L2TpUmIOoiJC)
:::

# CUPED {.unnumbered .unlisted background-iframe=".04_files/libs/colored-particles/index.html"}

## –¢–∏–ø–æ–≤–∞ –∫–∞—Ä—Ç–∏–Ω–∞

–ù–∞ –º–∞–ª–µ–Ω—å–∫–∏—Ö –µ—Ñ–µ–∫—Ç–∞—Ö –Ω–∞–π—á–∞—Å—Ç—ñ—à–µ –º–∏ –±–∞—á–∏–º–æ –Ω–∏–∑—å–∫—É –ø–æ—Ç—É–∂–Ω—ñ—Å—Ç—å –Ω–∞ —Ä–∞–Ω–Ω—ñ—Ö –µ—Ç–∞–ø–∞—Ö –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—É. –ü—Ä–∏—á–∏–Ω–æ—é —Ü—å–æ–≥–æ —î –≤–∏—Å–æ–∫–∞ –¥–∏—Å–ø–µ—Ä—Å—ñ—è:

![](img/effect-vs-var.jpg){fig-align="center"}

. . .

:::: {.columns}

::: {.column width="33%"}
<center>‚úÖ</center>
:::

::: {.column width="33%"}
<center>‚ùå</center>
:::

::: {.column width="34%"}
<center>‚úÖ</center>
:::

::::

## –†—ñ—à–µ–Ω–Ω—è: –°–∫–æ—Ä–æ—á–µ–Ω–Ω—è –∑–∞ —Ä–∞—Ö—É–Ω–æ–∫ —ñ—Å—Ç–æ—Ä—ñ—ó

–°–∫–æ—Ä–æ—á–µ–Ω–Ω—è –¥–æ—Å—è–≥–∞—î—Ç—å—Å—è —à–ª—è—Ö–æ–º –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ø–µ—Ä–µ–¥-–µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–∏—Ö –¥–∞–Ω–∏—Ö:

1. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Å—Ç—Ä–∞—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó
2. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∫–æ–≤–∞—Ä—ñ–∞—Ç

![](img/cuped.jpg){fig-align="center"}

---

:::: {.columns}

::: {.column width="40%"}
$$ Y_{\text{CUPED}} = Y - \theta X $$
:::

::: {.column width="60%"}
–¥–µ $Y$ --- –º–µ—Ç—Ä–∏–∫–∞, \
$X$ --- –º–µ—Ç—Ä–∏–∫–∞ –¥–æ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—É. 

–î–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Å–µ—Ä–µ–¥–Ω—å–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è:

- $X - \hat{X}$
- $\theta - \frac{\text{cov}(Y, X)}{\text{var}(X)}$
:::

::::

—É CUPED –º–∏ –¥–∏–≤–∏–º–æ—Å—è –Ω–µ –ø—Ä–æ—Å—Ç–æ –Ω–∞ –±—ñ–∑–Ω–µ—Å-–º–µ—Ç—Ä–∏–∫—É $Y$, –∞ –Ω–∞ –∑–º—ñ–Ω–µ–Ω—É $Y_{\text{CUPED}}$, —è–∫–∞ —á—É—Ç–ª–∏–≤—ñ—à–∞, –∑–∞–≤–¥—è–∫–∏ —ó—ó –∑–≤'—è–∑–∫—É –∑ –ø–µ—Ä–µ–¥-–µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–∏–º –ø–µ—Ä—ñ–æ–¥–æ–º

. . .

–Ü–¥–µ—è –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, —â–æ –¥–∏—Å–ø–µ—Ä—Å—ñ—è –∑—É–º–æ–≤–ª–µ–Ω–∞ –¥–≤–æ–º–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏: –¥–∏—Å–ø–µ—Ä—Å—ñ—î—é –∫–æ–≤–∞—Ä—ñ–∞—Ç–∏ —ñ –¥–∏—Å–ø–µ—Ä—Å—ñ—î—é –Ω–µ–≤—ñ–¥–æ–º–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö. –ü—ñ—Å–ª—è –∫–æ—Ä–µ–∫—Ü—ñ—ó, –º–∏ –ø–æ–∑–±—É–≤–∞—î–º–æ—Å—è –¥–∏—Å–ø–µ—Ä—Å—ñ—ó —ñ –∑–∞–ª–∏—à–∞—î–º–æ –≤–ø–ª–∏–≤ –Ω–µ–≤—ñ–¥–æ–º–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö

## CUPED: –ü—Ä–∏–Ω—Ü–∏–ø 1

- –ü—Ä–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—ñ CUPED'–∞ –≤—Ä–∞—Ö–æ–≤—É—î—Ç—å—Å—è –ø–æ–≤–µ–¥—ñ–Ω–∫–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –¥–æ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—É (–∫–æ–≤–∞—Ä—ñ–∞—Ç–∞) —ñ –ø—ñ–¥ —á–∞—Å –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—É (—Ñ–∞–∫—Ç–∏—á–Ω–∞ –º–µ—Ç—Ä–∏–∫–∞).
- –ü—ñ—Å–ª—è –∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è –º—ñ–∂ —Ü–∏–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –∑–º–µ–Ω—à—É—î—Ç—å—Å—è –¥–∏—Å–ø–µ—Ä—Å—ñ—è $\rightarrow$ –∑–±—ñ–ª—å—à—É—î—Ç—å—Å—è —á—É—Ç–ª–∏–≤—ñ—Å—Ç—å
- –¢–∞–∫–∏–º —á–∏–Ω–æ–º, –º–∏ –¥—ñ–∑–Ω–∞—î–º–æ—Å—è —è–∫ –∑–º—ñ–Ω–∏–ª–∞—Å—è –ø–æ–≤–µ–¥—ñ–Ω–∫–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤—ñ–¥ —Å–µ—Ä–µ–¥–Ω—å–æ–≥–æ.

## CUPED: –ü—Ä–∏–Ω—Ü–∏–ø 2

CUPED –º–∞—î –¥–≤—ñ –º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—ó: –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ—ó —Å—Ç—Ä–∞—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –∞–±–æ –∫–æ–≤–∞—Ä—ñ–∞—Ç–∏:

- –ü–æ–ø–µ—Ä–µ–¥–Ω—è —Å—Ç—Ä–∞—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –∫–∞—Ç–µ–≥–æ—Ä—ñ–∞–ª—å–Ω—ñ –¥–∞–Ω—ñ —Ç–∏–ø—É —Ä–µ–≥—ñ–æ–Ω—É, –ø–∞–∫–µ—Ç–Ω–∏–π —Ç–∞—Ä–∏—Ñ —Ç–æ—â–æ.
- –ö–æ–≤–∞—Ä—ñ–∞—Ç–∞ --- —á–∏—Å–ª–æ–≤–∞ –Ω–µ–ø–µ—Ä–µ—Ä–≤–Ω–∞ –º–µ—Ç—Ä–∏–∫–∞ (—Å–µ—Ä–µ–¥–Ω—ñ–π —á–µ–∫) –≤–∑—è—Ç–∞ –∑ —ñ—Å—Ç–æ—Ä—ñ—ó –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞

–ù–∞ –ø—Ä–∞–∫—Ç–∏—Ü—ñ —á–∞—Å—Ç—ñ—à–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –∫–æ–≤–∞—Ä—ñ–∞—Ç–∞, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–æ–Ω–∞ –¥–∞—î –∑–º–æ–≥—É —Å–∏–ª—å–Ω—ñ—à–µ —Å–∫–æ—Ä–æ—Ç–∏—Ç–∏ –¥–∏—Å–ø–µ—Ä—Å—ñ—é, –Ω—ñ–∂ —Å—Ç—Ä–∞—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è

## CUPED: –ü—Ä–∏–Ω—Ü–∏–ø 3

```{python}
#| label: cuped-table
#| echo: false

from great_tables import GT

# Create a table
table = pd.DataFrame({
    "id": ["1", "2", "3", "4"],
    "exp_variant": ["control", "control", "treatment", "treatment"],
    "sessionDuration (–º–µ—Ç—Ä–∏–∫–∞)": [31, 23, 25, 41],
    "sessionDuration (–ø–æ–ø–µ—Ä–µ–¥–Ω—è –º–µ—Ç—Ä–∏–∫–∞)": [30, 20, 22, 46],
    "sessionDuration (CUPED)": ["31 - (30 - —Å—Ä.–∫–æ–≤–∞—Ä—ñ–∞—Ç–∞) * Œ∏", 
                                "23 - (20 - —Å—Ä.–∫–æ–≤–∞—Ä—ñ–∞—Ç–∞) * Œ∏", 
                                "25 - (22 - —Å—Ä.–∫–æ–≤–∞—Ä—ñ–∞—Ç–∞) * Œ∏", 
                                "41 - (46 - —Å—Ä.–∫–æ–≤–∞—Ä—ñ–∞—Ç–∞) * Œ∏"]

})

(
  GT(table)
)

```

C–µ—Ä–µ–¥–Ω—î –∑–∞ –∫–æ–≤–∞—Ä—ñ–∞—Ç–æ–º —ñ $\theta$ –ø—ñ–¥–±–∏—Ä–∞—é—Ç—å—Å—è –∑–∞ –≤—Å—ñ–º–∞ –≥—Ä—É–ø–∞–º–∏

---

![](img/cuped-2.jpg){fig-align="center"}

## –û–±–º–µ–∂–µ–Ω–Ω—è —Ç–∞ –≤–∏–º–æ–≥–∏

- –ù–µ–æ–±—Ö—ñ–¥–Ω—ñ —ñ—Å—Ç–æ—Ä–∏—á–Ω—ñ –¥–∞–Ω—ñ –ø—Ä–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- –ù–µ–æ—á–µ–≤–∏–¥–Ω–æ —è–∫–∏–π –ø–µ—Ä–µ–¥-–µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–∏–π –ø–µ—Ä—ñ–æ–¥ –≤–∏–±—Ä–∞—Ç–∏ –¥–ª—è –∫–æ–≤–∞—Ä—ñ–∞—Ç–∏
- –ü—ñ–¥—Ö–æ–¥–∏—Ç—å –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ —Ä—ñ–∑–Ω–∏—Ü–µ—é —Å–µ—Ä–µ–¥–Ω—ñ—Ö
- –î–ª—è –¥–∏—Å–∫—Ä–µ—Ç–Ω–∏—Ö (–±—ñ–Ω–∞—Ä–Ω–∏—Ö) –≤–µ–ª–∏—á–∏–Ω –Ω–µ –ø—ñ–¥—Ö–æ–¥–∏—Ç—å

::: footer
[{{< iconify devicon googlecolab >}} Google Colab: CUPED](https://colab.research.google.com/drive/13TMz1WLDVu5tdvnf5eM1lFWG9-oVu_eZ)
:::

# Ratio-–º–µ—Ç—Ä–∏–∫–∞ —Ç–∞ –ª—ñ–Ω–µ–∞—Ä–∏–∑–∞—Ü—ñ—è {.unnumbered .unlisted background-iframe=".04_files/libs/colored-particles/index.html"}

---

:::: {.columns}

::: {.column width="50%"}
–í–∏–±—ñ—Ä–∫–æ–≤–∞ –º–µ—Ç—Ä–∏–∫–∞

$$\bar{X} = \frac{1}{n} \sum_{i=1}^{n} X_i$$

- –°–µ—Ä–µ–¥–Ω—ñ–π —á–µ–∫
- ARPU
:::

::: {.column width="50%"}
–ú–µ—Ç—Ä–∏–∫–∞ –∑–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞

$$\bar{R} = \frac{\bar{Y}}{\bar{Z}} = \frac{\sum{Y_i}}{\sum{Z_i}}$$

- CTR
- Action per session
:::

::::

---

| –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á | –î—ñ–π –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ | –ü–µ—Ä–µ–≥–ª—è–¥—ñ–≤ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ |
|------------|-----------------|---------------------|
| 1          | 10              | 200                 |
| 2          | 3               | 259                 |
| 3          | 90              | 139                 |
| 4          | 10              | 20                  |

:::: {.columns}

::: {.column width="40%"}
$ratioUser1 = \frac{10}{200} = 0.05$ \
$ratioUser2 = \frac{3}{259} = 0.0116$ \
$ratioUser3 = \frac{90}{139} = 0.6475$ \
$ratioUser4 = \frac{10}{20} = 0.5$
:::

::: {.column width="60%"}
$naiveAVG = \frac{0.05 + 0.0116 + 0.6475 + 0.5}{4} = 0.302$
:::

::::

---

| –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á | –î—ñ–π –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ | –ü–µ—Ä–µ–≥–ª—è–¥—ñ–≤ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ |
|------------|-----------------|---------------------|
| 1          | 10              | 200                 |
| 2          | 3               | 259                 |
| 3          | 90              | 139                 |
| 4          | 10              | 20                  |

$globalRatio = \frac{10 + 3 + 90 + 10}{200 + 259 + 139 + 20} = \frac{113}{618} = 0.182$

$$naiveAVG = \frac{0.05 + 0.0116 + 0.6475 + 0.5}{4} = 0.302$$

$$bias = 0.302 - 0.182 = 0.12$$

## Ratio-–º–µ—Ç—Ä–∏–∫–∞ {.smaller}

Ratio –º–µ—Ç—Ä–∏–∫—É –º–∏ –º–æ–∂–µ–º–æ –ø–æ—Ä–∞—Ö—É–≤–∞—Ç–∏ —è–∫ –º—ñ–Ω—ñ–º—É–º —Ç—Ä—å–æ–º–∞ —Å–ø–æ—Å–æ–±–∞–º–∏

:::: {.columns}

::: {.column width="33%"}
**naiveRatio**

- –ú–∞—î —Å–∏–ª—å–Ω–∏–π –∑—Å—É–≤ –≤—ñ–¥–Ω–æ—Å–Ω–æ globalRatio
- –ó–∞ —Ä–∞—Ö—É–Ω–æ–∫ –∑—Å—É–≤—É $p$-–∑–Ω–∞—á–µ–Ω–Ω—è –º–æ–∂–µ ¬´—Ñ–∞—Ä–±—É–≤–∞—Ç–∏—Å—è¬ª –≤–∏–ø–∞–¥–∫–æ–≤–æ
:::

::: {.column width="33%"}
**globalRatio**

- –í–∏–º–∞–≥–∞—î —Ä–∞—Ö—É–≤–∞—Ç–∏ –¥–∏—Å–ø–µ—Ä—Å—ñ—é –¥–ª—è –≤—ñ–¥–Ω–æ—à–µ–Ω–Ω—è –¥–≤–æ—Ö –≤–∏–ø–∞–¥–∫–æ–≤–∏—Ö –≤–µ–ª–∏—á–∏–Ω
- –ù–µ–º–æ–∂–ª–∏–≤–æ –∑–±–µ—Ä–µ–≥—Ç–∏ ¬´–ø–æ—é–∑–µ—Ä–Ω—É¬ª —Å–ø—Ä—è–º–æ–≤–∞–Ω—ñ—Å—Ç—å
- –î–ª—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É –¥–∏—Å–ø–µ—Ä—Å—ñ—ó –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –±—É—Ç—Å—Ä–µ–ø
:::

::: {.column width="34%"}
**L-–º–µ—Ç—Ä–∏–∫–∞ (–ª—ñ–Ω–µ–∞—Ä–∏–∑–∞—Ü—ñ—è)**

- –ó–±–µ—Ä—ñ–≥–∞—î ¬´–ø–æ—é–∑–µ—Ä–Ω—É¬ª —Å–ø—Ä—è–º–æ–≤–∞–Ω—ñ—Å—Ç—å
- –ú–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –±–∞–∑–æ–≤—ñ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω—ñ –æ—Ü—ñ–Ω—é–≤–∞—á—ñ
- –ú–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–ª—è –ø–æ–¥–∞–ª—å—à–æ—ó –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó –¥–∏—Å–ø–µ—Ä—Å—ñ—ó
- –ü—Ä–æ—Å—Ç–æ –æ–±—á–∏—Å–ª—é—î—Ç—å—Å—è
- –ù–µ –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è global ratio
:::

::::

## –ü—Ä–∏–Ω—Ü–∏–ø —Ä–æ–±–æ—Ç–∏ –ª—ñ–Ω–µ–∞—Ä–∏–∑–∞—Ü—ñ—ó

$$Lx, y, k(U) = X(u) - kY(u)$$

- K --- ratio –∑ –∫–æ–Ω—Ç—Ä–æ–ª—é
- X --- –∫–ª—ñ–∫–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- Y --- –ø–µ—Ä–µ–≥–ª—è–¥–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞

–ú–∏ —Ö–æ—á–µ–º–æ –∑—Ä–æ–∑—É–º—ñ—Ç–∏ –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è –º–µ—Ç—Ä–∏–∫–∏ –≤ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ñ –≤—ñ–¥–Ω–æ—Å–Ω–æ ratio —É –∫–æ–Ω—Ç—Ä–æ–ª—ñ

–Ü–Ω–∞–∫—à–µ –∫–∞–∂—É—á–∏ --- –¥–∏–≤–∏–º–æ—Å—è, —â–æ –∑–º—ñ–Ω–∏–ª–æ—Å—è –≤ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ñ –≤—ñ–¥–Ω–æ—Å–Ω–æ —Å–∏—Ç—É–∞—Ü—ñ—ó –≤ –∫–æ–Ω—Ç—Ä–æ–ª—ñ

## –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è —Å–ø–æ—Å–æ–±—ñ–≤ –∞–Ω–∞–ª—ñ–∑—É ratio-–º–µ—Ç—Ä–∏–∫

![](img/ratio.jpg){fig-align="center"}

- $p$-–∑–Ω–∞—á–µ–Ω–Ω—è –∑–∞ $L$ –º–µ—Ç—Ä–∏–∫–∏ —Å–ø—ñ–≤—Å–ø—Ä—è–º–æ–≤–∞–Ω–∏–π –∑ $p$-–∑–Ω–∞—á–µ–Ω–Ω—è –¥–ª—è ratio –±—É—Ç—Å—Ä–µ–ø–∞
- –°–µ—Ä–µ–¥–Ω—î –≤—Å—ñ—Ö –≤—ñ–¥–Ω–æ—à–µ–Ω—å —Å–∏–ª—å–Ω–æ –≤—ñ–¥—Ä—ñ–∑–Ω—è—î—Ç—å—Å—è –≤—ñ–¥ –±—É—Ç—Å—Ä–µ–ø–∞ —ñ L –º–µ—Ç—Ä–∏–∫–∏ –∑–∞ —Ä–∞—Ö—É–Ω–æ–∫ –∑—Å—É–≤—É
- –õ—ñ–Ω–µ–∞—Ä–∏–∑–∞—Ü—ñ—è **–Ω–µ –¥–æ–∑–≤–æ–ª—è—î –ø—Ä–∏—Å–∫–æ—Ä—é–≤–∞—Ç–∏ a/b —Ç–µ—Å—Ç–∏**

## –ü–ª—é—Å–∏ L –º–µ—Ç—Ä–∏–∫–∏

- –ó–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –ø–æ—é–∑–µ—Ä–Ω–∞ —Å–ø—Ä—è–º–æ–≤–∞–Ω—ñ—Å—Ç—å
- –ù–∞ L –º–µ—Ç—Ä–∏–∫—É –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –º–µ—Ç–æ–¥–∏ –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó –¥–∏—Å–ø–µ—Ä—Å—ñ—ó –Ω–∞ –∫—à—Ç–∞–ª—Ç CUPED
- –Ø–∫—â–æ –ø–µ—Ä–µ–¥ –≤–∞–º–∏ –Ω–µ —Å—Ç–æ—ó—Ç—å –∑–∞–≤–¥–∞–Ω–Ω—è –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ –ø–æ—é–∑–µ—Ä–Ω—É —Å–ø—Ä—è–º–æ–≤–∞–Ω—ñ—Å—Ç—å –∞–±–æ —Å–ø—Ä–æ—â—É–≤–∞—Ç–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó --- —Ç–æ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –±—É—Ç—Å—Ä–µ–ø –¥–ª—è –æ—Ü—ñ–Ω–∫–∏ ratio –º–µ—Ç—Ä–∏–∫. –†–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ —Å–ø—ñ–≤—Å–ø—Ä—è–º–æ–≤–∞–Ω–∏–π –∑ L –º–µ—Ç—Ä–∏–∫–æ—é

::: footer
[{{< iconify devicon googlecolab >}} Google Colab: –õ—ñ–Ω–µ—Ä–∏–∑–∞—Ü—ñ—è](https://colab.research.google.com/drive/1pUnH3VTs1gcsGyFoRRgQOCXvZAx6nQOn)
:::

# –î—è–∫—É—é –∑–∞ —É–≤–∞–≥—É! {.unnumbered .unlisted background-iframe=".04_files/libs/colored-particles/index.html"}

<br> <br>

{{< iconify solar book-bold >}} [–ú–∞—Ç–µ—Ä—ñ–∞–ª–∏ –∫—É—Ä—Å—É](https://aranaur.rbind.io/lectures/applied_analytics/)

{{< iconify mdi envelope >}} ihor.miroshnychenko\@knu.ua

{{< iconify ic baseline-telegram >}} [Data Mirosh](https://t.me/araprof)

{{< iconify mdi linkedin >}} [\@ihormiroshnychenko](https://www.linkedin.com/in/ihormiroshnychenko/)

{{< iconify mdi github >}} [\@aranaur](https://github.com/Aranaur)

{{< iconify ion home >}} [aranaur.rbind.io](https://aranaur.rbind.io)
