<!DOCTYPE html>
<html lang="en"><head>
<script src=".07_files/libs/clipboard/clipboard.min.js"></script>
<script src=".07_files/libs/quarto-html/tabby.min.js"></script>
<script src=".07_files/libs/quarto-html/popper.min.js"></script>
<script src=".07_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href=".07_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href=".07_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href=".07_files/libs/quarto-html/quarto-syntax-highlighting-59898bd1c6b9d2bb783127feaa000c76.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src=".07_files/libs/quarto-contrib/iconify-1.0.7/iconify-icon.min.js"></script><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.33">

  <meta name="author" content="–Ü–≥–æ—Ä –ú—ñ—Ä–æ—à–Ω–∏—á–µ–Ω–∫–æ">
  <title>–†–µ–ø–ª—ñ–∫–∞—Ü—ñ—è —Å—Ç–∞—Ç—Ç—ñ –∑ üî•PyTorch</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href=".07_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href=".07_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #24292e;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #24292e; } /* Normal */
    code span.al { color: #ff5555; font-weight: bold; } /* Alert */
    code span.an { color: #6a737d; } /* Annotation */
    code span.at { color: #d73a49; } /* Attribute */
    code span.bn { color: #005cc5; } /* BaseN */
    code span.bu { color: #d73a49; } /* BuiltIn */
    code span.cf { color: #d73a49; } /* ControlFlow */
    code span.ch { color: #032f62; } /* Char */
    code span.cn { color: #005cc5; } /* Constant */
    code span.co { color: #6a737d; } /* Comment */
    code span.cv { color: #6a737d; } /* CommentVar */
    code span.do { color: #6a737d; } /* Documentation */
    code span.dt { color: #d73a49; } /* DataType */
    code span.dv { color: #005cc5; } /* DecVal */
    code span.er { color: #ff5555; text-decoration: underline; } /* Error */
    code span.ex { color: #d73a49; font-weight: bold; } /* Extension */
    code span.fl { color: #005cc5; } /* Float */
    code span.fu { color: #6f42c1; } /* Function */
    code span.im { color: #032f62; } /* Import */
    code span.in { color: #6a737d; } /* Information */
    code span.kw { color: #d73a49; } /* Keyword */
    code span.op { color: #24292e; } /* Operator */
    code span.ot { color: #6f42c1; } /* Other */
    code span.pp { color: #d73a49; } /* Preprocessor */
    code span.re { color: #6a737d; } /* RegionMarker */
    code span.sc { color: #005cc5; } /* SpecialChar */
    code span.ss { color: #032f62; } /* SpecialString */
    code span.st { color: #032f62; } /* String */
    code span.va { color: #e36209; } /* Variable */
    code span.vs { color: #032f62; } /* VerbatimString */
    code span.wa { color: #ff5555; } /* Warning */
  </style>
  <link rel="stylesheet" href=".07_files/libs/revealjs/dist/theme/quarto-9f00fb8b82e8e7e674b22104b1ca12a2.css">
  <link href=".07_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href=".07_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href=".07_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href=".07_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href=".07_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href=".07_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src=".07_files/libs/quarto-diagram/mermaid.min.js"></script>
  <script src=".07_files/libs/quarto-diagram/mermaid-init.js"></script>
  <link href=".07_files/libs/quarto-diagram/mermaid.css" rel="stylesheet">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-iframe=".07_files/libs/colored-particles/index.html" class="quarto-title-block center">
  <h1 class="title">–†–µ–ø–ª—ñ–∫–∞—Ü—ñ—è —Å—Ç–∞—Ç—Ç—ñ –∑ üî•PyTorch</h1>
  <p class="subtitle">–¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó –∫–æ–º–ø‚Äô—é—Ç–µ—Ä–Ω–æ–≥–æ –∑–æ—Ä—É</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
–Ü–≥–æ—Ä –ú—ñ—Ä–æ—à–Ω–∏—á–µ–Ω–∫–æ 
</div>
        <p class="quarto-title-affiliation">
            –ö–ù–£ —ñ–º–µ–Ω—ñ –¢–∞—Ä–∞—Å–∞ –®–µ–≤—á–µ–Ω–∫–∞, –§–Ü–¢
          </p>
    </div>
</div>

</section>
<section id="—â–æ-—Ç–∞–∫–µ-—Ä–µ–ø–ª—ñ–∫–∞—Ü—ñ—è-–Ω–∞—É–∫–æ–≤–æ—ó-—Å—Ç–∞—Ç—Ç—ñ" class="slide level2">
<h2>–©–æ —Ç–∞–∫–µ —Ä–µ–ø–ª—ñ–∫–∞—Ü—ñ—è –Ω–∞—É–∫–æ–≤–æ—ó —Å—Ç–∞—Ç—Ç—ñ?</h2>
<ul>
<li>–†–µ–ø–ª—ñ–∫–∞—Ü—ñ—è (–≤—ñ–¥ –∞–Ω–≥–ª. replication) ‚Äî —Ü–µ –ø—Ä–æ—Ü–µ—Å <strong>–≤—ñ–¥—Ç–≤–æ—Ä–µ–Ω–Ω—è</strong> —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ –Ω–∞—É–∫–æ–≤–æ–≥–æ –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º —Ç–∏—Ö —Å–∞–º–∏—Ö –º–µ—Ç–æ–¥—ñ–≤, –¥–∞–Ω–∏—Ö —Ç–∞ —É–º–æ–≤, —â–æ –π —É –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–æ–º—É –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—ñ.</li>
<li>–¶–µ –¥–æ–∑–≤–æ–ª—è—î –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –æ—Å—Ç–∞–Ω–Ω—ñ <strong>–Ω–æ–≤–∏–Ω–∫–∏</strong> –≤ –Ω–∞—É–∫–æ–≤–∏—Ö –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è—Ö, –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —ó—Ö–Ω—é –¥–æ—Å—Ç–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å —Ç–∞ <strong>–∑—Ä–æ–∑—É–º—ñ—Ç–∏</strong>, —è–∫ –≤–æ–Ω–∏ –ø—Ä–∞—Ü—é—é—Ç—å –Ω–∞ –ø—Ä–∞–∫—Ç–∏—Ü—ñ.</li>
<li>–†–µ–ø–ª—ñ–∫–∞—Ü—ñ—è —î –≤–∞–∂–ª–∏–≤–æ—é —á–∞—Å—Ç–∏–Ω–æ—é –Ω–∞—É–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–æ–Ω–∞ –¥–æ–ø–æ–º–∞–≥–∞—î <strong>–ø—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏</strong> –∞–±–æ <strong>—Å–ø—Ä–æ—Å—Ç—É–≤–∞—Ç–∏</strong> —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –¥–æ—Å–ª—ñ–¥–∂–µ–Ω—å, –∞ —Ç–∞–∫–æ–∂ —Å–ø—Ä–∏—è—î —Ä–æ–∑–≤–∏—Ç–∫—É –Ω–æ–≤–∏—Ö —ñ–¥–µ–π —Ç–∞ –º–µ—Ç–æ–¥—ñ–≤.</li>
</ul>
</section>
<section id="–∑-—á–æ–≥–æ-—Å–∫–ª–∞–¥–∞—î—Ç—å—Å—è-—Å—Ç–∞—Ç—Ç—è" class="slide level2 smaller">
<h2>–ó —á–æ–≥–æ —Å–∫–ª–∞–¥–∞—î—Ç—å—Å—è —Å—Ç–∞—Ç—Ç—è?</h2>
<ul>
<li><strong>–ê–Ω–æ—Ç–∞—Ü—ñ—è</strong> (Abstract): –ö–æ—Ä–æ—Ç–∫–∏–π –æ–≥–ª—è–¥ –æ—Å–Ω–æ–≤–Ω–∏—Ö —Ü—ñ–ª–µ–π, –º–µ—Ç–æ–¥—ñ–≤, —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ —Ç–∞ –≤–∏—Å–Ω–æ–≤–∫—ñ–≤ –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è.</li>
<li><strong>–í—Å—Ç—É–ø</strong> (Introduction): –û–ø–∏—Å –ø—Ä–æ–±–ª–µ–º–∏, –æ–≥–ª—è–¥ –ª—ñ—Ç–µ—Ä–∞—Ç—É—Ä–∏ —Ç–∞ –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ü—ñ–ª–µ–π –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è.</li>
<li><strong>–ú–µ—Ç–æ–¥–æ–ª–æ–≥—ñ—è</strong> (Methodology): –î–µ—Ç–∞–ª—å–Ω–∏–π –æ–ø–∏—Å –º–µ—Ç–æ–¥—ñ–≤, —è–∫—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–ª–∏—Å—è –¥–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω—è –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è.</li>
<li><strong>–†–µ–∑—É–ª—å—Ç–∞—Ç–∏</strong> (Results): –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—è –æ—Å–Ω–æ–≤–Ω–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è, —á–∞—Å—Ç–æ –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º —Ç–∞–±–ª–∏—Ü—å —Ç–∞ –≥—Ä–∞—Ñ—ñ–∫—ñ–≤.</li>
<li><strong>–í–∏—Å–Ω–æ–≤–∫–∏</strong> (Conclusion): –ü—ñ–¥—Å—É–º–æ–∫ –æ—Å–Ω–æ–≤–Ω–∏—Ö –≤–∏—Å–Ω–æ–≤–∫—ñ–≤ –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è —Ç–∞ —ó—Ö –∑–Ω–∞—á–µ–Ω–Ω—è.</li>
<li><strong>–ü–æ—Å–∏–ª–∞–Ω–Ω—è</strong> (References): –°–ø–∏—Å–æ–∫ –¥–∂–µ—Ä–µ–ª, —è–∫—ñ –±—É–ª–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –≤ –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—ñ.</li>
<li><strong>–î–æ–¥–∞—Ç–∫–∏</strong> (Appendices): –î–æ–¥–∞—Ç–∫–æ–≤–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è, —è–∫–∞ –º–æ–∂–µ –±—É—Ç–∏ –∫–æ—Ä–∏—Å–Ω–æ—é –¥–ª—è —Ä–æ–∑—É–º—ñ–Ω–Ω—è –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è, –∞–ª–µ –Ω–µ —î –∫—Ä–∏—Ç–∏—á–Ω–æ—é –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç—É.</li>
</ul>
</section>
<section id="–¥–µ-—à—É–∫–∞—Ç–∏-—Å—Ç–∞—Ç—Ç—ñ" class="slide level2">
<h2>–î–µ —à—É–∫–∞—Ç–∏ —Å—Ç–∞—Ç—Ç—ñ?</h2>
<ul>
<li><a href="https://arxiv.org/">arXiv</a> ‚Äî –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–∏–π –∞—Ä—Ö—ñ–≤ –Ω–∞—É–∫–æ–≤–∏—Ö —Å—Ç–∞—Ç–µ–π –∑ —Ä—ñ–∑–Ω–∏—Ö –≥–∞–ª—É–∑–µ–π –Ω–∞—É–∫–∏, –≤–∫–ª—é—á–∞—é—á–∏ –∫–æ–º–ø‚Äô—é—Ç–µ—Ä–Ω—ñ –Ω–∞—É–∫–∏, —Ñ—ñ–∑–∏–∫—É, –º–∞—Ç–µ–º–∞—Ç–∏–∫—É —Ç–∞ —ñ–Ω—à—ñ.</li>
<li><a href="https://scholar.google.com/">Google Scholar</a> ‚Äî –ø–æ—à—É–∫–æ–≤–∞ —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –Ω–∞—É–∫–æ–≤–∏—Ö —Å—Ç–∞—Ç–µ–π, –¥–∏—Å–µ—Ä—Ç–∞—Ü—ñ–π, –∫–Ω–∏–≥ —Ç–∞ —ñ–Ω—à–∏—Ö –∞–∫–∞–¥–µ–º—ñ—á–Ω–∏—Ö —Ä–µ—Å—É—Ä—Å—ñ–≤.</li>
<li><a href="https://huggingface.co/papers/trending">Hugging Face Papers with Code</a> ‚Äî –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞, —è–∫–∞ –Ω–∞–¥–∞—î –¥–æ—Å—Ç—É–ø –¥–æ –Ω–∞—É–∫–æ–≤–∏—Ö —Å—Ç–∞—Ç–µ–π –∑ –≤—ñ–¥–∫—Ä–∏—Ç–∏–º –∫–æ–¥–æ–º, —â–æ –¥–æ–∑–≤–æ–ª—è—î –ª–µ–≥–∫–æ –∑–Ω–∞—Ö–æ–¥–∏—Ç–∏ —Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –Ω–æ–≤—ñ—Ç–Ω—ñ –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è –≤ –≥–∞–ª—É–∑—ñ –º–∞—à–∏–Ω–Ω–æ–≥–æ –Ω–∞–≤—á–∞–Ω–Ω—è.</li>
<li><a href="https://github.com/lucidrains/vit-pytorch">GitHub</a> ‚Äî –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è —Ö–æ—Å—Ç–∏–Ω–≥—É —Ç–∞ —Å–ø—ñ–ª—å–Ω–æ—ó —Ä–æ–±–æ—Ç–∏ –Ω–∞–¥ –ø—Ä–æ–µ–∫—Ç–∞–º–∏, —è–∫–∞ —Ç–∞–∫–æ–∂ –º—ñ—Å—Ç–∏—Ç—å –±–∞–≥–∞—Ç–æ –Ω–∞—É–∫–æ–≤–∏—Ö —Å—Ç–∞—Ç–µ–π —Ç–∞ —Ä–µ—Å—É—Ä—Å—ñ–≤.</li>
</ul>
</section>
<section id="vanilla-vision-transformer" class="slide level2">
<h2>Vanilla Vision Transformer</h2>
<p>ViT ‚Äî —Ü–µ –º–æ–¥–µ–ª—å –≥–ª–∏–±–æ–∫–æ–≥–æ –Ω–∞–≤—á–∞–Ω–Ω—è, —è–∫–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä—É —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–∞ –¥–ª—è –æ–±—Ä–æ–±–∫–∏ –∑–æ–±—Ä–∞–∂–µ–Ω—å. –í–æ–Ω–∞ –±—É–ª–∞ –∑–∞–ø—Ä–æ–ø–æ–Ω–æ–≤–∞–Ω–∞ –≤ —Å—Ç–∞—Ç—Ç—ñ <a href="https://arxiv.org/abs/2010.11929">‚ÄúAn Image is Worth 16x16 Words: Transformers for Image Recognition at Scale‚Äù</a> (Dosovitskiy et al., 2020).</p>
</section>
<section class="slide level2">


<img data-src="img/vit.gif" class="r-stretch quarto-figure-center"><p class="caption">ViT Architecture</p></section>
<section id="—Å—Ç–∞—Ä—Ç—É—î–º–æ" class="slide level2 smaller">
<h2>–°—Ç–∞—Ä—Ç—É—î–º–æ‚Ä¶</h2>
<div id="58df80e5" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href=""></a><span class="im">import</span> torch</span>
<span id="cb1-2"><a href=""></a><span class="im">import</span> torchvision</span>
<span id="cb1-3"><a href=""></a><span class="bu">print</span>(<span class="ss">f"torch version: </span><span class="sc">{</span>torch<span class="sc">.</span>__version__<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-4"><a href=""></a><span class="bu">print</span>(<span class="ss">f"torchvision version: </span><span class="sc">{</span>torchvision<span class="sc">.</span>__version__<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-5"><a href=""></a></span>
<span id="cb1-6"><a href=""></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-7"><a href=""></a></span>
<span id="cb1-8"><a href=""></a><span class="im">from</span> torch <span class="im">import</span> nn</span>
<span id="cb1-9"><a href=""></a><span class="im">from</span> torchvision <span class="im">import</span> transforms</span>
<span id="cb1-10"><a href=""></a><span class="im">from</span> torchinfo <span class="im">import</span> summary</span>
<span id="cb1-11"><a href=""></a><span class="im">from</span> going_modular.going_modular <span class="im">import</span> data_setup, engine</span>
<span id="cb1-12"><a href=""></a><span class="im">from</span> helper_functions <span class="im">import</span> download_data, set_seeds, plot_loss_curves</span>
<span id="cb1-13"><a href=""></a></span>
<span id="cb1-14"><a href=""></a>device <span class="op">=</span> <span class="st">"cuda"</span> <span class="cf">if</span> torch.cuda.is_available() <span class="cf">else</span> <span class="st">"cpu"</span></span>
<span id="cb1-15"><a href=""></a><span class="bu">print</span>(<span class="ss">f"Using device: </span><span class="sc">{</span>device<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-16"><a href=""></a></span>
<span id="cb1-17"><a href=""></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb1-18"><a href=""></a>data_path <span class="op">=</span> Path(<span class="st">"going_modular/"</span>)</span>
<span id="cb1-19"><a href=""></a>train_dir <span class="op">=</span> data_path <span class="op">/</span> <span class="st">"pizza_steak_sushi/train"</span></span>
<span id="cb1-20"><a href=""></a>test_dir <span class="op">=</span> data_path <span class="op">/</span> <span class="st">"pizza_steak_sushi/test"</span></span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>torch version: 2.8.0+cu129
torchvision version: 0.23.0+cu129
Using device: cuda</code></pre>
</div>
</div>
</section>
<section id="datasets-—Ç–∞-dataloaders" class="slide level2">
<h2>Datasets —Ç–∞ DataLoaders</h2>
<ul>
<li>–§—É–Ω–∫—Ü—ñ—è <code>create_dataloaders()</code> —É —Ñ–∞–π–ª—ñ <code>going_modular/going_modular.py</code> —Å—Ç–≤–æ—Ä—é—î DataLoaders –¥–ª—è —Ç—Ä–µ–Ω—É–≤–∞–ª—å–Ω–æ–≥–æ —Ç–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –Ω–∞–±–æ—Ä—ñ–≤ –¥–∞–Ω–∏—Ö.</li>
<li>–ê–ª–µ —Å–ø–æ—á–∞—Ç–∫—É –ø–æ—Ç—Ä—ñ–±–Ω–æ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º—É–≤–∞—Ç–∏ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è. –î–∏–≤. <a href="https://arxiv.org/pdf/2010.11929">—Ç–∞–±–ª–∏—Ü—é 3</a>.</li>
</ul>

<img data-src="img/vif-01.jpg" class="r-stretch"></section>
<section id="—Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ—ó" class="slide level2">
<h2>–¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ—ó</h2>
<div id="ffdac3e1" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href=""></a>IMG_SIZE <span class="op">=</span> <span class="dv">224</span></span>
<span id="cb3-2"><a href=""></a></span>
<span id="cb3-3"><a href=""></a>manual_transforms <span class="op">=</span> transforms.Compose([</span>
<span id="cb3-4"><a href=""></a>    transforms.Resize((IMG_SIZE, IMG_SIZE)),</span>
<span id="cb3-5"><a href=""></a>    transforms.ToTensor(),</span>
<span id="cb3-6"><a href=""></a>])</span>
<span id="cb3-7"><a href=""></a><span class="bu">print</span>(<span class="ss">f"Manually created transforms: </span><span class="sc">{</span>manual_transforms<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Manually created transforms: Compose(
    Resize(size=(224, 224), interpolation=bilinear, max_size=None, antialias=True)
    ToTensor()
)</code></pre>
</div>
</div>
</section>
<section id="–ø–µ—Ä–µ–¥–∞—î–º–æ-—É-dataloader" class="slide level2">
<h2>–ü–µ—Ä–µ–¥–∞—î–º–æ —É DataLoader</h2>
<ul>
<li>–†–æ–∑–º—ñ—Ä –±–∞—Ç—á—É —É —Å—Ç–∞—Ç—ñ - 4096, –∞–ª–µ —É –Ω–∞—Å –º–æ–∂–µ –Ω–µ –±—É—Ç–∏ —Å—Ç—ñ–ª—å–∫–∏ –ø–∞–º‚Äô—è—Ç—ñ.</li>
<li>–í–∏–∫–æ—Ä–∏—Å—Ç–∞—î–º–æ 32.</li>
<li>–Ø–∫—â–æ –≤—Å–µ –æ–∫, –º–æ–∂–Ω–∞ –∑–±—ñ–ª—å—à–∏—Ç–∏.</li>
</ul>
<div id="286f07f2" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href=""></a>BATCH_SIZE <span class="op">=</span> <span class="dv">32</span></span>
<span id="cb5-2"><a href=""></a></span>
<span id="cb5-3"><a href=""></a>train_dataloader, test_dataloader, class_names <span class="op">=</span> data_setup.create_dataloaders(</span>
<span id="cb5-4"><a href=""></a>    train_dir<span class="op">=</span>train_dir,</span>
<span id="cb5-5"><a href=""></a>    test_dir<span class="op">=</span>test_dir,</span>
<span id="cb5-6"><a href=""></a>    transform<span class="op">=</span>manual_transforms,</span>
<span id="cb5-7"><a href=""></a>    batch_size<span class="op">=</span>BATCH_SIZE,</span>
<span id="cb5-8"><a href=""></a>    num_workers<span class="op">=</span><span class="dv">0</span></span>
<span id="cb5-9"><a href=""></a>)</span>
<span id="cb5-10"><a href=""></a></span>
<span id="cb5-11"><a href=""></a>train_dataloader, test_dataloader, class_names</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>(&lt;torch.utils.data.dataloader.DataLoader at 0x2089e07de10&gt;,
 &lt;torch.utils.data.dataloader.DataLoader at 0x2089e07d1d0&gt;,
 ['pizza', 'steak', 'sushi'])</code></pre>
</div>
</div>
</section>
<section id="–≤—Ö–æ–¥–∏-–≤–∏—Ö–æ–¥–∏-—à–∞—Ä–∏-—Ç–∞-–±–ª–æ–∫–∏" class="slide level2">
<h2>–í—Ö–æ–¥–∏, –≤–∏—Ö–æ–¥–∏, —à–∞—Ä–∏ —Ç–∞ –±–ª–æ–∫–∏</h2>
<ul>
<li>–í—Ö—ñ–¥: –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∑ —Ç—Ä—å–æ–º–∞ –∫–ª–∞—Å–∞–º–∏ (–ø—ñ—Ü–∞, —Å—Ç–µ–π–∫, —Å—É—à—ñ).</li>
<li>–í–∏—Ö—ñ–¥: –π–º–æ–≤—ñ—Ä–Ω–æ—Å—Ç—ñ –Ω–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –¥–æ –∫–æ–∂–Ω–æ–≥–æ –∑ —Ç—Ä—å–æ—Ö –∫–ª–∞—Å—ñ–≤.</li>
<li>–®–∞—Ä–∏: –ø—Ä–∏–π–º–∞—î –≤—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ, –≤–∏–∫–æ–Ω—É—î –æ–±—á–∏—Å–ª–µ–Ω–Ω—è —Ç–∞ –ø–µ—Ä–µ–¥–∞—î –≤–∏—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ –Ω–∞—Å—Ç—É–ø–Ω–æ–º—É —à–∞—Ä—É.</li>
<li>–ë–ª–æ–∫–∏: —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å —à–∞—Ä—ñ–≤, —è–∫—ñ –ø—Ä–∞—Ü—é—é—Ç—å —Ä–∞–∑–æ–º –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –ø–µ–≤–Ω–æ—ó —Ñ—É–Ω–∫—Ü—ñ—ó.</li>
<li>–ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ (–º–æ–¥–µ–ª—å): —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å –±–ª–æ–∫—ñ–≤, —è–∫—ñ –ø—Ä–∞—Ü—é—é—Ç—å —Ä–∞–∑–æ–º –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Å–∫–ª–∞–¥–Ω–æ–≥–æ –∑–∞–≤–¥–∞–Ω–Ω—è.</li>
</ul>
</section>
<section class="slide level2">

<div class="columns">
<div class="column">
<div class="cell" data-reveal="true" data-layout-align="center">
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<pre class="mermaid mermaid-js">graph LR
    A[Inputs] --&gt; B{Layer};
    B --&gt; C[Outputs];
    
    subgraph " "
        direction TB
        D["&lt;b&gt;Attention(Q, K, V) = softmax(QK&lt;sup&gt;T&lt;/sup&gt;/‚àöd&lt;sub&gt;k&lt;/sub&gt;)V"]
    end

    B-.-&gt;D
    
    style B fill:#7FFFD4,stroke:#7FFFD4,color:#000
    style D fill:#000,stroke:#000,color:#fff
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div><div class="column">
<div class="cell" data-reveal="true" data-layout-align="center">
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<pre class="mermaid mermaid-js">graph LR
    Inputs --&gt; L1;

    subgraph Block
        direction LR
        L1[Layer]
        L2[Layer]
        L3[Layer]
    end
    
    L3 --&gt; Outputs;
    
    style Block fill:#1E90FF,stroke:#1E90FF,color:white
    style L1 fill:#7FFFD4,stroke:#7FFFD4,color:#000
    style L2 fill:#7FFFD4,stroke:#7FFFD4,color:#000
    style L3 fill:#7FFFD4,stroke:#7FFFD4,color:#000
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div></div>
</section>
<section class="slide level2">

<div class="cell" data-reveal="true" data-layout-align="center">
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<pre class="mermaid mermaid-js">graph LR
    Inputs --&gt; Model;
    subgraph Model
        direction LR
        subgraph Block_1
            direction LR
            L1[Layer]
            L2[Layer]
            L3[Layer]
        end
        subgraph Block_2
            direction LR
            L4[Layer]
            L5[Layer]
            L6[Layer]
        end
        etc[...]
    end
    Model --&gt; Outputs;

    style Model fill:#FA8072,stroke:#FA8072,color:white
    style Block_1 fill:#1E90FF,stroke:#1E90FF,color:white
    style Block_2 fill:#1E90FF,stroke:#1E90FF,color:white
    style L1 fill:#7FFFD4,stroke:#7FFFD4,color:#000
    style L2 fill:#7FFFD4,stroke:#7FFFD4,color:#000
    style L3 fill:#7FFFD4,stroke:#7FFFD4,color:#000
    style L4 fill:#7FFFD4,stroke:#7FFFD4,color:#000
    style L5 fill:#7FFFD4,stroke:#7FFFD4,color:#000
    style L6 fill:#7FFFD4,stroke:#7FFFD4,color:#000
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
<section id="–∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞-vision-transformer" class="slide level2 smaller">
<h2>–ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ Vision Transformer</h2>
<ul>
<li>–†–∏—Å—É–Ω–æ–∫ 1.: –ì—Ä–∞—Ñ—ñ—á–Ω–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—è –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏ ViT.</li>
<li>–§–æ—Ä–º—É–ª–∏ 1-4 —É —Ä–æ–∑–¥—ñ–ª—ñ 3.1: –º–∞—Ç–µ–º–∞—Ç–∏—á–Ω–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—è –æ—Å–Ω–æ–≤–Ω–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤ ViT.</li>
<li>–¢–∞–±–ª–∏—Ü—è 1: –≥—ñ–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –º–æ–¥–µ–ª—ñ ViT.</li>
</ul>
<div class="quarto-layout-panel" data-layout-ncol="3">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img data-src="img/vif-02.jpg"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img data-src="img/vif-03.jpg"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img data-src="img/vif-04.jpg"></p>
</div>
</div>
</div>
</section>
<section id="—Ä–∏—Å—É–Ω–æ–∫-1" class="slide level2 tiny">
<h2>–†–∏—Å—É–Ω–æ–∫ 1</h2>
<ul>
<li><strong>Patch + Position Embedding</strong> (–≤—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ) - –ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Ä–æ–∑–±–∏–≤–∞—î—Ç—å—Å—è –Ω–∞ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∏ (patches) –∑ –¥–æ–¥–∞–≤–∞–Ω–Ω—è–º —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ –ø–æ–∑–∏—Ü—ñ—é (position embeddings).</li>
<li><strong>Linear projection of flattened patches (Embedded Patches)</strong> - –§—Ä–∞–≥–º–µ–Ω—Ç–∏ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—é—Ç—å—Å—è –Ω–∞ –µ–º–±–µ–Ω–¥—ñ–Ω–≥–∏.</li>
<li><strong>Norm</strong> - —Ü–µ —Å–∫–æ—Ä–æ—á–µ–Ω–Ω—è –≤—ñ–¥ ¬´Layer Normalization¬ª –∞–±–æ ¬´LayerNorm¬ª, —Ç–µ—Ö–Ω—ñ–∫–∏ –¥–ª—è —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü—ñ—ó (–∑–º–µ–Ω—à–µ–Ω–Ω—è –ø–µ—Ä–µ–Ω–∞–≤—á–∞–Ω–Ω—è) –Ω–µ–π—Ä–æ–Ω–Ω–æ—ó –º–µ—Ä–µ–∂—ñ (<code>torch.nn.LayerNorm()</code>).</li>
<li><strong>Multi-Head Attention</strong> - —Ü–µ —à–∞—Ä Multi-Headed Self-Attention –∞–±–æ, —Å–∫–æ—Ä–æ—á–µ–Ω–æ, ¬´MSA¬ª (<code>torch.nn.MultiheadAttention()</code>).</li>
<li><strong>MLP</strong> (–∞–±–æ –±–∞–≥–∞—Ç–æ—à–∞—Ä–æ–≤–∏–π –ø–µ—Ä—Ü–µ–ø—Ç—Ä–æ–Ω) ‚Äî MLP —á–∞—Å—Ç–æ –º–æ–∂–µ –æ–∑–Ω–∞—á–∞—Ç–∏ –±—É–¥—å-—è–∫—É —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å —à–∞—Ä—ñ–≤ –ø—Ä—è–º–æ–≥–æ –ø–æ—à–∏—Ä–µ–Ω–Ω—è (–∞–±–æ, —É –≤–∏–ø–∞–¥–∫—É PyTorch, —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å —à–∞—Ä—ñ–≤ –∑ –º–µ—Ç–æ–¥–æ–º <code>forward()</code>). –£ —Å—Ç–∞—Ç—Ç—ñ –ø—Ä–æ ViT –∞–≤—Ç–æ—Ä–∏ –Ω–∞–∑–∏–≤–∞—é—Ç—å MLP ¬´–±–ª–æ–∫–æ–º MLP¬ª, —è–∫–∏–π –º—ñ—Å—Ç–∏—Ç—å –¥–≤–∞ —à–∞—Ä–∏ <code>torch.nn.Linear()</code> –∑ –Ω–µ–ª—ñ–Ω—ñ–π–Ω–æ—é –∞–∫—Ç–∏–≤–∞—Ü—ñ—î—é <code>torch.nn.GELU()</code> –º—ñ–∂ –Ω–∏–º–∏ —ñ —à–∞—Ä <code>torch.nn.Dropout()</code> –ø—ñ—Å–ª—è –∫–æ–∂–Ω–æ–≥–æ –∑ –Ω–∏—Ö.</li>
<li><strong>Transformer Encoder</strong> ‚Äî —Ü–µ —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å —à–∞—Ä—ñ–≤, –ø–µ—Ä–µ—Ä–∞—Ö–æ–≤–∞–Ω–∏—Ö –≤–∏—â–µ. –ó–∞–≥–∞–ª—å–Ω–∞ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ ViT —Å–∫–ª–∞–¥–∞—î—Ç—å—Å—è –∑ –¥–µ–∫—ñ–ª—å–∫–æ—Ö Transformer encoders, —Ä–æ–∑—Ç–∞—à–æ–≤–∞–Ω–∏—Ö –æ–¥–∏–Ω –Ω–∞–¥ –æ–¥–Ω–∏–º. –°–∏–º–≤–æ–ª ‚Äú+‚Äù –Ω–∞ –º–∞–ª—é–Ω–∫—É –≤–∫–∞–∑—É—î –Ω–∞ —Ç–µ, —â–æ –≤–∏—Ö—ñ–¥ –æ–¥–Ω–æ–≥–æ Transformer encoder —î –≤—Ö–æ–¥–æ–º –¥–ª—è –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ.</li>
<li><strong>MLP Head</strong> ‚Äî —Ü–µ –≤–∏—Ö—ñ–¥–Ω–∏–π —à–∞—Ä –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏, —è–∫–∏–π –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î –≤–∏–≤—á–µ–Ω—ñ –æ—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ –≤—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö —É –≤–∏—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ –∫–ª–∞—Å—É.</li>
</ul>
</section>
<section id="patch-position-embedding" class="slide level2">
<h2>Patch + Position Embedding</h2>
<div id="7172e113" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href=""></a>height <span class="op">=</span> <span class="dv">224</span> <span class="co"># H</span></span>
<span id="cb7-2"><a href=""></a>width <span class="op">=</span> <span class="dv">224</span> <span class="co"># W</span></span>
<span id="cb7-3"><a href=""></a>color_channels <span class="op">=</span> <span class="dv">3</span> <span class="co"># C</span></span>
<span id="cb7-4"><a href=""></a>patch_size <span class="op">=</span> <span class="dv">16</span> <span class="co"># P</span></span>
<span id="cb7-5"><a href=""></a></span>
<span id="cb7-6"><a href=""></a>number_of_patches <span class="op">=</span> <span class="bu">int</span>((height <span class="op">*</span> width) <span class="op">/</span> patch_size<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb7-7"><a href=""></a><span class="bu">print</span>(<span class="ss">f"Number of patches: </span><span class="sc">{</span>number_of_patches<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of patches: 196</code></pre>
</div>
</div>
</section>
<section id="patch-position-embedding-1" class="slide level2">
<h2>Patch + Position Embedding</h2>
<ul>
<li><strong>–í—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ:</strong> –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Å–ø–æ—á–∞—Ç–∫—É –º–∞—î –≤–∏–≥–ª—è–¥ 2D —Ä–æ–∑–º—ñ—Ä–æ–º <span class="math inline">\({H \times W \times C}\)</span>.</li>
<li><strong>–í–∏—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ:</strong> –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –Ω–∞ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å —Å–ø–ª–æ—â–µ–Ω–∏—Ö 2D —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ñ–≤ —Ä–æ–∑–º—ñ—Ä–æ–º <span class="math inline">\({N \times\left(P^{2} \cdot C\right)}\)</span>.</li>
</ul>
<div id="07171f76" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href=""></a>embedding_layer_input_shape <span class="op">=</span> (height, width, color_channels)</span>
<span id="cb9-2"><a href=""></a></span>
<span id="cb9-3"><a href=""></a>embedding_layer_output_shape <span class="op">=</span> (number_of_patches, patch_size<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> color_channels)</span>
<span id="cb9-4"><a href=""></a></span>
<span id="cb9-5"><a href=""></a><span class="bu">print</span>(<span class="ss">f"Input shape (single 2D image): </span><span class="sc">{</span>embedding_layer_input_shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb9-6"><a href=""></a><span class="bu">print</span>(<span class="ss">f"Output shape (single 2D image flattened into patches): </span><span class="sc">{</span>embedding_layer_output_shape<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Input shape (single 2D image): (224, 224, 3)
Output shape (single 2D image flattened into patches): (196, 768)</code></pre>
</div>
</div>
</section>
<section id="—è–∫-—Ü–µ-–≤–∏–≥–ª—è–¥–∞—î" class="slide level2">
<h2>–Ø–∫ —Ü–µ –≤–∏–≥–ª—è–¥–∞—î?</h2>
<div id="45e0e1b5" class="cell columns column-output-location" data-execution_count="7">
<div class="column">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href=""></a><span class="co"># Get a batch of images</span></span>
<span id="cb11-2"><a href=""></a>image_batch, label_batch <span class="op">=</span> <span class="bu">next</span>(<span class="bu">iter</span>(train_dataloader))</span>
<span id="cb11-3"><a href=""></a></span>
<span id="cb11-4"><a href=""></a><span class="co"># Get a single image from the batch</span></span>
<span id="cb11-5"><a href=""></a>image, label <span class="op">=</span> image_batch[<span class="dv">0</span>], label_batch[<span class="dv">0</span>]</span>
<span id="cb11-6"><a href=""></a></span>
<span id="cb11-7"><a href=""></a><span class="co"># View the batch shapes</span></span>
<span id="cb11-8"><a href=""></a><span class="bu">print</span>(image.shape, label)</span>
<span id="cb11-9"><a href=""></a></span>
<span id="cb11-10"><a href=""></a>plt.imshow(image.permute(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">0</span>)) <span class="co"># adjust for matplotlib</span></span>
<span id="cb11-11"><a href=""></a>plt.title(class_names[label])</span>
<span id="cb11-12"><a href=""></a>plt.axis(<span class="va">False</span>)<span class="op">;</span></span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-stdout">
<pre><code>torch.Size([3, 224, 224]) tensor(1)</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src=".07_files/figure-revealjs/cell-8-output-2.svg"></p>
</figure>
</div>
</div>
</div></div>
</section>
<section id="—è–∫-—Ü–µ-–≤–∏–≥–ª—è–¥–∞—î-1" class="slide level2">
<h2>–Ø–∫ —Ü–µ –≤–∏–≥–ª—è–¥–∞—î?</h2>
<div id="81ce5a55" class="cell columns column-output-location" data-execution_count="8">
<div class="column">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href=""></a>image_permuted <span class="op">=</span> image.permute(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">0</span>)</span>
<span id="cb13-2"><a href=""></a></span>
<span id="cb13-3"><a href=""></a><span class="co"># Index to plot the top row of patched pixels</span></span>
<span id="cb13-4"><a href=""></a>patch_size <span class="op">=</span> <span class="dv">16</span></span>
<span id="cb13-5"><a href=""></a>plt.figure(figsize<span class="op">=</span>(patch_size, patch_size))</span>
<span id="cb13-6"><a href=""></a>plt.imshow(image_permuted[:patch_size, :, :])<span class="op">;</span></span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src=".07_files/figure-revealjs/cell-9-output-1.svg"></p>
</figure>
</div>
</div>
</div></div>
</section>
<section id="—è–∫-—Ü–µ-–≤–∏–≥–ª—è–¥–∞—î-2" class="slide level2 tiny">
<h2>–Ø–∫ —Ü–µ –≤–∏–≥–ª—è–¥–∞—î?</h2>
<div id="f2d62adf" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href=""></a>img_size <span class="op">=</span> <span class="dv">224</span></span>
<span id="cb14-2"><a href=""></a>patch_size <span class="op">=</span> <span class="dv">16</span></span>
<span id="cb14-3"><a href=""></a>num_patches <span class="op">=</span> img_size<span class="op">/</span>patch_size</span>
<span id="cb14-4"><a href=""></a><span class="cf">assert</span> img_size <span class="op">%</span> patch_size <span class="op">==</span> <span class="dv">0</span>, <span class="st">"Image size must be divisible by patch size"</span></span>
<span id="cb14-5"><a href=""></a><span class="bu">print</span>(<span class="ss">f"Number of patches per row: </span><span class="sc">{</span>num_patches<span class="sc">}</span><span class="ch">\n</span><span class="ss">Patch size: </span><span class="sc">{</span>patch_size<span class="sc">}</span><span class="ss"> pixels x </span><span class="sc">{</span>patch_size<span class="sc">}</span><span class="ss"> pixels"</span>)</span>
<span id="cb14-6"><a href=""></a></span>
<span id="cb14-7"><a href=""></a>fig, axs <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb14-8"><a href=""></a>                        ncols<span class="op">=</span>img_size <span class="op">//</span> patch_size,</span>
<span id="cb14-9"><a href=""></a>                        figsize<span class="op">=</span>(num_patches, num_patches),</span>
<span id="cb14-10"><a href=""></a>                        sharex<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb14-11"><a href=""></a>                        sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb14-12"><a href=""></a></span>
<span id="cb14-13"><a href=""></a><span class="cf">for</span> i, patch <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">range</span>(<span class="dv">0</span>, img_size, patch_size)):</span>
<span id="cb14-14"><a href=""></a>    axs[i].imshow(image_permuted[:patch_size, patch:patch<span class="op">+</span>patch_size, :])<span class="op">;</span></span>
<span id="cb14-15"><a href=""></a>    axs[i].set_xlabel(i<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb14-16"><a href=""></a>    axs[i].set_xticks([])</span>
<span id="cb14-17"><a href=""></a>    axs[i].set_yticks([])</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</section>
<section id="—è–∫-—Ü–µ-–≤–∏–≥–ª—è–¥–∞—î-2-output" class="slide level2 tiny output-location-slide"><h2>–Ø–∫ —Ü–µ –≤–∏–≥–ª—è–¥–∞—î?</h2><div class="cell output-location-slide" data-execution_count="9">
<div class="cell-output cell-output-stdout">
<pre><code>Number of patches per row: 14.0
Patch size: 16 pixels x 16 pixels</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src=".07_files/figure-revealjs/cell-10-output-2.svg"></p>
</figure>
</div>
</div>
</div></section><section id="—è–∫-—Ü–µ-–≤–∏–≥–ª—è–¥–∞—î-3" class="slide level2">
<h2>–Ø–∫ —Ü–µ –≤–∏–≥–ª—è–¥–∞—î?</h2>
<div id="32b2f5f4" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href=""></a>img_size <span class="op">=</span> <span class="dv">224</span></span>
<span id="cb16-2"><a href=""></a>patch_size <span class="op">=</span> <span class="dv">16</span></span>
<span id="cb16-3"><a href=""></a>num_patches <span class="op">=</span> img_size<span class="op">/</span>patch_size</span>
<span id="cb16-4"><a href=""></a><span class="cf">assert</span> img_size <span class="op">%</span> patch_size <span class="op">==</span> <span class="dv">0</span>, <span class="st">"Image size must be divisible by patch size"</span></span>
<span id="cb16-5"><a href=""></a><span class="bu">print</span>(<span class="ss">f"Number of patches per row: </span><span class="sc">{</span>num_patches<span class="sc">}</span><span class="op">\</span></span>
<span id="cb16-6"><a href=""></a><span class="ss">        </span><span class="ch">\n</span><span class="ss">Number of patches per column: </span><span class="sc">{</span>num_patches<span class="sc">}</span><span class="op">\</span></span>
<span id="cb16-7"><a href=""></a><span class="ss">        </span><span class="ch">\n</span><span class="ss">Total patches: </span><span class="sc">{</span>num_patches<span class="op">*</span>num_patches<span class="sc">}</span><span class="op">\</span></span>
<span id="cb16-8"><a href=""></a><span class="ss">        </span><span class="ch">\n</span><span class="ss">Patch size: </span><span class="sc">{</span>patch_size<span class="sc">}</span><span class="ss"> pixels x </span><span class="sc">{</span>patch_size<span class="sc">}</span><span class="ss"> pixels"</span>)</span>
<span id="cb16-9"><a href=""></a></span>
<span id="cb16-10"><a href=""></a>fig, axs <span class="op">=</span> plt.subplots(nrows<span class="op">=</span>img_size <span class="op">//</span> patch_size,</span>
<span id="cb16-11"><a href=""></a>                        ncols<span class="op">=</span>img_size <span class="op">//</span> patch_size,</span>
<span id="cb16-12"><a href=""></a>                        figsize<span class="op">=</span>(num_patches, num_patches),</span>
<span id="cb16-13"><a href=""></a>                        sharex<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb16-14"><a href=""></a>                        sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb16-15"><a href=""></a></span>
<span id="cb16-16"><a href=""></a><span class="cf">for</span> i, patch_height <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">range</span>(<span class="dv">0</span>, img_size, patch_size)):</span>
<span id="cb16-17"><a href=""></a>    <span class="cf">for</span> j, patch_width <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">range</span>(<span class="dv">0</span>, img_size, patch_size)):</span>
<span id="cb16-18"><a href=""></a></span>
<span id="cb16-19"><a href=""></a>        axs[i, j].imshow(image_permuted[patch_height:patch_height<span class="op">+</span>patch_size,</span>
<span id="cb16-20"><a href=""></a>                                        patch_width:patch_width<span class="op">+</span>patch_size,</span>
<span id="cb16-21"><a href=""></a>                                        :])</span>
<span id="cb16-22"><a href=""></a></span>
<span id="cb16-23"><a href=""></a>        axs[i, j].set_ylabel(i<span class="op">+</span><span class="dv">1</span>,</span>
<span id="cb16-24"><a href=""></a>                             rotation<span class="op">=</span><span class="st">"horizontal"</span>,</span>
<span id="cb16-25"><a href=""></a>                             horizontalalignment<span class="op">=</span><span class="st">"right"</span>,</span>
<span id="cb16-26"><a href=""></a>                             verticalalignment<span class="op">=</span><span class="st">"center"</span>)</span>
<span id="cb16-27"><a href=""></a>        axs[i, j].set_xlabel(j<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb16-28"><a href=""></a>        axs[i, j].set_xticks([])</span>
<span id="cb16-29"><a href=""></a>        axs[i, j].set_yticks([])</span>
<span id="cb16-30"><a href=""></a>        axs[i, j].label_outer()</span>
<span id="cb16-31"><a href=""></a></span>
<span id="cb16-32"><a href=""></a>fig.suptitle(<span class="ss">f"</span><span class="sc">{</span>class_names[label]<span class="sc">}</span><span class="ss"> -&gt; Patchified"</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb16-33"><a href=""></a>plt.show()</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</section>
<section id="—è–∫-—Ü–µ-–≤–∏–≥–ª—è–¥–∞—î-3-output" class="slide level2 output-location-slide"><h2>–Ø–∫ —Ü–µ –≤–∏–≥–ª—è–¥–∞—î?</h2><div class="cell output-location-slide" data-execution_count="10">
<div class="cell-output cell-output-stdout">
<pre><code>Number of patches per row: 14.0        
Number of patches per column: 14.0        
Total patches: 196.0        
Patch size: 16 pixels x 16 pixels</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src=".07_files/figure-revealjs/cell-11-output-2.svg"></p>
</figure>
</div>
</div>
</div></section><section id="torch.nn.conv2d" class="slide level2 smaller">
<h2><code>torch.nn.Conv2d()</code></h2>
<ul>
<li>–ú–∏ –º–æ–∂–µ–º–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ <code>torch.nn.Conv2d()</code> –¥–ª—è —Ä–æ–∑–±–∏—Ç—Ç—è –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –Ω–∞ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∏ (patches).</li>
<li>–ü–∞—Ä–∞–º–µ—Ç—Ä–∏:
<ul>
<li><code>in_channels</code>: –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∫–∞–Ω–∞–ª—ñ–≤ —É –≤—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö (3 –¥–ª—è RGB-–∑–æ–±—Ä–∞–∂–µ–Ω—å).</li>
<li><code>out_channels</code>: –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ñ—ñ–ª—å—Ç—Ä—ñ–≤ (–ø–æ—Ç—Ä—ñ–±–Ω–æ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —Ä—ñ–≤–Ω–∏–º —Ä–æ–∑–º—ñ—Ä—É –µ–º–±–µ–¥—ñ–Ω–≥—É, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, 768).</li>
<li><code>kernel_size</code>: —Ä–æ–∑–º—ñ—Ä —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞ (patch size), –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, 16.</li>
<li><code>stride</code>: –∫—Ä–æ–∫ –∫–æ–≤–∑–∞–Ω–Ω—è —Ñ—ñ–ª—å—Ç—Ä–∞ (stride), —Ç–∞–∫–æ–∂ –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î—Ç—å—Å—è —Ä—ñ–≤–Ω–∏–º —Ä–æ–∑–º—ñ—Ä—É —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞.</li>
<li><code>padding</code>: –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø—ñ–∫—Å–µ–ª—ñ–≤, —è–∫—ñ –¥–æ–¥–∞—é—Ç—å—Å—è –¥–æ –∫—Ä–∞—ó–≤ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è (0 –¥–ª—è –±–µ–∑ –¥–æ–¥–∞—Ç–∫–æ–≤–æ–≥–æ –ø–∞–¥–¥—ñ–Ω–≥—É).</li>
</ul></li>
</ul>
<div id="ca7bf3af" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href=""></a><span class="im">from</span> torch <span class="im">import</span> nn</span>
<span id="cb18-2"><a href=""></a></span>
<span id="cb18-3"><a href=""></a>patch_size<span class="op">=</span><span class="dv">16</span></span>
<span id="cb18-4"><a href=""></a></span>
<span id="cb18-5"><a href=""></a>conv2d <span class="op">=</span> nn.Conv2d(in_channels<span class="op">=</span><span class="dv">3</span>, </span>
<span id="cb18-6"><a href=""></a>                   out_channels<span class="op">=</span><span class="dv">768</span>,</span>
<span id="cb18-7"><a href=""></a>                   kernel_size<span class="op">=</span>patch_size,</span>
<span id="cb18-8"><a href=""></a>                   stride<span class="op">=</span>patch_size,</span>
<span id="cb18-9"><a href=""></a>                   padding<span class="op">=</span><span class="dv">0</span>)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div id="5bfb5336" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href=""></a><span class="co"># View single image</span></span>
<span id="cb19-2"><a href=""></a>plt.imshow(image.permute(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">0</span>)) <span class="co"># adjust for matplotlib</span></span>
<span id="cb19-3"><a href=""></a>plt.title(class_names[label])</span>
<span id="cb19-4"><a href=""></a>plt.axis(<span class="va">False</span>)<span class="op">;</span></span>
<span id="cb19-5"><a href=""></a></span>
<span id="cb19-6"><a href=""></a>image_out_of_conv <span class="op">=</span> conv2d(image.unsqueeze(<span class="dv">0</span>))</span>
<span id="cb19-7"><a href=""></a><span class="bu">print</span>(image_out_of_conv.shape)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>torch.Size([1, 768, 14, 14])</code></pre>
</div>

</div>
<img data-src=".07_files/figure-revealjs/cell-13-output-2.svg" class="r-stretch"></section>
<section class="slide level2">

<p>–í—ñ–∑—É–∞–ª—ñ–∑—É—î–º–æ –≤–∏—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ –ø—ñ—Å–ª—è —à–∞—Ä—É <code>Conv2d</code></p>
<div id="ef8f2790" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href=""></a><span class="im">import</span> random</span>
<span id="cb21-2"><a href=""></a>random_indexes <span class="op">=</span> random.sample(<span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">758</span>), k<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb21-3"><a href=""></a><span class="bu">print</span>(<span class="ss">f"Showing random convolutional feature maps from indexes: </span><span class="sc">{</span>random_indexes<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb21-4"><a href=""></a></span>
<span id="cb21-5"><a href=""></a>fig, axs <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">5</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">12</span>))</span>
<span id="cb21-6"><a href=""></a></span>
<span id="cb21-7"><a href=""></a><span class="cf">for</span> i, idx <span class="kw">in</span> <span class="bu">enumerate</span>(random_indexes):</span>
<span id="cb21-8"><a href=""></a>    image_conv_feature_map <span class="op">=</span> image_out_of_conv[:, idx, :, :]</span>
<span id="cb21-9"><a href=""></a>    axs[i].imshow(image_conv_feature_map.squeeze().detach().numpy())</span>
<span id="cb21-10"><a href=""></a>    axs[i].<span class="bu">set</span>(xticklabels<span class="op">=</span>[], yticklabels<span class="op">=</span>[], xticks<span class="op">=</span>[], yticks<span class="op">=</span>[])<span class="op">;</span></span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Showing random convolutional feature maps from indexes: [290, 691, 29, 426, 140]</code></pre>
</div>

</div>
<img data-src=".07_files/figure-revealjs/cell-14-output-2.svg" class="r-stretch"></section>
<section class="slide level2">

<p>–ü–µ—Ä–µ–≥–ª—è–Ω–µ–º–æ –æ–∫—Ä–µ–º—É –æ–∑–Ω–∞–∫—É –≤ —Ç–µ–Ω–∑–æ—Ä–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—ñ</p>
<div id="26274c2d" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href=""></a><span class="co"># Get a single feature map in tensor form</span></span>
<span id="cb23-2"><a href=""></a>single_feature_map <span class="op">=</span> image_out_of_conv[:, <span class="dv">0</span>, :, :]</span>
<span id="cb23-3"><a href=""></a>single_feature_map, single_feature_map.requires_grad</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>(tensor([[[-0.5682, -0.3294, -0.1865, -0.3129, -0.2170, -0.1989, -0.2166,
           -0.3147, -0.6004, -0.4499, -0.5044, -0.4318, -0.4904, -0.4215],
          [-0.5707, -0.1634, -0.1752, -0.1351, -0.1421, -0.5539, -0.2433,
           -0.2004, -0.5177, -0.3425, -0.2038, -0.3769, -0.4639, -0.4092],
          [-0.3764, -0.1589, -0.1826, -0.1505, -0.2242, -0.3970, -0.2123,
           -0.3874, -0.3093, -0.3198, -0.2962, -0.3580, -0.4708, -0.2804],
          [-0.1281, -0.0262, -0.0843, -0.2140, -0.3014, -0.2103, -0.3015,
           -0.5217, -0.2137, -0.2273, -0.3424, -0.2282, -0.5093, -0.5065],
          [-0.1994, -0.2153, -0.4105, -0.3352, -0.2084, -0.2269, -0.2250,
           -0.4635, -0.2580, -0.3233, -0.4156, -0.2745, -0.3273, -0.4559],
          [-0.6673, -0.5647, -0.3877, -0.2124, -0.1688, -0.2347, -0.2694,
           -0.3876, -0.3589, -0.2834, -0.2911, -0.3708, -0.2751, -0.4755],
          [-0.4905, -0.1917, -0.3946, -0.4608, -0.2368, -0.1890, -0.2922,
           -0.1895, -0.3366, -0.3923, -0.4055, -0.3608, -0.6184, -0.6183],
          [-0.2765, -0.2388, -0.2157, -0.3127, -0.3921, -0.2119, -0.1932,
           -0.1103, -0.1748, -0.4203, -0.4680, -0.4042, -0.3833, -0.5966],
          [-0.5245, -0.1914, -0.4600, -0.3360, -0.2282, -0.2910, -0.3459,
           -0.3338, -0.3649, -0.3006, -0.3510, -0.3075, -0.4411, -0.5954],
          [-0.6219, -0.4053, -0.1084, -0.1925, -0.2095, -0.6167, -0.4540,
           -0.2195, -0.2781, -0.3779, -0.6944, -0.7391, -0.6584, -0.5501],
          [-0.5733, -0.5314, -0.3289, -0.2664, -0.3436, -0.2475, -0.3160,
           -0.3267, -0.1395, -0.4851, -0.5872, -0.6027, -0.5761, -0.5736],
          [-0.5727, -0.5826, -0.4578, -0.5197, -0.4892, -0.2703, -0.3564,
           -0.6256, -0.4860, -0.4873, -0.5894, -0.5865, -0.5896, -0.5904],
          [-0.5475, -0.5705, -0.5776, -0.6038, -0.4822, -0.4554, -0.3770,
           -0.4674, -0.5047, -0.5263, -0.5786, -0.5727, -0.5712, -0.5543],
          [-0.5091, -0.5334, -0.5548, -0.5673, -0.5761, -0.5689, -0.5613,
           -0.5715, -0.5746, -0.5686, -0.5581, -0.5459, -0.5271, -0.5054]]],
        grad_fn=&lt;SliceBackward0&gt;),
 True)</code></pre>
</div>
</div>
</section>
<section id="torch.nn.flatten" class="slide level2 tiny">
<h2><code>torch.nn.Flatten()</code></h2>
<p>–ü–µ—Ä–µ—Ç–≤–æ—Ä—é—î–º–æ –≤–∏—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ –ø—ñ—Å–ª—è —à–∞—Ä—É <code>Conv2d</code> —É —Ñ–æ—Ä–º–∞—Ç, –ø—Ä–∏–¥–∞—Ç–Ω–∏–π –¥–ª—è –ª—ñ–Ω—ñ–π–Ω–æ–≥–æ —à–∞—Ä—É</p>
<div id="182f9f8a" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href=""></a><span class="co"># Current tensor shape</span></span>
<span id="cb25-2"><a href=""></a><span class="bu">print</span>(<span class="ss">f"Current tensor shape: </span><span class="sc">{</span>image_out_of_conv<span class="sc">.</span>shape<span class="sc">}</span><span class="ss"> -&gt; [batch, embedding_dim, feature_map_height, feature_map_width]"</span>)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Current tensor shape: torch.Size([1, 768, 14, 14]) -&gt; [batch, embedding_dim, feature_map_height, feature_map_width]</code></pre>
</div>
</div>
<ul>
<li><code>start_dim=2</code>: –ø–æ—á–∏–Ω–∞—î–º–æ —Å–ø–ª–æ—â–µ–Ω–Ω—è –∑ —Ç—Ä–µ—Ç—å–æ–≥–æ –≤–∏–º—ñ—Ä—É (—ñ–Ω–¥–µ–∫—Å–∞—Ü—ñ—è –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –∑ 0).</li>
<li><code>end_dim=3</code>: –∑–∞–∫—ñ–Ω—á—É—î–º–æ —Å–ø–ª–æ—â–µ–Ω–Ω—è –Ω–∞ —á–µ—Ç–≤–µ—Ä—Ç–æ–º—É –≤–∏–º—ñ—Ä—ñ.</li>
</ul>
<div id="fc528bb2" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href=""></a>flatten <span class="op">=</span> nn.Flatten(start_dim<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb27-2"><a href=""></a>                     end_dim<span class="op">=</span><span class="dv">3</span>)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="–≤—Å–µ-—Ä–∞–∑–æ–º" class="slide level2 tiny">
<h2>–í—Å–µ —Ä–∞–∑–æ–º</h2>
<ol type="1">
<li>–ë–µ—Ä–µ–º–æ –æ–¥–Ω–µ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è.</li>
<li>–ü—Ä–æ–ø—É—Å—Ç–∏—Ç–∏ –π–æ–≥–æ —á–µ—Ä–µ–∑ –∫–æ–Ω–≤–æ–ª—é—Ü—ñ–π–Ω–∏–π —à–∞—Ä (conv2d), —â–æ–± –ø–µ—Ä–µ—Ç–≤–æ—Ä–∏—Ç–∏ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –Ω–∞ 2D-–∫–∞—Ä—Ç–∏ –æ–∑–Ω–∞–∫ (–≤–±—É–¥–æ–≤—É–≤–∞–Ω–Ω—è –ø–∞—Ç—á—ñ–≤).</li>
<li>–°–ø–ª–∞–≤–∏—Ç–∏ 2D-–∫–∞—Ä—Ç—É –æ–∑–Ω–∞–∫ –≤ –æ–¥–Ω—É –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å.</li>
</ol>
<div id="4bd0d2b0" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href=""></a>plt.imshow(image.permute(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">0</span>))</span>
<span id="cb28-2"><a href=""></a>plt.title(class_names[label])</span>
<span id="cb28-3"><a href=""></a>plt.axis(<span class="va">False</span>)<span class="op">;</span></span>
<span id="cb28-4"><a href=""></a><span class="bu">print</span>(<span class="ss">f"Original image shape: </span><span class="sc">{</span>image<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb28-5"><a href=""></a></span>
<span id="cb28-6"><a href=""></a>image_out_of_conv <span class="op">=</span> conv2d(image.unsqueeze(<span class="dv">0</span>))</span>
<span id="cb28-7"><a href=""></a><span class="bu">print</span>(<span class="ss">f"Image feature map shape: </span><span class="sc">{</span>image_out_of_conv<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb28-8"><a href=""></a></span>
<span id="cb28-9"><a href=""></a>image_out_of_conv_flattened <span class="op">=</span> flatten(image_out_of_conv)</span>
<span id="cb28-10"><a href=""></a><span class="bu">print</span>(<span class="ss">f"Flattened image feature map shape: </span><span class="sc">{</span>image_out_of_conv_flattened<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</section>
<section id="–≤—Å–µ-—Ä–∞–∑–æ–º-output" class="slide level2 tiny output-location-slide"><h2>–í—Å–µ —Ä–∞–∑–æ–º</h2><div class="cell output-location-slide" data-execution_count="17">
<div class="cell-output cell-output-stdout">
<pre><code>Original image shape: torch.Size([3, 224, 224])
Image feature map shape: torch.Size([1, 768, 14, 14])
Flattened image feature map shape: torch.Size([1, 768, 196])</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src=".07_files/figure-revealjs/cell-18-output-2.svg"></p>
</figure>
</div>
</div>
</div></section><section id="torch.tensor.permute" class="slide level2">
<h2><code>torch.Tensor.permute()</code></h2>
<ul>
<li>–ü—ñ—Å–ª—è —Å–ø–ª–æ—â–µ–Ω–Ω—è, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ –æ—Å—Ç–∞—Ç–æ—á–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç –µ–º–±–µ–¥—ñ–Ω–≥—É –ø–∞—Ç—á—ñ–≤, –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–º—ñ–Ω–∏—Ç–∏ –ø–æ—Ä—è–¥–æ–∫ –≤–∏–º—ñ—Ä—ñ–≤ —Ç–µ–Ω–∑–æ—Ä–∞.</li>
</ul>
<div id="be666775" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href=""></a>image_out_of_conv_flattened_reshaped <span class="op">=</span> image_out_of_conv_flattened.permute(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb30-2"><a href=""></a><span class="bu">print</span>(<span class="ss">f"Patch embedding sequence shape: </span><span class="sc">{</span>image_out_of_conv_flattened_reshaped<span class="sc">.</span>shape<span class="sc">}</span><span class="ss"> -&gt; [batch_size, num_patches, embedding_size]"</span>)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Patch embedding sequence shape: torch.Size([1, 196, 768]) -&gt; [batch_size, num_patches, embedding_size]</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>–í—ñ–∑—É–∞–ª—ñ–∑—É—î–º–æ –æ–∫—Ä–µ–º—É –æ–∑–Ω–∞–∫—É –ø—ñ—Å–ª—è —Å–ø–ª–æ—â–µ–Ω–Ω—è</p>
<div id="2ddc6b41" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href=""></a>single_flattened_feature_map <span class="op">=</span> image_out_of_conv_flattened_reshaped[:, :, <span class="dv">0</span>]</span>
<span id="cb32-2"><a href=""></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">22</span>, <span class="dv">22</span>))</span>
<span id="cb32-3"><a href=""></a>plt.imshow(single_flattened_feature_map.detach().numpy())</span>
<span id="cb32-4"><a href=""></a>plt.title(<span class="ss">f"Flattened feature map shape: </span><span class="sc">{</span>single_flattened_feature_map<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb32-5"><a href=""></a>plt.axis(<span class="va">False</span>)<span class="op">;</span></span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src=".07_files/figure-revealjs/cell-20-output-1.svg" class="r-stretch"></section>
<section class="slide level2">

<p>–ü–µ—Ä–µ–≥–ª—è–Ω–µ–º–æ –æ–∫—Ä–µ–º—É –æ–∑–Ω–∞–∫—É —É —Ç–µ–Ω–∑–æ—Ä–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—ñ</p>
<div id="eed06cb9" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href=""></a>single_flattened_feature_map, single_flattened_feature_map.requires_grad, single_flattened_feature_map.shape</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>(tensor([[-0.5682, -0.3294, -0.1865, -0.3129, -0.2170, -0.1989, -0.2166, -0.3147,
          -0.6004, -0.4499, -0.5044, -0.4318, -0.4904, -0.4215, -0.5707, -0.1634,
          -0.1752, -0.1351, -0.1421, -0.5539, -0.2433, -0.2004, -0.5177, -0.3425,
          -0.2038, -0.3769, -0.4639, -0.4092, -0.3764, -0.1589, -0.1826, -0.1505,
          -0.2242, -0.3970, -0.2123, -0.3874, -0.3093, -0.3198, -0.2962, -0.3580,
          -0.4708, -0.2804, -0.1281, -0.0262, -0.0843, -0.2140, -0.3014, -0.2103,
          -0.3015, -0.5217, -0.2137, -0.2273, -0.3424, -0.2282, -0.5093, -0.5065,
          -0.1994, -0.2153, -0.4105, -0.3352, -0.2084, -0.2269, -0.2250, -0.4635,
          -0.2580, -0.3233, -0.4156, -0.2745, -0.3273, -0.4559, -0.6673, -0.5647,
          -0.3877, -0.2124, -0.1688, -0.2347, -0.2694, -0.3876, -0.3589, -0.2834,
          -0.2911, -0.3708, -0.2751, -0.4755, -0.4905, -0.1917, -0.3946, -0.4608,
          -0.2368, -0.1890, -0.2922, -0.1895, -0.3366, -0.3923, -0.4055, -0.3608,
          -0.6184, -0.6183, -0.2765, -0.2388, -0.2157, -0.3127, -0.3921, -0.2119,
          -0.1932, -0.1103, -0.1748, -0.4203, -0.4680, -0.4042, -0.3833, -0.5966,
          -0.5245, -0.1914, -0.4600, -0.3360, -0.2282, -0.2910, -0.3459, -0.3338,
          -0.3649, -0.3006, -0.3510, -0.3075, -0.4411, -0.5954, -0.6219, -0.4053,
          -0.1084, -0.1925, -0.2095, -0.6167, -0.4540, -0.2195, -0.2781, -0.3779,
          -0.6944, -0.7391, -0.6584, -0.5501, -0.5733, -0.5314, -0.3289, -0.2664,
          -0.3436, -0.2475, -0.3160, -0.3267, -0.1395, -0.4851, -0.5872, -0.6027,
          -0.5761, -0.5736, -0.5727, -0.5826, -0.4578, -0.5197, -0.4892, -0.2703,
          -0.3564, -0.6256, -0.4860, -0.4873, -0.5894, -0.5865, -0.5896, -0.5904,
          -0.5475, -0.5705, -0.5776, -0.6038, -0.4822, -0.4554, -0.3770, -0.4674,
          -0.5047, -0.5263, -0.5786, -0.5727, -0.5712, -0.5543, -0.5091, -0.5334,
          -0.5548, -0.5673, -0.5761, -0.5689, -0.5613, -0.5715, -0.5746, -0.5686,
          -0.5581, -0.5459, -0.5271, -0.5054]], grad_fn=&lt;SelectBackward0&gt;),
 True,
 torch.Size([1, 196]))</code></pre>
</div>
</div>
</section>
<section id="–¥—è–∫—É—é-–∑–∞-—É–≤–∞–≥—É" class="title-slide slide level1 unnumbered unlisted center" data-background-iframe=".07_files/libs/colored-particles/index.html">
<h1>–î—è–∫—É—é –∑–∞ —É–≤–∞–≥—É!</h1>
<p><br> <br></p>
<p><iconify-icon inline="" icon="solar:book-bold"></iconify-icon> <a href="https://aranaur.rbind.io/lectures/">–ú–∞—Ç–µ—Ä—ñ–∞–ª–∏ –∫—É—Ä—Å—É</a></p>
<p><iconify-icon inline="" icon="mdi:envelope"></iconify-icon> ihor.miroshnychenko@knu.ua</p>
<p><iconify-icon inline="" icon="ic:baseline-telegram"></iconify-icon> <a href="https://t.me/araprof">Data Mirosh</a></p>
<p><iconify-icon inline="" icon="mdi:linkedin"></iconify-icon> <a href="https://www.linkedin.com/in/ihormiroshnychenko/">@ihormiroshnychenko</a></p>
<p><iconify-icon inline="" icon="mdi:github"></iconify-icon> <a href="https://github.com/Aranaur">@aranaur</a></p>
<p><iconify-icon inline="" icon="ion:home"></iconify-icon> <a href="https://aranaur.rbind.io">aranaur.rbind.io</a></p>

</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="fit.png" class="slide-logo"></p>
<div class="footer footer-default">
<p><a href="https://aranaur.rbind.io/lectures">üîó–¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó –∫–æ–º–ø‚Äô—é—Ç–µ—Ä–Ω–æ–≥–æ –∑–æ—Ä—É</a></p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src=".07_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src=".07_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src=".07_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src=".07_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src=".07_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src=".07_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src=".07_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src=".07_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src=".07_files/libs/revealjs/plugin/search/search.js"></script>
  <script src=".07_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src=".07_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: true,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: true,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1350,

        height: 759.375,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "–°–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "–°–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>