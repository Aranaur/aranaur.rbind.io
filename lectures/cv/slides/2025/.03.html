<!DOCTYPE html>
<html lang="en"><head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src=".03_files/libs/clipboard/clipboard.min.js"></script>
<script src=".03_files/libs/quarto-html/tabby.min.js"></script>
<script src=".03_files/libs/quarto-html/popper.min.js"></script>
<script src=".03_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href=".03_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href=".03_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href=".03_files/libs/quarto-html/quarto-syntax-highlighting-59898bd1c6b9d2bb783127feaa000c76.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src=".03_files/libs/quarto-contrib/iconify-1.0.7/iconify-icon.min.js"></script><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.33">

  <meta name="author" content="–Ü–≥–æ—Ä –ú—ñ—Ä–æ—à–Ω–∏—á–µ–Ω–∫–æ">
  <title>–ö–æ–º–ø‚Äô—é—Ç–µ—Ä–Ω–∏–π –∑—ñ—Ä üî•PyTorch</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href=".03_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href=".03_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #24292e;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #24292e; } /* Normal */
    code span.al { color: #ff5555; font-weight: bold; } /* Alert */
    code span.an { color: #6a737d; } /* Annotation */
    code span.at { color: #d73a49; } /* Attribute */
    code span.bn { color: #005cc5; } /* BaseN */
    code span.bu { color: #d73a49; } /* BuiltIn */
    code span.cf { color: #d73a49; } /* ControlFlow */
    code span.ch { color: #032f62; } /* Char */
    code span.cn { color: #005cc5; } /* Constant */
    code span.co { color: #6a737d; } /* Comment */
    code span.cv { color: #6a737d; } /* CommentVar */
    code span.do { color: #6a737d; } /* Documentation */
    code span.dt { color: #d73a49; } /* DataType */
    code span.dv { color: #005cc5; } /* DecVal */
    code span.er { color: #ff5555; text-decoration: underline; } /* Error */
    code span.ex { color: #d73a49; font-weight: bold; } /* Extension */
    code span.fl { color: #005cc5; } /* Float */
    code span.fu { color: #6f42c1; } /* Function */
    code span.im { color: #032f62; } /* Import */
    code span.in { color: #6a737d; } /* Information */
    code span.kw { color: #d73a49; } /* Keyword */
    code span.op { color: #24292e; } /* Operator */
    code span.ot { color: #6f42c1; } /* Other */
    code span.pp { color: #d73a49; } /* Preprocessor */
    code span.re { color: #6a737d; } /* RegionMarker */
    code span.sc { color: #005cc5; } /* SpecialChar */
    code span.ss { color: #032f62; } /* SpecialString */
    code span.st { color: #032f62; } /* String */
    code span.va { color: #e36209; } /* Variable */
    code span.vs { color: #032f62; } /* VerbatimString */
    code span.wa { color: #ff5555; } /* Warning */
  </style>
  <link rel="stylesheet" href=".03_files/libs/revealjs/dist/theme/quarto-9f00fb8b82e8e7e674b22104b1ca12a2.css">
  <link href=".03_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href=".03_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href=".03_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href=".03_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href=".03_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href=".03_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
  
  <script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
  <script src="https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js" crossorigin="anonymous"></script>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-iframe=".03_files/libs/colored-particles/index.html" class="quarto-title-block center">
  <h1 class="title">–ö–æ–º–ø‚Äô—é—Ç–µ—Ä–Ω–∏–π –∑—ñ—Ä üî•PyTorch</h1>
  <p class="subtitle">–¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó –∫–æ–º–ø‚Äô—é—Ç–µ—Ä–Ω–æ–≥–æ –∑–æ—Ä—É</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
–Ü–≥–æ—Ä –ú—ñ—Ä–æ—à–Ω–∏—á–µ–Ω–∫–æ 
</div>
        <p class="quarto-title-affiliation">
            –ö–ù–£ —ñ–º–µ–Ω—ñ –¢–∞—Ä–∞—Å–∞ –®–µ–≤—á–µ–Ω–∫–∞, –§–Ü–¢
          </p>
    </div>
</div>

</section>
<section id="–±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏" class="slide level2 tiny">
<h2>–ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∏</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th>–ú–æ–¥—É–ª—å PyTorch</th>
<th>–©–æ –≤—ñ–Ω —Ä–æ–±–∏—Ç—å?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="https://pytorch.org/vision/stable/index.html"><code>torchvision</code></a></td>
<td>–ú—ñ—Å—Ç–∏—Ç—å –Ω–∞–±–æ—Ä–∏ –¥–∞–Ω–∏—Ö, –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏ –º–æ–¥–µ–ª–µ–π —Ç–∞ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑–æ–±—Ä–∞–∂–µ–Ω—å.</td>
</tr>
<tr class="even">
<td><a href="https://pytorch.org/vision/stable/datasets.html"><code>torchvision.datasets</code></a></td>
<td>–ù–∞–±—ñ—Ä –¥–∞—Ç–∞—Å–µ—Ç—ñ–≤ –¥–ª—è –∫–æ–º–ø‚Äô—é—Ç–µ—Ä–Ω–æ–≥–æ –∑–æ—Ä—É.</td>
</tr>
<tr class="odd">
<td><a href="https://pytorch.org/vision/stable/models.html"><code>torchvision.models</code></a></td>
<td>–¶–µ–π –º–æ–¥—É–ª—å –º—ñ—Å—Ç–∏—Ç—å –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ —Ç–∞ –ø–æ–ø—É–ª—è—Ä–Ω—ñ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏ –º–æ–¥–µ–ª–µ–π –∫–æ–º–ø‚Äô—é—Ç–µ—Ä–Ω–æ–≥–æ –∑–æ—Ä—É.</td>
</tr>
<tr class="even">
<td><a href="https://pytorch.org/vision/stable/transforms.html"><code>torchvision.transforms</code></a></td>
<td>–ß–∞—Å—Ç–æ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –ø–æ—Ç—Ä—ñ–±–Ω–æ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º—É–≤–∞—Ç–∏ (–ø–µ—Ä–µ—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–∞ —á–∏—Å–ª–∞/–æ–±—Ä–æ–±–∏—Ç–∏/–¥–æ–ø–æ–≤–Ω–∏—Ç–∏) –ø–µ—Ä–µ–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º —É –º–æ–¥–µ–ª—ñ. –¢—É—Ç –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ –ø–æ—à–∏—Ä–µ–Ω—ñ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ—ó –∑–æ–±—Ä–∞–∂–µ–Ω—å.</td>
</tr>
<tr class="odd">
<td><a href="https://pytorch.org/docs/stable/data.html#torch.utils.data.Dataset"><code>torch.utils.data.Dataset</code></a></td>
<td>–ë–∞–∑–æ–≤–∏–π –∫–ª–∞—Å –Ω–∞–±–æ—Ä—É –¥–∞–Ω–∏—Ö –¥–ª—è PyTorch.</td>
</tr>
<tr class="even">
<td><a href="https://pytorch.org/docs/stable/data.html#module-torch.utils.data"><code>torch.utils.data.DataLoader</code></a></td>
<td>–°—Ç–≤–æ—Ä—é—î —ñ—Ç–µ—Ä–∞–±–µ–ª—å–Ω–∏–π –æ–±‚Äô—î–∫—Ç Python –Ω–∞–¥ –Ω–∞–±–æ—Ä–æ–º –¥–∞–Ω–∏—Ö (—Å—Ç–≤–æ—Ä–µ–Ω–∏–π –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é <code>torch.utils.data.Dataset</code>).</td>
</tr>
</tbody>
</table>
</section>
<section id="–ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è-–±—ñ–±–ª—ñ–æ—Ç–µ–∫" class="slide level2">
<h2>–ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –±—ñ–±–ª—ñ–æ—Ç–µ–∫</h2>
<div id="2c6a4f9f" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href=""></a><span class="im">import</span> torch</span>
<span id="cb1-2"><a href=""></a><span class="im">from</span> torch <span class="im">import</span> nn</span>
<span id="cb1-3"><a href=""></a></span>
<span id="cb1-4"><a href=""></a><span class="im">import</span> torchvision</span>
<span id="cb1-5"><a href=""></a><span class="im">from</span> torchvision <span class="im">import</span> datasets</span>
<span id="cb1-6"><a href=""></a><span class="im">from</span> torchvision.transforms <span class="im">import</span> ToTensor</span>
<span id="cb1-7"><a href=""></a></span>
<span id="cb1-8"><a href=""></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-9"><a href=""></a></span>
<span id="cb1-10"><a href=""></a><span class="bu">print</span>(<span class="ss">f"PyTorch version: </span><span class="sc">{</span>torch<span class="sc">.</span>__version__<span class="sc">}</span><span class="ch">\n</span><span class="ss">torchvision version: </span><span class="sc">{</span>torchvision<span class="sc">.</span>__version__<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>PyTorch version: 2.0.1+cu118
torchvision version: 0.15.2+cu118</code></pre>
</div>
</div>
<div class="callout callout-important no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>–í–∞–∂–ª–∏–≤–æ</strong></p>
</div>
<div class="callout-content">
<p>–í–µ—Ä—Å—ñ—è PyTorch –Ω–µ –ø–æ–≤–∏–Ω–Ω–∞ –±—É—Ç–∏ –Ω–∏–∂—á–æ—é –∑–∞ 1.10.0, –∞ –≤–µ—Ä—Å—ñ—è torchvision ‚Äî –Ω–∏–∂—á–æ—é –∑–∞ 0.11.</p>
</div>
</div>
</div>
</section>
<section id="–æ—Ç—Ä–∏–º–∞–Ω–Ω—è-–¥–∞–Ω–∏—Ö" class="slide level2 tiny">
<h2>–û—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö</h2>
<p>–ü–æ—á–Ω–µ–º–æ –∑ –ø—Ä–æ—Å—Ç–æ–≥–æ –Ω–∞–±–æ—Ä—É –¥–∞–Ω–∏—Ö FashionMNIST.</p>
<div class="columns">
<div class="column">
<ul>
<li><code>root</code>: –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—è, –¥–µ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏–º—É—Ç—å—Å—è –¥–∞–Ω—ñ (—ó—Ö –±—É–¥–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ, —è–∫—â–æ —ó—Ö —Ç–∞–º –Ω–µ–º–∞—î).</li>
<li><code>train: Bool</code>: —á–∏ —Ö–æ—á–µ–º–æ —Ä–æ–∑–±–∏–≤–∞—Ç–∏ –¥–∞–Ω—ñ –Ω–∞ –Ω–∞–≤—á–∞–ª—å–Ω—ñ —á–∏ —Ç–µ—Å—Ç–æ–≤—ñ.</li>
<li><code>download: Bool</code>: —á–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –¥–∞–Ω—ñ.</li>
<li><code>transform: torchvision.transforms</code>: —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ—ó, —è–∫—ñ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ –¥–æ –∑–æ–±—Ä–∞–∂–µ–Ω—å (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è —ó—Ö –Ω–∞ —Ç–µ–Ω–∑–æ—Ä–∏).</li>
<li><code>target_transform</code>: –º–æ–∂–Ω–∞ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º—É–≤–∞—Ç–∏ –º—ñ—Ç–∫–∏, —è–∫—â–æ —Ö–æ—á–µ—Ç–µ.</li>
</ul>
</div><div class="column">
<div id="82f242eb" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href=""></a>train_data <span class="op">=</span> datasets.FashionMNIST(</span>
<span id="cb3-2"><a href=""></a>    root<span class="op">=</span><span class="st">"data"</span>,</span>
<span id="cb3-3"><a href=""></a>    train<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb3-4"><a href=""></a>    download<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb3-5"><a href=""></a>    transform<span class="op">=</span>ToTensor(),</span>
<span id="cb3-6"><a href=""></a>    target_transform<span class="op">=</span><span class="va">None</span></span>
<span id="cb3-7"><a href=""></a>)</span>
<span id="cb3-8"><a href=""></a></span>
<span id="cb3-9"><a href=""></a>test_data <span class="op">=</span> datasets.FashionMNIST(</span>
<span id="cb3-10"><a href=""></a>    root<span class="op">=</span><span class="st">"data"</span>,</span>
<span id="cb3-11"><a href=""></a>    train<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb3-12"><a href=""></a>    download<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb3-13"><a href=""></a>    transform<span class="op">=</span>ToTensor()</span>
<span id="cb3-14"><a href=""></a>)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div></div>
</section>
<section id="–ø–µ—Ä–µ–≥–ª—è–¥-–¥–∞–Ω–∏—Ö" class="slide level2 tiny">
<h2>–ü–µ—Ä–µ–≥–ª—è–¥ –¥–∞–Ω–∏—Ö</h2>
<div id="9a9dec4c" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href=""></a>image, label <span class="op">=</span> train_data[<span class="dv">0</span>]</span>
<span id="cb4-2"><a href=""></a>image, label</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>(tensor([[[0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
           0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
           0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
           0.0000, 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
           0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
           0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
           0.0000, 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
           0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
           0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
           0.0000, 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
           0.0000, 0.0000, 0.0000, 0.0000, 0.0039, 0.0000, 0.0000, 0.0510,
           0.2863, 0.0000, 0.0000, 0.0039, 0.0157, 0.0000, 0.0000, 0.0000,
           0.0000, 0.0039, 0.0039, 0.0000],
          [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
           0.0000, 0.0000, 0.0000, 0.0000, 0.0118, 0.0000, 0.1412, 0.5333,
           0.4980, 0.2431, 0.2118, 0.0000, 0.0000, 0.0000, 0.0039, 0.0118,
           0.0157, 0.0000, 0.0000, 0.0118],
          [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
           0.0000, 0.0000, 0.0000, 0.0000, 0.0235, 0.0000, 0.4000, 0.8000,
           0.6902, 0.5255, 0.5647, 0.4824, 0.0902, 0.0000, 0.0000, 0.0000,
           0.0000, 0.0471, 0.0392, 0.0000],
          [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
           0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.6078, 0.9255,
           0.8118, 0.6980, 0.4196, 0.6118, 0.6314, 0.4275, 0.2510, 0.0902,
           0.3020, 0.5098, 0.2824, 0.0588],
          [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
           0.0000, 0.0000, 0.0000, 0.0039, 0.0000, 0.2706, 0.8118, 0.8745,
           0.8549, 0.8471, 0.8471, 0.6392, 0.4980, 0.4745, 0.4784, 0.5725,
           0.5529, 0.3451, 0.6745, 0.2588],
          [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
           0.0000, 0.0039, 0.0039, 0.0039, 0.0000, 0.7843, 0.9098, 0.9098,
           0.9137, 0.8980, 0.8745, 0.8745, 0.8431, 0.8353, 0.6431, 0.4980,
           0.4824, 0.7686, 0.8980, 0.0000],
          [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
           0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.7176, 0.8824, 0.8471,
           0.8745, 0.8941, 0.9216, 0.8902, 0.8784, 0.8706, 0.8784, 0.8667,
           0.8745, 0.9608, 0.6784, 0.0000],
          [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
           0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.7569, 0.8941, 0.8549,
           0.8353, 0.7765, 0.7059, 0.8314, 0.8235, 0.8275, 0.8353, 0.8745,
           0.8627, 0.9529, 0.7922, 0.0000],
          [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
           0.0000, 0.0039, 0.0118, 0.0000, 0.0471, 0.8588, 0.8627, 0.8314,
           0.8549, 0.7529, 0.6627, 0.8902, 0.8157, 0.8549, 0.8784, 0.8314,
           0.8863, 0.7725, 0.8196, 0.2039],
          [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
           0.0000, 0.0000, 0.0235, 0.0000, 0.3882, 0.9569, 0.8706, 0.8627,
           0.8549, 0.7961, 0.7765, 0.8667, 0.8431, 0.8353, 0.8706, 0.8627,
           0.9608, 0.4667, 0.6549, 0.2196],
          [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
           0.0000, 0.0157, 0.0000, 0.0000, 0.2157, 0.9255, 0.8941, 0.9020,
           0.8941, 0.9412, 0.9098, 0.8353, 0.8549, 0.8745, 0.9176, 0.8510,
           0.8510, 0.8196, 0.3608, 0.0000],
          [0.0000, 0.0000, 0.0039, 0.0157, 0.0235, 0.0275, 0.0078, 0.0000,
           0.0000, 0.0000, 0.0000, 0.0000, 0.9294, 0.8863, 0.8510, 0.8745,
           0.8706, 0.8588, 0.8706, 0.8667, 0.8471, 0.8745, 0.8980, 0.8431,
           0.8549, 1.0000, 0.3020, 0.0000],
          [0.0000, 0.0118, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
           0.0000, 0.2431, 0.5686, 0.8000, 0.8941, 0.8118, 0.8353, 0.8667,
           0.8549, 0.8157, 0.8275, 0.8549, 0.8784, 0.8745, 0.8588, 0.8431,
           0.8784, 0.9569, 0.6235, 0.0000],
          [0.0000, 0.0000, 0.0000, 0.0000, 0.0706, 0.1725, 0.3216, 0.4196,
           0.7412, 0.8941, 0.8627, 0.8706, 0.8510, 0.8863, 0.7843, 0.8039,
           0.8275, 0.9020, 0.8784, 0.9176, 0.6902, 0.7373, 0.9804, 0.9725,
           0.9137, 0.9333, 0.8431, 0.0000],
          [0.0000, 0.2235, 0.7333, 0.8157, 0.8784, 0.8667, 0.8784, 0.8157,
           0.8000, 0.8392, 0.8157, 0.8196, 0.7843, 0.6235, 0.9608, 0.7569,
           0.8078, 0.8745, 1.0000, 1.0000, 0.8667, 0.9176, 0.8667, 0.8275,
           0.8627, 0.9098, 0.9647, 0.0000],
          [0.0118, 0.7922, 0.8941, 0.8784, 0.8667, 0.8275, 0.8275, 0.8392,
           0.8039, 0.8039, 0.8039, 0.8627, 0.9412, 0.3137, 0.5882, 1.0000,
           0.8980, 0.8667, 0.7373, 0.6039, 0.7490, 0.8235, 0.8000, 0.8196,
           0.8706, 0.8941, 0.8824, 0.0000],
          [0.3843, 0.9137, 0.7765, 0.8235, 0.8706, 0.8980, 0.8980, 0.9176,
           0.9765, 0.8627, 0.7608, 0.8431, 0.8510, 0.9451, 0.2549, 0.2863,
           0.4157, 0.4588, 0.6588, 0.8588, 0.8667, 0.8431, 0.8510, 0.8745,
           0.8745, 0.8784, 0.8980, 0.1137],
          [0.2941, 0.8000, 0.8314, 0.8000, 0.7569, 0.8039, 0.8275, 0.8824,
           0.8471, 0.7255, 0.7725, 0.8078, 0.7765, 0.8353, 0.9412, 0.7647,
           0.8902, 0.9608, 0.9373, 0.8745, 0.8549, 0.8314, 0.8196, 0.8706,
           0.8627, 0.8667, 0.9020, 0.2627],
          [0.1882, 0.7961, 0.7176, 0.7608, 0.8353, 0.7725, 0.7255, 0.7451,
           0.7608, 0.7529, 0.7922, 0.8392, 0.8588, 0.8667, 0.8627, 0.9255,
           0.8824, 0.8471, 0.7804, 0.8078, 0.7294, 0.7098, 0.6941, 0.6745,
           0.7098, 0.8039, 0.8078, 0.4510],
          [0.0000, 0.4784, 0.8588, 0.7569, 0.7020, 0.6706, 0.7176, 0.7686,
           0.8000, 0.8235, 0.8353, 0.8118, 0.8275, 0.8235, 0.7843, 0.7686,
           0.7608, 0.7490, 0.7647, 0.7490, 0.7765, 0.7529, 0.6902, 0.6118,
           0.6549, 0.6941, 0.8235, 0.3608],
          [0.0000, 0.0000, 0.2902, 0.7412, 0.8314, 0.7490, 0.6863, 0.6745,
           0.6863, 0.7098, 0.7255, 0.7373, 0.7412, 0.7373, 0.7569, 0.7765,
           0.8000, 0.8196, 0.8235, 0.8235, 0.8275, 0.7373, 0.7373, 0.7608,
           0.7529, 0.8471, 0.6667, 0.0000],
          [0.0078, 0.0000, 0.0000, 0.0000, 0.2588, 0.7843, 0.8706, 0.9294,
           0.9373, 0.9490, 0.9647, 0.9529, 0.9569, 0.8667, 0.8627, 0.7569,
           0.7490, 0.7020, 0.7137, 0.7137, 0.7098, 0.6902, 0.6510, 0.6588,
           0.3882, 0.2275, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.1569,
           0.2392, 0.1725, 0.2824, 0.1608, 0.1373, 0.0000, 0.0000, 0.0000,
           0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
           0.0000, 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
           0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
           0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
           0.0000, 0.0000, 0.0000, 0.0000],
          [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
           0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
           0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
           0.0000, 0.0000, 0.0000, 0.0000]]]),
 9)</code></pre>
</div>
</div>
</section>
<section id="—Ñ–æ—Ä–º–∞-–¥–∞–Ω–∏—Ö" class="slide level2">
<h2>–§–æ—Ä–º–∞ –¥–∞–Ω–∏—Ö</h2>
<div id="8a98abe4" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href=""></a>image.shape</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>torch.Size([1, 28, 28])</code></pre>
</div>
</div>
<p>–Ü–Ω—à–∏–º–∏ —Å–ª–æ–≤–∞–º–∏, —Ü–µ 1-–∫–∞–Ω–∞–ª—å–Ω–µ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Ä–æ–∑–º—ñ—Ä–æ–º 28x28 –ø—ñ–∫—Å–µ–ª—ñ–≤ (CHW-—Ñ–æ—Ä–º–∞—Ç).</p>
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>–ü—Ä–∏–º—ñ—Ç–∫–∞</strong></p>
</div>
<div class="callout-content">
<p>–í–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ —Ñ–æ—Ä–º–∞—Ç–∏ <code>NCHW</code> —ñ <code>NHWC</code>, –¥–µ <code>N</code> –æ–∑–Ω–∞—á–∞—î –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∑–æ–±—Ä–∞–∂–µ–Ω—å. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —è–∫—â–æ —É –≤–∞—Å <code>batch_size=32</code>, —Ñ–æ—Ä–º–∞ —Ç–µ–Ω–∑–æ—Ä–∞ –º–æ–∂–µ –±—É—Ç–∏ <code>[32, 1, 28, 28]</code>.</p>
</div>
</div>
</div>
<div class="footer">
<p><a href="https://pytorch.org/blog/tensor-memory-format-matters/#pytorch-best-practice">NCHW vs NHWC</a></p>
</div>
</section>
<section id="—Ä–æ–∑–º—ñ—Ä-–Ω–∞–±–æ—Ä—É-–¥–∞–Ω–∏—Ö" class="slide level2 tiny">
<h2>–†–æ–∑–º—ñ—Ä –Ω–∞–±–æ—Ä—É –¥–∞–Ω–∏—Ö</h2>
<div id="4050ca8b" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href=""></a><span class="bu">len</span>(train_data.data), <span class="bu">len</span>(train_data.targets), <span class="bu">len</span>(test_data.data), <span class="bu">len</span>(test_data.targets)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>(60000, 60000, 10000, 10000)</code></pre>
</div>
</div>
<p>60k –∑–æ–±—Ä–∞–∂–µ–Ω—å –¥–ª—è –Ω–∞–≤—á–∞–Ω–Ω—è —Ç–∞ 10k –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è.</p>
</section>
<section id="–∫—ñ–ª—å–∫—ñ—Å—Ç—å-–∫–ª–∞—Å—ñ–≤" class="slide level2">
<h2>–ö—ñ–ª—å–∫—ñ—Å—Ç—å –∫–ª–∞—Å—ñ–≤</h2>
<div id="ed36e0dc" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href=""></a>class_names <span class="op">=</span> train_data.classes</span>
<span id="cb10-2"><a href=""></a><span class="bu">len</span>(class_names), class_names</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>(10,
 ['T-shirt/top',
  'Trouser',
  'Pullover',
  'Dress',
  'Coat',
  'Sandal',
  'Shirt',
  'Sneaker',
  'Bag',
  'Ankle boot'])</code></pre>
</div>
</div>
</section>
<section id="–≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è-–¥–∞–Ω–∏—Ö-13" class="slide level2">
<h2>–í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è –¥–∞–Ω–∏—Ö 1/3</h2>
<div id="741aa3a9" class="cell columns column-output-location" data-execution_count="8">
<div class="column">
<div class="sourceCode cell-code" id="annotated-cell-6"><pre class="sourceCode numberSource python code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode python"><span id="annotated-cell-6-1"><a href="#annotated-cell-6-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="annotated-cell-6-2"><a href="#annotated-cell-6-2"></a></span>
<span id="annotated-cell-6-3"><a href="#annotated-cell-6-3"></a>image, label <span class="op">=</span> train_data[<span class="dv">0</span>]</span>
<span id="annotated-cell-6-4"><a href="#annotated-cell-6-4"></a><span class="bu">print</span>(<span class="ss">f"Image shape: </span><span class="sc">{</span>image<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-6" data-target-annotation="1" onclick="event.preventDefault();" href="">1</a><span id="annotated-cell-6-5" class="code-annotation-target"><a href="#annotated-cell-6-5"></a>plt.imshow(image.squeeze())</span>
<span id="annotated-cell-6-6"><a href="#annotated-cell-6-6"></a>plt.title(label)<span class="op">;</span></span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-6" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-6" data-code-lines="5" data-code-annotation="1"><code>squeeze()</code> –≤–∏–¥–∞–ª—è—î —Ä–æ–∑–º—ñ—Ä–Ω—ñ—Å—Ç—å –∑ 1 (—Ç–æ–±—Ç–æ –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î <code>[1, 28, 28]</code> –Ω–∞ <code>[28, 28]</code>).</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Image shape: torch.Size([1, 28, 28])</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src=".03_files/figure-revealjs/cell-9-output-2.svg"></p>
</figure>
</div>
</div>
</div></div>
</section>
<section id="–≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è-–¥–∞–Ω–∏—Ö-23" class="slide level2">
<h2>–í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è –¥–∞–Ω–∏—Ö 2/3</h2>
<ul>
<li><code>cmap</code> ‚Äî –∫–æ–ª—ñ—Ä–Ω–∞ –∫–∞—Ä—Ç–∞ (colormap).</li>
</ul>
<div id="a977d4c3" class="cell columns column-output-location" data-execution_count="9">
<div class="column">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href=""></a>plt.imshow(image.squeeze(), cmap<span class="op">=</span><span class="st">"gray"</span>)</span>
<span id="cb13-2"><a href=""></a>plt.title(class_names[label])<span class="op">;</span></span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src=".03_files/figure-revealjs/cell-10-output-1.svg"></p>
</figure>
</div>
</div>
</div></div>
</section>
<section id="–≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è-–¥–∞–Ω–∏—Ö-33" class="slide level2">
<h2>–í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è –¥–∞–Ω–∏—Ö 3/3</h2>
<div id="7911bf49" class="cell columns column-output-location" data-execution_count="10">
<div class="column">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href=""></a>torch.manual_seed(<span class="dv">73</span>)</span>
<span id="cb14-2"><a href=""></a>fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">9</span>, <span class="dv">9</span>))</span>
<span id="cb14-3"><a href=""></a>rows, cols <span class="op">=</span> <span class="dv">4</span>, <span class="dv">4</span></span>
<span id="cb14-4"><a href=""></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, rows <span class="op">*</span> cols <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb14-5"><a href=""></a>    random_idx <span class="op">=</span> torch.randint(<span class="dv">0</span>, <span class="bu">len</span>(train_data), size<span class="op">=</span>[<span class="dv">1</span>]).item()</span>
<span id="cb14-6"><a href=""></a>    img, label <span class="op">=</span> train_data[random_idx]</span>
<span id="cb14-7"><a href=""></a>    fig.add_subplot(rows, cols, i)</span>
<span id="cb14-8"><a href=""></a>    plt.imshow(img.squeeze(), cmap<span class="op">=</span><span class="st">"gray"</span>)</span>
<span id="cb14-9"><a href=""></a>    plt.title(class_names[label])</span>
<span id="cb14-10"><a href=""></a>    plt.axis(<span class="va">False</span>)<span class="op">;</span></span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src=".03_files/figure-revealjs/cell-11-output-1.svg"></p>
</figure>
</div>
</div>
</div></div>
</section>
<section id="–ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞-dataloader-–∞" class="slide level2">
<h2>–ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ DataLoader-–∞</h2>
<ul>
<li class="fragment">DataLoader ‚Äî —Ü–µ —ñ—Ç–µ—Ä–∞—Ç–æ—Ä, —è–∫–∏–π –¥–æ–ø–æ–º–∞–≥–∞—î –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏ –¥–∞–Ω—ñ –ø–∞–∫–µ—Ç–∞–º–∏ (batches).</li>
<li class="fragment">–Ø–∫–∏–π —Ä–æ–∑–º—ñ—Ä –ø–∞–∫–µ—Ç–∞ (batch size) –æ–±—Ä–∞—Ç–∏?</li>
<li class="fragment">32 ‚Äî —Ü–µ <a href="https://x.com/ylecun/status/989610208497360896?t=N96J_jotN--PYuJk2WcjMw">—Ö–æ—Ä–æ—à–∏–π –ø–æ—á–∞—Ç–æ–∫</a>.</li>
<li class="fragment">–ê–ª–µ –º–æ–∂–Ω–∞ –π –±—ñ–ª—å—à–µ, —è–∫—â–æ –¥–æ–∑–≤–æ–ª—è—î –ø–∞–º‚Äô—è—Ç—å. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, 64, 128 —Ç–æ—â–æ.</li>
</ul>
</section>
<section id="—Å—Ç–≤–æ—Ä–µ–Ω–Ω—è-dataloader-–∞" class="slide level2 tiny">
<h2>–°—Ç–≤–æ—Ä–µ–Ω–Ω—è DataLoader-–∞</h2>
<div id="8c77aa00" class="cell columns column-output-location" data-execution_count="11">
<div class="column">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href=""></a><span class="im">from</span> torch.utils.data <span class="im">import</span> DataLoader</span>
<span id="cb15-2"><a href=""></a></span>
<span id="cb15-3"><a href=""></a>BATCH_SIZE <span class="op">=</span> <span class="dv">32</span></span>
<span id="cb15-4"><a href=""></a></span>
<span id="cb15-5"><a href=""></a>train_dataloader <span class="op">=</span> DataLoader(train_data,</span>
<span id="cb15-6"><a href=""></a>    batch_size<span class="op">=</span>BATCH_SIZE,</span>
<span id="cb15-7"><a href=""></a>    shuffle<span class="op">=</span><span class="va">True</span></span>
<span id="cb15-8"><a href=""></a>)</span>
<span id="cb15-9"><a href=""></a></span>
<span id="cb15-10"><a href=""></a>test_dataloader <span class="op">=</span> DataLoader(test_data,</span>
<span id="cb15-11"><a href=""></a>    batch_size<span class="op">=</span>BATCH_SIZE,</span>
<span id="cb15-12"><a href=""></a>    shuffle<span class="op">=</span><span class="va">False</span></span>
<span id="cb15-13"><a href=""></a>)</span>
<span id="cb15-14"><a href=""></a></span>
<span id="cb15-15"><a href=""></a><span class="bu">print</span>(<span class="ss">f"Dataloaders: </span><span class="sc">{</span>train_dataloader<span class="sc">,</span> test_dataloader<span class="sc">}</span><span class="ss">"</span>) </span>
<span id="cb15-16"><a href=""></a><span class="bu">print</span>(<span class="ss">f"–£ –Ω–∞–≤—á–∞–ª—å–Ω—ñ–π –≤–∏–±—ñ—Ä—Ü—ñ –º–∞—î–º–æ: </span><span class="sc">{</span><span class="bu">len</span>(train_dataloader)<span class="sc">}</span><span class="ss"> –±–∞—Ç—á—ñ–≤ –ø–æ </span><span class="sc">{</span>BATCH_SIZE<span class="sc">}</span><span class="ss"> –∑–æ–±—Ä–∞–∂–µ–Ω—å"</span>)</span>
<span id="cb15-17"><a href=""></a><span class="bu">print</span>(<span class="ss">f"–£ —Ç–µ—Å—Ç–æ–≤—ñ–π –≤–∏–±—ñ—Ä—Ü—ñ –º–∞—î–º–æ: </span><span class="sc">{</span><span class="bu">len</span>(test_dataloader)<span class="sc">}</span><span class="ss"> –±–∞—Ç—á—ñ–≤ –ø–æ </span><span class="sc">{</span>BATCH_SIZE<span class="sc">}</span><span class="ss"> –∑–æ–±—Ä–∞–∂–µ–Ω—å"</span>)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-stdout">
<pre><code>Dataloaders: (&lt;torch.utils.data.dataloader.DataLoader object at 0x000001ABC0DC2810&gt;, &lt;torch.utils.data.dataloader.DataLoader object at 0x000001ABC0ADD390&gt;)
–£ –Ω–∞–≤—á–∞–ª—å–Ω—ñ–π –≤–∏–±—ñ—Ä—Ü—ñ –º–∞—î–º–æ: 1875 –±–∞—Ç—á—ñ–≤ –ø–æ 32 –∑–æ–±—Ä–∞–∂–µ–Ω—å
–£ —Ç–µ—Å—Ç–æ–≤—ñ–π –≤–∏–±—ñ—Ä—Ü—ñ –º–∞—î–º–æ: 313 –±–∞—Ç—á—ñ–≤ –ø–æ 32 –∑–æ–±—Ä–∞–∂–µ–Ω—å</code></pre>
</div>
</div></div>
<p><br></p>
<div id="fb273b19" class="cell columns column-output-location" data-execution_count="12">
<div class="column">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href=""></a>train_features_batch, train_labels_batch <span class="op">=</span> <span class="bu">next</span>(<span class="bu">iter</span>(train_dataloader))</span>
<span id="cb17-2"><a href=""></a>train_features_batch.shape, train_labels_batch.shape</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>(torch.Size([32, 1, 28, 28]), torch.Size([32]))</code></pre>
</div>
</div></div>
</section>
<section id="–º–æ–¥–µ–ª—å-0-–ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞" class="slide level2">
<h2>–ú–æ–¥–µ–ª—å 0: –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞</h2>
<ul>
<li><code>nn.Linear()</code>: –ø–æ–≤–Ω–æ–∑–≤‚Äô—è–∑–Ω–∏–π (fully connected) —à–∞—Ä.</li>
<li><code>nn.Flatten()</code>: –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î –∫–æ–∂–Ω–µ 2D-–∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Ä–æ–∑–º—ñ—Ä–æ–º 28x28 —É –≤–µ–∫—Ç–æ—Ä —Ä–æ–∑–º—ñ—Ä–æ–º 784 (28*28=784).</li>
</ul>
<div id="01fa8bda" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href=""></a>flatten_model <span class="op">=</span> nn.Flatten()</span>
<span id="cb19-2"><a href=""></a></span>
<span id="cb19-3"><a href=""></a>x <span class="op">=</span> train_features_batch[<span class="dv">0</span>]</span>
<span id="cb19-4"><a href=""></a></span>
<span id="cb19-5"><a href=""></a>output <span class="op">=</span> flatten_model(x)</span>
<span id="cb19-6"><a href=""></a></span>
<span id="cb19-7"><a href=""></a><span class="co"># Print out what happened</span></span>
<span id="cb19-8"><a href=""></a><span class="bu">print</span>(<span class="ss">f"Shape before flattening: </span><span class="sc">{</span>x<span class="sc">.</span>shape<span class="sc">}</span><span class="ss"> -&gt; [color_channels, height, width]"</span>)</span>
<span id="cb19-9"><a href=""></a><span class="bu">print</span>(<span class="ss">f"Shape after flattening: </span><span class="sc">{</span>output<span class="sc">.</span>shape<span class="sc">}</span><span class="ss"> -&gt; [color_channels, height*width]"</span>)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Shape before flattening: torch.Size([1, 28, 28]) -&gt; [color_channels, height, width]
Shape after flattening: torch.Size([1, 784]) -&gt; [color_channels, height*width]</code></pre>
</div>
</div>
</section>
<section id="–º–æ–¥–µ–ª—å-0-—ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è" class="slide level2">
<h2>–ú–æ–¥–µ–ª—å 0: —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è</h2>
<div id="fa36c932" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href=""></a><span class="im">from</span> torch <span class="im">import</span> nn</span>
<span id="cb21-2"><a href=""></a><span class="kw">class</span> FashionMNISTModelV0(nn.Module):</span>
<span id="cb21-3"><a href=""></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, input_shape: <span class="bu">int</span>, hidden_units: <span class="bu">int</span>, output_shape: <span class="bu">int</span>):</span>
<span id="cb21-4"><a href=""></a>        <span class="bu">super</span>().<span class="fu">__init__</span>()</span>
<span id="cb21-5"><a href=""></a>        <span class="va">self</span>.layer_stack <span class="op">=</span> nn.Sequential(</span>
<span id="cb21-6"><a href=""></a>            nn.Flatten(),</span>
<span id="cb21-7"><a href=""></a>            nn.Linear(in_features<span class="op">=</span>input_shape, out_features<span class="op">=</span>hidden_units),</span>
<span id="cb21-8"><a href=""></a>            nn.Linear(in_features<span class="op">=</span>hidden_units, out_features<span class="op">=</span>output_shape)</span>
<span id="cb21-9"><a href=""></a>        )</span>
<span id="cb21-10"><a href=""></a>    </span>
<span id="cb21-11"><a href=""></a>    <span class="kw">def</span> forward(<span class="va">self</span>, x):</span>
<span id="cb21-12"><a href=""></a>        <span class="cf">return</span> <span class="va">self</span>.layer_stack(x)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="–º–æ–¥–µ–ª—å-0-–ø–æ–±—É–¥–æ–≤–∞" class="slide level2 tiny">
<h2>–ú–æ–¥–µ–ª—å 0: –ø–æ–±—É–¥–æ–≤–∞</h2>
<ul>
<li><code>input_shape=784</code>: –∫—ñ–ª—å–∫—ñ—Å—Ç—å –≤—Ö—ñ–¥–Ω–∏—Ö –æ–∑–Ω–∞–∫ (features).</li>
<li><code>hidden_units=10</code>: –∫—ñ–ª—å–∫—ñ—Å—Ç—å –Ω–µ–π—Ä–æ–Ω—ñ–≤ —É –ø—Ä–∏—Ö–æ–≤–∞–Ω–æ–º—É —à–∞—Ä—ñ.</li>
<li><code>output_shape=len(class_names)</code>: –∫—ñ–ª—å–∫—ñ—Å—Ç—å –≤–∏—Ö—ñ–¥–Ω–∏—Ö –∫–ª–∞—Å—ñ–≤.</li>
</ul>
<div id="02ab83da" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href=""></a>torch.manual_seed(<span class="dv">42</span>)</span>
<span id="cb22-2"><a href=""></a></span>
<span id="cb22-3"><a href=""></a>model_0 <span class="op">=</span> FashionMNISTModelV0(input_shape<span class="op">=</span><span class="dv">784</span>,</span>
<span id="cb22-4"><a href=""></a>    hidden_units<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb22-5"><a href=""></a>    output_shape<span class="op">=</span><span class="bu">len</span>(class_names)</span>
<span id="cb22-6"><a href=""></a>)</span>
<span id="cb22-7"><a href=""></a>model_0.to(<span class="st">"cpu"</span>)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>FashionMNISTModelV0(
  (layer_stack): Sequential(
    (0): Flatten(start_dim=1, end_dim=-1)
    (1): Linear(in_features=784, out_features=10, bias=True)
    (2): Linear(in_features=10, out_features=10, bias=True)
  )
)</code></pre>
</div>
</div>
</section>
<section id="—Ñ—É–Ω–∫—Ü—ñ—è-–≤—Ç—Ä–∞—Ç-–æ–ø—Ç–∏–º—ñ–∑–∞—Ç–æ—Ä-—Ç–∞-–º–µ—Ç—Ä–∏–∫–∞" class="slide level2">
<h2>–§—É–Ω–∫—Ü—ñ—è –≤—Ç—Ä–∞—Ç, –æ–ø—Ç–∏–º—ñ–∑–∞—Ç–æ—Ä —Ç–∞ –º–µ—Ç—Ä–∏–∫–∞</h2>
<ul>
<li>–í–∏–∫–æ—Ä–∏—Å—Ç–∞—î–º–æ <code>accuracy_fn()</code> –∑ <code>helper_functions.py</code> (–¥–∏–≤. –º–∏–Ω—É–ª—ñ –ª–µ–∫—Ü—ñ—ó).</li>
</ul>
<div id="1f8334ee" class="cell" data-execution_count="16">
<details class="code-fold">
<summary>–ö–æ–¥</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href=""></a><span class="im">import</span> requests</span>
<span id="cb24-2"><a href=""></a><span class="im">from</span> pathlib <span class="im">import</span> Path </span>
<span id="cb24-3"><a href=""></a></span>
<span id="cb24-4"><a href=""></a><span class="co"># Download helper functions from Learn PyTorch repo (if not already downloaded)</span></span>
<span id="cb24-5"><a href=""></a><span class="cf">if</span> Path(<span class="st">"helper_functions.py"</span>).is_file():</span>
<span id="cb24-6"><a href=""></a>  <span class="bu">print</span>(<span class="st">"helper_functions.py already exists, skipping download"</span>)</span>
<span id="cb24-7"><a href=""></a><span class="cf">else</span>:</span>
<span id="cb24-8"><a href=""></a>  <span class="bu">print</span>(<span class="st">"Downloading helper_functions.py"</span>)</span>
<span id="cb24-9"><a href=""></a>  <span class="co"># Note: you need the "raw" GitHub URL for this to work</span></span>
<span id="cb24-10"><a href=""></a>  request <span class="op">=</span> requests.get(<span class="st">"https://raw.githubusercontent.com/Aranaur/aranaur.rbind.io/refs/heads/main/lectures/cv/slides/2025/helper_functions.py"</span>)</span>
<span id="cb24-11"><a href=""></a>  <span class="cf">with</span> <span class="bu">open</span>(<span class="st">"helper_functions.py"</span>, <span class="st">"wb"</span>) <span class="im">as</span> f:</span>
<span id="cb24-12"><a href=""></a>    f.write(request.content)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>helper_functions.py already exists, skipping download</code></pre>
</div>
</div>
<p><br></p>
<div id="885d7b82" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href=""></a><span class="im">from</span> helper_functions <span class="im">import</span> accuracy_fn</span>
<span id="cb26-2"><a href=""></a></span>
<span id="cb26-3"><a href=""></a>loss_fn <span class="op">=</span> nn.CrossEntropyLoss()</span>
<span id="cb26-4"><a href=""></a>optimizer <span class="op">=</span> torch.optim.SGD(params<span class="op">=</span>model_0.parameters(), lr<span class="op">=</span><span class="fl">0.1</span>)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="—Å–ª—ñ–¥–∫—É—î–º–æ-–∑–∞-—á–∞—Å–æ–º" class="slide level2">
<h2>–°–ª—ñ–¥–∫—É—î–º–æ –∑–∞ —á–∞—Å–æ–º</h2>
<ul>
<li>–ü–æ—Ä—ñ–≤–Ω—è—î–º–æ —á–∞—Å –Ω–∞–≤—á–∞–Ω–Ω—è –Ω–∞ CPU —ñ GPU (—è–∫—â–æ —î).</li>
</ul>
<div id="918133de" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href=""></a><span class="im">from</span> timeit <span class="im">import</span> default_timer <span class="im">as</span> timer </span>
<span id="cb27-2"><a href=""></a><span class="kw">def</span> print_train_time(start: <span class="bu">float</span>, end: <span class="bu">float</span>, device: torch.device <span class="op">=</span> <span class="va">None</span>):</span>
<span id="cb27-3"><a href=""></a>    </span>
<span id="cb27-4"><a href=""></a>    total_time <span class="op">=</span> end <span class="op">-</span> start</span>
<span id="cb27-5"><a href=""></a>    <span class="bu">print</span>(<span class="ss">f"Train time on </span><span class="sc">{</span>device<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>total_time<span class="sc">:.3f}</span><span class="ss"> seconds"</span>)</span>
<span id="cb27-6"><a href=""></a>    <span class="cf">return</span> total_time</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="–º–æ–¥–µ–ª—å-0-–Ω–∞–≤—á–∞–Ω–Ω—è" class="slide level2 tiny scrollable">
<h2>–ú–æ–¥–µ–ª—å 0: –Ω–∞–≤—á–∞–Ω–Ω—è</h2>
<div id="fa94c7f6" class="cell columns column-output-location" data-execution_count="19">
<div class="column">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href=""></a><span class="im">from</span> tqdm.auto <span class="im">import</span> tqdm</span>
<span id="cb28-2"><a href=""></a></span>
<span id="cb28-3"><a href=""></a>torch.manual_seed(<span class="dv">73</span>)</span>
<span id="cb28-4"><a href=""></a>train_time_start_on_cpu <span class="op">=</span> timer()</span>
<span id="cb28-5"><a href=""></a></span>
<span id="cb28-6"><a href=""></a>epochs <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb28-7"><a href=""></a></span>
<span id="cb28-8"><a href=""></a><span class="cf">for</span> epoch <span class="kw">in</span> tqdm(<span class="bu">range</span>(epochs)):</span>
<span id="cb28-9"><a href=""></a>    <span class="bu">print</span>(<span class="ss">f"Epoch: </span><span class="sc">{</span>epoch<span class="sc">}</span><span class="ch">\n</span><span class="ss">-------"</span>)</span>
<span id="cb28-10"><a href=""></a>    <span class="co">### Training</span></span>
<span id="cb28-11"><a href=""></a>    train_loss <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb28-12"><a href=""></a>    <span class="co"># Add a loop to loop through training batches</span></span>
<span id="cb28-13"><a href=""></a>    <span class="cf">for</span> batch, (X, y) <span class="kw">in</span> <span class="bu">enumerate</span>(train_dataloader):</span>
<span id="cb28-14"><a href=""></a>        model_0.train() </span>
<span id="cb28-15"><a href=""></a>        <span class="co"># 1. Forward pass</span></span>
<span id="cb28-16"><a href=""></a>        y_pred <span class="op">=</span> model_0(X)</span>
<span id="cb28-17"><a href=""></a></span>
<span id="cb28-18"><a href=""></a>        <span class="co"># 2. Calculate loss (per batch)</span></span>
<span id="cb28-19"><a href=""></a>        loss <span class="op">=</span> loss_fn(y_pred, y)</span>
<span id="cb28-20"><a href=""></a>        train_loss <span class="op">+=</span> loss <span class="co"># accumulatively add up the loss per epoch </span></span>
<span id="cb28-21"><a href=""></a></span>
<span id="cb28-22"><a href=""></a>        <span class="co"># 3. Optimizer zero grad</span></span>
<span id="cb28-23"><a href=""></a>        optimizer.zero_grad()</span>
<span id="cb28-24"><a href=""></a></span>
<span id="cb28-25"><a href=""></a>        <span class="co"># 4. Loss backward</span></span>
<span id="cb28-26"><a href=""></a>        loss.backward()</span>
<span id="cb28-27"><a href=""></a></span>
<span id="cb28-28"><a href=""></a>        <span class="co"># 5. Optimizer step</span></span>
<span id="cb28-29"><a href=""></a>        optimizer.step()</span>
<span id="cb28-30"><a href=""></a></span>
<span id="cb28-31"><a href=""></a>        <span class="co"># Print out how many samples have been seen</span></span>
<span id="cb28-32"><a href=""></a>        <span class="cf">if</span> batch <span class="op">%</span> <span class="dv">400</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb28-33"><a href=""></a>            <span class="bu">print</span>(<span class="ss">f"Looked at </span><span class="sc">{</span>batch <span class="op">*</span> <span class="bu">len</span>(X)<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span><span class="bu">len</span>(train_dataloader.dataset)<span class="sc">}</span><span class="ss"> samples"</span>)</span>
<span id="cb28-34"><a href=""></a></span>
<span id="cb28-35"><a href=""></a>    <span class="co"># Divide total train loss by length of train dataloader (average loss per batch per epoch)</span></span>
<span id="cb28-36"><a href=""></a>    train_loss <span class="op">/=</span> <span class="bu">len</span>(train_dataloader)</span>
<span id="cb28-37"><a href=""></a>    </span>
<span id="cb28-38"><a href=""></a>    <span class="co">### Testing</span></span>
<span id="cb28-39"><a href=""></a>    <span class="co"># Setup variables for accumulatively adding up loss and accuracy </span></span>
<span id="cb28-40"><a href=""></a>    test_loss, test_acc <span class="op">=</span> <span class="dv">0</span>, <span class="dv">0</span> </span>
<span id="cb28-41"><a href=""></a>    model_0.<span class="bu">eval</span>()</span>
<span id="cb28-42"><a href=""></a>    <span class="cf">with</span> torch.inference_mode():</span>
<span id="cb28-43"><a href=""></a>        <span class="cf">for</span> X, y <span class="kw">in</span> test_dataloader:</span>
<span id="cb28-44"><a href=""></a>            <span class="co"># 1. Forward pass</span></span>
<span id="cb28-45"><a href=""></a>            test_pred <span class="op">=</span> model_0(X)</span>
<span id="cb28-46"><a href=""></a>           </span>
<span id="cb28-47"><a href=""></a>            <span class="co"># 2. Calculate loss (accumulatively)</span></span>
<span id="cb28-48"><a href=""></a>            test_loss <span class="op">+=</span> loss_fn(test_pred, y) <span class="co"># accumulatively add up the loss per epoch</span></span>
<span id="cb28-49"><a href=""></a></span>
<span id="cb28-50"><a href=""></a>            <span class="co"># 3. Calculate accuracy (preds need to be same as y_true)</span></span>
<span id="cb28-51"><a href=""></a>            test_acc <span class="op">+=</span> accuracy_fn(y_true<span class="op">=</span>y, y_pred<span class="op">=</span>test_pred.argmax(dim<span class="op">=</span><span class="dv">1</span>))</span>
<span id="cb28-52"><a href=""></a>        </span>
<span id="cb28-53"><a href=""></a>        <span class="co"># Calculations on test metrics need to happen inside torch.inference_mode()</span></span>
<span id="cb28-54"><a href=""></a>        <span class="co"># Divide total test loss by length of test dataloader (per batch)</span></span>
<span id="cb28-55"><a href=""></a>        test_loss <span class="op">/=</span> <span class="bu">len</span>(test_dataloader)</span>
<span id="cb28-56"><a href=""></a></span>
<span id="cb28-57"><a href=""></a>        <span class="co"># Divide total accuracy by length of test dataloader (per batch)</span></span>
<span id="cb28-58"><a href=""></a>        test_acc <span class="op">/=</span> <span class="bu">len</span>(test_dataloader)</span>
<span id="cb28-59"><a href=""></a></span>
<span id="cb28-60"><a href=""></a>    <span class="co">## Print out what's happening</span></span>
<span id="cb28-61"><a href=""></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Train loss: </span><span class="sc">{</span>train_loss<span class="sc">:.5f}</span><span class="ss"> | Test loss: </span><span class="sc">{</span>test_loss<span class="sc">:.5f}</span><span class="ss">, Test acc: </span><span class="sc">{</span>test_acc<span class="sc">:.2f}</span><span class="ss">%</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb28-62"><a href=""></a></span>
<span id="cb28-63"><a href=""></a><span class="co"># Calculate training time      </span></span>
<span id="cb28-64"><a href=""></a>train_time_end_on_cpu <span class="op">=</span> timer()</span>
<span id="cb28-65"><a href=""></a>total_train_time_model_0 <span class="op">=</span> print_train_time(start<span class="op">=</span>train_time_start_on_cpu, </span>
<span id="cb28-66"><a href=""></a>                                           end<span class="op">=</span>train_time_end_on_cpu,</span>
<span id="cb28-67"><a href=""></a>                                           device<span class="op">=</span><span class="bu">str</span>(<span class="bu">next</span>(model_0.parameters()).device))</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"dac9874a97dc47169f674c92a8a9589a","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 0
-------
Looked at 0/60000 samples
Looked at 12800/60000 samples
Looked at 25600/60000 samples
Looked at 38400/60000 samples
Looked at 51200/60000 samples

Train loss: 0.58780 | Test loss: 0.52729, Test acc: 81.46%

Epoch: 1
-------
Looked at 0/60000 samples
Looked at 12800/60000 samples
Looked at 25600/60000 samples
Looked at 38400/60000 samples
Looked at 51200/60000 samples

Train loss: 0.47574 | Test loss: 0.54711, Test acc: 80.70%

Epoch: 2
-------
Looked at 0/60000 samples
Looked at 12800/60000 samples
Looked at 25600/60000 samples
Looked at 38400/60000 samples
Looked at 51200/60000 samples

Train loss: 0.45400 | Test loss: 0.50029, Test acc: 81.90%

Train time on cpu: 12.105 seconds</code></pre>
</div>
</div></div>
</section>
<section id="–º–æ–¥–µ–ª—å-0-–ø—Ä–æ–≥–Ω–æ–∑" class="slide level2 tiny">
<h2>–ú–æ–¥–µ–ª—å 0: –ø—Ä–æ–≥–Ω–æ–∑</h2>
<div id="761ea20c" class="cell columns column-output-location" data-execution_count="20">
<div class="column">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href=""></a>torch.manual_seed(<span class="dv">73</span>)</span>
<span id="cb30-2"><a href=""></a><span class="kw">def</span> eval_model(model: torch.nn.Module, </span>
<span id="cb30-3"><a href=""></a>               data_loader: torch.utils.data.DataLoader, </span>
<span id="cb30-4"><a href=""></a>               loss_fn: torch.nn.Module, </span>
<span id="cb30-5"><a href=""></a>               accuracy_fn):</span>
<span id="cb30-6"><a href=""></a></span>
<span id="cb30-7"><a href=""></a>    loss, acc <span class="op">=</span> <span class="dv">0</span>, <span class="dv">0</span></span>
<span id="cb30-8"><a href=""></a>    model.<span class="bu">eval</span>()</span>
<span id="cb30-9"><a href=""></a>    <span class="cf">with</span> torch.inference_mode():</span>
<span id="cb30-10"><a href=""></a>        <span class="cf">for</span> X, y <span class="kw">in</span> data_loader:</span>
<span id="cb30-11"><a href=""></a>            <span class="co"># Make predictions with the model</span></span>
<span id="cb30-12"><a href=""></a>            y_pred <span class="op">=</span> model(X)</span>
<span id="cb30-13"><a href=""></a>            </span>
<span id="cb30-14"><a href=""></a>            <span class="co"># Accumulate the loss and accuracy values per batch</span></span>
<span id="cb30-15"><a href=""></a>            loss <span class="op">+=</span> loss_fn(y_pred, y)</span>
<span id="cb30-16"><a href=""></a>            acc <span class="op">+=</span> accuracy_fn(y_true<span class="op">=</span>y, </span>
<span id="cb30-17"><a href=""></a>                                y_pred<span class="op">=</span>y_pred.argmax(dim<span class="op">=</span><span class="dv">1</span>)) <span class="co"># For accuracy, need the prediction labels (logits -&gt; pred_prob -&gt; pred_labels)</span></span>
<span id="cb30-18"><a href=""></a>        </span>
<span id="cb30-19"><a href=""></a>        <span class="co"># Scale loss and acc to find the average loss/acc per batch</span></span>
<span id="cb30-20"><a href=""></a>        loss <span class="op">/=</span> <span class="bu">len</span>(data_loader)</span>
<span id="cb30-21"><a href=""></a>        acc <span class="op">/=</span> <span class="bu">len</span>(data_loader)</span>
<span id="cb30-22"><a href=""></a>        </span>
<span id="cb30-23"><a href=""></a>    <span class="cf">return</span> {<span class="st">"model_name"</span>: model.<span class="va">__class__</span>.<span class="va">__name__</span>, <span class="co"># only works when model was created with a class</span></span>
<span id="cb30-24"><a href=""></a>            <span class="st">"model_loss"</span>: loss.item(),</span>
<span id="cb30-25"><a href=""></a>            <span class="st">"model_acc"</span>: acc}</span>
<span id="cb30-26"><a href=""></a></span>
<span id="cb30-27"><a href=""></a><span class="co"># Calculate model 0 results on test dataset</span></span>
<span id="cb30-28"><a href=""></a>model_0_results <span class="op">=</span> eval_model(model<span class="op">=</span>model_0, data_loader<span class="op">=</span>test_dataloader,</span>
<span id="cb30-29"><a href=""></a>    loss_fn<span class="op">=</span>loss_fn, accuracy_fn<span class="op">=</span>accuracy_fn</span>
<span id="cb30-30"><a href=""></a>)</span>
<span id="cb30-31"><a href=""></a>model_0_results</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>{'model_name': 'FashionMNISTModelV0',
 'model_loss': 0.5002917647361755,
 'model_acc': 81.89896166134186}</code></pre>
</div>
</div></div>
</section>
<section id="device-agnostic-code" class="slide level2">
<h2>Device-agnostic code</h2>
<div id="9897a366" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href=""></a><span class="im">import</span> torch</span>
<span id="cb32-2"><a href=""></a>device <span class="op">=</span> <span class="st">"cuda"</span> <span class="cf">if</span> torch.cuda.is_available() <span class="cf">else</span> <span class="st">"cpu"</span></span>
<span id="cb32-3"><a href=""></a>device</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>'cuda'</code></pre>
</div>
</div>
</section>
<section id="–º–æ–¥–µ–ª—å-1-–Ω–µ–ª—ñ–Ω—ñ–π–Ω—ñ—Å—Ç—å" class="slide level2">
<h2>–ú–æ–¥–µ–ª—å 1: –Ω–µ–ª—ñ–Ω—ñ–π–Ω—ñ—Å—Ç—å</h2>
<ul>
<li>–î–æ–¥–∞–º–æ –Ω–µ–ª—ñ–Ω—ñ–π–Ω—ñ—Å—Ç—å –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é <code>nn.ReLU()</code>.</li>
</ul>
<div id="19cbc291" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href=""></a><span class="kw">class</span> FashionMNISTModelV1(nn.Module):</span>
<span id="cb34-2"><a href=""></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, input_shape: <span class="bu">int</span>, hidden_units: <span class="bu">int</span>, output_shape: <span class="bu">int</span>):</span>
<span id="cb34-3"><a href=""></a>        <span class="bu">super</span>().<span class="fu">__init__</span>()</span>
<span id="cb34-4"><a href=""></a>        <span class="va">self</span>.layer_stack <span class="op">=</span> nn.Sequential(</span>
<span id="cb34-5"><a href=""></a>            nn.Flatten(),</span>
<span id="cb34-6"><a href=""></a>            nn.Linear(in_features<span class="op">=</span>input_shape, out_features<span class="op">=</span>hidden_units),</span>
<span id="cb34-7"><a href=""></a>            nn.ReLU(),</span>
<span id="cb34-8"><a href=""></a>            nn.Linear(in_features<span class="op">=</span>hidden_units, out_features<span class="op">=</span>output_shape),</span>
<span id="cb34-9"><a href=""></a>            nn.ReLU()</span>
<span id="cb34-10"><a href=""></a>        )</span>
<span id="cb34-11"><a href=""></a>    </span>
<span id="cb34-12"><a href=""></a>    <span class="kw">def</span> forward(<span class="va">self</span>, x: torch.Tensor):</span>
<span id="cb34-13"><a href=""></a>        <span class="cf">return</span> <span class="va">self</span>.layer_stack(x)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="–º–æ–¥–µ–ª—å-1-–ø–æ–±—É–¥–æ–≤–∞" class="slide level2 tiny">
<h2>–ú–æ–¥–µ–ª—å 1: –ø–æ–±—É–¥–æ–≤–∞</h2>
<div id="d169d683" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href=""></a>torch.manual_seed(<span class="dv">73</span>)</span>
<span id="cb35-2"><a href=""></a>model_1 <span class="op">=</span> FashionMNISTModelV1(input_shape<span class="op">=</span><span class="dv">784</span>,</span>
<span id="cb35-3"><a href=""></a>    hidden_units<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb35-4"><a href=""></a>    output_shape<span class="op">=</span><span class="bu">len</span>(class_names)</span>
<span id="cb35-5"><a href=""></a>).to(device)</span>
<span id="cb35-6"><a href=""></a><span class="bu">next</span>(model_1.parameters()).device</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>device(type='cuda', index=0)</code></pre>
</div>
</div>
</section>
<section id="–º–æ–¥–µ–ª—å-1-—Ñ—É–Ω–∫—Ü—ñ—è-–≤—Ç—Ä–∞—Ç-–æ–ø—Ç–∏–º—ñ–∑–∞—Ç–æ—Ä-—Ç–∞-–º–µ—Ç—Ä–∏–∫–∞" class="slide level2">
<h2>–ú–æ–¥–µ–ª—å 1: —Ñ—É–Ω–∫—Ü—ñ—è –≤—Ç—Ä–∞—Ç, –æ–ø—Ç–∏–º—ñ–∑–∞—Ç–æ—Ä —Ç–∞ –º–µ—Ç—Ä–∏–∫–∞</h2>
<div id="46c8f73b" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href=""></a><span class="im">from</span> helper_functions <span class="im">import</span> accuracy_fn</span>
<span id="cb37-2"><a href=""></a>loss_fn <span class="op">=</span> nn.CrossEntropyLoss()</span>
<span id="cb37-3"><a href=""></a>optimizer <span class="op">=</span> torch.optim.SGD(params<span class="op">=</span>model_1.parameters(), </span>
<span id="cb37-4"><a href=""></a>                            lr<span class="op">=</span><span class="fl">0.1</span>)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="–º–æ–¥–µ–ª—å-1-—Ñ—É–Ω–∫—Ü—ñ—è-–Ω–∞–≤—á–∞–Ω–Ω—è" class="slide level2 tiny scrollable">
<h2>–ú–æ–¥–µ–ª—å 1: —Ñ—É–Ω–∫—Ü—ñ—è –Ω–∞–≤—á–∞–Ω–Ω—è</h2>
<div id="6a20f5a4" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href=""></a><span class="kw">def</span> train_step(model: torch.nn.Module,</span>
<span id="cb38-2"><a href=""></a>               data_loader: torch.utils.data.DataLoader,</span>
<span id="cb38-3"><a href=""></a>               loss_fn: torch.nn.Module,</span>
<span id="cb38-4"><a href=""></a>               optimizer: torch.optim.Optimizer,</span>
<span id="cb38-5"><a href=""></a>               accuracy_fn,</span>
<span id="cb38-6"><a href=""></a>               device: torch.device <span class="op">=</span> device):</span>
<span id="cb38-7"><a href=""></a>    train_loss, train_acc <span class="op">=</span> <span class="dv">0</span>, <span class="dv">0</span></span>
<span id="cb38-8"><a href=""></a>    model.to(device)</span>
<span id="cb38-9"><a href=""></a>    <span class="cf">for</span> batch, (X, y) <span class="kw">in</span> <span class="bu">enumerate</span>(data_loader):</span>
<span id="cb38-10"><a href=""></a>        <span class="co"># Send data to GPU</span></span>
<span id="cb38-11"><a href=""></a>        X, y <span class="op">=</span> X.to(device), y.to(device)</span>
<span id="cb38-12"><a href=""></a></span>
<span id="cb38-13"><a href=""></a>        <span class="co"># 1. Forward pass</span></span>
<span id="cb38-14"><a href=""></a>        y_pred <span class="op">=</span> model(X)</span>
<span id="cb38-15"><a href=""></a></span>
<span id="cb38-16"><a href=""></a>        <span class="co"># 2. Calculate loss</span></span>
<span id="cb38-17"><a href=""></a>        loss <span class="op">=</span> loss_fn(y_pred, y)</span>
<span id="cb38-18"><a href=""></a>        train_loss <span class="op">+=</span> loss</span>
<span id="cb38-19"><a href=""></a>        train_acc <span class="op">+=</span> accuracy_fn(y_true<span class="op">=</span>y,</span>
<span id="cb38-20"><a href=""></a>                                 y_pred<span class="op">=</span>y_pred.argmax(dim<span class="op">=</span><span class="dv">1</span>)) <span class="co"># Go from logits -&gt; pred labels</span></span>
<span id="cb38-21"><a href=""></a></span>
<span id="cb38-22"><a href=""></a>        <span class="co"># 3. Optimizer zero grad</span></span>
<span id="cb38-23"><a href=""></a>        optimizer.zero_grad()</span>
<span id="cb38-24"><a href=""></a></span>
<span id="cb38-25"><a href=""></a>        <span class="co"># 4. Loss backward</span></span>
<span id="cb38-26"><a href=""></a>        loss.backward()</span>
<span id="cb38-27"><a href=""></a></span>
<span id="cb38-28"><a href=""></a>        <span class="co"># 5. Optimizer step</span></span>
<span id="cb38-29"><a href=""></a>        optimizer.step()</span>
<span id="cb38-30"><a href=""></a></span>
<span id="cb38-31"><a href=""></a>    <span class="co"># Calculate loss and accuracy per epoch and print out what's happening</span></span>
<span id="cb38-32"><a href=""></a>    train_loss <span class="op">/=</span> <span class="bu">len</span>(data_loader)</span>
<span id="cb38-33"><a href=""></a>    train_acc <span class="op">/=</span> <span class="bu">len</span>(data_loader)</span>
<span id="cb38-34"><a href=""></a>    <span class="bu">print</span>(<span class="ss">f"Train loss: </span><span class="sc">{</span>train_loss<span class="sc">:.5f}</span><span class="ss"> | Train accuracy: </span><span class="sc">{</span>train_acc<span class="sc">:.2f}</span><span class="ss">%"</span>)</span>
<span id="cb38-35"><a href=""></a></span>
<span id="cb38-36"><a href=""></a><span class="kw">def</span> test_step(data_loader: torch.utils.data.DataLoader,</span>
<span id="cb38-37"><a href=""></a>              model: torch.nn.Module,</span>
<span id="cb38-38"><a href=""></a>              loss_fn: torch.nn.Module,</span>
<span id="cb38-39"><a href=""></a>              accuracy_fn,</span>
<span id="cb38-40"><a href=""></a>              device: torch.device <span class="op">=</span> device):</span>
<span id="cb38-41"><a href=""></a>    test_loss, test_acc <span class="op">=</span> <span class="dv">0</span>, <span class="dv">0</span></span>
<span id="cb38-42"><a href=""></a>    model.to(device)</span>
<span id="cb38-43"><a href=""></a>    model.<span class="bu">eval</span>() <span class="co"># put model in eval mode</span></span>
<span id="cb38-44"><a href=""></a>    <span class="co"># Turn on inference context manager</span></span>
<span id="cb38-45"><a href=""></a>    <span class="cf">with</span> torch.inference_mode(): </span>
<span id="cb38-46"><a href=""></a>        <span class="cf">for</span> X, y <span class="kw">in</span> data_loader:</span>
<span id="cb38-47"><a href=""></a>            <span class="co"># Send data to GPU</span></span>
<span id="cb38-48"><a href=""></a>            X, y <span class="op">=</span> X.to(device), y.to(device)</span>
<span id="cb38-49"><a href=""></a>            </span>
<span id="cb38-50"><a href=""></a>            <span class="co"># 1. Forward pass</span></span>
<span id="cb38-51"><a href=""></a>            test_pred <span class="op">=</span> model(X)</span>
<span id="cb38-52"><a href=""></a>            </span>
<span id="cb38-53"><a href=""></a>            <span class="co"># 2. Calculate loss and accuracy</span></span>
<span id="cb38-54"><a href=""></a>            test_loss <span class="op">+=</span> loss_fn(test_pred, y)</span>
<span id="cb38-55"><a href=""></a>            test_acc <span class="op">+=</span> accuracy_fn(y_true<span class="op">=</span>y,</span>
<span id="cb38-56"><a href=""></a>                y_pred<span class="op">=</span>test_pred.argmax(dim<span class="op">=</span><span class="dv">1</span>) <span class="co"># Go from logits -&gt; pred labels</span></span>
<span id="cb38-57"><a href=""></a>            )</span>
<span id="cb38-58"><a href=""></a>        </span>
<span id="cb38-59"><a href=""></a>        <span class="co"># Adjust metrics and print out</span></span>
<span id="cb38-60"><a href=""></a>        test_loss <span class="op">/=</span> <span class="bu">len</span>(data_loader)</span>
<span id="cb38-61"><a href=""></a>        test_acc <span class="op">/=</span> <span class="bu">len</span>(data_loader)</span>
<span id="cb38-62"><a href=""></a>        <span class="bu">print</span>(<span class="ss">f"Test loss: </span><span class="sc">{</span>test_loss<span class="sc">:.5f}</span><span class="ss"> | Test accuracy: </span><span class="sc">{</span>test_acc<span class="sc">:.2f}</span><span class="ss">%</span><span class="ch">\n</span><span class="ss">"</span>)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="–º–æ–¥–µ–ª—å-1-–Ω–∞–≤—á–∞–Ω–Ω—è" class="slide level2 tiny scrollable">
<h2>–ú–æ–¥–µ–ª—å 1: –Ω–∞–≤—á–∞–Ω–Ω—è</h2>
<div id="f34aec75" class="cell columns column-output-location" data-execution_count="26">
<div class="column">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href=""></a>torch.manual_seed(<span class="dv">73</span>)</span>
<span id="cb39-2"><a href=""></a></span>
<span id="cb39-3"><a href=""></a><span class="im">from</span> timeit <span class="im">import</span> default_timer <span class="im">as</span> timer</span>
<span id="cb39-4"><a href=""></a>train_time_start_on_gpu <span class="op">=</span> timer()</span>
<span id="cb39-5"><a href=""></a></span>
<span id="cb39-6"><a href=""></a>epochs <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb39-7"><a href=""></a><span class="cf">for</span> epoch <span class="kw">in</span> tqdm(<span class="bu">range</span>(epochs)):</span>
<span id="cb39-8"><a href=""></a>    <span class="bu">print</span>(<span class="ss">f"Epoch: </span><span class="sc">{</span>epoch<span class="sc">}</span><span class="ch">\n</span><span class="ss">---------"</span>)</span>
<span id="cb39-9"><a href=""></a>    train_step(data_loader<span class="op">=</span>train_dataloader, </span>
<span id="cb39-10"><a href=""></a>        model<span class="op">=</span>model_1, </span>
<span id="cb39-11"><a href=""></a>        loss_fn<span class="op">=</span>loss_fn,</span>
<span id="cb39-12"><a href=""></a>        optimizer<span class="op">=</span>optimizer,</span>
<span id="cb39-13"><a href=""></a>        accuracy_fn<span class="op">=</span>accuracy_fn</span>
<span id="cb39-14"><a href=""></a>    )</span>
<span id="cb39-15"><a href=""></a>    test_step(data_loader<span class="op">=</span>test_dataloader,</span>
<span id="cb39-16"><a href=""></a>        model<span class="op">=</span>model_1,</span>
<span id="cb39-17"><a href=""></a>        loss_fn<span class="op">=</span>loss_fn,</span>
<span id="cb39-18"><a href=""></a>        accuracy_fn<span class="op">=</span>accuracy_fn</span>
<span id="cb39-19"><a href=""></a>    )</span>
<span id="cb39-20"><a href=""></a></span>
<span id="cb39-21"><a href=""></a>train_time_end_on_gpu <span class="op">=</span> timer()</span>
<span id="cb39-22"><a href=""></a>total_train_time_model_1 <span class="op">=</span> print_train_time(start<span class="op">=</span>train_time_start_on_gpu,</span>
<span id="cb39-23"><a href=""></a>                                            end<span class="op">=</span>train_time_end_on_gpu,</span>
<span id="cb39-24"><a href=""></a>                                            device<span class="op">=</span>device)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"47c217a74bea4364b28debffb05bfdc7","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 0
---------
Train loss: 1.18067 | Train accuracy: 57.35%
Test loss: 0.98600 | Test accuracy: 69.28%

Epoch: 1
---------
Train loss: 0.73643 | Train accuracy: 73.11%
Test loss: 0.77977 | Test accuracy: 70.94%

Epoch: 2
---------
Train loss: 0.69153 | Train accuracy: 74.27%
Test loss: 0.74039 | Test accuracy: 71.94%

Train time on cuda: 19.213 seconds</code></pre>
</div>
</div></div>
</section>
<section id="–º–æ–¥–µ–ª—å-1-–æ—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è" class="slide level2 tiny">
<h2>–ú–æ–¥–µ–ª—å 1: –æ—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è</h2>
<div class="columns">
<div class="column">
<div id="87df98b3" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href=""></a>torch.manual_seed(<span class="dv">73</span>)</span>
<span id="cb41-2"><a href=""></a></span>
<span id="cb41-3"><a href=""></a>model_1_results <span class="op">=</span> eval_model(model<span class="op">=</span>model_1, </span>
<span id="cb41-4"><a href=""></a>    data_loader<span class="op">=</span>test_dataloader,</span>
<span id="cb41-5"><a href=""></a>    loss_fn<span class="op">=</span>loss_fn, </span>
<span id="cb41-6"><a href=""></a>    accuracy_fn<span class="op">=</span>accuracy_fn) </span>
<span id="cb41-7"><a href=""></a>model_1_results </span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg ansi-bold">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg ansi-bold">RuntimeError</span>                              Traceback (most recent call last)
Cell <span class="ansi-green-fg ansi-bold">In[27], line 3</span>
<span class="ansi-green-fg">      1</span> torch<span style="color:rgb(98,98,98)">.</span>manual_seed(<span style="color:rgb(98,98,98)">73</span>)
<span class="ansi-green-fg ansi-bold">----&gt; 3</span> model_1_results <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">eval_model</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">model</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">model_1</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span>
<span class="ansi-green-fg">      4</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">data_loader</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">test_dataloader</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg">      5</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">loss_fn</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">loss_fn</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span>
<span class="ansi-green-fg">      6</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">accuracy_fn</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">accuracy_fn</span><span class="ansi-yellow-bg">)</span> 
<span class="ansi-green-fg">      7</span> model_1_results 

Cell <span class="ansi-green-fg ansi-bold">In[20], line 12</span>, in <span class="ansi-cyan-fg">eval_model</span><span class="ansi-blue-fg ansi-bold">(model, data_loader, loss_fn, accuracy_fn)</span>
<span class="ansi-green-fg">      9</span> <span style="font-weight:bold;color:rgb(0,135,0)">with</span> torch<span style="color:rgb(98,98,98)">.</span>inference_mode():
<span class="ansi-green-fg">     10</span>     <span style="font-weight:bold;color:rgb(0,135,0)">for</span> X, y <span style="font-weight:bold;color:rgb(175,0,255)">in</span> data_loader:
<span class="ansi-green-fg">     11</span>         <span style="font-style:italic;color:rgb(95,135,135)"># Make predictions with the model</span>
<span class="ansi-green-fg ansi-bold">---&gt; 12</span>         y_pred <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">model</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">X</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg">     14</span>         <span style="font-style:italic;color:rgb(95,135,135)"># Accumulate the loss and accuracy values per batch</span>
<span class="ansi-green-fg">     15</span>         loss <span style="color:rgb(98,98,98)">+</span><span style="color:rgb(98,98,98)">=</span> loss_fn(y_pred, y)

File <span class="ansi-green-fg ansi-bold">C:\Python\Python311\Lib\site-packages\torch\nn\modules\module.py:1501</span>, in <span class="ansi-cyan-fg">Module._call_impl</span><span class="ansi-blue-fg ansi-bold">(self, *args, **kwargs)</span>
<span class="ansi-green-fg">   1496</span> <span style="font-style:italic;color:rgb(95,135,135)"># If we don't have any hooks, we want to skip the rest of the logic in</span>
<span class="ansi-green-fg">   1497</span> <span style="font-style:italic;color:rgb(95,135,135)"># this function, and just call forward.</span>
<span class="ansi-green-fg">   1498</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> <span style="font-weight:bold;color:rgb(175,0,255)">not</span> (<span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>_backward_hooks <span style="font-weight:bold;color:rgb(175,0,255)">or</span> <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>_backward_pre_hooks <span style="font-weight:bold;color:rgb(175,0,255)">or</span> <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>_forward_hooks <span style="font-weight:bold;color:rgb(175,0,255)">or</span> <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>_forward_pre_hooks
<span class="ansi-green-fg">   1499</span>         <span style="font-weight:bold;color:rgb(175,0,255)">or</span> _global_backward_pre_hooks <span style="font-weight:bold;color:rgb(175,0,255)">or</span> _global_backward_hooks
<span class="ansi-green-fg">   1500</span>         <span style="font-weight:bold;color:rgb(175,0,255)">or</span> _global_forward_hooks <span style="font-weight:bold;color:rgb(175,0,255)">or</span> _global_forward_pre_hooks):
<span class="ansi-green-fg ansi-bold">-&gt; 1501</span>     <span style="font-weight:bold;color:rgb(0,135,0)">return</span> <span class="ansi-yellow-bg">forward_call</span><span class="ansi-yellow-bg">(</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">*</span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">*</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">*</span><span class="ansi-yellow-bg">kwargs</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg">   1502</span> <span style="font-style:italic;color:rgb(95,135,135)"># Do not call functions when jit is used</span>
<span class="ansi-green-fg">   1503</span> full_backward_hooks, non_full_backward_hooks <span style="color:rgb(98,98,98)">=</span> [], []

Cell <span class="ansi-green-fg ansi-bold">In[22], line 13</span>, in <span class="ansi-cyan-fg">FashionMNISTModelV1.forward</span><span class="ansi-blue-fg ansi-bold">(self, x)</span>
<span class="ansi-green-fg">     12</span> <span style="font-weight:bold;color:rgb(0,135,0)">def</span> <span style="color:rgb(0,0,255)">forward</span>(<span style="color:rgb(0,135,0)">self</span>, x: torch<span style="color:rgb(98,98,98)">.</span>Tensor):
<span class="ansi-green-fg ansi-bold">---&gt; 13</span>     <span style="font-weight:bold;color:rgb(0,135,0)">return</span> <span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">layer_stack</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">x</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg ansi-bold">C:\Python\Python311\Lib\site-packages\torch\nn\modules\module.py:1501</span>, in <span class="ansi-cyan-fg">Module._call_impl</span><span class="ansi-blue-fg ansi-bold">(self, *args, **kwargs)</span>
<span class="ansi-green-fg">   1496</span> <span style="font-style:italic;color:rgb(95,135,135)"># If we don't have any hooks, we want to skip the rest of the logic in</span>
<span class="ansi-green-fg">   1497</span> <span style="font-style:italic;color:rgb(95,135,135)"># this function, and just call forward.</span>
<span class="ansi-green-fg">   1498</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> <span style="font-weight:bold;color:rgb(175,0,255)">not</span> (<span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>_backward_hooks <span style="font-weight:bold;color:rgb(175,0,255)">or</span> <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>_backward_pre_hooks <span style="font-weight:bold;color:rgb(175,0,255)">or</span> <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>_forward_hooks <span style="font-weight:bold;color:rgb(175,0,255)">or</span> <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>_forward_pre_hooks
<span class="ansi-green-fg">   1499</span>         <span style="font-weight:bold;color:rgb(175,0,255)">or</span> _global_backward_pre_hooks <span style="font-weight:bold;color:rgb(175,0,255)">or</span> _global_backward_hooks
<span class="ansi-green-fg">   1500</span>         <span style="font-weight:bold;color:rgb(175,0,255)">or</span> _global_forward_hooks <span style="font-weight:bold;color:rgb(175,0,255)">or</span> _global_forward_pre_hooks):
<span class="ansi-green-fg ansi-bold">-&gt; 1501</span>     <span style="font-weight:bold;color:rgb(0,135,0)">return</span> <span class="ansi-yellow-bg">forward_call</span><span class="ansi-yellow-bg">(</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">*</span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">*</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">*</span><span class="ansi-yellow-bg">kwargs</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg">   1502</span> <span style="font-style:italic;color:rgb(95,135,135)"># Do not call functions when jit is used</span>
<span class="ansi-green-fg">   1503</span> full_backward_hooks, non_full_backward_hooks <span style="color:rgb(98,98,98)">=</span> [], []

File <span class="ansi-green-fg ansi-bold">C:\Python\Python311\Lib\site-packages\torch\nn\modules\container.py:217</span>, in <span class="ansi-cyan-fg">Sequential.forward</span><span class="ansi-blue-fg ansi-bold">(self, input)</span>
<span class="ansi-green-fg">    215</span> <span style="font-weight:bold;color:rgb(0,135,0)">def</span> <span style="color:rgb(0,0,255)">forward</span>(<span style="color:rgb(0,135,0)">self</span>, <span style="color:rgb(0,135,0)">input</span>):
<span class="ansi-green-fg">    216</span>     <span style="font-weight:bold;color:rgb(0,135,0)">for</span> module <span style="font-weight:bold;color:rgb(175,0,255)">in</span> <span style="color:rgb(0,135,0)">self</span>:
<span class="ansi-green-fg ansi-bold">--&gt; 217</span>         <span style="color:rgb(0,135,0)">input</span> <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">module</span><span class="ansi-yellow-bg">(</span><span style="color:rgb(0,135,0)" class="ansi-yellow-bg">input</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg">    218</span>     <span style="font-weight:bold;color:rgb(0,135,0)">return</span> <span style="color:rgb(0,135,0)">input</span>

File <span class="ansi-green-fg ansi-bold">C:\Python\Python311\Lib\site-packages\torch\nn\modules\module.py:1501</span>, in <span class="ansi-cyan-fg">Module._call_impl</span><span class="ansi-blue-fg ansi-bold">(self, *args, **kwargs)</span>
<span class="ansi-green-fg">   1496</span> <span style="font-style:italic;color:rgb(95,135,135)"># If we don't have any hooks, we want to skip the rest of the logic in</span>
<span class="ansi-green-fg">   1497</span> <span style="font-style:italic;color:rgb(95,135,135)"># this function, and just call forward.</span>
<span class="ansi-green-fg">   1498</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> <span style="font-weight:bold;color:rgb(175,0,255)">not</span> (<span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>_backward_hooks <span style="font-weight:bold;color:rgb(175,0,255)">or</span> <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>_backward_pre_hooks <span style="font-weight:bold;color:rgb(175,0,255)">or</span> <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>_forward_hooks <span style="font-weight:bold;color:rgb(175,0,255)">or</span> <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>_forward_pre_hooks
<span class="ansi-green-fg">   1499</span>         <span style="font-weight:bold;color:rgb(175,0,255)">or</span> _global_backward_pre_hooks <span style="font-weight:bold;color:rgb(175,0,255)">or</span> _global_backward_hooks
<span class="ansi-green-fg">   1500</span>         <span style="font-weight:bold;color:rgb(175,0,255)">or</span> _global_forward_hooks <span style="font-weight:bold;color:rgb(175,0,255)">or</span> _global_forward_pre_hooks):
<span class="ansi-green-fg ansi-bold">-&gt; 1501</span>     <span style="font-weight:bold;color:rgb(0,135,0)">return</span> <span class="ansi-yellow-bg">forward_call</span><span class="ansi-yellow-bg">(</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">*</span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">*</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">*</span><span class="ansi-yellow-bg">kwargs</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg">   1502</span> <span style="font-style:italic;color:rgb(95,135,135)"># Do not call functions when jit is used</span>
<span class="ansi-green-fg">   1503</span> full_backward_hooks, non_full_backward_hooks <span style="color:rgb(98,98,98)">=</span> [], []

File <span class="ansi-green-fg ansi-bold">C:\Python\Python311\Lib\site-packages\torch\nn\modules\linear.py:114</span>, in <span class="ansi-cyan-fg">Linear.forward</span><span class="ansi-blue-fg ansi-bold">(self, input)</span>
<span class="ansi-green-fg">    113</span> <span style="font-weight:bold;color:rgb(0,135,0)">def</span> <span style="color:rgb(0,0,255)">forward</span>(<span style="color:rgb(0,135,0)">self</span>, <span style="color:rgb(0,135,0)">input</span>: Tensor) <span style="color:rgb(98,98,98)">-</span><span style="color:rgb(98,98,98)">&gt;</span> Tensor:
<span class="ansi-green-fg ansi-bold">--&gt; 114</span>     <span style="font-weight:bold;color:rgb(0,135,0)">return</span> <span class="ansi-yellow-bg">F</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">linear</span><span class="ansi-yellow-bg">(</span><span style="color:rgb(0,135,0)" class="ansi-yellow-bg">input</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">weight</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">bias</span><span class="ansi-yellow-bg">)</span>

<span class="ansi-red-fg ansi-bold">RuntimeError</span>: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)</pre>
</div>
</div>
</div>
</div><div class="column">
<blockquote>
<p>RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)</p>
</blockquote>
</div></div>
</section>
<section id="–º–æ–¥–µ–ª—å-1-–æ—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è-–≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è" class="slide level2 tiny">
<h2>–ú–æ–¥–µ–ª—å 1: –æ—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è (–≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è)</h2>
<div id="51041a89" class="cell columns column-output-location" data-execution_count="28">
<div class="column">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href=""></a>torch.manual_seed(<span class="dv">73</span>)</span>
<span id="cb42-2"><a href=""></a><span class="kw">def</span> eval_model(model: torch.nn.Module, </span>
<span id="cb42-3"><a href=""></a>               data_loader: torch.utils.data.DataLoader, </span>
<span id="cb42-4"><a href=""></a>               loss_fn: torch.nn.Module, </span>
<span id="cb42-5"><a href=""></a>               accuracy_fn, </span>
<span id="cb42-6"><a href=""></a>               device: torch.device <span class="op">=</span> device):</span>
<span id="cb42-7"><a href=""></a></span>
<span id="cb42-8"><a href=""></a>    loss, acc <span class="op">=</span> <span class="dv">0</span>, <span class="dv">0</span></span>
<span id="cb42-9"><a href=""></a>    model.<span class="bu">eval</span>()</span>
<span id="cb42-10"><a href=""></a>    <span class="cf">with</span> torch.inference_mode():</span>
<span id="cb42-11"><a href=""></a>        <span class="cf">for</span> X, y <span class="kw">in</span> data_loader:</span>
<span id="cb42-12"><a href=""></a>            X, y <span class="op">=</span> X.to(device), y.to(device)</span>
<span id="cb42-13"><a href=""></a>            y_pred <span class="op">=</span> model(X)</span>
<span id="cb42-14"><a href=""></a>            loss <span class="op">+=</span> loss_fn(y_pred, y)</span>
<span id="cb42-15"><a href=""></a>            acc <span class="op">+=</span> accuracy_fn(y_true<span class="op">=</span>y, y_pred<span class="op">=</span>y_pred.argmax(dim<span class="op">=</span><span class="dv">1</span>))</span>
<span id="cb42-16"><a href=""></a>        </span>
<span id="cb42-17"><a href=""></a>        loss <span class="op">/=</span> <span class="bu">len</span>(data_loader)</span>
<span id="cb42-18"><a href=""></a>        acc <span class="op">/=</span> <span class="bu">len</span>(data_loader)</span>
<span id="cb42-19"><a href=""></a>    <span class="cf">return</span> {<span class="st">"model_name"</span>: model.<span class="va">__class__</span>.<span class="va">__name__</span>,</span>
<span id="cb42-20"><a href=""></a>            <span class="st">"model_loss"</span>: loss.item(),</span>
<span id="cb42-21"><a href=""></a>            <span class="st">"model_acc"</span>: acc}</span>
<span id="cb42-22"><a href=""></a></span>
<span id="cb42-23"><a href=""></a>model_1_results <span class="op">=</span> eval_model(model<span class="op">=</span>model_1, data_loader<span class="op">=</span>test_dataloader,</span>
<span id="cb42-24"><a href=""></a>    loss_fn<span class="op">=</span>loss_fn, accuracy_fn<span class="op">=</span>accuracy_fn,</span>
<span id="cb42-25"><a href=""></a>    device<span class="op">=</span>device</span>
<span id="cb42-26"><a href=""></a>)</span>
<span id="cb42-27"><a href=""></a>model_1_results, model_0_results</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>({'model_name': 'FashionMNISTModelV1',
  'model_loss': 0.7403943538665771,
  'model_acc': 71.94488817891374},
 {'model_name': 'FashionMNISTModelV0',
  'model_loss': 0.5002917647361755,
  'model_acc': 81.89896166134186})</code></pre>
</div>
</div></div>
</section>
<section id="–º–æ–¥–µ–ª—å-2-cnn" class="slide level2 tiny scrollable">
<h2>–ú–æ–¥–µ–ª—å 2: CNN</h2>
<ul>
<li>–í–∏–∫–æ—Ä–∏—Å—Ç–∞—î–º–æ <code>nn.Conv2d()</code> –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è <a href="https://poloclub.github.io/cnn-explainer/">–∑–≥–æ—Ä—Ç–∫–æ–≤–æ–≥–æ</a> —à–∞—Ä—É.</li>
<li>–í–∏–∫–æ—Ä–∏—Å—Ç–∞—î–º–æ <code>nn.MaxPool2d()</code> –¥–ª—è –∑–º–µ–Ω—à–µ–Ω–Ω—è —Ä–æ–∑–º—ñ—Ä–Ω–æ—Å—Ç—ñ (downsampling).</li>
</ul>
<div id="774e0fdc" class="cell columns column-output-location" data-execution_count="29">
<div class="column">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href=""></a><span class="kw">class</span> FashionMNISTModelV2(nn.Module):</span>
<span id="cb44-2"><a href=""></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, input_shape: <span class="bu">int</span>, hidden_units: <span class="bu">int</span>, output_shape: <span class="bu">int</span>):</span>
<span id="cb44-3"><a href=""></a>        <span class="bu">super</span>().<span class="fu">__init__</span>()</span>
<span id="cb44-4"><a href=""></a>        <span class="va">self</span>.block_1 <span class="op">=</span> nn.Sequential(</span>
<span id="cb44-5"><a href=""></a>            nn.Conv2d(in_channels<span class="op">=</span>input_shape, </span>
<span id="cb44-6"><a href=""></a>                      out_channels<span class="op">=</span>hidden_units, </span>
<span id="cb44-7"><a href=""></a>                      kernel_size<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb44-8"><a href=""></a>                      stride<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb44-9"><a href=""></a>                      padding<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb44-10"><a href=""></a>            nn.ReLU(),</span>
<span id="cb44-11"><a href=""></a>            nn.Conv2d(in_channels<span class="op">=</span>hidden_units, </span>
<span id="cb44-12"><a href=""></a>                      out_channels<span class="op">=</span>hidden_units,</span>
<span id="cb44-13"><a href=""></a>                      kernel_size<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb44-14"><a href=""></a>                      stride<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb44-15"><a href=""></a>                      padding<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb44-16"><a href=""></a>            nn.ReLU(),</span>
<span id="cb44-17"><a href=""></a>            nn.MaxPool2d(kernel_size<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb44-18"><a href=""></a>                         stride<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb44-19"><a href=""></a>        )</span>
<span id="cb44-20"><a href=""></a>        <span class="va">self</span>.block_2 <span class="op">=</span> nn.Sequential(</span>
<span id="cb44-21"><a href=""></a>            nn.Conv2d(hidden_units, hidden_units, <span class="dv">3</span>, padding<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb44-22"><a href=""></a>            nn.ReLU(),</span>
<span id="cb44-23"><a href=""></a>            nn.Conv2d(hidden_units, hidden_units, <span class="dv">3</span>, padding<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb44-24"><a href=""></a>            nn.ReLU(),</span>
<span id="cb44-25"><a href=""></a>            nn.MaxPool2d(<span class="dv">2</span>)</span>
<span id="cb44-26"><a href=""></a>        )</span>
<span id="cb44-27"><a href=""></a>        <span class="va">self</span>.classifier <span class="op">=</span> nn.Sequential(</span>
<span id="cb44-28"><a href=""></a>            nn.Flatten(),</span>
<span id="cb44-29"><a href=""></a>            nn.Linear(in_features<span class="op">=</span>hidden_units<span class="op">*</span><span class="dv">7</span><span class="op">*</span><span class="dv">7</span>, </span>
<span id="cb44-30"><a href=""></a>                      out_features<span class="op">=</span>output_shape)</span>
<span id="cb44-31"><a href=""></a>        )</span>
<span id="cb44-32"><a href=""></a>    </span>
<span id="cb44-33"><a href=""></a>    <span class="kw">def</span> forward(<span class="va">self</span>, x: torch.Tensor):</span>
<span id="cb44-34"><a href=""></a>        x <span class="op">=</span> <span class="va">self</span>.block_1(x)</span>
<span id="cb44-35"><a href=""></a>        x <span class="op">=</span> <span class="va">self</span>.block_2(x)</span>
<span id="cb44-36"><a href=""></a>        x <span class="op">=</span> <span class="va">self</span>.classifier(x)</span>
<span id="cb44-37"><a href=""></a>        <span class="cf">return</span> x</span>
<span id="cb44-38"><a href=""></a></span>
<span id="cb44-39"><a href=""></a>torch.manual_seed(<span class="dv">42</span>)</span>
<span id="cb44-40"><a href=""></a>model_2 <span class="op">=</span> FashionMNISTModelV2(input_shape<span class="op">=</span><span class="dv">1</span>, </span>
<span id="cb44-41"><a href=""></a>    hidden_units<span class="op">=</span><span class="dv">10</span>, </span>
<span id="cb44-42"><a href=""></a>    output_shape<span class="op">=</span><span class="bu">len</span>(class_names)).to(device)</span>
<span id="cb44-43"><a href=""></a>model_2</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>FashionMNISTModelV2(
  (block_1): Sequential(
    (0): Conv2d(1, 10, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU()
    (2): Conv2d(10, 10, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (3): ReLU()
    (4): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  )
  (block_2): Sequential(
    (0): Conv2d(10, 10, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU()
    (2): Conv2d(10, 10, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (3): ReLU()
    (4): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  )
  (classifier): Sequential(
    (0): Flatten(start_dim=1, end_dim=-1)
    (1): Linear(in_features=490, out_features=10, bias=True)
  )
)</code></pre>
</div>
</div></div>
</section>
<section id="nn.conv2d" class="slide level2">
<h2><code>nn.Conv2d()</code></h2>
<ul>
<li><code>in_channels</code>: –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∫–∞–Ω–∞–ª—ñ–≤ –Ω–∞ –≤—Ö—ñ–¥ (1 –¥–ª—è —á–æ—Ä–Ω–æ-–±—ñ–ª–∏—Ö –∑–æ–±—Ä–∞–∂–µ–Ω—å, 3 –¥–ª—è –∫–æ–ª—å–æ—Ä–æ–≤–∏—Ö).</li>
<li><code>out_channels</code>: –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ñ—ñ–ª—å—Ç—Ä—ñ–≤ (–ø—ñ–¥–±–∏—Ä–∞—î—Ç—å—Å—è –µ–º–ø—ñ—Ä–∏—á–Ω–æ).</li>
<li><code>kernel_size</code>: —Ä–æ–∑–º—ñ—Ä —Ñ—ñ–ª—å—Ç—Ä–∞ (3x3, 5x5, 7x7 —Ç–æ—â–æ).</li>
<li><code>stride</code>: –∫—Ä–æ–∫ —Ñ—ñ–ª—å—Ç—Ä–∞ (1, 2 —Ç–æ—â–æ).</li>
<li><code>padding</code>: –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –ø—ñ–∫—Å–µ–ª—ñ –Ω–∞–≤–∫–æ–ª–æ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è (0, 1, 2 —Ç–æ—â–æ).</li>
</ul>
<div class="footer">
<p><a href="https://poloclub.github.io/cnn-explainer/">CNN Explainer webpage</a></p>
</div>
</section>
<section id="–º–æ–¥–µ–ª—å-2-—Ñ—É–Ω–∫—Ü—ñ—è-–≤—Ç—Ä–∞—Ç-–æ–ø—Ç–∏–º—ñ–∑–∞—Ç–æ—Ä-—Ç–∞-–º–µ—Ç—Ä–∏–∫–∞" class="slide level2">
<h2>–ú–æ–¥–µ–ª—å 2: —Ñ—É–Ω–∫—Ü—ñ—è –≤—Ç—Ä–∞—Ç, –æ–ø—Ç–∏–º—ñ–∑–∞—Ç–æ—Ä —Ç–∞ –º–µ—Ç—Ä–∏–∫–∞</h2>
<div id="a02f325e" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href=""></a>loss_fn <span class="op">=</span> nn.CrossEntropyLoss()</span>
<span id="cb46-2"><a href=""></a>optimizer <span class="op">=</span> torch.optim.SGD(params<span class="op">=</span>model_2.parameters(), </span>
<span id="cb46-3"><a href=""></a>                             lr<span class="op">=</span><span class="fl">0.1</span>)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="–º–æ–¥–µ–ª—å-2-–Ω–∞–≤—á–∞–Ω–Ω—è" class="slide level2 tiny scrollable">
<h2>–ú–æ–¥–µ–ª—å 2: –Ω–∞–≤—á–∞–Ω–Ω—è</h2>
<div id="654f3fa4" class="cell columns column-output-location" data-execution_count="31">
<div class="column">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href=""></a>torch.manual_seed(<span class="dv">73</span>)</span>
<span id="cb47-2"><a href=""></a></span>
<span id="cb47-3"><a href=""></a><span class="im">from</span> timeit <span class="im">import</span> default_timer <span class="im">as</span> timer</span>
<span id="cb47-4"><a href=""></a>train_time_start_model_2 <span class="op">=</span> timer()</span>
<span id="cb47-5"><a href=""></a></span>
<span id="cb47-6"><a href=""></a>epochs <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb47-7"><a href=""></a><span class="cf">for</span> epoch <span class="kw">in</span> tqdm(<span class="bu">range</span>(epochs)):</span>
<span id="cb47-8"><a href=""></a>    <span class="bu">print</span>(<span class="ss">f"Epoch: </span><span class="sc">{</span>epoch<span class="sc">}</span><span class="ch">\n</span><span class="ss">---------"</span>)</span>
<span id="cb47-9"><a href=""></a>    train_step(data_loader<span class="op">=</span>train_dataloader, </span>
<span id="cb47-10"><a href=""></a>        model<span class="op">=</span>model_2, </span>
<span id="cb47-11"><a href=""></a>        loss_fn<span class="op">=</span>loss_fn,</span>
<span id="cb47-12"><a href=""></a>        optimizer<span class="op">=</span>optimizer,</span>
<span id="cb47-13"><a href=""></a>        accuracy_fn<span class="op">=</span>accuracy_fn,</span>
<span id="cb47-14"><a href=""></a>        device<span class="op">=</span>device</span>
<span id="cb47-15"><a href=""></a>    )</span>
<span id="cb47-16"><a href=""></a>    test_step(data_loader<span class="op">=</span>test_dataloader,</span>
<span id="cb47-17"><a href=""></a>        model<span class="op">=</span>model_2,</span>
<span id="cb47-18"><a href=""></a>        loss_fn<span class="op">=</span>loss_fn,</span>
<span id="cb47-19"><a href=""></a>        accuracy_fn<span class="op">=</span>accuracy_fn,</span>
<span id="cb47-20"><a href=""></a>        device<span class="op">=</span>device</span>
<span id="cb47-21"><a href=""></a>    )</span>
<span id="cb47-22"><a href=""></a></span>
<span id="cb47-23"><a href=""></a>train_time_end_model_2 <span class="op">=</span> timer()</span>
<span id="cb47-24"><a href=""></a>total_train_time_model_2 <span class="op">=</span> print_train_time(start<span class="op">=</span>train_time_start_model_2,</span>
<span id="cb47-25"><a href=""></a>                                           end<span class="op">=</span>train_time_end_model_2,</span>
<span id="cb47-26"><a href=""></a>                                           device<span class="op">=</span>device)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"acee3e6ebd9b4aefb5d21c4c7d2f2186","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 0
---------
Train loss: 0.58545 | Train accuracy: 78.68%
Test loss: 0.38676 | Test accuracy: 86.04%

Epoch: 1
---------
Train loss: 0.34949 | Train accuracy: 87.36%
Test loss: 0.39586 | Test accuracy: 85.23%

Epoch: 2
---------
Train loss: 0.31176 | Train accuracy: 88.70%
Test loss: 0.32746 | Test accuracy: 88.03%

Train time on cuda: 20.853 seconds</code></pre>
</div>
</div></div>
</section>
<section id="–º–æ–¥–µ–ª—å-2-–æ—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è" class="slide level2">
<h2>–ú–æ–¥–µ–ª—å 2: –æ—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è</h2>
<div id="e68b1175" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href=""></a>model_2_results <span class="op">=</span> eval_model(</span>
<span id="cb49-2"><a href=""></a>    model<span class="op">=</span>model_2,</span>
<span id="cb49-3"><a href=""></a>    data_loader<span class="op">=</span>test_dataloader,</span>
<span id="cb49-4"><a href=""></a>    loss_fn<span class="op">=</span>loss_fn,</span>
<span id="cb49-5"><a href=""></a>    accuracy_fn<span class="op">=</span>accuracy_fn</span>
<span id="cb49-6"><a href=""></a>)</span>
<span id="cb49-7"><a href=""></a>model_2_results</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>{'model_name': 'FashionMNISTModelV2',
 'model_loss': 0.32745975255966187,
 'model_acc': 88.02915335463258}</code></pre>
</div>
</div>
</section>
<section id="–ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è-—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤-–º–æ–¥–µ–ª–µ–π" class="slide level2 tiny">
<h2>–ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ –º–æ–¥–µ–ª–µ–π</h2>
<div id="312c66c9" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href=""></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb51-2"><a href=""></a>compare_results <span class="op">=</span> pd.DataFrame([model_0_results, model_1_results, model_2_results])</span>
<span id="cb51-3"><a href=""></a>compare_results[<span class="st">"training_time"</span>] <span class="op">=</span> [total_train_time_model_0,</span>
<span id="cb51-4"><a href=""></a>                                    total_train_time_model_1,</span>
<span id="cb51-5"><a href=""></a>                                    total_train_time_model_2]</span>
<span id="cb51-6"><a href=""></a>compare_results</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">model_name</th>
<th data-quarto-table-cell-role="th">model_loss</th>
<th data-quarto-table-cell-role="th">model_acc</th>
<th data-quarto-table-cell-role="th">training_time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>FashionMNISTModelV0</td>
<td>0.500292</td>
<td>81.898962</td>
<td>12.104740</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>FashionMNISTModelV1</td>
<td>0.740394</td>
<td>71.944888</td>
<td>19.213192</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>FashionMNISTModelV2</td>
<td>0.327460</td>
<td>88.029153</td>
<td>20.853124</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="–∫–æ–º–ø—Ä–æ–º—ñ—Å-–º—ñ–∂-—á–∞—Å–æ–º-—ñ-—Ç–æ—á–Ω—ñ—Å—Ç—é" class="slide level2 tiny">
<h2>–ö–æ–º–ø—Ä–æ–º—ñ—Å –º—ñ–∂ —á–∞—Å–æ–º —ñ —Ç–æ—á–Ω—ñ—Å—Ç—é</h2>
<div id="de781624" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href=""></a><span class="co"># Visualize our model results</span></span>
<span id="cb52-2"><a href=""></a>compare_results.set_index(<span class="st">"model_name"</span>)[<span class="st">"model_acc"</span>].plot(kind<span class="op">=</span><span class="st">"barh"</span>)</span>
<span id="cb52-3"><a href=""></a>plt.xlabel(<span class="st">"accuracy (%)"</span>)</span>
<span id="cb52-4"><a href=""></a>plt.ylabel(<span class="st">"model"</span>)<span class="op">;</span></span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src=".03_files/figure-revealjs/cell-35-output-1.svg" class="r-stretch"></section>
<section id="–ø—Ä–æ–≥–Ω–æ–∑-–∑–∞-–∫—Ä–∞—â–æ—é-–º–æ–¥–µ–ª–ª—é-13" class="slide level2 smaller">
<h2>–ü—Ä–æ–≥–Ω–æ–∑ –∑–∞ –∫—Ä–∞—â–æ—é –º–æ–¥–µ–ª–ª—é 1/3</h2>
<div id="f3c6d72f" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href=""></a><span class="kw">def</span> make_predictions(model: torch.nn.Module, data: <span class="bu">list</span>, device: torch.device <span class="op">=</span> device):</span>
<span id="cb53-2"><a href=""></a>    pred_probs <span class="op">=</span> []</span>
<span id="cb53-3"><a href=""></a>    model.<span class="bu">eval</span>()</span>
<span id="cb53-4"><a href=""></a>    <span class="cf">with</span> torch.inference_mode():</span>
<span id="cb53-5"><a href=""></a>        <span class="cf">for</span> sample <span class="kw">in</span> data:</span>
<span id="cb53-6"><a href=""></a>            sample <span class="op">=</span> torch.unsqueeze(sample, dim<span class="op">=</span><span class="dv">0</span>).to(device)</span>
<span id="cb53-7"><a href=""></a></span>
<span id="cb53-8"><a href=""></a>            pred_logit <span class="op">=</span> model(sample)</span>
<span id="cb53-9"><a href=""></a></span>
<span id="cb53-10"><a href=""></a>            pred_prob <span class="op">=</span> torch.softmax(pred_logit.squeeze(), dim<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb53-11"><a href=""></a></span>
<span id="cb53-12"><a href=""></a>            pred_probs.append(pred_prob.cpu())</span>
<span id="cb53-13"><a href=""></a>            </span>
<span id="cb53-14"><a href=""></a>    <span class="cf">return</span> torch.stack(pred_probs)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="–ø—Ä–æ–≥–Ω–æ–∑-–∑–∞-–∫—Ä–∞—â–æ—é-–º–æ–¥–µ–ª–ª—é-23" class="slide level2 smaller">
<h2>–ü—Ä–æ–≥–Ω–æ–∑ –∑–∞ –∫—Ä–∞—â–æ—é –º–æ–¥–µ–ª–ª—é 2/3</h2>
<div id="fd9d2ab8" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href=""></a><span class="im">import</span> random</span>
<span id="cb54-2"><a href=""></a>random.seed(<span class="dv">73</span>)</span>
<span id="cb54-3"><a href=""></a>test_samples <span class="op">=</span> []</span>
<span id="cb54-4"><a href=""></a>test_labels <span class="op">=</span> []</span>
<span id="cb54-5"><a href=""></a><span class="cf">for</span> sample, label <span class="kw">in</span> random.sample(<span class="bu">list</span>(test_data), k<span class="op">=</span><span class="dv">9</span>):</span>
<span id="cb54-6"><a href=""></a>    test_samples.append(sample)</span>
<span id="cb54-7"><a href=""></a>    test_labels.append(label)</span>
<span id="cb54-8"><a href=""></a></span>
<span id="cb54-9"><a href=""></a><span class="bu">print</span>(<span class="ss">f"Test sample image shape: </span><span class="sc">{</span>test_samples[<span class="dv">0</span>]<span class="sc">.</span>shape<span class="sc">}</span><span class="ch">\n</span><span class="ss">Test sample label: </span><span class="sc">{</span>test_labels[<span class="dv">0</span>]<span class="sc">}</span><span class="ss"> (</span><span class="sc">{</span>class_names[test_labels[<span class="dv">0</span>]]<span class="sc">}</span><span class="ss">)"</span>)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test sample image shape: torch.Size([1, 28, 28])
Test sample label: 9 (Ankle boot)</code></pre>
</div>
</div>
</section>
<section id="–ø—Ä–æ–≥–Ω–æ–∑-–∑–∞-–∫—Ä–∞—â–æ—é-–º–æ–¥–µ–ª–ª—é-33" class="slide level2 smaller scrollable">
<h2>–ü—Ä–æ–≥–Ω–æ–∑ –∑–∞ –∫—Ä–∞—â–æ—é –º–æ–¥–µ–ª–ª—é 3/3</h2>
<div id="6e2ae39c" class="cell columns column-output-location" data-execution_count="37">
<div class="column">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href=""></a>pred_probs<span class="op">=</span> make_predictions(model<span class="op">=</span>model_2, </span>
<span id="cb56-2"><a href=""></a>                             data<span class="op">=</span>test_samples)</span>
<span id="cb56-3"><a href=""></a></span>
<span id="cb56-4"><a href=""></a>pred_classes <span class="op">=</span> pred_probs.argmax(dim<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb56-5"><a href=""></a></span>
<span id="cb56-6"><a href=""></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">9</span>, <span class="dv">9</span>))</span>
<span id="cb56-7"><a href=""></a>nrows <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb56-8"><a href=""></a>ncols <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb56-9"><a href=""></a><span class="cf">for</span> i, sample <span class="kw">in</span> <span class="bu">enumerate</span>(test_samples):</span>
<span id="cb56-10"><a href=""></a>  <span class="co"># Create a subplot</span></span>
<span id="cb56-11"><a href=""></a>  plt.subplot(nrows, ncols, i<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb56-12"><a href=""></a></span>
<span id="cb56-13"><a href=""></a>  <span class="co"># Plot the target image</span></span>
<span id="cb56-14"><a href=""></a>  plt.imshow(sample.squeeze(), cmap<span class="op">=</span><span class="st">"gray"</span>)</span>
<span id="cb56-15"><a href=""></a></span>
<span id="cb56-16"><a href=""></a>  <span class="co"># Find the prediction label (in text form, e.g. "Sandal")</span></span>
<span id="cb56-17"><a href=""></a>  pred_label <span class="op">=</span> class_names[pred_classes[i]]</span>
<span id="cb56-18"><a href=""></a></span>
<span id="cb56-19"><a href=""></a>  <span class="co"># Get the truth label (in text form, e.g. "T-shirt")</span></span>
<span id="cb56-20"><a href=""></a>  truth_label <span class="op">=</span> class_names[test_labels[i]] </span>
<span id="cb56-21"><a href=""></a></span>
<span id="cb56-22"><a href=""></a>  <span class="co"># Create the title text of the plot</span></span>
<span id="cb56-23"><a href=""></a>  title_text <span class="op">=</span> <span class="ss">f"Pred: </span><span class="sc">{</span>pred_label<span class="sc">}</span><span class="ss"> | Truth: </span><span class="sc">{</span>truth_label<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb56-24"><a href=""></a>  </span>
<span id="cb56-25"><a href=""></a>  <span class="co"># Check for equality and change title colour accordingly</span></span>
<span id="cb56-26"><a href=""></a>  <span class="cf">if</span> pred_label <span class="op">==</span> truth_label:</span>
<span id="cb56-27"><a href=""></a>      plt.title(title_text, fontsize<span class="op">=</span><span class="dv">10</span>, c<span class="op">=</span><span class="st">"g"</span>) <span class="co"># green text if correct</span></span>
<span id="cb56-28"><a href=""></a>  <span class="cf">else</span>:</span>
<span id="cb56-29"><a href=""></a>      plt.title(title_text, fontsize<span class="op">=</span><span class="dv">10</span>, c<span class="op">=</span><span class="st">"r"</span>) <span class="co"># red text if wrong</span></span>
<span id="cb56-30"><a href=""></a>  plt.axis(<span class="va">False</span>)<span class="op">;</span></span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src=".03_files/figure-revealjs/cell-38-output-1.svg"></p>
</figure>
</div>
</div>
</div></div>
</section>
<section id="–º–∞—Ç—Ä–∏—Ü—è-–Ω–µ–≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ" class="slide level2 smaller">
<h2>–ú–∞—Ç—Ä–∏—Ü—è –Ω–µ–≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ</h2>
<ul>
<li>–û—Ç—Ä–∏–º–∞—î–º–æ –≤—Å—ñ –ø—Ä–æ–≥–Ω–æ–∑–∏ –¥–ª—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –Ω–∞–±–æ—Ä—É –¥–∞–Ω–∏—Ö.</li>
</ul>
<div id="f0af4a33" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href=""></a><span class="im">from</span> tqdm.auto <span class="im">import</span> tqdm</span>
<span id="cb57-2"><a href=""></a></span>
<span id="cb57-3"><a href=""></a>y_preds <span class="op">=</span> []</span>
<span id="cb57-4"><a href=""></a>model_2.<span class="bu">eval</span>()</span>
<span id="cb57-5"><a href=""></a><span class="cf">with</span> torch.inference_mode():</span>
<span id="cb57-6"><a href=""></a>  <span class="cf">for</span> X, y <span class="kw">in</span> tqdm(test_dataloader, desc<span class="op">=</span><span class="st">"Making predictions"</span>):</span>
<span id="cb57-7"><a href=""></a>    X, y <span class="op">=</span> X.to(device), y.to(device)</span>
<span id="cb57-8"><a href=""></a>    y_logit <span class="op">=</span> model_2(X)</span>
<span id="cb57-9"><a href=""></a>    y_pred <span class="op">=</span> torch.softmax(y_logit, dim<span class="op">=</span><span class="dv">1</span>).argmax(dim<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb57-10"><a href=""></a>    y_preds.append(y_pred.cpu())</span>
<span id="cb57-11"><a href=""></a>y_pred_tensor <span class="op">=</span> torch.cat(y_preds)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"6948f747140e468a8c48ba4f248f7a57","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
</div>
</section>
<section id="–º–∞—Ç—Ä–∏—Ü—è-–Ω–µ–≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ-1" class="slide level2">
<h2>–ú–∞—Ç—Ä–∏—Ü—è –Ω–µ–≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ</h2>
<ul>
<li>–í–∏–∫–æ—Ä–∏—Å—Ç–∞—î–º–æ <code>torchmetrics</code> –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –º–∞—Ç—Ä–∏—Ü—ñ –Ω–µ–≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ (confusion matrix).</li>
</ul>
<div id="cad153a8" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href=""></a><span class="cf">try</span>:</span>
<span id="cb58-2"><a href=""></a>    <span class="im">import</span> torchmetrics, mlxtend</span>
<span id="cb58-3"><a href=""></a>    <span class="bu">print</span>(<span class="ss">f"mlxtend version: </span><span class="sc">{</span>mlxtend<span class="sc">.</span>__version__<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb58-4"><a href=""></a>    <span class="cf">assert</span> <span class="bu">int</span>(mlxtend.__version__.split(<span class="st">"."</span>)[<span class="dv">1</span>]) <span class="op">&gt;=</span> <span class="dv">19</span>, <span class="st">"mlxtend verison should be 0.19.0 or higher"</span></span>
<span id="cb58-5"><a href=""></a><span class="cf">except</span>:</span>
<span id="cb58-6"><a href=""></a>    <span class="op">!</span>pip install <span class="op">-</span>q torchmetrics <span class="op">-</span>U mlxtend </span>
<span id="cb58-7"><a href=""></a>    <span class="im">import</span> torchmetrics, mlxtend</span>
<span id="cb58-8"><a href=""></a>    <span class="bu">print</span>(<span class="ss">f"mlxtend version: </span><span class="sc">{</span>mlxtend<span class="sc">.</span>__version__<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>mlxtend version: 0.23.4</code></pre>
</div>
</div>
</section>
<section id="–º–∞—Ç—Ä–∏—Ü—è-–Ω–µ–≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ-2" class="slide level2">
<h2>–ú–∞—Ç—Ä–∏—Ü—è –Ω–µ–≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ</h2>
<div id="e3b23904" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href=""></a><span class="im">import</span> mlxtend </span>
<span id="cb60-2"><a href=""></a><span class="bu">print</span>(mlxtend.__version__)</span>
<span id="cb60-3"><a href=""></a><span class="cf">assert</span> <span class="bu">int</span>(mlxtend.__version__.split(<span class="st">"."</span>)[<span class="dv">1</span>]) <span class="op">&gt;=</span> <span class="dv">19</span> </span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.23.4</code></pre>
</div>
</div>
</section>
<section id="–º–∞—Ç—Ä–∏—Ü—è-–Ω–µ–≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ-3" class="slide level2">
<h2>–ú–∞—Ç—Ä–∏—Ü—è –Ω–µ–≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ</h2>
<div id="de5affdb" class="cell columns column-output-location" data-execution_count="41">
<div class="column">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href=""></a><span class="im">from</span> torchmetrics <span class="im">import</span> ConfusionMatrix</span>
<span id="cb62-2"><a href=""></a><span class="im">from</span> mlxtend.plotting <span class="im">import</span> plot_confusion_matrix</span>
<span id="cb62-3"><a href=""></a></span>
<span id="cb62-4"><a href=""></a>confmat <span class="op">=</span> ConfusionMatrix(num_classes<span class="op">=</span><span class="bu">len</span>(class_names), task<span class="op">=</span><span class="st">'multiclass'</span>)</span>
<span id="cb62-5"><a href=""></a>confmat_tensor <span class="op">=</span> confmat(preds<span class="op">=</span>y_pred_tensor,</span>
<span id="cb62-6"><a href=""></a>                         target<span class="op">=</span>test_data.targets)</span>
<span id="cb62-7"><a href=""></a></span>
<span id="cb62-8"><a href=""></a>fig, ax <span class="op">=</span> plot_confusion_matrix(</span>
<span id="cb62-9"><a href=""></a>    conf_mat<span class="op">=</span>confmat_tensor.numpy(),</span>
<span id="cb62-10"><a href=""></a>    class_names<span class="op">=</span>class_names,</span>
<span id="cb62-11"><a href=""></a>    figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">7</span>)</span>
<span id="cb62-12"><a href=""></a>)<span class="op">;</span></span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src=".03_files/figure-revealjs/cell-42-output-1.svg"></p>
</figure>
</div>
</div>
</div></div>
</section>
<section id="–∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è-–º–æ–¥–µ–ª—ñ" class="slide level2 tiny">
<h2>–ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –º–æ–¥–µ–ª—ñ</h2>
<div id="135aaab0" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href=""></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb63-2"><a href=""></a></span>
<span id="cb63-3"><a href=""></a>MODEL_PATH <span class="op">=</span> Path(<span class="st">"models"</span>)</span>
<span id="cb63-4"><a href=""></a>MODEL_PATH.mkdir(parents<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb63-5"><a href=""></a>                 exist_ok<span class="op">=</span><span class="va">True</span></span>
<span id="cb63-6"><a href=""></a>)</span>
<span id="cb63-7"><a href=""></a></span>
<span id="cb63-8"><a href=""></a>MODEL_NAME <span class="op">=</span> <span class="st">"03_pytorch_computer_vision_model_2.pth"</span></span>
<span id="cb63-9"><a href=""></a>MODEL_SAVE_PATH <span class="op">=</span> MODEL_PATH <span class="op">/</span> MODEL_NAME</span>
<span id="cb63-10"><a href=""></a></span>
<span id="cb63-11"><a href=""></a><span class="bu">print</span>(<span class="ss">f"Saving model to: </span><span class="sc">{</span>MODEL_SAVE_PATH<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb63-12"><a href=""></a>torch.save(obj<span class="op">=</span>model_2.state_dict(),</span>
<span id="cb63-13"><a href=""></a>           f<span class="op">=</span>MODEL_SAVE_PATH)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Saving model to: models\03_pytorch_computer_vision_model_2.pth</code></pre>
</div>
</div>
</section>
<section id="–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è-–º–æ–¥–µ–ª—ñ" class="slide level2 tiny">
<h2>–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –º–æ–¥–µ–ª—ñ</h2>
<div id="684beaef" class="cell columns column-output-location" data-execution_count="43">
<div class="column">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href=""></a>loaded_model_2 <span class="op">=</span> FashionMNISTModelV2(input_shape<span class="op">=</span><span class="dv">1</span>, </span>
<span id="cb65-2"><a href=""></a>                                    hidden_units<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb65-3"><a href=""></a>                                    output_shape<span class="op">=</span><span class="dv">10</span>) </span>
<span id="cb65-4"><a href=""></a></span>
<span id="cb65-5"><a href=""></a>loaded_model_2.load_state_dict(torch.load(f<span class="op">=</span>MODEL_SAVE_PATH))</span>
<span id="cb65-6"><a href=""></a></span>
<span id="cb65-7"><a href=""></a>loaded_model_2 <span class="op">=</span> loaded_model_2.to(device)</span>
<span id="cb65-8"><a href=""></a></span>
<span id="cb65-9"><a href=""></a>torch.manual_seed(<span class="dv">73</span>)</span>
<span id="cb65-10"><a href=""></a></span>
<span id="cb65-11"><a href=""></a>loaded_model_2_results <span class="op">=</span> eval_model(</span>
<span id="cb65-12"><a href=""></a>    model<span class="op">=</span>loaded_model_2,</span>
<span id="cb65-13"><a href=""></a>    data_loader<span class="op">=</span>test_dataloader,</span>
<span id="cb65-14"><a href=""></a>    loss_fn<span class="op">=</span>loss_fn, </span>
<span id="cb65-15"><a href=""></a>    accuracy_fn<span class="op">=</span>accuracy_fn</span>
<span id="cb65-16"><a href=""></a>)</span>
<span id="cb65-17"><a href=""></a></span>
<span id="cb65-18"><a href=""></a>loaded_model_2_results</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>{'model_name': 'FashionMNISTModelV2',
 'model_loss': 0.32745975255966187,
 'model_acc': 88.02915335463258}</code></pre>
</div>
</div></div>
</section>
<section id="–¥—è–∫—É—é-–∑–∞-—É–≤–∞–≥—É" class="title-slide slide level1 unnumbered unlisted center" data-background-iframe=".03_files/libs/colored-particles/index.html">
<h1>–î—è–∫—É—é –∑–∞ —É–≤–∞–≥—É!</h1>
<p><br> <br></p>
<p><iconify-icon inline="" icon="solar:book-bold"></iconify-icon> <a href="https://aranaur.rbind.io/lectures/">–ú–∞—Ç–µ—Ä—ñ–∞–ª–∏ –∫—É—Ä—Å—É</a></p>
<p><iconify-icon inline="" icon="mdi:envelope"></iconify-icon> ihor.miroshnychenko@knu.ua</p>
<p><iconify-icon inline="" icon="ic:baseline-telegram"></iconify-icon> <a href="https://t.me/araprof">Data Mirosh</a></p>
<p><iconify-icon inline="" icon="mdi:linkedin"></iconify-icon> <a href="https://www.linkedin.com/in/ihormiroshnychenko/">@ihormiroshnychenko</a></p>
<p><iconify-icon inline="" icon="mdi:github"></iconify-icon> <a href="https://github.com/Aranaur">@aranaur</a></p>
<p><iconify-icon inline="" icon="ion:home"></iconify-icon> <a href="https://aranaur.rbind.io">aranaur.rbind.io</a></p>

</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="fit.png" class="slide-logo"></p>
<div class="footer footer-default">
<p><a href="https://aranaur.rbind.io/lectures">üîó–¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó –∫–æ–º–ø‚Äô—é—Ç–µ—Ä–Ω–æ–≥–æ –∑–æ—Ä—É</a></p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src=".03_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src=".03_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src=".03_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src=".03_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src=".03_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src=".03_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src=".03_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src=".03_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src=".03_files/libs/revealjs/plugin/search/search.js"></script>
  <script src=".03_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src=".03_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: true,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: true,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1350,

        height: 759.375,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script type="application/vnd.jupyter.widget-state+json">
    {"state":{"0062089dbfde4b67b12e91b0cd39a889":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"01e717ed0d2441a2b53d40ce029b70bb":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HTMLView","description":"","description_allow_html":false,"layout":"IPY_MODEL_26e37c695f9944329c398f8337bd600e","placeholder":"‚Äã","style":"IPY_MODEL_dd05b514720c4d7989634967c76f31ba","tabbable":null,"tooltip":null,"value":" 3/3 [00:20&lt;00:00,  6.88s/it]"}},"05ecd812dcc149b69ab6bc32bfd7d0b8":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0ea8085e0bcd44ed87ee1623924ea183":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HTMLView","description":"","description_allow_html":false,"layout":"IPY_MODEL_1d5531e7defd46f19bf33ff72901b4ba","placeholder":"‚Äã","style":"IPY_MODEL_a5caf135b5cb4232864b539f2f27f6dc","tabbable":null,"tooltip":null,"value":" 313/313 [00:00&lt;00:00, 425.28it/s]"}},"13a6191d1d3b4e6bacc1188e49aa270d":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1d5531e7defd46f19bf33ff72901b4ba":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"21635f6bffb94c5aa9495e07babf7c6d":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"26e37c695f9944329c398f8337bd600e":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"271a893174c548ce8589752794c6c351":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"274a77bb17b643dc9f5c1d2956524ce9":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"38a0b8532023431b9db12ed09bb25552":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"3a82d9168493413d937a62c3a5d69fc0":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"ProgressView","bar_style":"success","description":"","description_allow_html":false,"layout":"IPY_MODEL_d7d574e5c2cd429ab79590f80feab323","max":3,"min":0,"orientation":"horizontal","style":"IPY_MODEL_70c2f96989f348f0bfd6359d733aff12","tabbable":null,"tooltip":null,"value":3}},"451ca817ca3045f09767c1f06e445f27":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"47c217a74bea4364b28debffb05bfdc7":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_913bb0a613fe4e75bbe3597b605dcad5","IPY_MODEL_57f9c565688646169f65a4e31d283e04","IPY_MODEL_c24c9a4237f74bce8b50a55348cb5fe4"],"layout":"IPY_MODEL_8a1a7afdba6d4a2fa3ff554e5a0ddea5","tabbable":null,"tooltip":null}},"4ea815b59851491c9b6749ba63bd7ad8":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"51bd389ae45c407e839a11feb50213fb":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"55aaf8eb7421447ba8df896736da9670":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"57f9c565688646169f65a4e31d283e04":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"ProgressView","bar_style":"success","description":"","description_allow_html":false,"layout":"IPY_MODEL_649b0508dd54482b9c290c6eb1bcfad1","max":3,"min":0,"orientation":"horizontal","style":"IPY_MODEL_dbd44045111547edb500a113a42b8c1c","tabbable":null,"tooltip":null,"value":3}},"649b0508dd54482b9c290c6eb1bcfad1":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6948f747140e468a8c48ba4f248f7a57":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_ef88d3b708ae4e63bbe3bc7592156d79","IPY_MODEL_d6f8bd51b0ff414389ef98fdcd8adafa","IPY_MODEL_0ea8085e0bcd44ed87ee1623924ea183"],"layout":"IPY_MODEL_bfdc8cd67e4b4f7bb2e9b3e94b24e3c4","tabbable":null,"tooltip":null}},"70c2f96989f348f0bfd6359d733aff12":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"7caddb2230f64184ae7962f2acf4fdcc":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8a1a7afdba6d4a2fa3ff554e5a0ddea5":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8f777fa3dea8454aa0d792746dd8eadc":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HTMLView","description":"","description_allow_html":false,"layout":"IPY_MODEL_451ca817ca3045f09767c1f06e445f27","placeholder":"‚Äã","style":"IPY_MODEL_b4454ee877034720a3398ec477ac93ec","tabbable":null,"tooltip":null,"value":"100%"}},"913bb0a613fe4e75bbe3597b605dcad5":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HTMLView","description":"","description_allow_html":false,"layout":"IPY_MODEL_13a6191d1d3b4e6bacc1188e49aa270d","placeholder":"‚Äã","style":"IPY_MODEL_271a893174c548ce8589752794c6c351","tabbable":null,"tooltip":null,"value":"100%"}},"9d06a49e7c974ea2bd84c0f18fc88d74":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"ProgressView","bar_style":"success","description":"","description_allow_html":false,"layout":"IPY_MODEL_21635f6bffb94c5aa9495e07babf7c6d","max":3,"min":0,"orientation":"horizontal","style":"IPY_MODEL_38a0b8532023431b9db12ed09bb25552","tabbable":null,"tooltip":null,"value":3}},"9d869fd355184405b6bea8607a12327b":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9e422a0e8f8c486e858b318ea6f79cf6":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"a5caf135b5cb4232864b539f2f27f6dc":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"acee3e6ebd9b4aefb5d21c4c7d2f2186":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_8f777fa3dea8454aa0d792746dd8eadc","IPY_MODEL_9d06a49e7c974ea2bd84c0f18fc88d74","IPY_MODEL_01e717ed0d2441a2b53d40ce029b70bb"],"layout":"IPY_MODEL_9d869fd355184405b6bea8607a12327b","tabbable":null,"tooltip":null}},"b4454ee877034720a3398ec477ac93ec":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"bb9f55109f004745ba3ecdc4a5ca77da":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"bde3085ed0384d8d9ecdb6584932f426":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"bfdc8cd67e4b4f7bb2e9b3e94b24e3c4":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c24c9a4237f74bce8b50a55348cb5fe4":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HTMLView","description":"","description_allow_html":false,"layout":"IPY_MODEL_7caddb2230f64184ae7962f2acf4fdcc","placeholder":"‚Äã","style":"IPY_MODEL_55aaf8eb7421447ba8df896736da9670","tabbable":null,"tooltip":null,"value":" 3/3 [00:19&lt;00:00,  6.60s/it]"}},"d6f8bd51b0ff414389ef98fdcd8adafa":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"ProgressView","bar_style":"success","description":"","description_allow_html":false,"layout":"IPY_MODEL_0062089dbfde4b67b12e91b0cd39a889","max":313,"min":0,"orientation":"horizontal","style":"IPY_MODEL_ed1a78401a194eed85b005c4ff7ba64e","tabbable":null,"tooltip":null,"value":313}},"d7d574e5c2cd429ab79590f80feab323":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d9adf5ab0aa84330ac748796f44b4016":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HTMLView","description":"","description_allow_html":false,"layout":"IPY_MODEL_bb9f55109f004745ba3ecdc4a5ca77da","placeholder":"‚Äã","style":"IPY_MODEL_51bd389ae45c407e839a11feb50213fb","tabbable":null,"tooltip":null,"value":"100%"}},"dac9874a97dc47169f674c92a8a9589a":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_d9adf5ab0aa84330ac748796f44b4016","IPY_MODEL_3a82d9168493413d937a62c3a5d69fc0","IPY_MODEL_ea6d979fd73c4f69a87a49fbf0460845"],"layout":"IPY_MODEL_274a77bb17b643dc9f5c1d2956524ce9","tabbable":null,"tooltip":null}},"dbd44045111547edb500a113a42b8c1c":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"dd05b514720c4d7989634967c76f31ba":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"ea6d979fd73c4f69a87a49fbf0460845":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HTMLView","description":"","description_allow_html":false,"layout":"IPY_MODEL_4ea815b59851491c9b6749ba63bd7ad8","placeholder":"‚Äã","style":"IPY_MODEL_bde3085ed0384d8d9ecdb6584932f426","tabbable":null,"tooltip":null,"value":" 3/3 [00:12&lt;00:00,  4.04s/it]"}},"ed1a78401a194eed85b005c4ff7ba64e":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"ef88d3b708ae4e63bbe3bc7592156d79":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HTMLView","description":"","description_allow_html":false,"layout":"IPY_MODEL_05ecd812dcc149b69ab6bc32bfd7d0b8","placeholder":"‚Äã","style":"IPY_MODEL_9e422a0e8f8c486e858b318ea6f79cf6","tabbable":null,"tooltip":null,"value":"Making predictions: 100%"}}},"version_major":2,"version_minor":0}
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "–°–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "–°–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>