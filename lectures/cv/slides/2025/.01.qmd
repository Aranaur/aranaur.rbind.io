---
title: "–û—Å–Ω–æ–≤–∏ üî•PyTorch"
subtitle: "–¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó –∫–æ–º–ø'—é—Ç–µ—Ä–Ω–æ–≥–æ –∑–æ—Ä—É"
author: "–Ü–≥–æ—Ä –ú—ñ—Ä–æ—à–Ω–∏—á–µ–Ω–∫–æ"
institute: –ö–ù–£ —ñ–º–µ–Ω—ñ –¢–∞—Ä–∞—Å–∞ –®–µ–≤—á–µ–Ω–∫–∞, –§–Ü–¢
from: markdown+emoji
title-slide-attributes:
    data-background-iframe: .01_files/libs/colored-particles/index.html
language: _language-ua.yml
footer: <a href="https://aranaur.rbind.io/lectures">üîó–¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó –∫–æ–º–ø'—é—Ç–µ—Ä–Ω–æ–≥–æ –∑–æ—Ä—É</a>
format:
  revealjs: 
    transition: fade
    chalkboard: true
    logo: fit.png
    slide-number: true
    # toc: true
    # toc-depth: 1
    mouse-wheel: true
    width: 1350  
    height: 759.375
    highlight-style: github
    fig-width: 9
    fig-height: 5
    fig-format: svg
    fig-align: center
    theme: [default, custom.scss]
#   gfm:
#     mermaid-format: png
preload-iframes: true
jupyter: python3
execute: 
  echo: true
  warning: false
editor_options: 
  chunk_output_type: console
---

# –í—Å—Ç—É–ø

## –©–æ —Ç–∞–∫–µ PyTorch? {.smaller}

- –û–¥–∏–Ω –∑ –Ω–∞–π–±—ñ–ª—å—à –ø–æ–ø—É–ª—è—Ä–Ω–∏—Ö —Ñ—Ä–µ–π–º–≤–æ—Ä–∫—ñ–≤ –¥–ª—è –≥–ª–∏–±–æ–∫–æ–≥–æ –Ω–∞–≤—á–∞–Ω–Ω—è, —Ä–æ–∑—Ä–æ–±–ª–µ–Ω–∏–π Facebook (Meta).
- User-friendly –∫–æ–¥ –¥–ª—è –≥–ª–∏–±–æ–∫–æ–≥–æ –Ω–∞–≤—á–∞–Ω–Ω—è –Ω–∞ Python (–∑ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—é –∑–∞–ø—É—Å–∫—É –Ω–∞ GPU/GPUs)
- –î–æ—Å—Ç—É–ø –¥–æ –±–∞–≥–∞—Ç—å–æ—Ö –≥–æ—Ç–æ–≤–∏—Ö –º–æ–¥–µ–ª–µ–π –≥–ª–∏–±–æ–∫–æ–≥–æ –Ω–∞–≤—á–∞–Ω–Ω—è (Torch Hub/[torchvision.models](https://docs.pytorch.org/vision/stable/models.html))
- –ü–æ–≤–Ω–∏–π —Å—Ç–µ–∫: –ø–æ–ø–µ—Ä–µ–¥–Ω—è –æ–±—Ä–æ–±–∫–∞ –¥–∞–Ω–∏—Ö, –º–æ–¥–µ–ª—é–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö, —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è –º–æ–¥–µ–ª—ñ —É –≤–∞—à—ñ–π –ø—Ä–æ–≥—Ä–∞–º—ñ/—Ö–º–∞—Ä—ñ
- –°–ø–æ—á–∞—Ç–∫—É —Ä–æ–∑—Ä–æ–±–ª–µ–Ω–∏–π —ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–Ω–∏–π –≤–Ω—É—Ç—Ä—ñ—à–Ω—å–æ –∫–æ–º–ø–∞–Ω—ñ—î—é Facebook/Meta (–∑–∞—Ä–∞–∑ —î –≤—ñ–¥–∫—Ä–∏—Ç–∏–º –∫–æ–¥–æ–º —ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —Ç–∞–∫–∏–º–∏ –∫–æ–º–ø–∞–Ω—ñ—è–º–∏, —è–∫ Tesla, Microsoft, OpenAI)

## –ß–æ–º—É PyTorch?

![](img/pytorch_members.png)

## –©–æ —Ç–∞–∫–µ GPU/TPU? {.smaller}

::: {.columns}
::: {.column}
![](img/GPU.jpg){width="70%"}

GPU (Graphics Processing Unit)
:::
::: {.column}
![](img/TPU.jpg){width="70%"}

TPU (Tensor Processing Unit)
:::
:::

![](img/CUDA.jpg)

## –©–æ —Ç–∞–∫–µ —Ç–µ–Ω–∑–æ—Ä? 1/2

![](img/tensor.jpg)

## –©–æ —Ç–∞–∫–µ —Ç–µ–Ω–∑–æ—Ä? 2/2

![](img/tensor2.jpg)

# –í—Å—Ç—É–ø –¥–æ üî•PyTorch

## –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è üî•PyTorch

- –í—ñ–¥–≤—ñ–¥–∞–π—Ç–µ [—Å–∞–π—Ç PyTorch: Get Started](https://pytorch.org/get-started/locally/) –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ–π —â–æ–¥–æ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è.
- –í–∏–±–µ—Ä—ñ—Ç—å –≤–∞—à—É –æ–ø–µ—Ä–∞—Ü—ñ–π–Ω—É —Å–∏—Å—Ç–µ–º—É, –ø–∞–∫–µ—Ç–Ω–∏–π –º–µ–Ω–µ–¥–∂–µ—Ä —Ç–∞ –≤–µ—Ä—Å—ñ—é CUDA (—è–∫—â–æ –≤–∏ –ø–ª–∞–Ω—É—î—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ GPU).
- –°–∫–æ–ø—ñ—é–π—Ç–µ –∫–æ–º–∞–Ω–¥—É –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–∞ –≤–∏–∫–æ–Ω–∞–π—Ç–µ —ó—ó —É –≤–∞—à–æ–º—É —Ç–µ—Ä–º—ñ–Ω–∞–ª—ñ.

```bash
pip3 install torch torchvision --index-url https://download.pytorch.org/whl/cu126
```

## –Ü–º–ø–æ—Ä—Ç PyTorch

```{python}
import torch

print(torch.__version__)
print(torch.cuda.is_available())
```

## –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–µ–Ω–∑–æ—Ä–∞: —Å–∫–∞–ª—è—Ä

–°–∫–∞–ª—è—Ä --- —Ü–µ –æ–¥–Ω–µ —á–∏—Å–ª–æ, –∞ –≤ —Ç–µ—Ä–º—ñ–Ω–æ–ª–æ–≥—ñ—ó —Ç–µ–Ω–∑–æ—Ä—ñ–≤ --- —Ü–µ —Ç–µ–Ω–∑–æ—Ä –Ω—É–ª—å–æ–≤–æ–≥–æ —Ä–∞–Ω–≥—É.

```{python}
scalar = torch.tensor(7)
print(scalar)
print(f'–†–∞–Ω–≥ —Ç–µ–Ω–∑–æ—Ä–∞: {scalar.ndim}')
print(f'–ó–Ω–∞—á–µ–Ω–Ω—è —Ç–µ–Ω–∑–æ—Ä–∞: {scalar.item()}')
```

## –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–µ–Ω–∑–æ—Ä–∞: –≤–µ–∫—Ç–æ—Ä

–í–µ–∫—Ç–æ—Ä --- —Ü–µ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å —á–∏—Å–µ–ª, –∞ –≤ —Ç–µ—Ä–º—ñ–Ω–æ–ª–æ–≥—ñ—ó —Ç–µ–Ω–∑–æ—Ä—ñ–≤ --- —Ü–µ —Ç–µ–Ω–∑–æ—Ä –ø–µ—Ä—à–æ–≥–æ —Ä–∞–Ω–≥—É.

```{python}
vector = torch.tensor([1, 2, 3])
print(vector)
print(f'–†–∞–Ω–≥ —Ç–µ–Ω–∑–æ—Ä–∞: {vector.ndim}')
print(f'–†–æ–∑–º—ñ—Ä —Ç–µ–Ω–∑–æ—Ä–∞: {vector.shape}')
```

::: {.callout-note icon="false" appearance="simple"}
–†–∞–Ω–≥ —Ç–µ–Ω–∑–æ—Ä–∞ –º–æ–∂–Ω–∞ –≤–∏–∑–Ω–∞—á–∏—Ç–∏ –∑–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—é –¥—É–∂–æ–∫ `[`
:::

## –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–µ–Ω–∑–æ—Ä–∞: –º–∞—Ç—Ä–∏—Ü—è

–ú–∞—Ç—Ä–∏—Ü—è --- —Ü–µ —Ç–∞–±–ª–∏—Ü—è —á–∏—Å–µ–ª, –∞ –≤ —Ç–µ—Ä–º—ñ–Ω–æ–ª–æ–≥—ñ—ó —Ç–µ–Ω–∑–æ—Ä—ñ–≤ --- —Ü–µ —Ç–µ–Ω–∑–æ—Ä –¥—Ä—É–≥–æ–≥–æ —Ä–∞–Ω–≥—É.

```{python}
matrix = torch.tensor([[1, 2, 3],
                       [4, 5, 6]])
print(matrix)
print(f'–†–∞–Ω–≥ —Ç–µ–Ω–∑–æ—Ä–∞: {matrix.ndim}')
print(f'–†–æ–∑–º—ñ—Ä —Ç–µ–Ω–∑–æ—Ä–∞: {matrix.shape}')
```

## –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–µ–Ω–∑–æ—Ä–∞: —Ç–µ–Ω–∑–æ—Ä üòÖ

```{python}
tensor = torch.tensor([[[1, 2], [3, 4]], [[5, 6], [7, 8]]])
print(tensor)
print(f'–†–∞–Ω–≥ —Ç–µ–Ω–∑–æ—Ä–∞: {tensor.ndim}')
print(f'–†–æ–∑–º—ñ—Ä —Ç–µ–Ω–∑–æ—Ä–∞: {tensor.shape}')
```

---

![](img/00-scalar-vector-matrix-tensor.png)

## –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –≤–∏–ø–∞–¥–∫–æ–≤–∏—Ö –≤–µ–ª–∏—á–∏–Ω

–¢–µ–Ω–∑–æ—Ä–∏ –º–æ–∂—É—Ç—å –±—É—Ç–∏ —Å—Ç–≤–æ—Ä–µ–Ω—ñ –∑ –≤–∏–ø–∞–¥–∫–æ–≤–∏–º–∏ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ñ—É–Ω–∫—Ü—ñ—ó `torch.rand` (—Ä—ñ–≤–Ω–æ–º—ñ—Ä–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª) –∞–±–æ `torch.randn` (–Ω–æ—Ä–º–∞–ª—å–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª) –∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º `size`.

```{python}
torch.manual_seed(73)
random_tensor = torch.rand(2, 3, 2)
print(random_tensor)
```

## –ù—É–ª—å–æ–≤–∏–π —Ç–∞ –æ–¥–∏–Ω–∏—á–Ω–∏–π —Ç–µ–Ω–∑–æ—Ä

```{python}
#| output-location: column
zeros = torch.zeros(size=(3, 4))
zeros, zeros.dtype
```

<br>

```{python}
#| output-location: column
ones = torch.ones(size=(3, 4))
ones, ones.dtype
```

## –ü–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å

`torch.arange(start, end, step)`

```{python}
range_tensor = torch.arange(0, 10, 2)
range_tensor, range_tensor.dtype
```

::: {.callout-note icon="false" appearance="simple"}
`torch.range()` —î –∑–∞—Å—Ç–∞—Ä—ñ–ª–∏–º –≤–∞—Ä—ñ–∞–Ω—Ç–æ–º
:::

---

–Ü–Ω–æ–¥—ñ –º–æ–∂–µ –∑–Ω–∞–¥–æ–±–∏—Ç–∏—Å—è –æ–¥–∏–Ω —Ç–µ–Ω–∑–æ—Ä –ø–µ–≤–Ω–æ–≥–æ —Ç–∏–ø—É –∑ —Ç–∞–∫–æ—é —Å–∞–º–æ—é —Ñ–æ—Ä–º–æ—é, —è–∫ —ñ–Ω—à–∏–π —Ç–µ–Ω–∑–æ—Ä.

```{python}
torch.zeros_like(range_tensor), torch.ones_like(range_tensor)
```

## –¢–∏–ø–∏ –¥–∞–Ω–∏—Ö {.smaller}

–£ PyTorch –¥–æ—Å—Ç—É–ø–Ω–æ –±–∞–≥–∞—Ç–æ —Ä—ñ–∑–Ω–∏—Ö [—Ç–∏–ø—ñ–≤ –¥–∞–Ω–∏—Ö —Ç–µ–Ω–∑–æ—Ä–∞](https://docs.pytorch.org/docs/stable/tensors.html#data-types).

::: {.columns}
::: {.column width="40%"}
**–ù–∞–π–ø–æ–ø—É–ª—è—Ä–Ω—ñ—à—ñ:**

- `torch.float32`: –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –¥–ª—è —á–∏—Å–µ–ª –∑ –ø–ª–∞–≤–∞—é—á–æ—é –∫–æ–º–æ—é
- `torch.float64`: –ø–æ–¥–≤–æ—î–Ω–∞ —Ç–æ—á–Ω—ñ—Å—Ç—å
- `torch.float16`: –Ω–∞–ø—ñ–≤—Ç–æ—á–Ω—ñ—Å—Ç—å
- `torch.int64`: —Ü—ñ–ª—ñ —á–∏—Å–ª–∞
- `torch.uint8`: –±–µ–∑–∑–Ω–∞–∫–æ–≤—ñ —Ü—ñ–ª—ñ —á–∏—Å–ª–∞
:::
::: {.column}

- `dtype`: —Ç–∏–ø –¥–∞–Ω–∏—Ö —Ç–µ–Ω–∑–æ—Ä–∞
- `device`: –ø—Ä–∏—Å—Ç—Ä—ñ–π, –Ω–∞ —è–∫–æ–º—É —Ä–æ–∑–º—ñ—â–µ–Ω–æ —Ç–µ–Ω–∑–æ—Ä
- `requires_grad`: —á–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤—ñ–¥—Å—Ç–µ–∂—É–≤–∞—Ç–∏ –≥—Ä–∞–¥—ñ—î–Ω—Ç–∏ –¥–ª—è —Ü—å–æ–≥–æ —Ç–µ–Ω–∑–æ—Ä–∞

```{python}
float_32_tensor = torch.tensor([3.0, 6.0, 9.0],
                               dtype=None,
                               device="cuda" if torch.cuda.is_available() else "cpu",
                               requires_grad=False)

float_32_tensor.shape, float_32_tensor.dtype, float_32_tensor.device
```
:::
:::

## –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ —Ç–µ–Ω–∑–æ—Ä {.smaller}

::: {.columns}
::: {.column width="40%"}
- `shape`: —Ñ–æ—Ä–º–∞ —Ç–µ–Ω–∑–æ—Ä–∞
- `dtype`: —Ç–∏–ø –¥–∞–Ω–∏—Ö —Ç–µ–Ω–∑–æ—Ä–∞
- `device`: –ø—Ä–∏—Å—Ç—Ä—ñ–π, –Ω–∞ —è–∫–æ–º—É —Ä–æ–∑–º—ñ—â–µ–Ω–æ —Ç–µ–Ω–∑–æ—Ä
- `requires_grad`: —á–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤—ñ–¥—Å—Ç–µ–∂—É–≤–∞—Ç–∏ –≥—Ä–∞–¥—ñ—î–Ω—Ç–∏ –¥–ª—è —Ü—å–æ–≥–æ —Ç–µ–Ω–∑–æ—Ä–∞
:::
::: {.column}
```{python}
torch.manual_seed(73)
torch.set_default_device("cuda" if torch.cuda.is_available() else "cpu")

some_tensor = torch.rand(3, 4)

print(some_tensor)
print(f"–§–æ—Ä–º–∞ —Ç–µ–Ω–∑–æ—Ä–∞: {some_tensor.shape}")
print(f"–¢–∏–ø –¥–∞–Ω–∏—Ö —Ç–µ–Ω–∑–æ—Ä–∞: {some_tensor.dtype}")
print(f"–ü—Ä–∏—Å—Ç—Ä—ñ–π —Ç–µ–Ω–∑–æ—Ä–∞: {some_tensor.device}")
print(f"–í—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è –≥—Ä–∞–¥—ñ—î–Ω—Ç—ñ–≤: {some_tensor.requires_grad}")
```
:::
:::

## –ê—Ä–∏—Ñ–º–µ—Ç–∏–∫–∞ –∑ —Ç–µ–Ω–∑–æ—Ä–∞–º–∏ 1/2

```{python}
tensor = torch.tensor([1, 2, 3])
print(tensor + 10)
print(tensor - 10)
print(tensor * 10)
print(tensor / 10)
```

## –ê—Ä–∏—Ñ–º–µ—Ç–∏–∫–∞ –∑ —Ç–µ–Ω–∑–æ—Ä–∞–º–∏ 2/2

- `torch.add(tensor, 10)`
- `torch.sub(tensor, 10)`
- `torch.mul(tensor, 10)`
- `torch.div(tensor, 10)`

## –ú–Ω–æ–∂–µ–Ω–Ω—è –º–∞—Ç—Ä–∏—Ü—å {.tiny}

–û–¥–Ω–∞ –∑ –Ω–∞–π–ø–æ–ø—É–ª—è—Ä–Ω—ñ—à–∏—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π ML —Ç–∞ DL.

–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –º–µ—Ç–æ–¥ `torch.matmul()`[^torch-mm] –∞–±–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä `@`.

[^torch-mm]: –¢–∞–∫–æ–∂ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ —Å–∫–æ—Ä–æ—á–µ–Ω–∏–π –∑–∞–ø–∏—Å `torch.mm()`.

::: {.callout-important icon="false"}
1. **–í–Ω—É—Ç—Ä—ñ—à–Ω—ñ —Ä–æ–∑–º—ñ—Ä–∏** –ø–æ–≤–∏–Ω–Ω—ñ –∑–±—ñ–≥–∞—Ç–∏—Å—è:

- `(3, 2) @ (3, 2)` –Ω–µ —Å–ø—Ä–∞—Ü—é—î
- `(2, 3) @ (3, 2)` —Å–ø—Ä–∞—Ü—é—î
- `(3, 2) @ (2, 3)` —Å–ø—Ä–∞—Ü—é—î
2. –†–µ–∑—É–ª—å—Ç—É—é—á–∞ –º–∞—Ç—Ä–∏—Ü—è –º–∞—î —Ñ–æ—Ä–º—É **–∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö —Ä–æ–∑–º—ñ—Ä—ñ–≤**:

- `(2, 3) @ (3, 2)` -> `(2, 2)`
- `(3, 2) @ (2, 3)` -> `(3, 3)`
:::

## –†—ñ–∑–Ω–∏—Ü—è –º—ñ–∂ `*` —Ç–∞ `torch.matmul()` {.tiny}

| –û–ø–µ—Ä–∞—Ü—ñ—è  |  –ö–æ–¥ |  –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫  |
|-----------|-------------|-------|
| –ú–Ω–æ–∂–µ–Ω–Ω—è –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ | `tensor  * tensor` | `[1*1, 2*2, 3*3]` = `[1, 4, 9]`  |
| –ú–Ω–æ–∂–µ–Ω–Ω—è –º–∞—Ç—Ä–∏—Ü—å | `tensor.matmul(tensor)` | `[1*1 + 2*2 + 3*3]` = `[14]` |

```{python}
tensor = torch.tensor([1.0, 2.0, 3.0])
print(tensor * tensor)
print(torch.matmul(tensor, tensor))
print(tensor @ tensor)
```

## –ú–µ—Ç–æ–¥ `torch.matmul()` —à–≤–∏–¥—à–∏–π –∑–∞ `*`

```{python}
#| output-location: column

%%time
value = 0
for i in range(len(tensor)):
  value += tensor[i] * tensor[i]
value
```

<br>

```{python}
#| output-location: column

%%time
torch.matmul(tensor, tensor)
```

## –ù–∞–π–ø–æ—à–∏—Ä–µ–Ω—ñ—à–∞ –ø–æ–º–∏–ª–∫–∞ 1/2 {.tiny}

```{python}
#| error: true
tensor_A = torch.tensor([[1, 2],
                         [3, 4],
                         [5, 6]], dtype=torch.float32)

tensor_B = torch.tensor([[7, 10],
                         [8, 11], 
                         [9, 12]], dtype=torch.float32)

torch.matmul(tensor_A, tensor_B)
```

## –ù–∞–π–ø–æ—à–∏—Ä–µ–Ω—ñ—à–∞ –ø–æ–º–∏–ª–∫–∞ 2/2

- `tensor.T`: —Ç—Ä–∞–Ω—Å–ø–æ–Ω—É–≤–∞–Ω–Ω—è —Ç–µ–Ω–∑–æ—Ä–∞

```{python}
torch.matmul(tensor_A, tensor_B.T)
```

## min, max, mean, sum...

```{python}
torch.manual_seed(73)
tensor = torch.rand(10)

print(f"–ú—ñ–Ω—ñ–º—É–º: {torch.min(tensor)}")
print(f"–ú–∞–∫—Å–∏–º—É–º: {torch.max(tensor)}")
print(f"–°–µ—Ä–µ–¥–Ω—î: {torch.mean(tensor)}")
print(f"–°—É–º–∞: {torch.sum(tensor)}")
```

## –ü–æ–∑–∏—Ü—ñ–π–Ω–∏–π min —Ç–∞ max

- `torch.argmax()`: –ø–æ–≤–µ—Ä—Ç–∞—î —ñ–Ω–¥–µ–∫—Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–Ω—è
- `torch.argmin()`: –ø–æ–≤–µ—Ä—Ç–∞—î —ñ–Ω–¥–µ–∫—Å –º—ñ–Ω—ñ–º–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–Ω—è

```{python}
print(f"–ü–æ–∑–∏—Ü—ñ–π–Ω–∏–π –º—ñ–Ω—ñ–º—É–º: {torch.argmin(tensor)}")
print(f"–ü–æ–∑–∏—Ü—ñ–π–Ω–∏–π –º–∞–∫—Å–∏–º—É–º: {torch.argmax(tensor)}")
```

## –ó–º—ñ–Ω–∞ —Ç–∏–ø—ñ–≤ –¥–∞–Ω–∏—Ö {.smaller}

–Ø–∫—â–æ –æ–¥–∏–Ω —Ç–µ–Ω–∑–æ—Ä –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è `torch.float64`, –∞ —ñ–Ω—à–∏–π --- `torch.float32`, –º–æ–∂—É—Ç—å –≤–∏–Ω–∏–∫–Ω—É—Ç–∏ –¥–µ—è–∫—ñ –ø–æ–º–∏–ª–∫–∏. –ê–ª–µ —Ü–µ –ª–µ–≥–∫–æ –≤–∏–ø—Ä–∞–≤–∏—Ç–∏:

- `tensor = tensor.to(torch.float32)`
- `tensor = tensor.type(torch.float32)`

```{python}
tensor_32 = torch.rand(10)
print(f"–ü–æ—á–∞—Ç–∫–æ–≤–∏–π —Ç–∏–ø: {tensor_32.dtype}")

tensor_64 = tensor_32.to(torch.float64)
print(f"–ù–æ–≤–∏–π —Ç–∏–ø: {tensor_64.dtype}")

tensor_16 = tensor_32.type(torch.float16)
print(f"–ù–æ–≤–∏–π —Ç–∏–ø: {tensor_16.dtype}")
```

## Reshaping

```{python}
tensor = torch.rand(10)
print(f"–ü–æ—á–∞—Ç–∫–æ–≤–∞ —Ñ–æ—Ä–º–∞: {tensor.shape}")

tensor = tensor.reshape(5, 2)
print(f"–ù–æ–≤–∞ —Ñ–æ—Ä–º–∞: {tensor.shape}")
```

::: footer
[`torch.reshape()` vs `torch.view()`](https://stackoverflow.com/a/54507446/7900723)
:::

## Stacking

```{python}
tensor_A = torch.rand(10)
tensor_B = torch.rand(10)

# –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–µ –æ–±'—î–¥–Ω–∞–Ω–Ω—è
stacked_v = torch.vstack((tensor_A, tensor_B))
print(f"–°–∫–ª–∞–¥–µ–Ω–∞ —Ñ–æ—Ä–º–∞ (–≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ): {stacked_v.shape}")

# –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–µ –æ–±'—î–¥–Ω–∞–Ω–Ω—è
stacked_h = torch.hstack((tensor_A, tensor_B))
print(f"–°–∫–ª–∞–¥–µ–Ω–∞ —Ñ–æ—Ä–º–∞ (–≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ): {stacked_h.shape}")
```

## –Ü–Ω–¥–µ–∫—Å–∞—Ü—ñ—è

```{python}
#| output-location: column
tensor = torch.arange(1, 10).reshape(1, 3, 3)

print(f"–ü–µ—Ä—à–∞ –∫–≤–∞–¥—Ä–∞—Ç–Ω–∞ –¥—É–∂–∫–∞:\n{tensor[0]}") 
print(f"–î—Ä—É–≥–∞ –∫–≤–∞–¥—Ä–∞—Ç–Ω–∞ –¥—É–∂–∫–∞: {tensor[0][0]}") 
print(f"–¢—Ä–µ—Ç—è –∫–≤–∞–¥—Ä–∞—Ç–Ω–∞ –¥—É–∂–∫–∞: {tensor[0][0][0]}")
```

<br>

```{python}
#| output-location: column
print(tensor[:, 0])
print(tensor[:, :, 1])
print(tensor[:, 1, 1])
print(tensor[0, 0, :])
```

## –¢–µ–Ω–∑–æ—Ä–∏ PyTorch —Ç–∞ NumPy

- `torch.from_numpy(ndarray)`: –º–∞—Å–∏–≤ NumPy -> —Ç–µ–Ω–∑–æ—Ä PyTorch.
- `torch.Tensor.numpy()`: —Ç–µ–Ω–∑–æ—Ä PyTorch -> –º–∞—Å–∏–≤ NumPy.

```{python}
import numpy as np

array = np.arange(1.0, 8.0) # <1>
tensor = torch.from_numpy(array).to(torch.float32) # <2>
array, tensor
```

1. `array`: –º–∞—Å–∏–≤ NumPy, —Ç–∏–ø –¥–∞–Ω–∏—Ö `float64`.
2. `tensor`: —Ç–µ–Ω–∑–æ—Ä PyTorch, —Ç–∏–ø –¥–∞–Ω–∏—Ö `float32`.

# –î—è–∫—É—é –∑–∞ —É–≤–∞–≥—É! {.unnumbered .unlisted background-iframe=".01_files/libs/colored-particles/index.html"}

<br> <br>

{{< iconify solar book-bold >}} [–ú–∞—Ç–µ—Ä—ñ–∞–ª–∏ –∫—É—Ä—Å—É](https://aranaur.rbind.io/lectures/)

{{< iconify mdi envelope >}} ihor.miroshnychenko\@knu.ua

{{< iconify ic baseline-telegram >}} [Data Mirosh](https://t.me/araprof)

{{< iconify mdi linkedin >}} [\@ihormiroshnychenko](https://www.linkedin.com/in/ihormiroshnychenko/)

{{< iconify mdi github >}} [\@aranaur](https://github.com/Aranaur)

{{< iconify ion home >}} [aranaur.rbind.io](https://aranaur.rbind.io)
