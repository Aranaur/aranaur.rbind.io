---
title: "–†–æ–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å üî•PyTorch"
subtitle: "–¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó –∫–æ–º–ø'—é—Ç–µ—Ä–Ω–æ–≥–æ –∑–æ—Ä—É"
author: "–Ü–≥–æ—Ä –ú—ñ—Ä–æ—à–Ω–∏—á–µ–Ω–∫–æ"
institute: –ö–ù–£ —ñ–º–µ–Ω—ñ –¢–∞—Ä–∞—Å–∞ –®–µ–≤—á–µ–Ω–∫–∞
format:
  html: 
    highlight-style: github
    theme: [default, custom.scss]
    lang: ua
execute: 
  echo: true
  warning: false
editor_options: 
  chunk_output_type: console
---

```{python}
#| include: false
import torch

device = "cuda" if torch.cuda.is_available() else "cpu"

red_pink   = "#e64173"
turquoise  = "#20B2AA"
orange     = "#FFA500"
red        = "#fb6107"
blue       = "#181485"
navy       = "#150E37FF"
green      = "#8bb174"
yellow     = "#D8BD44"
purple     = "#6A5ACD"
slate      = "#314f4f"
```

1. –°—Ç–≤–æ—Ä—ñ—Ç—å –Ω–∞–±—ñ—Ä –¥–∞–Ω–∏—Ö –ø—Ä—è–º–æ—ó –ª—ñ–Ω—ñ—ó, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Ñ–æ—Ä–º—É–ª—É –ª—ñ–Ω—ñ–π–Ω–æ—ó —Ä–µ–≥—Ä–µ—Å—ñ—ó (`bias + weight * X`), –∞ —Ç–∞–∫–æ–∂ –¥–æ–¥–∞–π—Ç–µ —Ç—Ä–æ—Ö–∏ –≤–∏–ø–∞–¥–∫–æ–≤–æ–≥–æ —à—É–º—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `torch.randn()`). –ü—Ä–∏ —Ü—å–æ–º—É —Å–∞–º–æ—Å—Ç—ñ–π–Ω–æ –æ–±–µ—Ä—ñ—Ç—å –ø–æ—á–∞—Ç–∫–æ–≤–µ –∑–Ω–∞—á–µ–Ω–Ω—è –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ –≤–∏–ø–∞–¥–∫–æ–≤–∏—Ö —á–∏—Å–µ–ª.
    * –í–∏–ø–∞–¥–∫–æ–≤–æ –æ–±–µ—Ä—ñ—Ç—å `bias` —ñ `weight`. –¢–æ—á–æ–∫ –º–∞—î –±—É—Ç–∏ 100+. 
    * –†–æ–∑–¥—ñ–ª—ñ—Ç—å –¥–∞–Ω—ñ –Ω–∞ 80% –¥–ª—è –Ω–∞–≤—á–∞–ª—å–Ω–æ—ó —Ç–∞ 20% –¥–ª—è —Ç–µ—Å—Ç–æ–≤–æ—ó –≤–∏–±—ñ—Ä–∫–∏.
    * –ü–æ–±—É–¥—É–π—Ç–µ –≥—Ä–∞—Ñ—ñ–∫ –¥–∞–Ω–∏—Ö.

::: {.callout-tip collapse="true"}
## –û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

```{python}
#| echo: false

import matplotlib.pyplot as plt
torch.manual_seed(42)
X = torch.arange(0, 1, 0.01).unsqueeze(1)
bias = torch.rand(1)
weight = torch.rand(1)
y = bias + weight * X + 0.02 * torch.randn(X.shape)
plt.scatter(X, y, color=turquoise, s=10)
plt.xlabel("X")
plt.ylabel("y")
plt.title("Generated linear data with noise")
plt.show()
```
:::

2. –°—Ç–≤–æ—Ä—ñ—Ç—å –º–æ–¥–µ–ª—å PyTorch, —Å—Ç–≤–æ—Ä–∏–≤—à–∏ –ø—ñ–¥–∫–ª–∞—Å `nn.Module`.
    * –í—Å–µ—Ä–µ–¥–∏–Ω—ñ –ø–æ–≤–∏–Ω–µ–Ω –±—É—Ç–∏ –≤–∏–ø–∞–¥–∫–æ–≤–æ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω–∏–π `nn.Parameter()` –∑ `requires_grad=True`, –æ–¥–∏–Ω –¥–ª—è `weights` —ñ –æ–¥–∏–Ω –¥–ª—è `bias`. 
    * –†–µ–∞–ª—ñ–∑—É–π—Ç–µ –º–µ—Ç–æ–¥ `forward()` –¥–ª—è –æ–±—á–∏—Å–ª–µ–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ—ó –ª—ñ–Ω—ñ–π–Ω–æ—ó —Ä–µ–≥—Ä–µ—Å—ñ—ó, —è–∫—É –≤–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–ª–∏ –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–∞–±–æ—Ä—É –¥–∞–Ω–∏—Ö –≤ 1. 
    * –ü—ñ—Å–ª—è –ø–æ–±—É–¥–æ–≤–∏ –º–æ–¥–µ–ª—ñ —Å—Ç–≤–æ—Ä—ñ—Ç—å —ó—ó –µ–∫–∑–µ–º–ø–ª—è—Ä —ñ –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ –π–æ–≥–æ `state_dict()`.
  
::: {.callout-note}
–Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ `nn.Linear()` –∑–∞–º—ñ—Å—Ç—å `nn.Parameter()`, –≤–∏ –º–æ–∂–µ—Ç–µ —Ü–µ –∑—Ä–æ–±–∏—Ç–∏.
:::

3. –°—Ç–≤–æ—Ä—ñ—Ç—å —Ñ—É–Ω–∫—Ü—ñ—é –≤—Ç—Ä–∞—Ç —Ç–∞ –æ–ø—Ç–∏–º—ñ–∑–∞—Ç–æ—Ä, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ `nn.L1Loss()` —Ç–∞ `torch.optim.SGD(params, lr)`. 
    * –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å —à–≤–∏–¥–∫—ñ—Å—Ç—å –Ω–∞–≤—á–∞–Ω–Ω—è –æ–ø—Ç–∏–º—ñ–∑–∞—Ç–æ—Ä–∞ –Ω–∞ `0.01`, –∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –¥–ª—è –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó –º–∞—é—Ç—å –±—É—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –º–æ–¥–µ–ª—ñ, —è–∫—É –≤–∏ —Å—Ç–≤–æ—Ä–∏–ª–∏ –≤ –ø—É–Ω–∫—Ç—ñ 2.
    * –ù–∞–ø–∏—à—ñ—Ç—å —Ü–∏–∫–ª –Ω–∞–≤—á–∞–Ω–Ω—è, —â–æ–± –≤–∏–∫–æ–Ω–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ –∫—Ä–æ–∫–∏ –Ω–∞–≤—á–∞–Ω–Ω—è –ø—Ä–æ—Ç—è–≥–æ–º 300 –µ–ø–æ—Ö.
    * –¶–∏–∫–ª –Ω–∞–≤—á–∞–Ω–Ω—è –ø–æ–≤–∏–Ω–µ–Ω —Ç–µ—Å—Ç—É–≤–∞—Ç–∏ –º–æ–¥–µ–ª—å –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º—É –Ω–∞–±–æ—Ä—ñ –¥–∞–Ω–∏—Ö –∫–æ–∂–Ω—ñ 20 –µ–ø–æ—Ö.

4. –ó—Ä–æ–±—ñ—Ç—å –ø—Ä–æ–≥–Ω–æ–∑–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –Ω–∞–≤—á–µ–Ω–æ—ó –º–æ–¥–µ–ª—ñ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö.
    * –í—ñ–∑—É–∞–ª—ñ–∑—É–π—Ç–µ —Ü—ñ –ø—Ä–æ–≥–Ω–æ–∑–∏ –Ω–∞ —Ç–ª—ñ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏—Ö –Ω–∞–≤—á–∞–ª—å–Ω–∏—Ö —ñ —Ç–µ—Å—Ç–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö.
    
::: {.callout-note}
–Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏, —â–æ –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—é—Ç—å CUDA, —Ç–∞–∫—ñ —è–∫ `matplotlib`, –¥–ª—è –ø–æ–±—É–¥–æ–≤–∏ –≥—Ä–∞—Ñ—ñ–∫—ñ–≤, –≤–∞–º –º–æ–∂–µ –∑–Ω–∞–¥–æ–±–∏—Ç–∏—Å—è –ø–µ—Ä–µ–∫–æ–Ω–∞—Ç–∏—Å—è, —â–æ –ø—Ä–æ–≥–Ω–æ–∑–∏ *–Ω–µ* –≤–∏–∫–æ–Ω—É—é—Ç—å—Å—è –Ω–∞ GPU.
:::

5. –ó–±–µ—Ä–µ–∂—ñ—Ç—å `state_dict()` –≤–∞—à–æ—ó –Ω–∞–≤—á–µ–Ω–æ—ó –º–æ–¥–µ–ª—ñ —É —Ñ–∞–π–ª—ñ.
    * –°—Ç–≤–æ—Ä—ñ—Ç—å –Ω–æ–≤–∏–π –µ–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—É –º–æ–¥–µ–ª—ñ, —è–∫–∏–π –≤–∏ —Å—Ç–≤–æ—Ä–∏–ª–∏ –≤ –ø—É–Ω–∫—Ç—ñ 2, —ñ –∑–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –≤ –Ω—å–æ–≥–æ —â–æ–π–Ω–æ –∑–±–µ—Ä–µ–∂–µ–Ω–∏–π `state_dict()`.
    * –í–∏–∫–æ–Ω–∞–π—Ç–µ –ø—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è –Ω–∞ –≤–∞—à–∏—Ö —Ç–µ—Å—Ç–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ—ó –º–æ–¥–µ–ª—ñ —Ç–∞ –ø–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –≤–æ–Ω–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å –ø—Ä–æ–≥–Ω–æ–∑–∞–º –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–æ—ó –º–æ–¥–µ–ª—ñ –∑ –ø—É–Ω–∫—Ç—É 4.