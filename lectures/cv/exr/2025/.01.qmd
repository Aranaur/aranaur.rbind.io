---
title: "–û—Å–Ω–æ–≤–∏ üî•PyTorch"
subtitle: "–¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó –∫–æ–º–ø'—é—Ç–µ—Ä–Ω–æ–≥–æ –∑–æ—Ä—É"
author: "–Ü–≥–æ—Ä –ú—ñ—Ä–æ—à–Ω–∏—á–µ–Ω–∫–æ"
institute: –ö–ù–£ —ñ–º–µ–Ω—ñ –¢–∞—Ä–∞—Å–∞ –®–µ–≤—á–µ–Ω–∫–∞
format:
  html: 
    highlight-style: github
    theme: [default, custom.scss]
    lang: ua
execute: 
  echo: true
  warning: false
editor_options: 
  chunk_output_type: console
---

```{python}
#| include: false
import torch

device = "cuda" if torch.cuda.is_available() else "cpu"
```

1. –ß–∏—Ç–∞–Ω–Ω—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó

–í–∞–∂–ª–∏–≤–æ—é —á–∞—Å—Ç–∏–Ω–æ—é –≥–ª–∏–±–æ–∫–æ–≥–æ –Ω–∞–≤—á–∞–Ω–Ω—è (—ñ –Ω–∞–≤—á–∞–Ω–Ω—è –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—é –≤ —Ü—ñ–ª–æ–º—É) —î –æ–∑–Ω–∞–π–æ–º–ª–µ–Ω–Ω—è –∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—î—é –ø–µ–≤–Ω–æ–≥–æ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫—É, —è–∫–∏–π –≤–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ. –¢–æ–º—É —è —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –≤–∏—Ç—Ä–∞—Ç–∏—Ç–∏ 10 —Ö–≤–∏–ª–∏–Ω –Ω–∞ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—è –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –º–∞—Ç–µ—Ä—ñ–∞–ª—É (–Ω–µ –±—ñ–¥–∞, —è–∫—â–æ –≤–∏ –ø–æ–∫–∏ —â–æ –Ω–µ –≤—Å–µ –∑—Ä–æ–∑—É–º—ñ—î—Ç–µ, –∞–¥–∂–µ –≥–æ–ª–æ–≤–Ω–µ –Ω–µ –ø–æ–≤–Ω–µ —Ä–æ–∑—É–º—ñ–Ω–Ω—è, –∞ —É—Å–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è):

  - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è –ø—Ä–æ [`torch.Tensor`](https://docs.pytorch.org/docs/stable/tensors.html#torch-tensor).
  - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è –ø—Ä–æ [`torch.cuda`](https://docs.pytorch.org/docs/main/notes/cuda.html#cuda-semantics).

2. –°—Ç–≤–æ—Ä—ñ—Ç—å –≤–∏–ø–∞–¥–∫–æ–≤–∏–π —Ç–µ–Ω–∑–æ—Ä –∑ —Ñ–æ—Ä–º–æ—é `(7, 7)`.
3. –í–∏–∫–æ–Ω–∞–π—Ç–µ –º–Ω–æ–∂–µ–Ω–Ω—è –º–∞—Ç—Ä–∏—Ü—å –Ω–∞ —Ç–µ–Ω–∑–æ—Ä –∑ 2 –∑ —ñ–Ω—à–∏–º –≤–∏–ø–∞–¥–∫–æ–≤–∏–º —Ç–µ–Ω–∑–æ—Ä–æ–º –∑ —Ñ–æ—Ä–º–æ—é `(1, 7)`.
4. –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –≤–∏–ø–∞–¥–∫–æ–≤–µ –ø–æ—á–∞—Ç–∫–æ–≤–µ –∑–Ω–∞—á–µ–Ω–Ω—è –Ω–∞ `0` —ñ –ø–æ–≤—Ç–æ—Ä—ñ—Ç—å –∫—Ä–æ–∫–∏ 2 —ñ 3.

::: {.callout-tip collapse="true"}
## –û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

```{python}
#| echo: false

torch.manual_seed(0)
a = torch.rand((7, 7))
b = torch.rand((1, 7)).T
c = torch.matmul(a, b)
print(c, c.shape)
```
:::

5. –ì–æ–≤–æ—Ä—è—á–∏ –ø—Ä–æ –≤–∏–ø–∞–¥–∫–æ–≤—ñ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∏, –º–∏ –±–∞—á–∏–ª–∏, —è–∫ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –π–æ–≥–æ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `torch.manual_seed()`, –∞–ª–µ —á–∏ —ñ—Å–Ω—É—î –µ–∫–≤—ñ–≤–∞–ª–µ–Ω—Ç –¥–ª—è GPU[^gpu]?
    + –Ø–∫—â–æ —î, –≤—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –ø–æ—á–∞—Ç–∫–æ–≤–µ –∑–Ω–∞—á–µ–Ω–Ω—è GPU –Ω–∞ `1234`.

[^gpu]: –ü—ñ–¥–∫–∞–∑–∫–∞: –¥–ª—è —Ü—å–æ–≥–æ –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –±—É–¥–µ –∑–∞–≥–ª—è–Ω—É—Ç–∏ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—é –¥–æ `torch.cuda`

6. –°—Ç–≤–æ—Ä—ñ—Ç—å –¥–≤–∞ –≤–∏–ø–∞–¥–∫–æ–≤—ñ —Ç–µ–Ω–∑–æ—Ä–∏ —Ñ–æ—Ä–º–∏ `(2, 3)` —ñ –Ω–∞–¥—ñ—à–ª—ñ—Ç—å —ó—Ö –æ–±–∏–¥–≤–∞ –Ω–∞ GPU (–¥–ª—è —Ü—å–æ–≥–æ –≤–∞–º –∑–Ω–∞–¥–æ–±–∏—Ç—å—Å—è –¥–æ—Å—Ç—É–ø –¥–æ GPU). –ü—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ —Ç–µ–Ω–∑–æ—Ä—ñ–≤ –≤—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å `torch.manual_seed(1234)`.

::: {.callout-tip collapse="true"}
## –û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

```{python}
#| echo: false

torch.manual_seed(1234)
a = torch.rand((2, 3)).cuda()
b = torch.rand((2, 3)).cuda()
print(f'Using device: {a.device}')
print(a, a.shape)
print(b, b.shape)
```
:::


7. –í–∏–∫–æ–Ω–∞–π—Ç–µ –º–Ω–æ–∂–µ–Ω–Ω—è –º–∞—Ç—Ä–∏—Ü—å –Ω–∞ —Ç–µ–Ω–∑–æ—Ä–∏, —è–∫—ñ –≤–∏ —Å—Ç–≤–æ—Ä–∏–ª–∏ –≤ –ø—É–Ω–∫—Ç—ñ 6 (–∑–Ω–æ–≤—É –∂ —Ç–∞–∫–∏, –º–æ–∂–ª–∏–≤–æ, –¥–æ–≤–µ–¥–µ—Ç—å—Å—è —Å–∫–æ—Ä–∏–≥—É–≤–∞—Ç–∏ —Ñ–æ—Ä–º–∏ –æ–¥–Ω–æ–≥–æ –∑ —Ç–µ–Ω–∑–æ—Ä—ñ–≤).

::: {.callout-tip collapse="true"}
## –û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

```{python}
#| echo: false

c = torch.matmul(a, b.T)
print(c, c.shape)
```
:::

8. –ó–Ω–∞–π–¥—ñ—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–µ —Ç–∞ –º—ñ–Ω—ñ–º–∞–ª—å–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è –≤–∏—Ö–æ–¥—É 7.
9. –ó–Ω–∞–π–¥—ñ—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–µ —Ç–∞ –º—ñ–Ω—ñ–º–∞–ª—å–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è —ñ–Ω–¥–µ–∫—Å—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É 7.
10. –°—Ç–≤–æ—Ä—ñ—Ç—å –≤–∏–ø–∞–¥–∫–æ–≤–∏–π —Ç–µ–Ω–∑–æ—Ä –∑ —Ñ–æ—Ä–º–æ—é `(1, 1, 1, 10)`, –∞ –ø–æ—Ç—ñ–º —Å—Ç–≤–æ—Ä—ñ—Ç—å –Ω–æ–≤–∏–π —Ç–µ–Ω–∑–æ—Ä, –∑ —è–∫–æ–≥–æ –≤–∏–¥–∞–ª–µ–Ω—ñ –≤—Å—ñ —Ä–æ–∑–º—ñ—Ä–∏ `1`, —â–æ–± –∑–∞–ª–∏—à–∏–≤—Å—è —Ç–µ–Ω–∑–æ—Ä –∑ —Ñ–æ—Ä–º–æ—é `(10)`. –ü—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ –≤—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –ø–æ—á–∞—Ç–∫–æ–≤–µ –∑–Ω–∞—á–µ–Ω–Ω—è `7` –π –≤–∏–≤–µ–¥—ñ—Ç—å –Ω–∞ –µ–∫—Ä–∞–Ω –ø–µ—Ä—à–∏–π —Ç–µ–Ω–∑–æ—Ä —ñ –π–æ–≥–æ —Ñ–æ—Ä–º—É, –∞ —Ç–∞–∫–æ–∂ –¥—Ä—É–≥–∏–π —Ç–µ–Ω–∑–æ—Ä —ñ –π–æ–≥–æ —Ñ–æ—Ä–º—É.

::: {.callout-tip collapse="true"}
## –û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

```{python}
#| echo: false

torch.manual_seed(7)
a = torch.rand((1, 1, 1, 10))
b = a.squeeze()
print(a, a.shape)
print(b, b.shape)
```
:::
