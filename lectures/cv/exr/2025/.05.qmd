---
title: "–ú–æ–¥—É–ª—å–Ω—ñ—Å—Ç—å —Ç–∞ Transfer Learning üî•PyTorch"
subtitle: "–¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó –∫–æ–º–ø'—é—Ç–µ—Ä–Ω–æ–≥–æ –∑–æ—Ä—É"
author: "–Ü–≥–æ—Ä –ú—ñ—Ä–æ—à–Ω–∏—á–µ–Ω–∫–æ"
institute: –ö–ù–£ —ñ–º–µ–Ω—ñ –¢–∞—Ä–∞—Å–∞ –®–µ–≤—á–µ–Ω–∫–∞
format:
  html: 
    highlight-style: github
    theme: [default, custom.scss]
    lang: ua
execute: 
  echo: true
  warning: false
editor_options: 
  chunk_output_type: console
---

::: {.callout-note}
–í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ–Ω–∞—Ç–∏ —Ü–µ –∑–∞–≤–¥–∞–Ω–Ω—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —ñ–Ω—à—ñ –Ω–∞–±–æ—Ä–∏ –¥–∞–Ω–∏—Ö, –∞–ª–µ –ø–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ —É –≤–∞—Å —î 3+ –∫–ª–∞—Å–∏ –∑–æ–±—Ä–∞–∂–µ–Ω—å (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –∫—ñ—à–∫–∏, —Å–æ–±–∞–∫–∏, –ø—Ç–∞—Ö–∏).
:::

# –ú–æ–¥—É–ª—å–Ω—ñ—Å—Ç—å

1. –ü–µ—Ä–µ—Ç–≤–æ—Ä—ñ—Ç—å –∫–æ–¥ –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö —É —Å–∫—Ä–∏–ø—Ç Python, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ `get_data.py`.
    + –ö–æ–ª–∏ –≤–∏ –∑–∞–ø—É—Å–∫–∞—î—Ç–µ —Å–∫—Ä–∏–ø—Ç –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `python get_data.py`, –≤—ñ–Ω –ø–æ–≤–∏–Ω–µ–Ω –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –¥–∞–Ω—ñ –≤–∂–µ —ñ—Å–Ω—É—é—Ç—å, —ñ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è, —è–∫—â–æ —Ü–µ —Ç–∞–∫.
    + –Ø–∫—â–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –ø—Ä–æ–π—à–ª–æ —É—Å–ø—ñ—à–Ω–æ, –≤–∏ –ø–æ–≤–∏–Ω–Ω—ñ –º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –∑–æ–±—Ä–∞–∂–µ–Ω—å `pizza_steak_sushi` –∑ –∫–∞—Ç–∞–ª–æ–≥—É `data`.
2. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ [–º–æ–¥—É–ª—å `argparse` Python](https://docs.python.org/3/library/argparse.html), —â–æ–± –º–∞—Ç–∏ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –Ω–∞–¥—Å–∏–ª–∞—Ç–∏ `train.py` –≤–ª–∞—Å–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –≥—ñ–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –¥–ª—è –ø—Ä–æ—Ü–µ–¥—É—Ä –Ω–∞–≤—á–∞–Ω–Ω—è.
    + –î–æ–¥–∞–π—Ç–µ –∞—Ä–≥—É–º–µ–Ω—Ç –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è:
        - –ö–∞—Ç–∞–ª–æ–≥ –Ω–∞–≤—á–∞–Ω–Ω—è/—Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
        - –®–≤–∏–¥–∫—ñ—Å—Ç—å –Ω–∞–≤—á–∞–Ω–Ω—è
        - –†–æ–∑–º—ñ—Ä –ø–∞–∫–µ—Ç–∞
        - –ö—ñ–ª—å–∫—ñ—Å—Ç—å –µ–ø–æ—Ö –¥–ª—è –Ω–∞–≤—á–∞–Ω–Ω—è
        - –ö—ñ–ª—å–∫—ñ—Å—Ç—å –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏—Ö –æ–¥–∏–Ω–∏—Ü—å —É –º–æ–¥–µ–ª—ñ TinyVGG
    + –ó–±–µ—Ä–µ–∂—ñ—Ç—å –∑–Ω–∞—á–µ–Ω–Ω—è –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –∑ –≤–∏—â–µ–∑–∞–∑–Ω–∞—á–µ–Ω–∏—Ö –∞—Ä–≥—É–º–µ–Ω—Ç—ñ–≤ —Ç–∞–∫–∏–º–∏, —è–∫–∏–º–∏ –≤–æ–Ω–∏ –≤–∂–µ —î.
    + –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –≤–∏ –ø–æ–≤–∏–Ω–Ω—ñ –º–∞—Ç–∏ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –∑–∞–ø—É—Å—Ç–∏—Ç–∏ —â–æ—Å—å –ø–æ–¥—ñ–±–Ω–µ –¥–æ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ —Ä—è–¥–∫–∞, —â–æ–± –Ω–∞–≤—á–∏—Ç–∏ –º–æ–¥–µ–ª—å –∑—ñ —à–≤–∏–¥–∫—ñ—Å—Ç—é –Ω–∞–≤—á–∞–Ω–Ω—è 0.003 —ñ —Ä–æ–∑–º—ñ—Ä–æ–º –±–∞—Ç—á–∞ 64 –ø—Ä–æ—Ç—è–≥–æ–º 20 –µ–ø–æ—Ö: `python train.py --learning_rate 0.003 --batch_size 64 --num_epochs 20`.
    + **–ü—Ä–∏–º—ñ—Ç–∫–∞:** –æ—Å–∫—ñ–ª—å–∫–∏ `train.py` –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —ñ–Ω—à—ñ —Å–∫—Ä–∏–ø—Ç–∏, —Ç–∞–∫—ñ —è–∫ `model_builder.py`, `utils.py` —Ç–∞ `engine.py`, –≤–∏ –ø–æ–≤–∏–Ω–Ω—ñ –ø–µ—Ä–µ–∫–æ–Ω–∞—Ç–∏—Å—è, —â–æ –≤–æ–Ω–∏ —Ç–∞–∫–æ–∂ –¥–æ—Å—Ç—É–ø–Ω—ñ –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è.
3. –°—Ç–≤–æ—Ä—ñ—Ç—å —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `predict.py`) –Ω–∞ —Ü—ñ–ª—å–æ–≤–æ–º—É –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—ñ, –≤—Ä–∞—Ö–æ–≤—É—é—á–∏ —à–ª—è—Ö –¥–æ —Ñ–∞–π–ª—É —ñ–∑ –∑–±–µ—Ä–µ–∂–µ–Ω–æ—é –º–æ–¥–µ–ª–ª—é.
    + –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –≤–∏ –ø–æ–≤–∏–Ω–Ω—ñ –º–∞—Ç–∏ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –∑–∞–ø—É—Å—Ç–∏—Ç–∏ –∫–æ–º–∞–Ω–¥—É `python predict.py some_image.jpeg` —ñ –æ—Ç—Ä–∏–º–∞—Ç–∏ –ø—Ä–æ–≥–Ω–æ–∑ –Ω–∞–≤—á–µ–Ω–æ—ó –º–æ–¥–µ–ª—ñ PyTorch –Ω–∞ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—ñ —Ç–∞ –ø–æ–≤–µ—Ä–Ω—É—Ç–∏ –π–æ–≥–æ.
    + –ú–æ–∂–ª–∏–≤–æ, –≤–∞–º —Ç–∞–∫–æ–∂ –¥–æ–≤–µ–¥–µ—Ç—å—Å—è –Ω–∞–ø–∏—Å–∞—Ç–∏ –∫–æ–¥ –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞–≤—á–µ–Ω–æ—ó –º–æ–¥–µ–ª—ñ.

# Transfer Learning

1. –ó—Ä–æ–±—ñ—Ç—å –ø—Ä–æ–≥–Ω–æ–∑–∏ –Ω–∞ –æ—Å–Ω–æ–≤—ñ –≤—Å—å–æ–≥–æ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –Ω–∞–±–æ—Ä—É –¥–∞–Ω–∏—Ö —ñ –ø–æ–±—É–¥—É–π—Ç–µ –º–∞—Ç—Ä–∏—Ü—é –Ω–µ–≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ –Ω–∞—à–æ—ó –º–æ–¥–µ–ª—ñ –≤ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—ñ –∑ —ñ—Å—Ç–∏–Ω–Ω–∏–º–∏ –º—ñ—Ç–∫–∞–º–∏.
2. –û—Ç—Ä–∏–º–∞–π—Ç–µ "–Ω–∞–π–≥—ñ—Ä—à—ñ" –ø—Ä–æ–≥–Ω–æ–∑–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º—É –Ω–∞–±–æ—Ä—ñ –¥–∞–Ω–∏—Ö —ñ –ø–æ–±—É–¥—É–π—Ç–µ –≥—Ä–∞—Ñ—ñ–∫ 5 –∑–æ–±—Ä–∞–∂–µ–Ω—å –∑ –Ω–∞–π–≤–∏—â–æ—é –ø–æ–º–∏–ª–∫–æ—é. –í–∏ –º–æ–∂–µ—Ç–µ –∑—Ä–æ–±–∏—Ç–∏ —Ü–µ —Ç–∞–∫–∏–º —á–∏–Ω–æ–º:
    + –ü—Ä–æ–≥–Ω–æ–∑—É–π—Ç–µ –Ω–∞ –≤—Å—å–æ–º—É —Ç–µ—Å—Ç–æ–≤–æ–º—É –Ω–∞–±–æ—Ä—ñ –¥–∞–Ω–∏—Ö, –∑–±–µ—Ä—ñ–≥–∞—é—á–∏ –º—ñ—Ç–∫–∏ —Ç–∞ –ø—Ä–æ–≥–Ω–æ–∑–æ–≤–∞–Ω—ñ –π–º–æ–≤—ñ—Ä–Ω–æ—Å—Ç—ñ.
    + –°–æ—Ä—Ç—É–π—Ç–µ –ø—Ä–æ–≥–Ω–æ–∑–∏ –∑–∞ –ø–æ–º–∏–ª–∫–æ–≤–∏–º–∏ –ø—Ä–æ–≥–Ω–æ–∑–∞–º–∏, –∞ –ø–æ—Ç—ñ–º –∑–∞ —Å–ø–∞–¥–∞–Ω–Ω—è–º –ø—Ä–æ–≥–Ω–æ–∑–æ–≤–∞–Ω–∏—Ö –π–º–æ–≤—ñ—Ä–Ω–æ—Å—Ç–µ–π. –¶–µ –¥–∞—Å—Ç—å –≤–∞–º –ø–æ–º–∏–ª–∫–æ–≤—ñ –ø—Ä–æ–≥–Ω–æ–∑–∏ –∑ –Ω–∞–π–≤–∏—â–∏–º–∏ –π–º–æ–≤—ñ—Ä–Ω–æ—Å—Ç—è–º–∏ –ø—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è, —ñ–Ω—à–∏–º–∏ —Å–ª–æ–≤–∞–º–∏, "–Ω–∞–π–±—ñ–ª—å—à –ø–æ–º–∏–ª–∫–æ–≤—ñ".
    + –ù–∞–º–∞–ª—é–π—Ç–µ 5 "–Ω–∞–π–±—ñ–ª—å—à –ø–æ–º–∏–ª–∫–æ–≤–∏—Ö" –∑–æ–±—Ä–∞–∂–µ–Ω—å. –Ø–∫ –≤–∏ –¥—É–º–∞—î—Ç–µ, —á–æ–º—É –º–æ–¥–µ–ª—å –ø–æ–º–∏–ª–∏–ª–∞—Å—è?
3. –ó—Ä–æ–±—ñ—Ç—å –ø—Ä–æ–≥–Ω–æ–∑ –Ω–∞ –æ—Å–Ω–æ–≤—ñ –≤–ª–∞—Å–Ω–æ–≥–æ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è pizza/steak/sushi ‚Äî —è–∫ –ø—Ä–∞—Ü—é—î –º–æ–¥–µ–ª—å? –©–æ —Å—Ç–∞–Ω–µ—Ç—å—Å—è, —è–∫—â–æ –≤–∏ –∑—Ä–æ–±–∏—Ç–µ –ø—Ä–æ–≥–Ω–æ–∑ –Ω–∞ –æ—Å–Ω–æ–≤—ñ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è, —è–∫–µ –Ω–µ —î –ø—ñ—Ü–æ—é/—Å—Ç–µ–π–∫–æ–º/—Å—É—à—ñ?
4. –ù–∞–≤—á—ñ—Ç—å –º–æ–¥–µ–ª—å –¥–æ–≤—à–µ (10 –µ–ø–æ—Ö –º–∞—î –≤–∏—Å—Ç–∞—á–∏—Ç–∏), —â–æ —Å—Ç–∞–Ω–µ—Ç—å—Å—è –∑ –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—é?
5. –ù–∞–≤—á—ñ—Ç—å –º–æ–¥–µ–ª—å –∑ —Ä–æ–∑–¥—ñ–ª—É 4 –≤–∏—â–µ –∑ –±—ñ–ª—å—à–æ—é –∫—ñ–ª—å–∫—ñ—Å—Ç—é –¥–∞–Ω–∏—Ö, —Å–∫–∞–∂—ñ–º–æ, 20% –∑–æ–±—Ä–∞–∂–µ–Ω—å –∑ Food101 –∑–æ–±—Ä–∞–∂–µ–Ω—å –ø—ñ—Ü–∏, —Å—Ç–µ–π–∫–∞ —Ç–∞ —Å—É—à—ñ.
6. –°–ø—Ä–æ–±—É–π—Ç–µ —ñ–Ω—à—É –º–æ–¥–µ–ª—å –∑ `torchvision.models` –Ω–∞ –¥–∞–Ω–∏—Ö –ø—Ä–æ –ø—ñ—Ü—É, —Å—Ç–µ–π–∫ —ñ —Å—É—à—ñ. –Ø–∫ –ø—Ä–∞—Ü—é—î —Ü—è –º–æ–¥–µ–ª—å?
    + –í–∞–º –¥–æ–≤–µ–¥–µ—Ç—å—Å—è –∑–º—ñ–Ω–∏—Ç–∏ —Ä–æ–∑–º—ñ—Ä —à–∞—Ä—É –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∞, —â–æ–± –≤—ñ–Ω –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–≤ –Ω–∞—à—ñ–π –∑–∞–¥–∞—á—ñ.
    + –ú–æ–∂–ª–∏–≤–æ, –≤–∏ –∑–∞—Ö–æ—á–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ EfficientNet –∑ –±—ñ–ª—å—à–∏–º —á–∏—Å–ª–æ–º, –Ω—ñ–∂ –Ω–∞—à–µ B0, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ `torchvision.models.efficientnet_b2()`?

