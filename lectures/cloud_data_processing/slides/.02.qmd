---
title: "Google Cloud Console"
subtitle: "–•–º–∞—Ä–Ω—ñ —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó –æ–±—Ä–æ–±–∫–∏ –¥–∞–Ω–∏—Ö"
author: "–Ü–≥–æ—Ä –ú—ñ—Ä–æ—à–Ω–∏—á–µ–Ω–∫–æ"
institute: –ö–ù–£ —ñ–º–µ–Ω—ñ –¢–∞—Ä–∞—Å–∞ –®–µ–≤—á–µ–Ω–∫–∞ | –§–Ü–¢
# date: today
# date-format: iso
from: markdown+emoji
title-slide-attributes:
  data-background-iframe: .01_files/libs/colored-particles/index.html
#   data-background-color: "#eef3f8"
lang: ua
footer: üîó <a href="https://aranaur.rbind.io/lectures/cloud_data_processing/">–ú–∞—Ç–µ—Ä—ñ–∞–ª–∏ –∫—É—Ä—Å—É</a>
format: 
  html:
    toc: true
    code-line-numbers: false
    highlight-style: github
    pdf-separate-fragments: true
    # fig-height: 7.5
    fig-width: 15
    fig-align: center
    fig-format: svg
    theme: [default, custom.scss]
jupyter: python3
execute: 
  warning: false
  echo: true
---

```{python}
#| label: setup
#| include: false
#| eval: false

# Import libraries
import numpy as np
import pandas as pd
import statsmodels.api as sm
import statsmodels.formula.api as smf
import matplotlib.pyplot as plt
import seaborn as sns
from scipy.stats import norm, uniform, t

from IPython.display import Markdown
from tabulate import tabulate

# Set seaborn default style
sns.set_style('whitegrid')
sns.set_palette('colorblind')

# Define colors
red_pink   = "#e64173"
turquoise  = "#20B2AA"
orange     = "#FFA500"
red        = "#fb6107"
blue       = "#181485"
navy       = "#150E37FF"
green      = "#8bb174"
yellow     = "#D8BD44"
# grey_light = "grey70"
# grey_mid   = "grey50"
# grey_dark  = "grey20"
purple     = "#6A5ACD"
slate      = "#314f4f"
```

## –í–∏–º–æ–≥–∏

### –°—Ç–≤–æ—Ä—ñ—Ç—å –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å –Ω–∞ Google Cloud Platform (–±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ)

–ù–∞—Å—Ç—É–ø–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó —î –≤–∞–∂–ª–∏–≤–∏–º–∏, —Ç–æ–º—É, –±—É–¥—å –ª–∞—Å–∫–∞, —É–≤–∞–∂–Ω–æ –ø—Ä–æ—á–∏—Ç–∞–π—Ç–µ —ó—Ö.

1. –ü—ñ–¥–ø–∏—à—ñ—Ç—å—Å—è –Ω–∞ [3-–º—ñ—Å—è—á–Ω—É ($300+$100 –∫—Ä–µ–¥–∏—Ç) –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω—É –ø—Ä–æ–±–Ω—É –≤–µ—Ä—Å—ñ—é] (<https://console.cloud.google.com/freetrial>) Google Cloud Platform (GCP). –î–ª—è —Ü—å–æ–≥–æ –ø–æ—Ç—Ä—ñ–±–µ–Ω –Ω–∞—è–≤–Ω–∏–π –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å Google/Gmail[^gmail]. –ü—ñ–¥ —á–∞—Å —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó –≤–∞–º –±—É–¥–µ –∑–∞–ø—Ä–æ–ø–æ–Ω–æ–≤–∞–Ω–æ –≤–≤–µ—Å—Ç–∏ –¥–∞–Ω—ñ –∫—Ä–µ–¥–∏—Ç–Ω–æ—ó –∫–∞—Ä—Ç–∫–∏ –¥–ª—è –≤–∏—Å—Ç–∞–≤–ª–µ–Ω–Ω—è —Ä–∞—Ö—É–Ω–∫—É. –ù–µ —Ö–≤–∏–ª—é–π—Ç–µ—Å—è, –∑ –≤–∞—Å –Ω–µ —Å—Ç—è–≥—É–≤–∞—Ç–∏–º—É—Ç—å—Å—è –∫–æ—à—Ç–∏ –¥–æ—Ç–∏, –¥–æ–∫–∏ –≤–∏ –Ω–µ –∑—Ä–æ–±–∏—Ç–µ –∞–∫—Ç–∏–≤–Ω–∏–π –∑–∞–ø–∏—Ç –Ω–∞ –ø—Ä–æ–¥–æ–≤–∂–µ–Ω–Ω—è –¥–æ—Å—Ç—É–ø—É –¥–æ GCP –ø—ñ—Å–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ—ó –ø—Ä–æ–±–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó. –ê–ª–µ –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ—Å—Ç—É–ø—É –¥–æ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∏ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –º–∞—Ç–∏ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä –ø—Ä–æ–µ–∫—Ç—É, —è–∫–∏–π –ø—ñ–¥–ª—è–≥–∞—î –æ–ø–ª–∞—Ç—ñ.
2. (*–û–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ*) –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ —Ç–∞ –¥–æ—Ç—Ä–∏–º—É–π—Ç–µ—Å—å —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ–π –∑ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —É—Ç–∏–ª—ñ—Ç–∏ –∫–æ–º–∞–Ω–¥–Ω–æ–≥–æ —Ä—è–¥–∫–∞ [Google Cloud SDK](https://cloud.google.com/sdk/) `gcloud`.

[^gmail]: –Ø–∫—â–æ —É –≤–∞—Å —î –∫—ñ–ª—å–∫–∞ –æ–±–ª—ñ–∫–æ–≤–∏—Ö –∑–∞–ø–∏—Å—ñ–≤ Gmail, –≤–∏–±–µ—Ä—ñ—Ç—å –æ–¥–∏–Ω —ñ –ø–æ—Å—Ç—ñ–π–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –π–æ–≥–æ, –∫–æ–ª–∏ –∑'—è–≤–ª—è—î—Ç—å—Å—è –∑–∞–ø–∏—Ç –Ω–∞ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—é –Ω–æ–≤–æ–≥–æ API —Å–µ—Ä–≤—ñ—Å—É GCP

## –í—Å—Ç—É–ø

### –î–æ —Ö–º–∞—Ä–∏!

–ù–∞–π–ø—Ä–æ—Å—Ç—ñ—à–∏–π —ñ –Ω–∞–π–¥–µ—à–µ–≤—à–∏–π —Å–ø–æ—Å—ñ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –±—ñ–ª—å—à–∏—Ö –æ–±—á–∏—Å–ª—é–≤–∞–ª—å–Ω–∏—Ö –ø–æ—Ç—É–∂–Ω–æ—Å—Ç–µ–π —Å—å–æ–≥–æ–¥–Ω—ñ - —Ü–µ —Ö–º–∞—Ä–∞[^cloud]. –•–æ—á–∞ —î –±–∞–≥–∞—Ç–æ —á—É–¥–æ–≤–∏—Ö –ø–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫—ñ–≤ —Ö–º–∞—Ä–Ω–∏—Ö –ø–æ—Å–ª—É–≥, —è –∑–æ—Å–µ—Ä–µ–¥–∂—É—Å—è –Ω–∞ [**Google Cloud Platform**](https://console.cloud.google.com/) (**GCP**)[^gcp-alt]. GCP –ø—Ä–æ–ø–æ–Ω—É—î –Ω–∏–∑–∫—É –Ω–µ–π–º–æ–≤—ñ—Ä–Ω–æ –∫–æ—Ä–∏—Å–Ω–∏—Ö —Å–µ—Ä–≤—ñ—Å—ñ–≤, –ø—Ä–æ –¥–µ—è–∫—ñ –∑ —è–∫–∏—Ö –º–∏ —Ä–æ–∑–ø–æ–≤—ñ–º–æ –≤ –Ω–∞—Å—Ç—É–ø–Ω–∏—Ö –ª–µ–∫—Ü—ñ—è—Ö, –∞ 3-–º—ñ—Å—è—á–Ω–∞ –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–∞ –ø—Ä–æ–±–Ω–∞ –≤–µ—Ä—Å—ñ—è —î —ñ–¥–µ–∞–ª—å–Ω–æ—é –≤—ñ–¥–ø—Ä–∞–≤–Ω–æ—é —Ç–æ—á–∫–æ—é –¥–ª—è –≤–∏–≤—á–µ–Ω–Ω—è —Ö–º–∞—Ä–Ω–∏—Ö –æ–±—á–∏—Å–ª–µ–Ω—å.

[^cloud]: –•–æ—á–∞ —Ö–º–∞—Ä–∞ - —Ü–µ –Ω–µ —î–¥–∏–Ω–∞ –≥—Ä–∞ –≤ –º—ñ—Å—Ç—ñ, –≤–æ–Ω–∞ –ø—Ä–æ–ø–æ–Ω—É—î –±–µ–∑–ª—ñ—á –ø–µ—Ä–µ–≤–∞–≥, —è–∫—ñ, –Ω–∞ –º–æ—é –¥—É–º–∫—É, —Ä–æ–±–ª—è—Ç—å —ó—ó –±–µ–∑–ø—Ä–æ–±–ª–µ–º–Ω–æ—é –¥–ª—è –±—ñ–ª—å—à–æ—Å—Ç—ñ –ª—é–¥–µ–π: –µ–∫–æ–Ω–æ–º—ñ—è –Ω–∞ –º–∞—Å—à—Ç–∞–±–∞—Ö —Ä–æ–±–∏—Ç—å —ó—ó –Ω–∞–±–∞–≥–∞—Ç–æ –¥–µ—à–µ–≤—à–æ—é; —Ç—É—Ä–±–æ—Ç–∏ –ø—Ä–æ –æ–±—Å–ª—É–≥–æ–≤—É–≤–∞–Ω–Ω—è —Ç–∞ –∞–º–æ—Ä—Ç–∏–∑–∞—Ü—ñ—é –∑–Ω—è—Ç—ñ; –¥–æ—Å—Ç—É–ø –Ω–µ –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ —ñ–Ω—Å—Ç–∏—Ç—É—Ü—ñ–π–Ω–æ—ó –ø—Ä–∏–Ω–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –∞–±–æ —Å—Ç–∞—Ç—É—Å—É –≤–∏–∫–ª–∞–¥–∞—á–∞; —Ö–º–∞—Ä–Ω—ñ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∏ –ø—Ä–æ–ø–æ–Ω—É—é—Ç—å –±–µ–∑–ª—ñ—á —ñ–Ω—à–∏—Ö –∫–æ—Ä–∏—Å–Ω–∏—Ö –ø–æ—Å–ª—É–≥; —Ç–æ—â–æ

[^gcp-alt]: –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∏ GCP –≤–∫–ª—é—á–∞—é—Ç—å [AWS](https://aws.amazon.com/) —Ç–∞ [Digital Ocean](https://www.digitalocean.com/). Posit –Ω–µ—â–æ–¥–∞–≤–Ω–æ —Ç–∞–∫–æ–∂ –∑–∞–ø—É—Å—Ç–∏–ª–∞ –≤–ª–∞—Å–Ω–∏–π —Ö–º–∞—Ä–Ω–∏–π —Å–µ—Ä–≤—ñ—Å: [Posit Cloud](https://rstudio.cloud/), —è–∫–∏–π –º–∞—î –≤—É–∂—á—É —Å–ø—Ä—è–º–æ–≤–∞–Ω—ñ—Å—Ç—å, –∞–ª–µ —á—É–¥–æ–≤–æ –ø—ñ–¥—Ö–æ–¥–∏—Ç—å –¥–ª—è –Ω–∞–≤—á–∞–Ω–Ω—è —ñ —î (–Ω–∞—Ä–∞–∑—ñ) –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–∏–º –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è. –•–æ—Ä–æ—à–∞ –Ω–æ–≤–∏–Ω–∞ –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, —â–æ —Ü–µ –≤—Å–µ —á—É–¥–æ–≤—ñ –≤–∞—Ä—ñ–∞–Ω—Ç–∏, –∞ –∑–∞–≥–∞–ª—å–Ω—ñ –ø—Ä–∏–Ω—Ü–∏–ø–∏ —Ö–º–∞—Ä–Ω–∏—Ö –æ–±—á–∏—Å–ª–µ–Ω—å –ø–µ—Ä–µ–Ω–æ—Å—è—Ç—å—Å—è –¥—É–∂–µ –ª–µ–≥–∫–æ. –¢–æ–∂ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —Ç–µ, —â–æ –≤–∞–º –∑—Ä—É—á–Ω—ñ—à–µ

### –ü–æ—á–∞—Ç–æ–∫ —Ä–æ–±–æ—Ç–∏

1. –£–≤—ñ–π–¥—ñ—Ç—å –≤ [Google Cloud Console](https://console.cloud.google.com/).
2. –í–∏–±–µ—Ä—ñ—Ç—å –∞–±–æ —Å—Ç–≤–æ—Ä—ñ—Ç—å –ø—Ä–æ–µ–∫—Ç.
3. –í—ñ–¥–∫—Ä–∏–π—Ç–µ Cloud Shell[^4].
4. –í–≤–µ–¥—ñ—Ç—å –∫–æ–º–∞–Ω–¥—É –¥–ª—è –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ –∑ —Ü—å–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é:

```bash
git clone https://github.com/aranaur/data-science-on-gcp
cd data-science-on-gcp
```

[^4]: Cloud Shell - —Ü–µ –º—ñ–∫—Ä–æ-–í–ú, —è–∫–∞ —ñ—Å–Ω—É—î –ø—Ä–æ—Ç—è–≥–æ–º —É—Å—å–æ–≥–æ —á–∞—Å—É, –ø–æ–∫–∏ –≤—ñ–¥–∫—Ä–∏—Ç–æ –≤—ñ–∫–Ω–æ –±—Ä–∞—É–∑–µ—Ä–∞, —ñ –Ω–∞–¥–∞—î –≤–∞–º —Ç–µ—Ä–º—ñ–Ω–∞–ª—å–Ω–∏–π –¥–æ—Å—Ç—É–ø –¥–æ –º—ñ–∫—Ä–æ-–í–ú. –ó–∞–∫—Ä–∏–π—Ç–µ –≤—ñ–∫–Ω–æ –±—Ä–∞—É–∑–µ—Ä–∞, —ñ –º—ñ–∫—Ä–æ-–í–ú –∑–Ω–∏–∫–Ω–µ. –í–ú Cloud Shell –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–∞ —ñ –ø–æ—Å—Ç–∞—á–∞—î—Ç—å—Å—è –∑ –±–∞–≥–∞—Ç—å–º–∞ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏, —è–∫—ñ –∑–Ω–∞–¥–æ–±–ª—è—Ç—å—Å—è —Ä–æ–∑—Ä–æ–±–Ω–∏–∫–∞–º –Ω–∞ Google Cloud Platform. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –Ω–∞ –Ω—ñ–π –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ñ Python, Git, Google Cloud SDK —Ç–∞ Orion (–≤–µ–±-—Ä–µ–¥–∞–∫—Ç–æ—Ä –∫–æ–¥—É). –•–æ—á–∞ –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–∞ –º–∞—à–∏–Ω–∞ Cloud Shell —î –µ—Ñ–µ–º–µ—Ä–Ω–æ—é, –≤–æ–Ω–∞ –ø—Ä–∏–∫—Ä—ñ–ø–ª–µ–Ω–∞ –¥–æ –ø–æ—Å—Ç—ñ–π–Ω–æ–≥–æ –¥–∏—Å–∫–∞, —è–∫–∏–π –ø—Ä–∏–≤'—è–∑–∞–Ω–∏–π –¥–æ –≤–∞—à–æ–≥–æ –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞. –§–∞–π–ª–∏, —è–∫—ñ –≤–∏ –∑–±–µ—Ä—ñ–≥–∞—î—Ç–µ –≤ –¥–æ–º–∞—à–Ω—å–æ–º—É –∫–∞—Ç–∞–ª–æ–∑—ñ, –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –ø—ñ–¥ —á–∞—Å —Ä—ñ–∑–Ω–∏—Ö —Å–µ–∞–Ω—Å—ñ–≤ Cloud Shell.

## –î–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö —É GCP

### –î–∞–Ω—ñ

–í —è–∫–æ—Å—Ç—ñ –¥–∞–Ω–∏—Ö –±—É–¥–µ–º–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ [Airline On-Time Performance Data](https://www.bts.gov/topics/airline-time-tables).

–£—Å—ñ –≤–µ–ª–∏–∫—ñ –∞–≤—ñ–∞–ø–µ—Ä–µ–≤—ñ–∑–Ω–∏–∫–∏ –°–®–ê –∑–æ–±–æ–≤'—è–∑–∞–Ω—ñ –ø–æ–¥–∞–≤–∞—Ç–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω—ñ –¥–∞–Ω—ñ –ø—Ä–æ –∫–æ–∂–µ–Ω —Å–≤—ñ–π –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ–π —Ä–µ–π—Å –¥–æ –°–ª—É–∂–±–∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ—ó –±–µ–∑–ø–µ–∫–∏ (BTS).

–î–∞–Ω—ñ, —è–∫—ñ –≤–æ–Ω–∏ –∑–æ–±–æ–≤'—è–∑–∞–Ω—ñ –ø–æ–¥–∞–≤–∞—Ç–∏, –≤–∫–ª—é—á–∞—é—Ç—å –∑–∞–ø–ª–∞–Ω–æ–≤–∞–Ω–∏–π —á–∞—Å –≤–∏–ª—å–æ—Ç—É —Ç–∞ –ø—Ä–∏–±—É—Ç—Ç—è, –∞ —Ç–∞–∫–æ–∂ —Ñ–∞–∫—Ç–∏—á–Ω–∏–π —á–∞—Å –≤–∏–ª—å–æ—Ç—É —Ç–∞ –ø—Ä–∏–±—É—Ç—Ç—è. –ù–∞ –æ—Å–Ω–æ–≤—ñ –∑–∞–ø–ª–∞–Ω–æ–≤–∞–Ω–æ–≥–æ —Ç–∞ —Ñ–∞–∫—Ç–∏—á–Ω–æ–≥–æ —á–∞—Å—É –ø—Ä–∏–±—É—Ç—Ç—è –º–æ–∂–Ω–∞ —Ä–æ–∑—Ä–∞—Ö—É–≤–∞—Ç–∏ –∑–∞—Ç—Ä–∏–º–∫—É –ø—Ä–∏–±—É—Ç—Ç—è, –ø–æ–≤'—è–∑–∞–Ω—É –∑ –∫–æ–∂–Ω–∏–º —Ä–µ–π—Å–æ–º.

–§–∞–∫—Ç–∏—á–Ω–∏–π —á–∞—Å –≤–∏–ª—å–æ—Ç—É —ñ –ø—Ä–∏–±—É—Ç—Ç—è –≤–∏–∑–Ω–∞—á–∞—î—Ç—å—Å—è –¥–æ—Å–∏—Ç—å —Ç–æ—á–Ω–æ, –≤–∏—Ö–æ–¥—è—á–∏ –∑ —Ç–æ–≥–æ, –∫–æ–ª–∏ –≤—ñ–¥–ø—É—Å–∫–∞—î—Ç—å—Å—è —Å—Ç–æ—è–Ω–∫–æ–≤–µ –≥–∞–ª—å–º–æ –ª—ñ—Ç–∞–∫–∞ —ñ –∫–æ–ª–∏ –≤–æ–Ω–æ –∑–Ω–æ–≤—É –≤–º–∏–∫–∞—î—Ç—å—Å—è –≤ –ø—É–Ω–∫—Ç—ñ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è. –ü—Ä–∞–≤–∏–ª–∞ –Ω–∞–≤—ñ—Ç—å –≤–∏–∑–Ω–∞—á–∞—é—Ç—å, —â–æ —Å—Ç–∞–Ω–µ—Ç—å—Å—è, —è–∫—â–æ –ø—ñ–ª–æ—Ç –∑–∞–±—É–¥–µ —É–≤—ñ–º–∫–Ω—É—Ç–∏ —Å—Ç–æ—è–Ω–∫–æ–≤–µ –≥–∞–ª—å–º–æ - –≤ —Ç–∞–∫–æ–º—É –≤–∏–ø–∞–¥–∫—É –∑–∞–º—ñ—Å—Ç—å –Ω—å–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —á–∞—Å –∑–∞–∫—Ä–∏—Ç—Ç—è –∞–±–æ –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è –ø–∞—Å–∞–∂–∏—Ä—Å—å–∫–∏—Ö –¥–≤–µ—Ä–µ–π.

![](img/flight.jpg)

### –ó–º—ñ–Ω–Ω—ñ

–î–∞—Ç–∞—Å–µ—Ç –º—ñ—Å—Ç–∏—Ç—å –ø–æ–Ω–∞–¥ 100 –∑–º—ñ–Ω–Ω–∏—Ö, –∞–ª–µ –º–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—î–º–æ –ª–∏—à–µ –¥–µ—è–∫—ñ –∑ –Ω–∏—Ö:

| –ó–º—ñ–Ω–Ω–∞ | –û–ø–∏—Å |
|--------|------|
| `FlightDate` | –î–∞—Ç–∞ –ø–æ–ª—å–æ—Ç—É (yyyymmdd) |
| `Reporting_Airline ` | –£–Ω—ñ–∫–∞–ª—å–Ω–∏–π –∫–æ–¥ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞. –Ø–∫—â–æ –æ–¥–∏–Ω —ñ —Ç–æ–π —Å–∞–º–∏–π –∫–æ–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–≤—Å—è –∫—ñ–ª—å–∫–æ–º–∞ –ø–µ—Ä–µ–≤—ñ–∑–Ω–∏–∫–∞–º–∏, –¥–ª—è –±—ñ–ª—å—à —Ä–∞–Ω–Ω—ñ—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —Ü–∏—Ñ—Ä–æ–≤–∏–π —Å—É—Ñ—ñ–∫—Å, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, PA, PA(1), PA(2). –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —Ü–µ –ø–æ–ª–µ –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É –∑–∞ —Ä—ñ–∑–Ω—ñ —Ä–æ–∫–∏. |
| `Origin` | –ê–µ—Ä–æ–ø–æ—Ä—Ç –≤–∏–ª—å–æ—Ç—É |
| `Dest` | –ê–µ—Ä–æ–ø–æ—Ä—Ç –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è |
| `CRSDepTime` | –ß–∞—Å –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –∫–æ–º–ø'—é—Ç–µ—Ä–Ω–æ—ó —Å–∏—Å—Ç–µ–º–∏ –±—Ä–æ–Ω—é–≤–∞–Ω–Ω—è (CRS) (–º—ñ—Å—Ü–µ–≤–∏–π —á–∞—Å: hhmm) |
| `DepTime` | –§–∞–∫—Ç–∏—á–Ω–∏–π —á–∞—Å –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–Ω—è (–º—ñ—Å—Ü–µ–≤–∏–π —á–∞—Å: hhmm) |
| `DepDelay` | –†—ñ–∑–Ω–∏—Ü—è –≤ —Ö–≤–∏–ª–∏–Ω–∞—Ö –º—ñ–∂ –∑–∞–ø–ª–∞–Ω–æ–≤–∞–Ω–∏–º —ñ —Ñ–∞–∫—Ç–∏—á–Ω–∏–º —á–∞—Å–æ–º –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–Ω—è. –†–∞–Ω–Ω—ñ –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –ø–æ–∫–∞–∑—É—é—Ç—å –≤—ñ–¥'—î–º–Ω—ñ —á–∏—Å–ª–∞. |
| `TaxiOut` | –¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å —Ç–∞–∫—Å—ñ-–∞—É—Ç—É, –≤ —Ö–≤–∏–ª–∏–Ω–∞—Ö |
| `WheelsOff` | –ß–∞—Å –≤–∏—Å–∞–¥–∫–∏ (–º—ñ—Å—Ü–µ–≤–∏–π —á–∞—Å: hhmm) |
| `WheelsOn` | –ß–∞—Å –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–Ω—è (–º—ñ—Å—Ü–µ–≤–∏–π —á–∞—Å: hhmm) |
| `TaxiIn` | –¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å —Ç–∞–∫—Å—ñ (—Ö–≤–∏–ª–∏–Ω–∏) |
| `CRSArrTime` | –ß–∞—Å –ø—Ä–∏–±—É—Ç—Ç—è CRS (–º—ñ—Å—Ü–µ–≤–∏–π —á–∞—Å: hhmm) |
| `ArrTime` | –§–∞–∫—Ç–∏—á–Ω–∏–π —á–∞—Å –ø—Ä–∏–±—É—Ç—Ç—è (–º—ñ—Å—Ü–µ–≤–∏–π —á–∞—Å: hhmm) |
| `ArrDelay` | –†—ñ–∑–Ω–∏—Ü—è –≤ —Ö–≤–∏–ª–∏–Ω–∞—Ö –º—ñ–∂ –∑–∞–ø–ª–∞–Ω–æ–≤–∞–Ω–∏–º —ñ —Ñ–∞–∫—Ç–∏—á–Ω–∏–º —á–∞—Å–æ–º –ø—Ä–∏–±—É—Ç—Ç—è. –†–∞–Ω–Ω—ñ –ø—Ä–∏–±—É—Ç—Ç—è –ø–æ–∫–∞–∑—É—é—Ç—å –≤—ñ–¥'—î–º–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è. |
| `Cancelled` | –Ü–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å–∫–∞—Å–æ–≤–∞–Ω–æ–≥–æ –ø–æ–ª—å–æ—Ç—É (1 = –¢–∞–∫)  |
| `CancellationCode` | –ü—Ä–∏—á–∏–Ω—É —Å–∫–∞—Å—É–≤–∞–Ω–Ω—è  |
| `Diverted` | –Ü–Ω–¥–∏–∫–∞—Ç–æ—Ä –≤—ñ–¥—Ö–∏–ª–µ–Ω–æ–≥–æ –ø–æ–ª—å–æ—Ç—É (1 = –¢–∞–∫) |
| `Distance` | –í—ñ–¥—Å—Ç–∞–Ω—å –º—ñ–∂ –∞–µ—Ä–æ–ø–æ—Ä—Ç–∞–º–∏ (–º–∏–ª—ñ) |

::: callout-note
–í–µ—Å—å –ø–µ—Ä–µ–ª—ñ–∫ –∑–º—ñ–Ω–Ω–∏—Ö –¥–æ—Å—Ç—É–ø–Ω–∏–π –∑–∞ –ø–æ—Å–∏–ª–∞–Ω–Ω—è–º <https://www.transtats.bts.gov/Fields.asp?gnoyr_VQ=FGJ>.
:::

### –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è

–ó–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ —Ä–æ–∑—Ä–æ–±–Ω–∏–∫–∞ –±—Ä–∞—É–∑–µ—Ä–∞ –ø–æ–¥–∏–≤–∏–º–æ—Å—å –∫—É–¥–∏ –∑–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è –≤–µ–±-—Å–∞–π—Ç, –∫–æ–ª–∏ –º–∏ –≤–≤–æ–¥–∏–º–æ –∑–∞–ø–∏—Ç –Ω–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö. 

–ü–µ—Ä–µ–π–¥—ñ—Ç—å –∑–∞ –ø–æ—Å–∏–ª–∞–Ω–Ω—è–º <https://www.transtats.bts.gov/DL_SelectFields.aspx?gnoyr_VQ=FGJ&QO_fu146_anzr=b0-gvzr> —Ç–∞ –æ–±–µ—Ä—ñ—Ç—å –æ–ø—Ü—ñ—é "Prezipped File".

–í—ñ–¥–∫—Ä–∏–π—Ç–µ –≤–∫–ª–∞–¥–∫—É "Network" –≤ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ö —Ä–æ–∑—Ä–æ–±–Ω–∏–∫–∞ –±—Ä–∞—É–∑–µ—Ä–∞ —Ç–∞ –≤–≤–µ–¥—ñ—Ç—å –∑–∞–ø–∏—Ç –Ω–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö.

–ú–∏ –ø–æ–±–∞—á–∏–º–æ, —â–æ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –∑–∞–ø–∏—Ç –¥–æ <https://transtats.bts.gov/PREZIP/On_Time_Reporting_Carrier_On_Time_Performance_1987_present_2023_1.zip>.

–í–∏–¥–Ω–æ, –∑ —á–æ–≥–æ —Å–∫–ª–∞–¥–∞—î—Ç—å—Å—è —à–∞–±–ª–æ–Ω –∑–∞–ø–∏—Ç—É:

```
${–ë–∞–∑–æ–≤–∏–π_—Ä—ñ–∫}_${–†—ñ–∫}_${–ú—ñ—Å—è—Ü—å}.zip
```

–°–ø—Ä–æ–±—É—î–º–æ –∑ –∫–æ–º–∞–Ω–¥–Ω–æ–≥–æ —Ä—è–¥–∫–∞:

```bash
BTS=https://transtats.bts.gov/PREZIP
BASEURL="${BTS}/On_Time_Reporting_Carrier_On_Time_Performance_1987_present"
YEAR=2015
MONTH=3
curl -k -o temp.zip ${BASEURL}_${YEAR}_${MONTH}.zip
```

::: callout-note
- `curl` - —Ü–µ —É—Ç–∏–ª—ñ—Ç–∞ –∫–æ–º–∞–Ω–¥–Ω–æ–≥–æ —Ä—è–¥–∫–∞ –¥–ª—è –≤–∑–∞—î–º–æ–¥—ñ—ó –∑ —Å–µ—Ä–≤–µ—Ä–∞–º–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ä—ñ–∑–Ω–∏—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª—ñ–≤. –í –¥–∞–Ω–æ–º—É –≤–∏–ø–∞–¥–∫—É –º–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –ø—Ä–æ—Ç–æ–∫–æ–ª HTTP.
- `-k` –≤–∫–∞–∑—É—î –Ω–∞ —Ç–µ, —â–æ –º–∏ –¥–æ–∑–≤–æ–ª—è—î–º–æ `curl` –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –Ω–µ–∑–∞—Ö–∏—â–µ–Ω–µ –∑'—î–¥–Ω–∞–Ω–Ω—è.
- `-o` –≤–∫–∞–∑—É—î –Ω–∞ —Ç–µ, —â–æ –º–∏ —Ö–æ—á–µ–º–æ –∑–±–µ—Ä–µ–≥—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —É —Ñ–∞–π–ª `temp.zip`.
:::

–†–æ–∑–ø–∞–∫—É—î–º–æ –∞—Ä—Ö—ñ–≤:

```bash
unzip temp.zip
```

–¢–µ–ø–µ—Ä –≤–∏–¥–Ω–æ, —â–æ —É —Å–µ—Ä–µ–¥–∏–Ω—ñ –∞—Ä—Ö—ñ–≤—É –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è CSV-—Ñ–∞–π–ª. –ü–æ–¥–∏–≤–∏–º–æ—Å—å –Ω–∞ –ø–µ—Ä—à—ñ –∫—ñ–ª—å–∫–∞ —Ä—è–¥–∫—ñ–≤:

```bash
head -n 5 *.csv
```

–ó–∞–º—ñ—Å—Ç—å —Ç–æ–≥–æ, —â–æ–± –Ω–∞–∑–≤–∞—Ç–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏–π —Ñ–∞–π–ª `temp.zip`, –¥–∞–≤–∞–π—Ç–µ –Ω–∞–∑–≤–µ–º–æ –π–æ–≥–æ `201503.zip` —ñ –ø–æ–º—ñ—Å—Ç–∏–º–æ —É —Ç–∏–º—á–∞—Å–æ–≤–∏–π –∫–∞—Ç–∞–ª–æ–≥. –©–æ–± –∑–∞–º—ñ–Ω–∏—Ç–∏ –º—ñ—Å—è—Ü—å `3` –Ω–∞ `03`, –º–∏ –º–æ–∂–µ–º–æ —Å–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏—Å—è –∫–æ–º–∞–Ω–¥–æ—é `printf` —É bash:

```bash
MONTH2=$(printf "%02d" $MONTH)
```

–î–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–∞—Ç–∞–ª–æ–≥—É –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—î–º–æ –∫–æ–º–∞–Ω–¥—É `mkdir`:

```bash
TMPDIR=$(mktemp -d)
```

–¢–µ–ø–µ—Ä –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—î–º–æ –∫–æ–º–∞–Ω–¥—É `curl`:

```bash
ZIPFILE=${TMPDIR}/${YEAR}_${MONTH2}.zip
curl -o $ZIPFILE ${BASEURL}_${YEAR}_${MONTH}.zip
```

–¢–µ–ø–µ—Ä –º–∏ –º–æ–∂–µ–º–æ —Ä–æ–∑–∞—Ä—Ö—ñ–≤—É–≤–∞—Ç–∏ —Ñ–∞–π–ª, –≤–∏—Ç—è–≥—Ç–∏ CSV-—Ñ–∞–π–ª –¥–æ –ø–æ—Ç–æ—á–Ω–æ–≥–æ –∫–∞—Ç–∞–ª–æ–≥—É (`./`) —ñ –≤–∏–¥–∞–ª–∏—Ç–∏ —Ä–µ—à—Ç—É –≤–º—ñ—Å—Ç—É ZIP-—Ñ–∞–π–ª—É:

```bash
unzip -d $TMPDIR $ZIPFILE
mv $TMPDIR/*.csv ./${YEAR}${MONTH2}.csv
rm -rf $TMPDIR
```

–í—Å—ñ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ –∫–æ–º–∞–Ω–¥–∏ –º—ñ—Å—Ç—è—Ç—å—Å—è —É —Ñ–∞–π–ª—ñ –ø—ñ–¥ –Ω–∞–∑–≤–æ—é `download.sh`, –∞ –ø–æ—Ç—ñ–º —É —Å–∫—Ä–∏–ø—Ç—ñ `ingest.sh` –≤–∏–∫–ª–∏–∫–∞—î–º–æ —ó—Ö –∑ —Ü–∏–∫–ª—É `for`:

```bash
for MONTH in `seq 1 12`; do
  bask download.sh $YEAR $MONTH
done
```

–í–∏–∫–æ–Ω–∞—î–º–æ —Å–∫—Ä–∏–ø—Ç:

```bash
for MONTH in `seq 1 12`; do bash ../02_ingest/download.sh 2015 $MONTH; done
```

–ü–æ–¥–∏–≤–∏–º–æ—Å—å –Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ä—è–¥–∫—ñ–≤ —É —Ñ–∞–π–ª–∞—Ö:

```bash
wc -l *.csv
```

### –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö —É Google Cloud Storage

–¢–µ–ø–µ—Ä, –∫–æ–ª–∏ –º–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏–ª–∏ –¥–∞–Ω—ñ, –¥–∞–≤–∞–π—Ç–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏–º–æ —ó—Ö —É Google Cloud Storage (GCS). –¶–µ –¥–æ–∑–≤–æ–ª–∏—Ç—å –Ω–∞–º –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —ó—Ö —É —ñ–Ω—à–∏—Ö —Å–µ—Ä–≤—ñ—Å–∞—Ö GCP, —Ç–∞–∫–∏—Ö —è–∫ BigQuery, Dataflow, Dataproc, AI Platform —Ç–æ—â–æ.

–°–ø–æ—á–∞—Ç–∫—É —Ç—Ä–µ–±–∞ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–∏–π –±–∞–∫–µ—Ç - —Ü–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö –∑ —É–Ω—ñ–∫–∞–ª—å–Ω–∏–º —ñ–º–µ–Ω–µ–º.

–í–∏ –º–æ–∂–µ—Ç–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ —É–Ω—ñ–∫–∞–ª—å–Ω–µ –±–∞–∫–µ—Ç –≤ –∫–æ–º–∞–Ω–¥–Ω–æ–º—É —Ä—è–¥–∫—É –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é:

```bash
PROJECT=$(gcloud config get-value project)
BUCKET=${PROJECT}-dsongcp
REGION=us-central1 # –î–∏–≤—ñ—Ç—å—Å—è https://cloud.google.com/storage/docs/locations
gsutil mb -l $REGION gs://$BUCKET
```

–¢–µ–ø–µ—Ä, –∫–æ–ª–∏ –±–∞–∫–µ—Ç —Å—Ç–≤–æ—Ä–µ–Ω–æ, –º–∏ –º–æ–∂–µ–º–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ñ–∞–π–ª–∏ —É –Ω—å–æ–≥–æ:

```bash
gsutil -m cp *.csv gs://fit-cloud-course-dsongcp/flights/raw/
```

## BigQuery

–ü–µ—Ä—à–∏–º –∫—Ä–æ–∫–æ–º –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö —É BigQuery —î —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–∞–±–æ—Ä—É –¥–∞–Ω–∏—Ö - –Ω–∞–±–æ—Ä—É –¥–∞–Ω–∏—Ö, —è–∫–∏–π —î –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–º –¥–ª—è —Ç–∞–±–ª–∏—Ü—å. –£ –ø—Ä–æ–µ–∫—Ç—ñ –º–æ–∂–Ω–∞ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –∫—ñ–ª—å–∫–∞ –Ω–∞–±–æ—Ä—ñ–≤ –¥–∞–Ω–∏—Ö. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ [–≤–µ–±-–∫–æ–Ω—Å–æ–ª—ñ](https://console.cloud.google.com/bigquery) —ñ –≤–∏–±–µ—Ä—ñ—Ç—å –æ–ø—Ü—ñ—é *Create Dataset*. –ü–æ—Ç—ñ–º —Å—Ç–≤–æ—Ä—ñ—Ç—å –Ω–∞–±—ñ—Ä –¥–∞–Ω–∏—Ö –∑ –Ω–∞–∑–≤–æ—é `dsongcp`.

–ê–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ –∫–æ–º–∞–Ω–¥–Ω–∏–π —Ä—è–¥–æ–∫:

```bash
bq mk dsongcp
```

### –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö

–ú–∏ –º–æ–∂–µ–º–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –¥–∞–Ω—ñ –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ —É –≤–ª–∞—Å–Ω–µ —Å—Ö–æ–≤–∏—â–µ BigQuery –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —É—Ç–∏–ª—ñ—Ç–∏ –∫–æ–º–∞–Ω–¥–Ω–æ–≥–æ —Ä—è–¥–∫–∞ `bq`:

```bash
PROJECT=$(gcloud config get-value project)
BUCKET=${PROJECT}-dsongcp
bq load --autodetect --source_format=CSV \
dsongcp.flights_auto \
gs://${BUCKET}/flights/raw/201501.csv
```

–ú–∏ –º–æ–∂–µ–º–æ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –∑—Ä–æ–±–∏—Ç–∏ –∑–∞–ø–∏—Ç –Ω–∞ –¥–∞–Ω—ñ, —â–æ–± –∑–Ω–∞–π—Ç–∏ —Å–µ—Ä–µ–¥–Ω—é –∑–∞—Ç—Ä–∏–º–∫—É –≤–∏–ª—å–æ—Ç—É —Ç–∞ –ø—Ä–∏–ª—å–æ—Ç—É –≤ –Ω–∞–π–±—ñ–ª—å—à –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏—Ö –∞–µ—Ä–æ–ø–æ—Ä—Ç–∞—Ö:

```sql
SELECT
  ORIGIN,
  AVG(DepDelay) AS dep_delay,
  AVG(ArrDelay) AS arr_delay,
  COUNT(ArrDelay) AS num_flights
FROM
  `dsongcp.flights_auto`
GROUP BY
  ORIGIN
ORDER BY num_flights DESC
LIMIT 10
```

–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Å—Ö–µ–º–∏ –¥–æ–∑–≤–æ–ª—è—î –Ω–∞–º –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –¥–∞–Ω—ñ –±–µ–∑ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ—Å—Ç—ñ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Å—Ö–µ–º–∏. –ê–ª–µ —Ü–µ –º–æ–∂–µ –±—É—Ç–∏ –Ω–µ –Ω–∞–π–∫—Ä–∞—â–∏–º –≤–∞—Ä—ñ–∞–Ω—Ç–æ–º –¥–ª—è –≤–µ–ª–∏–∫–∏—Ö –Ω–∞–±–æ—Ä—ñ–≤ –¥–∞–Ω–∏—Ö. –í —Ç–∞–∫–æ–º—É –≤–∏–ø–∞–¥–∫—É –∫—Ä–∞—â–µ –≤–∏–∑–Ω–∞—á–∏—Ç–∏ —Å—Ö–µ–º—É –≤—Ä—É—á–Ω—É.

–ù–∞—Ä–∞–∑—ñ –º–∏ –º–∞–ª–æ —â–æ –∑–Ω–∞—î–º–æ –ø—Ä–æ –ø–æ–ª—è, —Ç–æ–º—É –º–æ–∂–µ–º–æ –ø–æ–ø—Ä–æ—Å–∏—Ç–∏ BigQuery –æ–±—Ä–æ–±–ª—è—Ç–∏ –≤—Å—ñ —Å—Ç–æ–≤–ø—Ü—ñ, –æ–∫—Ä—ñ–º `FlightDate`, —è–∫ —Ä—è–¥–∫–∏:

```bash
SCHEMA=Year:STRING,...,FlightDate:DATE,Reporting_Airline:STRING,...
```

–ö—Ä—ñ–º —Ç–æ–≥–æ, –º–∏ –º–æ–∂–µ–º–æ —Ä–æ–∑–±–∏—Ç–∏ –¥–∞–Ω—ñ –Ω–∞ –ø–∞—Ä—Ç—ñ—Ü—ñ—ó –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –ø–æ–ª—è `FlightDate`:

```bash
--time_partitioning_field=FlightDate --time_partitioning_type=MONTH
```

–¢–æ–¥—ñ –∫–æ–¥ –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö —É BigQuery –±—É–¥–µ –≤–∏–≥–ª—è–¥–∞—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω–∏–º —á–∏–Ω–æ–º:

```bash
PROJECT=$(gcloud config get-value project)
BUCKET=${PROJECT}-dsongcp
YEAR=2015
SCHEMA=Year:STRING,Quarter:STRING,Month:STRING,DayofMonth:STRING,DayOfWeek:STRING,FlightDate:DATE,Reporting_Airline:STRING,DOT_ID_Reporting_Airline:STRING,IATA_CODE_Reporting_Airline:STRING,Tail_Number:STRING,Flight_Number_Reporting_Airline:STRING,OriginAirportID:STRING,OriginAirportSeqID:STRING,OriginCityMarketID:STRING,Origin:STRING,OriginCityName:STRING,OriginState:STRING,OriginStateFips:STRING,OriginStateName:STRING,OriginWac:STRING,DestAirportID:STRING,DestAirportSeqID:STRING,DestCityMarketID:STRING,Dest:STRING,DestCityName:STRING,DestState:STRING,DestStateFips:STRING,DestStateName:STRING,DestWac:STRING,CRSDepTime:STRING,DepTime:STRING,DepDelay:STRING,DepDelayMinutes:STRING,DepDel15:STRING,DepartureDelayGroups:STRING,DepTimeBlk:STRING,TaxiOut:STRING,WheelsOff:STRING,WheelsOn:STRING,TaxiIn:STRING,CRSArrTime:STRING,ArrTime:STRING,ArrDelay:STRING,ArrDelayMinutes:STRING,ArrDel15:STRING,ArrivalDelayGroups:STRING,ArrTimeBlk:STRING,Cancelled:STRING,CancellationCode:STRING,Diverted:STRING,CRSElapsedTime:STRING,ActualElapsedTime:STRING,AirTime:STRING,Flights:STRING,Distance:STRING,DistanceGroup:STRING,CarrierDelay:STRING,WeatherDelay:STRING,NASDelay:STRING,SecurityDelay:STRING,LateAircraftDelay:STRING,FirstDepTime:STRING,TotalAddGTime:STRING,LongestAddGTime:STRING,DivAirportLandings:STRING,DivReachedDest:STRING,DivActualElapsedTime:STRING,DivArrDelay:STRING,DivDistance:STRING,Div1Airport:STRING,Div1AirportID:STRING,Div1AirportSeqID:STRING,Div1WheelsOn:STRING,Div1TotalGTime:STRING,Div1LongestGTime:STRING,Div1WheelsOff:STRING,Div1TailNum:STRING,Div2Airport:STRING,Div2AirportID:STRING,Div2AirportSeqID:STRING,Div2WheelsOn:STRING,Div2TotalGTime:STRING,Div2LongestGTime:STRING,Div2WheelsOff:STRING,Div2TailNum:STRING,Div3Airport:STRING,Div3AirportID:STRING,Div3AirportSeqID:STRING,Div3WheelsOn:STRING,Div3TotalGTime:STRING,Div3LongestGTime:STRING,Div3WheelsOff:STRING,Div3TailNum:STRING,Div4Airport:STRING,Div4AirportID:STRING,Div4AirportSeqID:STRING,Div4WheelsOn:STRING,Div4TotalGTime:STRING,Div4LongestGTime:STRING,Div4WheelsOff:STRING,Div4TailNum:STRING,Div5Airport:STRING,Div5AirportID:STRING,Div5AirportSeqID:STRING,Div5WheelsOn:STRING,Div5TotalGTime:STRING,Div5LongestGTime:STRING,Div5WheelsOff:STRING,Div5TailNum:STRING


for MONTH in `seq -w 1 12`; do
CSVFILE=gs://${BUCKET}/flights/raw/${YEAR}${MONTH}.csv
bq --project_id $PROJECT \
load --time_partitioning_field=FlightDate \
--time_partitioning_type=MONTH \
--source_format=CSV --ignore_unknown_values \
--skip_leading_rows=1 --schema=$SCHEMA \
${PROJECT}:dsongcp.flights_raw\$${YEAR}${MONTH} $CSVFILE
done
```

–ü–æ–≤–Ω–∏–π –∫–æ–¥ –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö —É BigQuery –º—ñ—Å—Ç–∏—Ç—å—Å—è —É —Ñ–∞–π–ª—ñ `bqload.sh`.

## –î–∞—à–±–æ—Ä–¥–∏

### –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—å

–ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—è - —Ü–µ –≤—ñ—Ä—Ç—É–∞–ª—å–Ω—ñ —Ç–∞–±–ª–∏—Ü—ñ, —è–∫—ñ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–ª—è —Å–ø—Ä–æ—â–µ–Ω–Ω—è —Å–∫–ª–∞–¥–Ω–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤. –í–æ–Ω–∏ –Ω–µ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å –∂–æ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö, –∞–ª–µ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –¥–ª—è –æ–±–º–µ–∂–µ–Ω–Ω—è –¥–æ—Å—Ç—É–ø—É –¥–æ –¥–∞–Ω–∏—Ö, –∞–≥—Ä–µ–≥–∞—Ü—ñ—ó –¥–∞–Ω–∏—Ö, –æ–±'—î–¥–Ω–∞–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—å —Ç–æ—â–æ.

–°—Ç–≤–æ—Ä–∏–º–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—è –¥–ª—è –∑–∞—Ç—Ä–∏–º–æ–∫ –≤–∏–ª—å–æ—Ç—É —Ç–∞ –ø—Ä–∏–ª—å–æ—Ç—É:

```sql
CREATE OR REPLACE VIEW dsongcp.flights AS
SELECT
  FlightDate AS FL_DATE,
  Reporting_Airline AS UNIQUE_CARRIER,
  OriginAirportSeqID AS ORIGIN_AIRPORT_SEQ_ID,
  Origin AS ORIGIN,
  DestAirportSeqID AS DEST_AIRPORT_SEQ_ID,
  Dest AS DEST,
  CRSDepTime AS CRS_DEP_TIME,
  DepTime AS DEP_TIME,
  CAST(DepDelay AS FLOAT64) AS DEP_DELAY,
  CAST(TaxiOut AS FLOAT64) AS TAXI_OUT,
  WheelsOff AS WHEELS_OFF,
  WheelsOn AS WHEELS_ON,
  CAST(TaxiIn AS FLOAT64) AS TAXI_IN,
  CRSArrTime AS CRS_ARR_TIME,
  ArrTime AS ARR_TIME,
  CAST(ArrDelay AS FLOAT64) AS ARR_DELAY,
  IF(Cancelled = '1.00', True, False) AS CANCELLED,
  IF(Diverted = '1.00', True, False) AS DIVERTED,
  DISTANCE
FROM dsongcp.flights_raw;
```

–¢–µ–ø–µ—Ä –º–æ–∂–µ–º–æ –ø—Ä–∏—Å—Ç—É–ø–∏—Ç–∏ –¥–æ –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—ó –¥–∞–Ω–∏—Ö.


