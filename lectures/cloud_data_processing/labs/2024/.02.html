<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ua" xml:lang="ua"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.547">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Лабораторна робота №2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src=".02_files/libs/clipboard/clipboard.min.js"></script>
<script src=".02_files/libs/quarto-html/quarto.js"></script>
<script src=".02_files/libs/quarto-html/popper.min.js"></script>
<script src=".02_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src=".02_files/libs/quarto-html/anchor.min.js"></script>
<link href=".02_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href=".02_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src=".02_files/libs/bootstrap/bootstrap.min.js"></script>
<link href=".02_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href=".02_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Лабораторна робота №2</h1>
<p class="subtitle lead">Хмарні технології обробки даних</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Важливо
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>Дедлайн</strong> здачі роботи: <strong>28.03.2024</strong></li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Розподіл по варіантах
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="cell-options" class="cell" data-execution_count="1">
<div id="options" class="cell-output cell-output-display" data-execution_count="1">
<style type="text/css">
</style>

<table id="T_61b4b" data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th id="T_61b4b_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">Студент</th>
<th id="T_61b4b_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">Варіант</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_61b4b_row0_col0" class="data row0 col0">Бовсуновська Марія Євгенівна</td>
<td id="T_61b4b_row0_col1" class="data row0 col1">Варіант 3</td>
</tr>
<tr class="even">
<td id="T_61b4b_row1_col0" class="data row1 col0">Бузюрова Анна Олександрівна</td>
<td id="T_61b4b_row1_col1" class="data row1 col1">Варіант 4</td>
</tr>
<tr class="odd">
<td id="T_61b4b_row2_col0" class="data row2 col0">Гудименко Максим Леонідович</td>
<td id="T_61b4b_row2_col1" class="data row2 col1">Варіант 1</td>
</tr>
<tr class="even">
<td id="T_61b4b_row3_col0" class="data row3 col0">Калініченко Назар Володимирович</td>
<td id="T_61b4b_row3_col1" class="data row3 col1">Варіант 1</td>
</tr>
<tr class="odd">
<td id="T_61b4b_row4_col0" class="data row4 col0">Кармелюк Тимофій Ігорович</td>
<td id="T_61b4b_row4_col1" class="data row4 col1">Варіант 3</td>
</tr>
<tr class="even">
<td id="T_61b4b_row5_col0" class="data row5 col0">Косован Іван Ігорович</td>
<td id="T_61b4b_row5_col1" class="data row5 col1">Варіант 2</td>
</tr>
<tr class="odd">
<td id="T_61b4b_row6_col0" class="data row6 col0">Малишев Кирило Едуардович</td>
<td id="T_61b4b_row6_col1" class="data row6 col1">Варіант 3</td>
</tr>
<tr class="even">
<td id="T_61b4b_row7_col0" class="data row7 col0">Марков Артур Андрійович</td>
<td id="T_61b4b_row7_col1" class="data row7 col1">Варіант 2</td>
</tr>
<tr class="odd">
<td id="T_61b4b_row8_col0" class="data row8 col0">Мельник Максим Володимирович</td>
<td id="T_61b4b_row8_col1" class="data row8 col1">Варіант 1</td>
</tr>
<tr class="even">
<td id="T_61b4b_row9_col0" class="data row9 col0">Морозов Ростислав Олегович</td>
<td id="T_61b4b_row9_col1" class="data row9 col1">Варіант 4</td>
</tr>
<tr class="odd">
<td id="T_61b4b_row10_col0" class="data row10 col0">Набережний Артур Вячеславович</td>
<td id="T_61b4b_row10_col1" class="data row10 col1">Варіант 4</td>
</tr>
<tr class="even">
<td id="T_61b4b_row11_col0" class="data row11 col0">Пантьо Іванка Іванівна</td>
<td id="T_61b4b_row11_col1" class="data row11 col1">Варіант 2</td>
</tr>
<tr class="odd">
<td id="T_61b4b_row12_col0" class="data row12 col0">Прийдун Марія Володимирівна</td>
<td id="T_61b4b_row12_col1" class="data row12 col1">Варіант 1</td>
</tr>
<tr class="even">
<td id="T_61b4b_row13_col0" class="data row13 col0">Титаренко Віктор Олександрович</td>
<td id="T_61b4b_row13_col1" class="data row13 col1">Варіант 2</td>
</tr>
<tr class="odd">
<td id="T_61b4b_row14_col0" class="data row14 col0">Фельдман Михайло Георгійович</td>
<td id="T_61b4b_row14_col1" class="data row14 col1">Варіант 1</td>
</tr>
<tr class="even">
<td id="T_61b4b_row15_col0" class="data row15 col0">Чернецький Дмитро Максимович</td>
<td id="T_61b4b_row15_col1" class="data row15 col1">Варіант 3</td>
</tr>
<tr class="odd">
<td id="T_61b4b_row16_col0" class="data row16 col0">Шабатін Павло Євгенійович</td>
<td id="T_61b4b_row16_col1" class="data row16 col1">Варіант 4</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<section id="попередні-вимоги" class="level2">
<h2 class="anchored" data-anchor-id="попередні-вимоги">Попередні вимоги</h2>
<p>Для виконання лабораторної роботи необхідно виконати завдання з <a href="https://aranaur.quarto.pub/01-lab-cloud-24/">попередньої лабораторної роботи</a>.</p>
</section>
<section id="завдання" class="level2">
<h2 class="anchored" data-anchor-id="завдання">Завдання</h2>
<p>Використовуючи дані з попередньої роботи, необхідно проаналізувати сервіс з доставки їжі та розрахуємо кілька показників. Вам потрібно написати кілька SQL-запитів в BigQuery та візуалізувати їх за допомогою <a href="https://lookerstudio.google.com/">Looker Studio</a>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">Варіант 1</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">Варіант 2</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false" href="">Варіант 3</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false" href="">Варіант 4</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>Проаналізуємо наскільки швидко зростає аудиторія нашого сервісу та подивимося на динаміку числа користувачів та кур’єрів.</p>
<section id="sec-1-1" class="level4">
<h4 class="anchored" data-anchor-id="sec-1-1">Завдання 1</h4>
<p>Для кожного дня, представленого в таблицях <code>user_actions</code> та <code>courier_actions</code>, розрахуйте такі показники:</p>
<ol type="1">
<li>Число нових користувачів.</li>
<li>Число нових кур’єрів.</li>
<li>Загальна кількість користувачів на сьогодні.</li>
<li>Загальна кількість кур’єрів на цей день.</li>
</ol>
<p>Колонки з показниками назвіть відповідно <code>new_users</code>, <code>new_couriers</code>, <code>total_users</code>, <code>total_couriers</code>. Колонку з датами назвіть <code>date</code>. Простежте, щоб показники були виражені <strong>цілими числами</strong>. Результат має бути відсортований за зростанням дати.</p>
<p>Поля в результуючій таблиці: <code>date</code>, <code>new_users</code>, <code>new_couriers</code>, <code>total_users</code>, <code>total_couriers</code></p>
<p><strong>Пояснення:</strong></p>
<p>Новими вважатимемо тих користувачів та кур’єрів, які в цей день здійснили свою першу дію в нашому сервісі. Загальна кількість користувачів/кур’єрів на поточний день — це результат додавання числа нових користувачів/кур’єрів у поточний день зі значеннями аналогічного показника всіх попередніх днів.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Підказка на випадок, якщо зовсім не виходить
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Щоб порахувати кількість нових користувачів/кур’єрів на кожну дату спочатку необхідно для кожного користувача/кур’єра визначити мінімальну дату, тобто дату першої дії в нашому сервісі. Потім потрібно провести групування і для кожної отриманої дати порахувати кількість користувачів/кур’єрів із цією датою. Далі до отриманої таблиці достатньо застосувати віконну функцію і кожної дати обчислити накопичувальну суму числа користувачів/кур’єрів.</p>
</div>
</div>
</div>
</section>
<section id="sec-1-2" class="level4">
<h4 class="anchored" data-anchor-id="sec-1-2">Завдання 2</h4>
<p>Аналізуючи динаміку показників із попереднього завдання, ви могли помітити, що порівнювати абсолютні значення не дуже зручно. Давайте порахуємо динаміку показників у відносних величинах.</p>
<p>Доповніть запит із попереднього завдання і тепер для кожного дня, поданого в таблицях <code>user_actions</code> та <code>courier_actions</code>, додатково розрахуйте такі показники:</p>
<ol type="1">
<li>Приріст числа нових користувачів.</li>
<li>Приріст числа нових кур’єрів.</li>
<li>Приріст загальної кількості користувачів.</li>
<li>Приріст загальної кількості кур’єрів.</li>
</ol>
<p>Показники, розраховані на попередньому кроці, також включіть у результуючу таблицю.</p>
<p>Колонки з новими показниками назвіть відповідно <code>new_users_change</code>, <code>new_couriers_change</code>, <code>total_users_growth</code>, <code>total_couriers_growth</code>. Колонку з датами назвіть <code>date</code>.</p>
<p>Усі показники приросту рахуйте <strong>у відсотках</strong> відносно попереднього дня. Під час розрахунку показників округляйте значення <strong>до двох знаків після коми</strong>.</p>
<p>Результуюча таблиця має бути відсортована за зростанням дати.</p>
<p>Поля в результуючій таблиці: <code>date</code>, <code>new_users</code>, <code>new_couriers</code>, <code>total_users</code>, <code>total_couriers</code>, <code>new_users_change</code>, <code>new_couriers_change</code>, <code>total_users_growth</code>, <code>total_couriers_growth</code></p>
<p><strong>Пояснення:</strong></p>
<p>Не забувайте при діленні заздалегідь наводити значення до потрібного типу даних. Пропущені значення приростів для першої дати не заповнюйте - просто залиште поля в цьому рядку порожніми.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Підказка на випадок, якщо зовсім не виходить
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Для розрахунку приростів скористайтесь віконними функціями та функціями зсунення.</p>
</div>
</div>
</div>
</section>
<section id="sec-1-3" class="level4">
<h4 class="anchored" data-anchor-id="sec-1-3">Завдання 3</h4>
<ul>
<li>Збережіть отримані результати в окремі представлення в BigQuery.</li>
<li>Підключіться до Looker Studio та побудуйте візуалізацію для отриманих даних.</li>
<li>Збережіть створену візуалізацію в окремий дашборд.</li>
<li>Поділіться посиланням на дашборд.</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Підказка щодо очікуваної візуалізації
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Очікується, що для Завдання 1 буде використані <strong>лінійні графіки</strong>, а для Завдання 2 - <strong>стовпчасті діаграми</strong>.</p>
<p>Але Ви можете запропонувати свої варіанти візуалізацій, якщо вони вважаєте, що вони краще підходять для відображення отриманих даних.</p>
</div>
</div>
</div>
</section>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>Проведемо аналіз користувачів, які оформлюють та оплачують замовлення у нашому сервісі.</p>
<section id="sec-2-1" class="level4">
<h4 class="anchored" data-anchor-id="sec-2-1">Завдання 1</h4>
<p>Для кожного дня, представленого в таблицях <code>user_actions</code> та <code>courier_actions</code>, розрахуйте такі показники:</p>
<ol type="1">
<li>Число користувачів, які оплачують замовлення.</li>
<li>Число активних кур’єрів.</li>
<li>Частку користувачів, що платять, в загальній кількості користувачів на поточний день.</li>
<li>Частку активних кур’єрів у кількості кур’єрів на поточний день.</li>
</ol>
<p>Колонки з показниками назвіть відповідно <code>paying_users</code>, <code>active_couriers</code>, <code>paying_users_share</code>, <code>active_couriers_share</code>. Колонку з датами назвіть <code>date</code>. Простежте, щоб абсолютні показники були виражені <strong>цілими числами</strong>. Усі показники часток необхідно виразити у <strong>відсотках</strong>. Під час їх розрахунку округляйте значення <strong>до двох знаків після коми</strong>.</p>
<p>Результат має бути відсортований за зростанням дати.</p>
<p>Поля в результуючій таблиці: <code>date</code>, <code>paying_users</code>, <code>active_couriers</code>, <code>paying_users_share</code>, <code>active_couriers_share</code></p>
<p><strong>Пояснення:</strong></p>
<p>Користувачів, які оплачують замовлення будемо вважати тих, які в даний день оформили хоча б одне замовлення, яке надалі не було скасовано.</p>
<p>Кур’єрів вважатимемо активними, якщо в даний день вони прийняли хоча б одне замовлення, яке було доставлено (можливо вже наступного дня), або доставили будь-яке замовлення.</p>
<p>Загальна кількість користувачів/кур’єрів на поточний день – це, як і раніше, результат складання числа нових користувачів/кур’єрів у поточний день зі значеннями аналогічного показника всіх попередніх днів. Ми рахували цей показник на попередніх кроках.</p>
<p>Не забувайте при діленні заздалегідь наводити значення до потрібного типу даних.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Підказка на випадок, якщо зовсім не виходить
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Для вирішення завдання необхідно спочатку для кожного дня порахувати кількість користувачів, які оплачують замовлення, і активних кур’єрів, а потім об’єднати отримані таблиці з даними про загальну кількість користувачів і кур’єрів на поточну дату і далі розрахувати всі необхідні відносні показники. Загальну кількість користувачів та кур’єрів на поточну дату ми вже рахували раніше.</p>
</div>
</div>
</div>
</section>
<section id="sec-2-2" class="level4">
<h4 class="anchored" data-anchor-id="sec-2-2">Завдання 2</h4>
<p>Для кожного дня, поданого в таблиці <code>user_actions</code>, розрахуйте такі показники:</p>
<ol type="1">
<li>Частку користувачів, які зробили в цей день всього одне замовлення, від загальної кількості користувачів, які оплачують замовлення.</li>
<li>Частку користувачів, які зробили цього дня кілька замовлень, від загальної кількості користувачів, які оплачують замовлення.</li>
</ol>
<p>Назвіть колонки з показниками відповідно <code>single_order_users_share</code>, <code>several_orders_users_share</code>. Колонку з датами назвіть <code>date</code>. Усі показники із частками необхідно виразити <strong>у відсотках</strong>. При розрахунку часток округляйте значення <strong>до двох знаків після коми</strong>.</p>
<p>Результат має бути відсортований за зростанням дати.</p>
<p>Поля в результуючій таблиці: <code>date</code>, <code>single_order_users_share</code>, <code>several_orders_users_share</code></p>
<p><strong>Пояснення:</strong></p>
<p>Користувачами, що оплачують замовлення, як і раніше, вважаємо тих користувачів, які в даний день оформили (і не скасували) хоча б одне замовлення.</p>
<p>Не забувайте при діленні заздалегідь наводити значення до потрібного типу даних.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Підказка на випадок, якщо зовсім не виходить
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Для вирішення завдання спочатку необхідно для кожного дня окремо розрахувати загальну кількість користувачів, що оплачують замовлення, кількість користувачів з одним замовленням і кількість користувачів з кількома замовленнями. Потім необхідно поєднати таблиці з цими даними за датою та порахувати всі необхідні показники.</p>
</div>
</div>
</div>
</section>
<section id="sec-2-3" class="level4">
<h4 class="anchored" data-anchor-id="sec-2-3">Завдання 3</h4>
<ul>
<li>Збережіть отримані результати в окремі представлення в BigQuery.</li>
<li>Підключіться до Looker Studio та побудуйте візуалізацію для отриманих даних.</li>
<li>Збережіть створену візуалізацію в окремий дашборд.</li>
<li>Поділіться посиланням на дашборд.</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Підказка щодо очікуваної візуалізації
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Для Завдання 1 очікується використання <strong>лінійного графіку</strong>, а для Завдання 2 — <strong>нормована стовпчаста діаграма</strong>.</p>
</div>
</div>
</div>
</section>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p>Розрахуємо декілька показників, пов’язаних із замовленнями.</p>
<p>Але Ви можете запропонувати свої варіанти візуалізацій, якщо вони вважаєте, що вони краще підходять для відображення отриманих даних.</p>
<section id="sec-3-1" class="level4">
<h4 class="anchored" data-anchor-id="sec-3-1">Завдання 1</h4>
<p>Для кожного дня, поданого в таблиці <code>user_actions</code>, розрахуйте такі показники:</p>
<ol type="1">
<li>Загальна кількість замовлень.</li>
<li>Число перших замовлень (замовлень, зроблених користувачами вперше).</li>
<li>Число замовлень нових користувачів (замовлень, зроблених користувачами того ж дня, коли вони вперше скористалися сервісом).</li>
<li>Частку перших замовлень у кількості замовлень (частку п.2 в п.1).</li>
<li>Частку замовлень нових користувачів у кількості замовлень (частку п.3 в п.1).</li>
</ol>
<p>Назвіть колонки з показниками відповідно <code>orders</code>, <code>first_orders</code>, <code>new_users_orders</code>, <code>first_orders_share</code>, <code>new_users_orders_share</code>. Колонку з датами назвіть <code>date</code>. Простежте, щоб у всіх випадках кількість замовлень була виражена <strong>цілим числом</strong>. Усі показники із частками необхідно виразити <strong>у відсотках</strong>. При розрахунку часток округляйте значення <strong>до двох знаків після коми</strong>.</p>
<p>Результат має бути відсортований за зростанням дати.</p>
<p>Поля в результуючій таблиці: <code>date</code>, <code>orders</code>, <code>first_orders</code>, <code>new_users_orders</code>, <code>first_orders_share</code>, <code>new_users_orders_share</code></p>
<p><strong>Пояснення:</strong></p>
<p>При розрахунку числа перших замовлень враховуйте, що у кожного користувача може бути лише одне перше замовлення (що цілком логічно).</p>
<p>При розрахунку числа замовлень нових користувачів враховуйте, що у свій перший день кожен новий користувач міг як зробити відразу кілька замовлень, так і не здійснити жодного.</p>
<p>У всіх випадках при розрахунку числа замовлень враховуйте лише фактично здійснені замовлення, скасовані замовлення не враховуйте.</p>
<p>Не забувайте при діленні заздалегідь приводити значення до потрібного типу даних.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Підказка на випадок, якщо зовсім не виходить
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Для вирішення завдання спочатку необхідно для кожного дня окремо розрахувати загальну кількість замовлень, кількість перших замовлень і кількість замовлень нових користувачів, а потім об’єднати отримані таблиці в одну і порахувати всі відносні показники. Для розрахунку числа перших замовлень для кожного користувача потрібно знайти дату оформлення першого нескасованого замовлення і потім здійснити групування за датою, порахувавши для кожного дня кількість користувачів, які зробили перше замовлення. Для розрахунку числа замовлень нових користувачів спочатку потрібно для кожного користувача знайти дату здійснення першої дії, а потім доповнити цю таблицю даними про кількість замовлень, зроблених користувачем свого першого дня. Це можна зробити, приєднавши до таблиці з датами перших дій таблицю із загальною кількістю замовлень на кожну дату для кожного користувача. Зверніть увагу, що в цій таблиці для деяких користувачів можуть бути відсутні дати здійснення першої дії оскільки користувач міг скасувати замовлення і фактично не здійснити жодної покупки свого першого дня. Після об’єднання таблиць для таких днів із пропущеними значеннями слід вказати кількість замовлень рівним 0. Це можна зробити, наприклад, за допомогою функції <code>COALESCE</code>.</p>
</div>
</div>
</div>
</section>
<section id="sec-3-2" class="level4">
<h4 class="anchored" data-anchor-id="sec-3-2">Завдання 2</h4>
<p>Оцінимо навантаження на наших кур’єрів і дізнаємося, скільки в середньому замовлень та користувачів припадає на кожного з них.</p>
<p>На основі даних у таблицях <code>user_actions</code>, <code>courier_actions</code> та <code>orders</code> для кожного дня розрахуйте такі показники:</p>
<ol type="1">
<li>Кількість користувачів, що оплатили замовлення на одного активного кур’єра.</li>
<li>Кількість замовлень на одного активного кур’єра.</li>
</ol>
<p>Колонки з показниками назвіть відповідно <code>users_per_courier</code> та <code>orders_per_courier</code>. Колонку з датами назвіть <code>date</code>. Під час розрахунку показників округляйте значення <strong>до двох знаків після коми</strong>.</p>
<p>Результуюча таблиця має бути відсортована за зростанням дати.</p>
<p>Поля в результуючій таблиці: <code>date</code>, <code>users_per_courier</code>, <code>orders_per_courier</code></p>
<p><strong>Пояснення:</strong></p>
<p>Користувачів, що оплатили замовлення, як і раніше, вважаємо тих користувачів, які в даний день оформили хоча б одне замовлення, яке надалі не було скасовано.</p>
<p>Кур’єрів вважаємо активними, якщо в даний день вони прийняли хоча б одне замовлення, яке було доставлено (можливо вже наступного дня), або доставили будь-яке замовлення.</p>
<p>У розрахунках враховуйте лише нескасовані замовлення.</p>
<p>Не забувайте при діленні заздалегідь наводити значення до потрібного типу даних.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Підказка на випадок, якщо зовсім не виходить
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Для вирішення завдання спочатку необхідно за допомогою групування та агрегації розрахувати кількість користувачів, кур’єрів та замовлень на кожну дату, а потім об’єднати дані в одну таблицю та провести всі необхідні розрахунки.</p>
</div>
</div>
</div>
</section>
<section id="sec-3-3" class="level4">
<h4 class="anchored" data-anchor-id="sec-3-3">Завдання 3</h4>
<ul>
<li>Збережіть отримані результати в окремі представлення в BigQuery.</li>
<li>Підключіться до Looker Studio та побудуйте візуалізацію для отриманих даних.</li>
<li>Збережіть створену візуалізацію в окремий дашборд.</li>
<li>Поділіться посиланням на дашборд.</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Підказка щодо очікуваної візуалізації
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Для Завдання 1 та Завдання 2 очікується використання <strong>лінійного графіку</strong>.</p>
<p>Але Ви можете запропонувати свої варіанти візуалізацій, якщо вони вважаєте, що вони краще підходять для відображення отриманих даних.</p>
</div>
</div>
</div>
</section>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<section id="sec-4-1" class="level4">
<h4 class="anchored" data-anchor-id="sec-4-1">Завдання 1</h4>
<p>На основі даних у таблиці <code>courier_actions</code> для кожного дня розрахуйте, за скільки хвилин у середньому кур’єри доставляли свої замовлення.</p>
<p>Назвіть колонку з показником <code>minutes_to_deliver</code>. Колонку з датами назвіть <code>date</code>. При розрахунку середнього часу доставки <strong>округляйте кількість хвилин до цілих значень</strong>. Враховуйте лише <strong>доставлені замовлення</strong>, скасовані замовлення не враховуйте.</p>
<p>Результуюча таблиця має бути відсортована за зростанням дати.</p>
<p>Поля в результуючій таблиці: <code>date</code>, <code>minutes_to_deliver</code></p>
<p><strong>Пояснення:</strong></p>
<p>Для вирішення завдання вам, можливо, доведеться згадати, як визначити кількість хвилин, що містяться в інтервалі часу.</p>
<p>Деякі замовлення оформляють одного дня, а доставляють вже наступного. При розрахунку середнього часу доставки в якості днів, для яких рахується середнє, використовуйте дні фактичної доставки замовлень.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Підказка на випадок, якщо зовсім не виходить
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Для вирішення завдання спочатку необхідно за допомогою групування та агрегації для кожного замовлення розрахувати час прийняття замовлення кур’єром (мінімальна позначка часу) та час доставки (максимальна позначка часу), обчислити різницю між цими значеннями та перевівши їх за хвилини. Потім можна провести групування за датою доставки та обчислити середній час доставки у кожний із днів.</p>
</div>
</div>
</div>
</section>
<section id="sec-4-2" class="level4">
<h4 class="anchored" data-anchor-id="sec-4-2">Завдання 2</h4>
<p>На основі даних у таблиці <code>orders</code> для кожної години на добу розрахуйте такі показники:</p>
<ol type="1">
<li>Число успішних (доставлених) замовлень.</li>
<li>Число скасованих замовлень.</li>
<li>Частку скасованих замовлень у загальній кількості замовлень (<strong>cancel rate</strong>).</li>
</ol>
<p>Колонки з показниками назвіть відповідно <code>successful_orders</code>, <code>canceled_orders</code>, <code>cancel_rate</code>. Колонку із годиною оформлення замовлення назвіть <code>hour</code>. При розрахунку частки скасованих замовлень округляйте значення <strong>до трьох знаків після коми</strong>.</p>
<p>Результуюча таблиця має бути відсортована за зростанням колонки з годиною оформлення замовлення.</p>
<p>Поля в результуючій таблиці: <code>hour</code>, <code>successful_orders</code>, <code>canceled_orders</code>, <code>cancel_rate</code></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Підказка на випадок, якщо зовсім не виходить
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Для вирішення завдання можна спочатку за допомогою групування за датою та агрегацією окремо розрахувати кількість успішних та скасованих замовлень, потім об’єднати дві таблиці в одну за датою і потім розрахувати <code>cancel_rate</code>.</p>
</div>
</div>
</div>
</section>
<section id="sec-4-3" class="level4">
<h4 class="anchored" data-anchor-id="sec-4-3">Завдання 3</h4>
<ul>
<li>Збережіть отримані результати в окремі представлення в BigQuery.</li>
<li>Підключіться до Looker Studio та побудуйте візуалізацію для отриманих даних.</li>
<li>Збережіть створену візуалізацію в окремий дашборд.</li>
<li>Поділіться посиланням на дашборд.</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Підказка щодо очікуваної візуалізації
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Для Завдання 1 очікується використання <strong>лінійного графіку</strong>, а для Завдання 2 - <strong>комбінованої діаграми</strong>.</p>
<p>Але Ви можете запропонувати свої варіанти візуалізацій, якщо вони вважаєте, що вони краще підходять для відображення отриманих даних.</p>
</div>
</div>
</div>
</section>
</div>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Скопійовано!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Скопійовано!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>