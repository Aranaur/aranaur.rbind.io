<!DOCTYPE html>
<html lang="en"><head>
<script src=".02_files/libs/clipboard/clipboard.min.js"></script>
<script src=".02_files/libs/quarto-html/tabby.min.js"></script>
<script src=".02_files/libs/quarto-html/popper.min.js"></script>
<script src=".02_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href=".02_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href=".02_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href=".02_files/libs/quarto-html/quarto-syntax-highlighting-de84f8d6bb715db06a919283c2d1e787.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src=".02_files/libs/quarto-contrib/iconify-1.0.7/iconify-icon.min.js"></script><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.42">

  <meta name="author" content="–Ü–≥–æ—Ä –ú—ñ—Ä–æ—à–Ω–∏—á–µ–Ω–∫–æ">
  <title>–û—Å–Ω–æ–≤–∏ –≤–µ–ª–∏–∫–∏—Ö –¥–∞–Ω–∏—Ö –∑ PySpark</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href=".02_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href=".02_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #24292e;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #24292e; } /* Normal */
    code span.al { color: #ff5555; font-weight: bold; } /* Alert */
    code span.an { color: #6a737d; } /* Annotation */
    code span.at { color: #d73a49; } /* Attribute */
    code span.bn { color: #005cc5; } /* BaseN */
    code span.bu { color: #d73a49; } /* BuiltIn */
    code span.cf { color: #d73a49; } /* ControlFlow */
    code span.ch { color: #032f62; } /* Char */
    code span.cn { color: #005cc5; } /* Constant */
    code span.co { color: #6a737d; } /* Comment */
    code span.cv { color: #6a737d; } /* CommentVar */
    code span.do { color: #6a737d; } /* Documentation */
    code span.dt { color: #d73a49; } /* DataType */
    code span.dv { color: #005cc5; } /* DecVal */
    code span.er { color: #ff5555; text-decoration: underline; } /* Error */
    code span.ex { color: #d73a49; font-weight: bold; } /* Extension */
    code span.fl { color: #005cc5; } /* Float */
    code span.fu { color: #6f42c1; } /* Function */
    code span.im { color: #032f62; } /* Import */
    code span.in { color: #6a737d; } /* Information */
    code span.kw { color: #d73a49; } /* Keyword */
    code span.op { color: #24292e; } /* Operator */
    code span.ot { color: #6f42c1; } /* Other */
    code span.pp { color: #d73a49; } /* Preprocessor */
    code span.re { color: #6a737d; } /* RegionMarker */
    code span.sc { color: #005cc5; } /* SpecialChar */
    code span.ss { color: #032f62; } /* SpecialString */
    code span.st { color: #032f62; } /* String */
    code span.va { color: #e36209; } /* Variable */
    code span.vs { color: #032f62; } /* VerbatimString */
    code span.wa { color: #ff5555; } /* Warning */
  </style>
  <link rel="stylesheet" href=".02_files/libs/revealjs/dist/theme/quarto-26a030a05c7f22f9b9eae400ebcceb06.css">
  <link href=".02_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href=".02_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href=".02_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href=".02_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href=".02_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href=".02_files/libs/revealjs/plugin/verticator/verticator.css" rel="stylesheet">
  <link href=".02_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-iframe=".02_files/libs/colored-particles/index.html" class="quarto-title-block center">
  <h1 class="title">–û—Å–Ω–æ–≤–∏ –≤–µ–ª–∏–∫–∏—Ö –¥–∞–Ω–∏—Ö –∑ PySpark</h1>
  <p class="subtitle">–ú–æ–¥–µ–ª—ñ —Ç–∞ –º–µ—Ç–æ–¥–∏ –æ–±—Ä–æ–±–∫–∏ –≤–µ–ª–∏–∫–∏—Ö –¥–∞–Ω–∏—Ö</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
–Ü–≥–æ—Ä –ú—ñ—Ä–æ—à–Ω–∏—á–µ–Ω–∫–æ 
</div>
        <p class="quarto-title-affiliation">
            –ö–ù–£ —ñ–º–µ–Ω—ñ –¢–∞—Ä–∞—Å–∞ –®–µ–≤—á–µ–Ω–∫–∞, –§–Ü–¢
          </p>
    </div>
</div>

</section><section id="TOC">
<nav role="doc-toc"> 
<h2 id="toc-title">–ó–º—ñ—Å—Ç</h2>
<ul>
<li><a href="#/–≤—Å—Ç—É–ø-–¥–æ-–∞–Ω–∞–ª—ñ–∑—É-–≤–µ–ª–∏–∫–∏—Ö-–¥–∞–Ω–∏—Ö-–∑–∞-–¥–æ–ø–æ–º–æ–≥–æ—é-spark" id="/toc-–≤—Å—Ç—É–ø-–¥–æ-–∞–Ω–∞–ª—ñ–∑—É-–≤–µ–ª–∏–∫–∏—Ö-–¥–∞–Ω–∏—Ö-–∑–∞-–¥–æ–ø–æ–º–æ–≥–æ—é-spark">–í—Å—Ç—É–ø –¥–æ –∞–Ω–∞–ª—ñ–∑—É –≤–µ–ª–∏–∫–∏—Ö –¥–∞–Ω–∏—Ö –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Spark</a></li>
<li><a href="#/–ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è-–≤-pyspark-rdd" id="/toc-–ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è-–≤-pyspark-rdd">–ü—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è –≤ PySpark RDD</a></li>
<li><a href="#/pyspark-sql" id="/toc-pyspark-sql">PySpark SQL</a></li>
<li><a href="#/pyspark-mllib" id="/toc-pyspark-mllib">PySpark MLlib</a></li>
</ul>
</nav>
</section>
<section>
<section id="–≤—Å—Ç—É–ø-–¥–æ-–∞–Ω–∞–ª—ñ–∑—É-–≤–µ–ª–∏–∫–∏—Ö-–¥–∞–Ω–∏—Ö-–∑–∞-–¥–æ–ø–æ–º–æ–≥–æ—é-spark" class="title-slide slide level1 center">
<h1>–í—Å—Ç—É–ø –¥–æ –∞–Ω–∞–ª—ñ–∑—É –≤–µ–ª–∏–∫–∏—Ö –¥–∞–Ω–∏—Ö –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Spark</h1>

</section>
<section id="—â–æ-—Ç–∞–∫–µ-–≤–µ–ª–∏–∫—ñ-–¥–∞–Ω—ñ" class="slide level2">
<h2>–©–æ —Ç–∞–∫–µ –≤–µ–ª–∏–∫—ñ –¥–∞–Ω—ñ?</h2>
<blockquote>
<p>–í–µ–ª–∏–∫—ñ –¥–∞–Ω—ñ ‚Äî –Ω–∞–±–æ—Ä–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó (—è–∫ —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω–æ—ó, —Ç–∞–∫ —ñ –Ω–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω–æ—ó) –Ω–∞—Å—Ç—ñ–ª—å–∫–∏ –≤–µ–ª–∏–∫–∏—Ö —Ä–æ–∑–º—ñ—Ä—ñ–≤, —â–æ —Ç—Ä–∞–¥–∏—Ü—ñ–π–Ω—ñ —Å–ø–æ—Å–æ–±–∏ —Ç–∞ –ø—ñ–¥—Ö–æ–¥–∏ (–∑–¥–µ–±—ñ–ª—å—à–æ–≥–æ –∑–∞—Å–Ω–æ–≤–∞–Ω—ñ –Ω–∞ —Ä—ñ—à–µ–Ω–Ω—è—Ö –∫–ª–∞—Å—É –±—ñ–∑–Ω–µ—Å–æ–≤–æ—ó –∞–Ω–∞–ª—ñ—Ç–∏–∫–∏ —Ç–∞ —Å–∏—Å—Ç–µ–º–∞—Ö —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –±–∞–∑–∞–º–∏ –¥–∞–Ω–∏—Ö) –Ω–µ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –∑–∞—Å—Ç–æ—Å–æ–≤–∞–Ω—ñ –¥–æ –Ω–∏—Ö - Wikipedia</p>
</blockquote>
</section>
<section id="—Ç—Ä–∏-v-–≤–µ–ª–∏–∫–∏—Ö-–¥–∞–Ω–∏—Ö" class="slide level2">
<h2>–¢—Ä–∏ ¬´V¬ª –≤–µ–ª–∏–∫–∏—Ö –¥–∞–Ω–∏—Ö</h2>
<ul>
<li><strong>–û–±—Å—è–≥</strong> (Volume) ‚Äî –æ–±—Å—è–≥ –¥–∞–Ω–∏—Ö, —è–∫—ñ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ —Ç–∞ –æ–±—Ä–æ–±–ª—è—Ç–∏. –¶–µ –º–æ–∂–µ –±—É—Ç–∏ –≤–µ–ª–∏—á–µ–∑–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –¥–∞–Ω–∏—Ö, —â–æ –ø–µ—Ä–µ–≤–∏—â—É—î –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ —Ç—Ä–∞–¥–∏—Ü—ñ–π–Ω–∏—Ö —Å–∏—Å—Ç–µ–º –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è.</li>
<li><strong>–®–≤–∏–¥–∫—ñ—Å—Ç—å</strong> (Velocity) ‚Äî —à–≤–∏–¥–∫—ñ—Å—Ç—å, –∑ —è–∫–æ—é –¥–∞–Ω—ñ –≥–µ–Ω–µ—Ä—É—é—Ç—å—Å—è —Ç–∞ –æ–±—Ä–æ–±–ª—è—é—Ç—å—Å—è. –¶–µ –º–æ–∂–µ –±—É—Ç–∏ –ø–æ—Ç—ñ–∫ –¥–∞–Ω–∏—Ö —É —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ –∞–±–æ –¥–∞–Ω—ñ, —è–∫—ñ –Ω–∞–¥—Ö–æ–¥—è—Ç—å –∑ —Ä—ñ–∑–Ω–∏—Ö –¥–∂–µ—Ä–µ–ª.</li>
<li><strong>–†—ñ–∑–Ω–æ–º–∞–Ω—ñ—Ç–Ω—ñ—Å—Ç—å</strong> (Variety) ‚Äî —Ä—ñ–∑–Ω–æ–º–∞–Ω—ñ—Ç–Ω—ñ—Å—Ç—å —Ç–∏–ø—ñ–≤ –¥–∞–Ω–∏—Ö, —è–∫—ñ –ø–æ—Ç—Ä—ñ–±–Ω–æ –æ–±—Ä–æ–±–ª—è—Ç–∏. –¶–µ –º–æ–∂—É—Ç—å –±—É—Ç–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω—ñ, –Ω–∞–ø—ñ–≤—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω—ñ —Ç–∞ –Ω–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω—ñ –¥–∞–Ω—ñ –∑ —Ä—ñ–∑–Ω–∏—Ö –¥–∂–µ—Ä–µ–ª.</li>
</ul>
</section>
<section id="–∫–æ–Ω—Ü–µ–ø—Ü—ñ—ó-—Ç–∞-—Ç–µ—Ä–º—ñ–Ω–æ–ª–æ–≥—ñ—è-–≤–µ–ª–∏–∫–∏—Ö-–¥–∞–Ω–∏—Ö" class="slide level2">
<h2>–ö–æ–Ω—Ü–µ–ø—Ü—ñ—ó —Ç–∞ —Ç–µ—Ä–º—ñ–Ω–æ–ª–æ–≥—ñ—è –≤–µ–ª–∏–∫–∏—Ö –¥–∞–Ω–∏—Ö</h2>
<ul>
<li><strong>–ö–ª–∞—Å—Ç–µ—Ä–Ω—ñ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è</strong>: –û–±‚Äô—î–¥–Ω–∞–Ω–Ω—è —Ä–µ—Å—É—Ä—Å—ñ–≤ –¥–µ–∫—ñ–ª—å–∫–æ—Ö –º–∞—à–∏–Ω</li>
<li><strong>–ü–∞—Ä–∞–ª–µ–ª—å–Ω—ñ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è</strong>: –û–¥–Ω–æ—á–∞—Å–Ω—ñ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è –Ω–∞ –æ–¥–Ω–æ–º—É –∫–æ–º–ø‚Äô—é—Ç–µ—Ä—ñ</li>
<li><strong>–†–æ–∑–ø–æ–¥—ñ–ª–µ–Ω—ñ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è</strong>: –°—É–∫—É–ø–Ω—ñ—Å—Ç—å –≤—É–∑–ª—ñ–≤ (–º–µ—Ä–µ–∂–µ–≤–∏—Ö –∫–æ–º–ø‚Äô—é—Ç–µ—Ä—ñ–≤), —è–∫—ñ –ø—Ä–∞—Ü—é—é—Ç—å –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ</li>
<li><strong>–ü–∞–∫–µ—Ç–Ω–∞ –æ–±—Ä–æ–±–∫–∞</strong>: –†–æ–∑–±–∏—Ç—Ç—è –∑–∞–≤–¥–∞–Ω–Ω—è –Ω–∞ –Ω–µ–≤–µ–ª–∏–∫—ñ —á–∞—Å—Ç–∏–Ω–∏ —ñ –∑–∞–ø—É—Å–∫ —ó—Ö –Ω–∞ –æ–∫—Ä–µ–º–∏—Ö –º–∞—à–∏–Ω–∞—Ö</li>
<li><strong>–û–±—Ä–æ–±–∫–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ</strong>: –ù–µ–≥–∞–π–Ω–∞ –æ–±—Ä–æ–±–∫–∞ –¥–∞–Ω–∏—Ö</li>
</ul>
</section>
<section id="—Å–∏—Å—Ç–µ–º–∏-–æ–±—Ä–æ–±–∫–∏-–≤–µ–ª–∏–∫–∏—Ö-–¥–∞–Ω–∏—Ö" class="slide level2 smaller">
<h2>–°–∏—Å—Ç–µ–º–∏ –æ–±—Ä–æ–±–∫–∏ –≤–µ–ª–∏–∫–∏—Ö –¥–∞–Ω–∏—Ö</h2>
<ul>
<li><strong>Hadoop/MapReduce</strong>: –ú–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω–∏–π —Ç–∞ –≤—ñ–¥–º–æ–≤–æ—Å—Ç—ñ–π–∫–∏–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –Ω–∞ Java
<ul>
<li>–í—ñ–¥–∫—Ä–∏—Ç–∏–π –≤–∏—Ö—ñ–¥–Ω–∏–π –∫–æ–¥</li>
<li>–ü–∞–∫–µ—Ç–Ω–∞ –æ–±—Ä–æ–±–∫–∞</li>
</ul></li>
<li><strong>Apache Spark</strong>: –£–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–∞ —Ç–∞ —à–≤–∏–¥–∫–∞ –∫–ª–∞—Å—Ç–µ—Ä–Ω–∞ –æ–±—á–∏—Å–ª—é–≤–∞–ª—å–Ω–∞ —Å–∏—Å—Ç–µ–º–∞
<ul>
<li>–í—ñ–¥–∫—Ä–∏—Ç–∏–π –≤–∏—Ö—ñ–¥–Ω–∏–π –∫–æ–¥</li>
<li>–ü–∞–∫–µ—Ç–Ω–∞ –æ–±—Ä–æ–±–∫–∞ –¥–∞–Ω–∏—Ö —Ç–∞ –æ–±—Ä–æ–±–∫–∞ –¥–∞–Ω–∏—Ö —É —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ</li>
</ul></li>
</ul>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>–ü—Ä–∏–º—ñ—Ç–∫–∞</strong></p>
</div>
<div class="callout-content">
<p>Apache Spark –Ω–∞ —Å—å–æ–≥–æ–¥–Ω—ñ—à–Ω—ñ–π –¥–µ–Ω—å —î –∫—Ä–∞—â–∏–º –∑–∞ Hadoop/MapReduce —É –±—ñ–ª—å—à–æ—Å—Ç—ñ –≤–∏–ø–∞–¥–∫—ñ–≤, –æ—Å–∫—ñ–ª—å–∫–∏ –≤—ñ–Ω —à–≤–∏–¥—à–∏–π, –ø—Ä–æ—Å—Ç—ñ—à–∏–π —É –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—ñ —Ç–∞ –ø—ñ–¥—Ç—Ä–∏–º—É—î —Ä—ñ–∑–Ω–æ–º–∞–Ω—ñ—Ç–Ω—ñ –¥–∂–µ—Ä–µ–ª–∞ –¥–∞–Ω–∏—Ö.</p>
</div>
</div>
</div>
</section>
<section id="–æ—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫—É-apache-spark" class="slide level2">
<h2>–û—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫—É Apache Spark</h2>
<ul>
<li>–§—Ä–µ–π–º–≤–æ—Ä–∫ —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω–∏—Ö –∫–ª–∞—Å—Ç–µ—Ä–Ω–∏—Ö –æ–±—á–∏—Å–ª–µ–Ω—å</li>
<li>–ï—Ñ–µ–∫—Ç–∏–≤–Ω—ñ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è –≤ –ø–∞–º‚Äô—è—Ç—ñ –¥–ª—è –≤–µ–ª–∏–∫–∏—Ö –º–∞—Å–∏–≤—ñ–≤ –¥–∞–Ω–∏—Ö</li>
<li>–ë–ª–∏—Å–∫–∞–≤–∏—á–Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –æ–±—Ä–æ–±–∫–∏ –¥–∞–Ω–∏—Ö</li>
<li>–ó–∞–±–µ–∑–ø–µ—á—É—î –ø—ñ–¥—Ç—Ä–∏–º–∫—É Java, Scala, Python, R —Ç–∞ SQL</li>
</ul>
</section>
<section id="–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏-apache-spark" class="slide level2">
<h2>–ö–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ Apache Spark</h2>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<svg width="960" height="480" viewbox="0.00 0.00 782.00 188.00" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none; display: block; margin: auto auto auto auto">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 184)">
<title>SparkArchitecture</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-184 778,-184 778,4 -4,4"></polygon>
<!-- Core -->
<g id="node1" class="node">
<title>Core</title>
<polygon fill="#72a8eb" stroke="black" points="477,-72 297,-72 297,0 477,0 477,-72"></polygon>
<text text-anchor="middle" x="387" y="-40.2" font-family="Times,serif" font-size="14.00">Apache Spark Core</text>
<text text-anchor="middle" x="387" y="-23.4" font-family="Times,serif" font-size="14.00">RDD API</text>
</g>
<!-- SQL -->
<g id="node2" class="node">
<title>SQL</title>
<polygon fill="#1a3a7a" stroke="black" points="180,-180 0,-180 0,-108 180,-108 180,-180"></polygon>
<text text-anchor="middle" x="90" y="-139.8" font-family="Times,serif" font-size="14.00" fill="white">Spark SQL</text>
</g>
<!-- Core&#45;&gt;SQL -->
<g id="edge1" class="edge">
<title>Core-&gt;SQL</title>
<path fill="none" stroke="black" d="M296.68,-69.24C262.91,-81.29 224.37,-95.04 189.79,-107.39"></path>
<polygon fill="black" stroke="black" points="188.39,-104.17 180.15,-110.83 190.74,-110.76 188.39,-104.17"></polygon>
</g>
<!-- ML -->
<g id="node3" class="node">
<title>ML</title>
<polygon fill="#1a3a7a" stroke="black" points="378,-180 198,-180 198,-108 378,-108 378,-180"></polygon>
<text text-anchor="middle" x="288" y="-148.2" font-family="Times,serif" font-size="14.00" fill="white">MLlib</text>
<text text-anchor="middle" x="288" y="-131.4" font-family="Times,serif" font-size="14.00" fill="white">Machine Learning</text>
</g>
<!-- Core&#45;&gt;ML -->
<g id="edge2" class="edge">
<title>Core-&gt;ML</title>
<path fill="none" stroke="black" d="M354.31,-72C345.87,-81.04 336.68,-90.88 327.91,-100.26"></path>
<polygon fill="black" stroke="black" points="325.26,-97.98 320.99,-107.67 330.38,-102.75 325.26,-97.98"></polygon>
</g>
<!-- GraphX -->
<g id="node4" class="node">
<title>GraphX</title>
<polygon fill="#1a3a7a" stroke="black" points="576,-180 396,-180 396,-108 576,-108 576,-180"></polygon>
<text text-anchor="middle" x="486" y="-139.8" font-family="Times,serif" font-size="14.00" fill="white">GraphX</text>
</g>
<!-- Core&#45;&gt;GraphX -->
<g id="edge3" class="edge">
<title>Core-&gt;GraphX</title>
<path fill="none" stroke="black" d="M419.69,-72C428.13,-81.04 437.32,-90.88 446.09,-100.26"></path>
<polygon fill="black" stroke="black" points="443.62,-102.75 453.01,-107.67 448.74,-97.98 443.62,-102.75"></polygon>
</g>
<!-- Streaming -->
<g id="node5" class="node">
<title>Streaming</title>
<polygon fill="#1a3a7a" stroke="black" points="774,-180 594,-180 594,-108 774,-108 774,-180"></polygon>
<text text-anchor="middle" x="684" y="-139.8" font-family="Times,serif" font-size="14.00" fill="white">Spark Streaming</text>
</g>
<!-- Core&#45;&gt;Streaming -->
<g id="edge4" class="edge">
<title>Core-&gt;Streaming</title>
<path fill="none" stroke="black" d="M477.32,-69.24C511.09,-81.29 549.63,-95.04 584.21,-107.39"></path>
<polygon fill="black" stroke="black" points="583.26,-110.76 593.85,-110.83 585.61,-104.17 583.26,-110.76"></polygon>
</g>
</g>
</svg>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
<section id="—Ä–µ–∂–∏–º–∏-—Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è-spark" class="slide level2">
<h2>–†–µ–∂–∏–º–∏ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è Spark</h2>
<ul>
<li><strong>–õ–æ–∫–∞–ª—å–Ω–∏–π —Ä–µ–∂–∏–º</strong>: –û–¥–Ω–∞ –º–∞—à–∏–Ω–∞, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –≤–∞—à –Ω–æ—É—Ç–±—É–∫
<ul>
<li>–õ–æ–∫–∞–ª—å–Ω–∞ –º–æ–¥–µ–ª—å –∑—Ä—É—á–Ω–∞ –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è, –Ω–∞–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è —Ç–∞ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—ó</li>
</ul></li>
<li><strong>–ö–ª–∞—Å—Ç–µ—Ä–Ω–∏–π —Ä–µ–∂–∏–º</strong>: –ù–∞–±—ñ—Ä –∑–∞–∑–¥–∞–ª–µ–≥—ñ–¥—å –≤–∏–∑–Ω–∞—á–µ–Ω–∏—Ö –º–∞—à–∏–Ω
<ul>
<li>–î–æ–±—Ä–µ –ø—ñ–¥—Ö–æ–¥–∏—Ç—å –¥–ª—è —Ä–µ–∞–ª—å–Ω–∏—Ö —Å—Ü–µ–Ω–∞—Ä—ñ—ó–≤, –∫–æ–ª–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ –æ–±—Ä–æ–±–ª—è—Ç–∏ –≤–µ–ª–∏–∫—ñ –æ–±—Å—è–≥–∏ –¥–∞–Ω–∏—Ö</li>
</ul></li>
<li>–†–æ–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å: –õ–æ–∫–∞–ª—å–Ω–æ <span class="math inline">\(\rightarrow\)</span> –∫–ª–∞—Å—Ç–µ—Ä–∏</li>
<li>–ù–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–º—ñ–Ω—é–≤–∞—Ç–∏ –∫–æ–¥</li>
</ul>
</section></section>
<section>
<section id="pyspark-spark-–∑-python" class="title-slide slide level1 unnumbered unlisted center">
<h1>PySpark: Spark –∑ Python</h1>

</section>
<section id="–æ–≥–ª—è–¥-pyspark" class="slide level2">
<h2>–û–≥–ª—è–¥ PySpark</h2>
<ul>
<li>Apache Spark –Ω–∞–ø–∏—Å–∞–Ω–æ –Ω–∞ Scala</li>
<li>–î–ª—è –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ Python –∑—ñ Spark, —Å–ø—ñ–ª—å–Ω–æ—Ç–∞ Apache Spark –≤–∏–ø—É—Å—Ç–∏–ª–∞ PySpark</li>
<li>–ü–æ–¥—ñ–±–Ω–∞ —à–≤–∏–¥–∫—ñ—Å—Ç—å —Ç–∞ –ø–æ—Ç—É–∂–Ω—ñ—Å—Ç—å –æ–±—á–∏—Å–ª–µ–Ω—å –¥–æ Scala</li>
<li>API PySpark —Å—Ö–æ–∂—ñ –Ω–∞ Pandas —Ç–∞ Scikit-learn</li>
</ul>
</section>
<section id="—â–æ-—Ç–∞–∫–µ-–æ–±–æ–ª–æ–Ω–∫–∞-spark" class="slide level2">
<h2>–©–æ —Ç–∞–∫–µ –æ–±–æ–ª–æ–Ω–∫–∞ Spark?</h2>
<ul>
<li>–Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–µ —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∑–∞–≤–¥–∞–Ω—å Spark</li>
<li>–î–æ–ø–æ–º–∞–≥–∞—î –¥–ª—è —à–≤–∏–¥–∫–æ–≥–æ —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø—Ä–æ—Ç–æ—Ç–∏–ø—É–≤–∞–Ω–Ω—è</li>
<li>–û–±–æ–ª–æ–Ω–∫–∏ Spark –¥–æ–∑–≤–æ–ª—è—é—Ç—å –≤–∑–∞—î–º–æ–¥—ñ—è—Ç–∏ –∑ –¥–∞–Ω–∏–º–∏ –Ω–∞ –¥–∏—Å–∫—É –∞–±–æ –≤ –ø–∞–º‚Äô—è—Ç—ñ</li>
<li>–¢—Ä–∏ —Ä—ñ–∑–Ω—ñ –æ–±–æ–ª–æ–Ω–∫–∏ Spark:
<ul>
<li>Spark-–æ–±–æ–ª–æ–Ω–∫–∞ –¥–ª—è Scala</li>
<li>PySpark-–æ–±–æ–ª–æ–Ω–∫–∞ –¥–ª—è Python</li>
<li>SparkR –¥–ª—è R</li>
</ul></li>
</ul>
</section>
<section id="pyspark-shell" class="slide level2">
<h2>PySpark shell</h2>
<ul>
<li>–û–±–æ–ª–æ–Ω–∫–∞ PySpark ‚Äî —Ü–µ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –∫–æ–º–∞–Ω–¥–Ω–æ–≥–æ —Ä—è–¥–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤—ñ Python</li>
<li>–û–±–æ–ª–æ–Ω–∫–∞ PySpark –¥–æ–∑–≤–æ–ª—è—î –∞–Ω–∞–ª—ñ—Ç–∏–∫–∞–º –¥–∞–Ω–∏—Ö –≤–∑–∞—î–º–æ–¥—ñ—è—Ç–∏ –∑—ñ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞–º–∏ –¥–∞–Ω–∏—Ö Spark</li>
<li>PySpark shell –ø—ñ–¥—Ç—Ä–∏–º—É—î –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞</li>
</ul>
</section>
<section id="—Ä–æ–∑—É–º—ñ–Ω–Ω—è-sparkcontext" class="slide level2">
<h2>–†–æ–∑—É–º—ñ–Ω–Ω—è SparkContext</h2>
<ul>
<li>SparkContext ‚Äî —Ü–µ —Ç–æ—á–∫–∞ –≤—Ö–æ–¥—É —É —Å–≤—ñ—Ç Spark</li>
<li>–¢–æ—á–∫–∞ –≤—Ö–æ–¥—É ‚Äî —Ü–µ —Å–ø–æ—Å—ñ–± –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞ Spark</li>
<li>–¢–æ—á–∫–∞ –≤—Ö–æ–¥—É ‚Äî —Ü–µ —è–∫ –∫–ª—é—á –¥–æ –±—É–¥–∏–Ω–∫—É</li>
<li>PySpark –º–∞—î SparkContext –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º, —è–∫–∏–π –Ω–∞–∑–∏–≤–∞—î—Ç—å—Å—è <code>sc</code></li>
</ul>
</section>
<section id="–ø–µ—Ä–µ–≤—ñ—Ä–∫–∞-sparkcontext" class="slide level2 tiny">
<h2>–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ SparkContext</h2>
<ul>
<li><strong>–í–µ—Ä—Å—ñ—è</strong>: –©–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ –≤–µ—Ä—Å—ñ—é SparkContext</li>
</ul>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Terminal</strong></pre>
</div>
<div class="sourceCode" id="cb1" data-filename="Terminal"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb1-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="at">pyspark --version</span></span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre class="{yaml}"><code>Welcome to
      ____              __
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /__ / .__/\_,_/_/ /_/\_\   version 3.5.5
      /_/

Using Python version 3.11.4 (tags/v3.11.4:d2340ef, Jun  7 2023 05:45:37)
Spark context Web UI available at http://AranaurPC:4040
Spark context available as 'sc' (master = local[*], app id = local-1745489304985).
SparkSession available as 'spark'.</code></pre>
<div id="4f58dc23" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyspark <span class="im">import</span> SparkContext</span>
<span id="cb3-2"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="" aria-hidden="true" tabindex="-1"></a>sc <span class="op">=</span> SparkContext(master <span class="op">=</span> <span class="st">'local[*]'</span>)</span>
<span id="cb3-4"><a href="" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sc.version)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>3.5.5</code></pre>
</div>
</div>
<ul>
<li><strong>–í–µ—Ä—Å—ñ—è Python</strong>:</li>
</ul>
<div id="3214d50d" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sc.pythonVer)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>3.11</code></pre>
</div>
</div>
<ul>
<li><strong>–ú–∞–π—Å—Ç–µ—Ä</strong>: URL –∫–ª–∞—Å—Ç–µ—Ä–∞ –∞–±–æ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ä—è–¥–∫–∞ –¥–ª—è –∑–∞–ø—É—Å–∫—É —É –ª–æ–∫–∞–ª—å–Ω–æ–º—É —Ä–µ–∂–∏–º—ñ SparkContext</li>
</ul>
<div id="797f9f24" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sc.master)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>local[*]</code></pre>
</div>
</div>
<div class="footer">
<p><a href="https://media.datacamp.com/legacy/image/upload/v1676303379/Marketing/Blog/PySpark_RDD_Cheat_Sheet.pdf">üîóPySpark RDD Cheat Sheet</a></p>
</div>
</section>
<section id="–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è-–¥–∞–Ω–∏—Ö-—É-pyspark" class="slide level2">
<h2>–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö —É PySpark</h2>
<ul>
<li>–ú–µ—Ç–æ–¥ SparkContext <code>parallelize()</code></li>
</ul>
<div id="9ed82be4" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="" aria-hidden="true" tabindex="-1"></a>rdd <span class="op">=</span> sc.parallelize([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>])</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>–ú–µ—Ç–æ–¥ <code>textFile()</code> SparkContext</li>
</ul>
<div id="a22b6166" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="" aria-hidden="true" tabindex="-1"></a>rdd <span class="op">=</span> sc.textFile(<span class="st">"data/data.txt"</span>)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section>
<section>
<section id="—Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–µ-–ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è-—É-python" class="title-slide slide level1 unnumbered unlisted center">
<h1>–§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–µ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è —É Python</h1>

</section>
<section id="—â–æ-—Ç–∞–∫–µ-–∞–Ω–æ–Ω—ñ–º–Ω—ñ-—Ñ—É–Ω–∫—Ü—ñ—ó-–≤-python" class="slide level2">
<h2>–©–æ —Ç–∞–∫–µ –∞–Ω–æ–Ω—ñ–º–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –≤ Python?</h2>
<ul>
<li>–õ—è–º–±–¥–∞-—Ñ—É–Ω–∫—Ü—ñ—ó ‚Äî –∞–Ω–æ–Ω—ñ–º–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –≤ Python</li>
<li>–î—É–∂–µ –ø–æ—Ç—É–∂–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è, —è–∫–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —É Python. –î–æ—Å–∏—Ç—å –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ –∑ <code>map()</code> —Ç–∞ <code>filter()</code></li>
<li>–õ—è–º–±–¥–∞-—Ñ—É–Ω–∫—Ü—ñ—ó —Å—Ç–≤–æ—Ä—é—é—Ç—å —Ñ—É–Ω–∫—Ü—ñ—ó –¥–ª—è –ø–æ–¥–∞–ª—å—à–æ–≥–æ –≤–∏–∫–ª–∏–∫—É –ø–æ–¥—ñ–±–Ω–æ –¥–æ <code>def</code></li>
<li>–ü–æ–≤–µ—Ä—Ç–∞—î —Ñ—É–Ω–∫—Ü—ñ—ó –±–µ–∑ —ñ–º–µ–Ω—ñ (—Ç–æ–±—Ç–æ –∞–Ω–æ–Ω—ñ–º–Ω—ñ)</li>
</ul>
</section>
<section id="—Å–∏–Ω—Ç–∞–∫—Å–∏—Å-–ª—è–º–±–¥–∞-—Ñ—É–Ω–∫—Ü—ñ—ó" class="slide level2">
<h2>–°–∏–Ω—Ç–∞–∫—Å–∏—Å –ª—è–º–±–¥–∞-—Ñ—É–Ω–∫—Ü—ñ—ó</h2>
<ul>
<li>–ó–∞–≥–∞–ª—å–Ω–∏–π –≤–∏–≥–ª—è–¥ –ª—è–º–±–¥–∞-—Ñ—É–Ω–∫—Ü—ñ—ó –º–∞—î –≤–∏–≥–ª—è–¥</li>
</ul>
<div id="d7e9db52" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="kw">lambda</span> arguments: expression</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>–ü—Ä–∏–∫–ª–∞–¥ –ª—è–º–±–¥–∞-—Ñ—É–Ω–∫—Ü—ñ—ó</li>
</ul>
<div id="defd497f" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="" aria-hidden="true" tabindex="-1"></a>double <span class="op">=</span> <span class="kw">lambda</span> x: x <span class="op">*</span> <span class="dv">2</span></span>
<span id="cb12-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(double(<span class="dv">3</span>))</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>6</code></pre>
</div>
</div>
</section>
<section id="—Ä—ñ–∑–Ω–∏—Ü—è-–º—ñ–∂-—Ñ—É–Ω–∫—Ü—ñ—è–º–∏-def-—Ç–∞-lambda" class="slide level2">
<h2>–†—ñ–∑–Ω–∏—Ü—è –º—ñ–∂ —Ñ—É–Ω–∫—Ü—ñ—è–º–∏ <code>def</code> —Ç–∞ <code>lambda</code></h2>
<ul>
<li>–ö–æ–¥ –Ω–∞ Python –¥–ª—è —ñ–ª—é—Å—Ç—Ä–∞—Ü—ñ—ó –∫—É–±–∞ —á–∏—Å–ª–∞</li>
</ul>
<div id="21b187f2" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cube(x):</span>
<span id="cb14-2"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> x <span class="op">**</span> <span class="dv">3</span></span>
<span id="cb14-3"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> <span class="kw">lambda</span> x: x <span class="op">**</span> <span class="dv">3</span></span>
<span id="cb14-5"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(g(<span class="dv">10</span>))</span>
<span id="cb14-7"><a href="" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(cube(<span class="dv">10</span>))</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1000
1000</code></pre>
</div>
</div>
<ul>
<li>–ù–µ–º–∞—î –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –¥–ª—è –ª—è–º–±–¥–∞-—Ñ—É–Ω–∫—Ü—ñ—ó</li>
<li>–ú–æ–∂–Ω–∞ —Ä–æ–∑–º—ñ—â—É–≤–∞—Ç–∏ –ª—è–º–±–¥–∞-—Ñ—É–Ω–∫—Ü—ñ—é –±—É–¥—å-–¥–µ</li>
</ul>
</section>
<section id="map" class="slide level2">
<h2><code>map()</code></h2>
<ul>
<li><code>map()</code> –∑–∞—Å—Ç–æ—Å–æ–≤—É—î —Ñ—É–Ω–∫—Ü—ñ—é –¥–æ –≤—Å—ñ—Ö –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ —É –≤—Ö—ñ–¥–Ω–æ–º—É —Å–ø–∏—Å–∫—É</li>
<li>–ó–∞–≥–∞–ª—å–Ω–∏–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å <code>map()</code></li>
</ul>
<div id="26336da5" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="bu">map</span>(function, <span class="bu">list</span>)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>–ü—Ä–∏–∫–ª–∞–¥ <code>map()</code></li>
</ul>
<div id="aa3140fd" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="" aria-hidden="true" tabindex="-1"></a>items <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>]</span>
<span id="cb17-2"><a href="" aria-hidden="true" tabindex="-1"></a>new_items <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="kw">lambda</span> x: x <span class="op">+</span> <span class="dv">2</span> , items))</span>
<span id="cb17-3"><a href="" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(new_items)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[3, 4, 5, 6]</code></pre>
</div>
</div>
</section>
<section id="filter" class="slide level2">
<h2><code>filter()</code></h2>
<ul>
<li>—Ñ—É–Ω–∫—Ü—ñ—è <code>filter()</code> –æ—Ç—Ä–∏–º—É—î —Ñ—É–Ω–∫—Ü—ñ—é —Ç–∞ —Å–ø–∏—Å–æ–∫ —ñ –ø–æ–≤–µ—Ä—Ç–∞—î –Ω–æ–≤–∏–π —Å–ø–∏—Å–æ–∫, –¥–ª—è —è–∫–æ–≥–æ —Ñ—É–Ω–∫—Ü—ñ—è –ø–æ–≤–µ—Ä—Ç–∞—î –∑–Ω–∞—á–µ–Ω–Ω—è <code>true</code></li>
<li>–ó–∞–≥–∞–ª—å–Ω–∏–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å <code>filter()</code></li>
</ul>
<div id="33b392ad" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="bu">filter</span>(function, <span class="bu">list</span>)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>–ü—Ä–∏–∫–ª–∞–¥ <code>filter()</code></li>
</ul>
<div id="419274bc" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="" aria-hidden="true" tabindex="-1"></a>items <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>]</span>
<span id="cb20-2"><a href="" aria-hidden="true" tabindex="-1"></a>new_items <span class="op">=</span> <span class="bu">list</span>(<span class="bu">filter</span>(<span class="kw">lambda</span> x: (x<span class="op">%</span><span class="dv">2</span> <span class="op">!=</span> <span class="dv">0</span>), items))</span>
<span id="cb20-3"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(new_items)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1, 3]</code></pre>
</div>
</div>
</section></section>
<section>
<section id="–ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è-–≤-pyspark-rdd" class="title-slide slide level1 center">
<h1>–ü—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è –≤ PySpark RDD</h1>

</section>
<section id="—â–æ-—Ç–∞–∫–µ-rdd" class="slide level2">
<h2>–©–æ —Ç–∞–∫–µ RDD?</h2>
<ul>
<li>RDD (Resilient Distributed Datasets) ‚Äî —Ü–µ –æ—Å–Ω–æ–≤–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–∏—Ö —É Spark</li>
</ul>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<svg width="960" height="480" viewbox="0.00 0.00 515.00 220.00" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none; display: block; margin: auto auto auto auto">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 216)">
<title>RDDDistribution</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-216 511,-216 511,4 -4,4"></polygon>
<g id="clust1" class="cluster">
<title>cluster_0</title>
<path fill="#f0f8ff" stroke="gray" d="M20,-8C20,-8 487,-8 487,-8 493,-8 499,-14 499,-20 499,-20 499,-78.4 499,-78.4 499,-84.4 493,-90.4 487,-90.4 487,-90.4 20,-90.4 20,-90.4 14,-90.4 8,-84.4 8,-78.4 8,-78.4 8,-20 8,-20 8,-14 14,-8 20,-8"></path>
<text text-anchor="middle" x="253.5" y="-73.8" font-family="Times,serif" font-size="14.00">–ö–ª–∞—Å—Ç–µ—Ä</text>
</g>
<!-- DataFile -->
<g id="node1" class="node">
<title>DataFile</title>
<polygon fill="white" stroke="black" stroke-width="2" points="329.14,-212 176.86,-212 176.86,-176 329.14,-176 329.14,-212"></polygon>
<text text-anchor="middle" x="253" y="-189.8" font-family="Helvetica,sans-Serif" font-size="14.00">–§–∞–π–ª –¥–∞–Ω–∏—Ö –Ω–∞ –¥–∏—Å–∫—É</text>
</g>
<!-- Driver -->
<g id="node2" class="node">
<title>Driver</title>
<polygon fill="white" stroke="black" stroke-width="2" points="354.98,-139.8 151.02,-139.8 151.02,-98.6 354.98,-98.6 354.98,-139.8"></polygon>
<text text-anchor="middle" x="253" y="-123.4" font-family="Helvetica,sans-Serif" font-size="14.00">–î—Ä–∞–π–≤–µ—Ä Spark —Å—Ç–≤–æ—Ä—é—î RDD</text>
<text text-anchor="middle" x="253" y="-106.6" font-family="Helvetica,sans-Serif" font-size="14.00"> –π —Ä–æ–∑–ø–æ–¥—ñ–ª—è—î –º—ñ–∂ –≤—É–∑–ª–∞–º–∏</text>
</g>
<!-- DataFile&#45;&gt;Driver -->
<g id="edge1" class="edge">
<title>DataFile-&gt;Driver</title>
<path fill="none" stroke="black" d="M253,-175.75C253,-168.09 253,-158.86 253,-150.14"></path>
<polygon fill="black" stroke="black" points="256.5,-149.9 253,-139.9 249.5,-149.9 256.5,-149.9"></polygon>
</g>
<!-- Node1 -->
<g id="node3" class="node">
<title>Node1</title>
<polygon fill="lightblue" stroke="black" points="490.96,-57.4 385.04,-57.4 385.04,-16.2 490.96,-16.2 490.96,-57.4"></polygon>
<text text-anchor="middle" x="438" y="-41" font-family="Helvetica,sans-Serif" font-size="14.00">–†–æ–∑–¥—ñ–ª –≤—É–∑–ª–∞</text>
<text text-anchor="middle" x="438" y="-24.2" font-family="Helvetica,sans-Serif" font-size="14.00">RDD 4</text>
</g>
<!-- Driver&#45;&gt;Node1 -->
<g id="edge2" class="edge">
<title>Driver-&gt;Node1</title>
<path fill="none" stroke="black" d="M354.94,-99.69C362.56,-97 370,-93.92 377,-90.4 389.94,-83.89 402.4,-74.04 412.64,-64.61"></path>
<polygon fill="black" stroke="black" points="415.22,-66.99 420.02,-57.55 410.37,-61.94 415.22,-66.99"></polygon>
</g>
<!-- Node2 -->
<g id="node4" class="node">
<title>Node2</title>
<polygon fill="lightblue" stroke="black" points="367.96,-57.4 262.04,-57.4 262.04,-16.2 367.96,-16.2 367.96,-57.4"></polygon>
<text text-anchor="middle" x="315" y="-41" font-family="Helvetica,sans-Serif" font-size="14.00">–†–æ–∑–¥—ñ–ª –≤—É–∑–ª–∞</text>
<text text-anchor="middle" x="315" y="-24.2" font-family="Helvetica,sans-Serif" font-size="14.00">RDD 3</text>
</g>
<!-- Driver&#45;&gt;Node2 -->
<g id="edge3" class="edge">
<title>Driver-&gt;Node2</title>
<path fill="none" stroke="black" d="M268.33,-98.33C275.98,-88.39 285.37,-76.22 293.72,-65.4"></path>
<polygon fill="black" stroke="black" points="296.52,-67.5 299.85,-57.45 290.97,-63.23 296.52,-67.5"></polygon>
</g>
<!-- Node3 -->
<g id="node5" class="node">
<title>Node3</title>
<polygon fill="lightblue" stroke="black" points="244.96,-57.4 139.04,-57.4 139.04,-16.2 244.96,-16.2 244.96,-57.4"></polygon>
<text text-anchor="middle" x="192" y="-41" font-family="Helvetica,sans-Serif" font-size="14.00">–†–æ–∑–¥—ñ–ª –≤—É–∑–ª–∞</text>
<text text-anchor="middle" x="192" y="-24.2" font-family="Helvetica,sans-Serif" font-size="14.00">RDD 2</text>
</g>
<!-- Driver&#45;&gt;Node3 -->
<g id="edge4" class="edge">
<title>Driver-&gt;Node3</title>
<path fill="none" stroke="black" d="M237.92,-98.33C230.46,-88.49 221.33,-76.46 213.18,-65.72"></path>
<polygon fill="black" stroke="black" points="215.74,-63.3 206.91,-57.45 210.16,-67.53 215.74,-63.3"></polygon>
</g>
<!-- Node4 -->
<g id="node6" class="node">
<title>Node4</title>
<polygon fill="lightblue" stroke="black" points="121.96,-57.4 16.04,-57.4 16.04,-16.2 121.96,-16.2 121.96,-57.4"></polygon>
<text text-anchor="middle" x="69" y="-41" font-family="Helvetica,sans-Serif" font-size="14.00">–†–æ–∑–¥—ñ–ª –≤—É–∑–ª–∞</text>
<text text-anchor="middle" x="69" y="-24.2" font-family="Helvetica,sans-Serif" font-size="14.00">RDD 1</text>
</g>
<!-- Driver&#45;&gt;Node4 -->
<g id="edge5" class="edge">
<title>Driver-&gt;Node4</title>
<path fill="none" stroke="black" d="M151.25,-99.41C143.91,-96.79 136.74,-93.8 130,-90.4 117.06,-83.88 104.61,-74.02 94.36,-64.6"></path>
<polygon fill="black" stroke="black" points="96.63,-61.92 86.99,-57.54 91.79,-66.98 96.63,-61.92"></polygon>
</g>
</g>
</svg>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
<section id="–¥–µ–∫–æ–º–ø–æ–∑–∏—Ü—ñ—è-rdd" class="slide level2">
<h2>–î–µ–∫–æ–º–ø–æ–∑–∏—Ü—ñ—è RDD</h2>
<ul>
<li>–°—Ç—ñ–π–∫—ñ —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω—ñ –Ω–∞–±–æ—Ä–∏ –¥–∞–Ω–∏—Ö
<ul>
<li><strong>–í—ñ–¥–º–æ–≤–æ—Å—Ç—ñ–π–∫—ñ—Å—Ç—å</strong>: –ó–¥–∞—Ç–Ω—ñ—Å—Ç—å –ø—Ä–æ—Ç–∏—Å—Ç–æ—è—Ç–∏ –∑–±–æ—è–º</li>
<li><strong>–†–æ–∑–ø–æ–¥—ñ–ª–µ–Ω—ñ</strong>: –†–æ–∑–ø–æ–¥—ñ–ª–µ–Ω—ñ –º—ñ–∂ –¥–µ–∫—ñ–ª—å–∫–æ–º–∞ –º–∞—à–∏–Ω–∞–º–∏</li>
<li><strong>–ù–∞–±–æ—Ä–∏ –¥–∞–Ω–∏—Ö</strong>: –ö–æ–ª–µ–∫—Ü—ñ—è —Ä–æ–∑–¥—ñ–ª–µ–Ω–∏—Ö –¥–∞–Ω–∏—Ö, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –º–∞—Å–∏–≤—ñ–≤, —Ç–∞–±–ª–∏—Ü—å, –∫–æ—Ä—Ç–µ–∂—ñ–≤ —Ç–æ—â–æ.</li>
</ul></li>
</ul>
</section>
<section id="—Å—Ç–≤–æ—Ä–µ–Ω–Ω—è-rdd.-—è–∫-—Ü–µ-–∑—Ä–æ–±–∏—Ç–∏" class="slide level2">
<h2>–°—Ç–≤–æ—Ä–µ–Ω–Ω—è RDD. –Ø–∫ —Ü–µ –∑—Ä–æ–±–∏—Ç–∏?</h2>
<ul>
<li>–†–æ–∑–ø–∞—Ä–∞–ª–µ–ª—é–≤–∞–Ω–Ω—è —ñ—Å–Ω—É—é—á–æ—ó –∫–æ–ª–µ–∫—Ü—ñ—ó –æ–±‚Äô—î–∫—Ç—ñ–≤</li>
<li>–ó–æ–≤–Ω—ñ—à–Ω—ñ –Ω–∞–±–æ—Ä–∏ –¥–∞–Ω–∏—Ö:
<ul>
<li>–§–∞–π–ª–∏ –≤ HDFS</li>
<li>–û–±‚Äô—î–∫—Ç–∏ –≤ Amazon S3 bucket</li>
<li>—Ä—è–¥–∫–∏ –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º—É —Ñ–∞–π–ª—ñ</li>
</ul></li>
<li>–ó —ñ—Å–Ω—É—é—á–∏—Ö RDD</li>
</ul>
</section>
<section id="—Ä–æ–∑–ø–∞—Ä–∞–ª–µ–ª–µ–Ω–∏–π-–∑–±—ñ—Ä-—Ä–æ–∑–ø–∞—Ä–∞–ª–µ–ª—é–≤–∞–Ω–Ω—è" class="slide level2">
<h2>–†–æ–∑–ø–∞—Ä–∞–ª–µ–ª–µ–Ω–∏–π –∑–±—ñ—Ä (—Ä–æ–∑–ø–∞—Ä–∞–ª–µ–ª—é–≤–∞–Ω–Ω—è)</h2>
<ul>
<li><code>parallelize()</code> –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è RDD –∑—ñ —Å–ø–∏—Å–∫—ñ–≤ –Ω–∞ Python</li>
</ul>
<div id="31080f8f" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="" aria-hidden="true" tabindex="-1"></a>numRDD <span class="op">=</span> sc.parallelize([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>])</span>
<span id="cb22-2"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="" aria-hidden="true" tabindex="-1"></a>helloRDD <span class="op">=</span> sc.parallelize(<span class="st">"Hello world"</span>)</span>
<span id="cb22-4"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(helloRDD)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>pyspark.rdd.RDD</code></pre>
</div>
</div>
</section>
<section id="—ñ–∑-–∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö-–Ω–∞–±–æ—Ä—ñ–≤-–¥–∞–Ω–∏—Ö" class="slide level2">
<h2>–Ü–∑ –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö –Ω–∞–±–æ—Ä—ñ–≤ –¥–∞–Ω–∏—Ö</h2>
<ul>
<li><code>textFile()</code> –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è RDD —ñ–∑ –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö –Ω–∞–±–æ—Ä—ñ–≤ –¥–∞–Ω–∏—Ö</li>
</ul>
<div id="87d8af62" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="" aria-hidden="true" tabindex="-1"></a>fileRDD <span class="op">=</span> sc.textFile(<span class="st">"data/data.txt"</span>)</span>
<span id="cb24-2"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(fileRDD)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>pyspark.rdd.RDD</code></pre>
</div>
</div>
</section>
<section id="—Ä–æ–∑—É–º—ñ–Ω–Ω—è-–ø–∞—Ä—Ç–∏—Ü—ñ–π-—É-pyspark" class="slide level2">
<h2>–†–æ–∑—É–º—ñ–Ω–Ω—è –ø–∞—Ä—Ç–∏—Ü—ñ–π —É PySpark</h2>
<ul>
<li><p>–ü–∞—Ä—Ç–∏—Ü—ñ—è (Partition) ‚Äî —Ü–µ –ª–æ–≥—ñ—á–Ω–∏–π –ø–æ–¥—ñ–ª –≤–µ–ª–∏–∫–æ–≥–æ —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω–æ–≥–æ –Ω–∞–±–æ—Ä—É –¥–∞–Ω–∏—Ö</p></li>
<li><p>–º–µ—Ç–æ–¥ <code>parallelize()</code></p></li>
</ul>
<div id="d0f26276" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="" aria-hidden="true" tabindex="-1"></a>numRDD <span class="op">=</span> sc.parallelize(<span class="bu">range</span>(<span class="dv">10</span>), numSlices <span class="op">=</span> <span class="dv">6</span>)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>–º–µ—Ç–æ–¥ <code>textFile()</code></li>
</ul>
<div id="e91b7c80" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="" aria-hidden="true" tabindex="-1"></a>fileRDD <span class="op">=</span> sc.textFile(<span class="st">"README.md"</span>, numSlices <span class="op">=</span> <span class="dv">6</span>)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>–ö—ñ–ª—å–∫—ñ—Å—Ç—å –ø–∞—Ä—Ç–∏—Ü—ñ–π –≤ RDD –º–æ–∂–Ω–∞ –¥—ñ–∑–Ω–∞—Ç–∏—Å—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –º–µ—Ç–æ–¥—É <code>getNumPartitions()</code></p>
</section></section>
<section>
<section id="rdd-operations-in-pyspark" class="title-slide slide level1 unnumbered unlisted center">
<h1>RDD operations in PySpark</h1>

</section>
<section id="–æ–≥–ª—è–¥-pyspark-operations" class="slide level2 smaller">
<h2>–û–≥–ª—è–¥ PySpark operations</h2>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<svg width="960" height="480" viewbox="0.00 0.00 395.82 116.00" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none; display: block; margin: auto auto auto auto">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 112)">
<title>SparkOperationsEmoji</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-112 391.82,-112 391.82,4 -4,4"></polygon>
<!-- Transformations -->
<g id="node1" class="node">
<title>Transformations</title>
<polygon fill="#c0f7a9" stroke="black" points="276.43,-108 0.19,-108 0.19,-72 276.43,-72 276.43,-108"></polygon>
<text text-anchor="middle" x="138.31" y="-85.8" font-family="Helvetica,sans-Serif" font-size="14.00">üêõ ‚û°Ô∏è üêõ ‚û°Ô∏è üêõ ‚û°Ô∏è ü¶ã Transformations</text>
</g>
<!-- Operations -->
<g id="node3" class="node">
<title>Operations</title>
<polygon fill="#ffe066" stroke="black" stroke-width="2" points="311.7,-36 166.92,-36 166.92,0 311.7,0 311.7,-36"></polygon>
<text text-anchor="middle" x="239.31" y="-13.8" font-family="Helvetica,sans-Serif" font-size="14.00">Spark üß† Operations</text>
</g>
<!-- Transformations&#45;&gt;Operations -->
<g id="edge1" class="edge">
<title>Transformations-&gt;Operations</title>
<path fill="none" stroke="black" d="M163.02,-71.88C175.98,-62.89 192.04,-51.76 206.08,-42.03"></path>
<polygon fill="black" stroke="black" points="208.28,-44.76 214.51,-36.19 204.29,-39.01 208.28,-44.76"></polygon>
</g>
<!-- Actions -->
<g id="node2" class="node">
<title>Actions</title>
<polygon fill="#b3e5fc" stroke="black" points="387.84,-108 294.78,-108 294.78,-72 387.84,-72 387.84,-108"></polygon>
<text text-anchor="middle" x="341.31" y="-85.8" font-family="Helvetica,sans-Serif" font-size="14.00">üñ®Ô∏è Actions</text>
</g>
<!-- Actions&#45;&gt;Operations -->
<g id="edge2" class="edge">
<title>Actions-&gt;Operations</title>
<path fill="none" stroke="black" d="M316.36,-71.88C303.27,-62.89 287.05,-51.76 272.87,-42.03"></path>
<polygon fill="black" stroke="black" points="274.58,-38.96 264.36,-36.19 270.62,-44.73 274.58,-38.96"></polygon>
</g>
</g>
</svg>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<ul>
<li>–ü–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å—Ç–≤–æ—Ä—é—é—Ç—å –Ω–æ–≤—ñ RDD</li>
<li>–î—ñ—ó –≤–∏–∫–æ–Ω—É—é—Ç—å –æ–±—á–∏—Å–ª–µ–Ω–Ω—è –Ω–∞ RDD</li>
</ul>
</section>
<section id="rdd-transformations" class="slide level2 tiny">
<h2>RDD Transformations</h2>
<ul>
<li>–¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ—ó –≤–∏–∫–æ–Ω—É—é—Ç—å –ª—ñ–Ω–∏–≤—ñ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è</li>
<li>–ë–∞–∑–æ–≤—ñ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è RDD
<ul>
<li><code>map()</code></li>
<li><code>filter()</code></li>
<li><code>flatMap()</code></li>
<li><code>union()</code></li>
</ul></li>
</ul>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<svg width="960" height="480" viewbox="0.00 0.00 836.37 76.40" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none; display: block; margin: auto auto auto auto">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 72.4)">
<title>RDDPipeline</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-72.4 832.37,-72.4 832.37,4 -4,4"></polygon>
<!-- Storage -->
<g id="node1" class="node">
<title>Storage</title>
<path fill="lightgreen" stroke="black" d="M65,-32.73C65,-34.53 50.43,-36 32.5,-36 14.57,-36 0,-34.53 0,-32.73 0,-32.73 0,-3.27 0,-3.27 0,-1.47 14.57,0 32.5,0 50.43,0 65,-1.47 65,-3.27 65,-3.27 65,-32.73 65,-32.73"></path>
<path fill="none" stroke="black" d="M65,-32.73C65,-30.92 50.43,-29.45 32.5,-29.45 14.57,-29.45 0,-30.92 0,-32.73"></path>
<text text-anchor="middle" x="32.5" y="-13.8" font-family="Times,serif" font-size="14.00">–°—Ö–æ–≤–∏—â–µ</text>
</g>
<!-- RDD1 -->
<g id="node2" class="node">
<title>RDD1</title>
<polygon fill="#eedd82" stroke="black" points="304.34,-36 250.34,-36 250.34,0 304.34,0 304.34,-36"></polygon>
<text text-anchor="middle" x="277.34" y="-13.8" font-family="Times,serif" font-size="14.00">RDD1</text>
</g>
<!-- Storage&#45;&gt;RDD1 -->
<g id="edge1" class="edge">
<title>Storage-&gt;RDD1</title>
<path fill="none" stroke="black" d="M65.25,-18C110.31,-18 192.6,-18 240.03,-18"></path>
<polygon fill="black" stroke="black" points="240.16,-21.5 250.16,-18 240.16,-14.5 240.16,-21.5"></polygon>
<text text-anchor="middle" x="157.67" y="-55.8" font-family="Times,serif" font-size="14.00">Rdd —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è —à–ª—è—Ö–æ–º</text>
<text text-anchor="middle" x="157.67" y="-39" font-family="Times,serif" font-size="14.00">—á–∏—Ç–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö</text>
<text text-anchor="middle" x="157.67" y="-22.2" font-family="Times,serif" font-size="14.00">–∑—ñ —Å—Ö–æ–≤–∏—â–∞</text>
</g>
<!-- RDD2 -->
<g id="node3" class="node">
<title>RDD2</title>
<polygon fill="#eedd82" stroke="black" points="476.76,-36 422.76,-36 422.76,0 476.76,0 476.76,-36"></polygon>
<text text-anchor="middle" x="449.76" y="-13.8" font-family="Times,serif" font-size="14.00">RDD2</text>
</g>
<!-- RDD1&#45;&gt;RDD2 -->
<g id="edge2" class="edge">
<title>RDD1-&gt;RDD2</title>
<path fill="none" stroke="black" d="M304.59,-18C333.45,-18 380,-18 412.37,-18"></path>
<polygon fill="black" stroke="black" points="412.75,-21.5 422.75,-18 412.75,-14.5 412.75,-21.5"></polygon>
<text text-anchor="middle" x="363.55" y="-22.2" font-family="Times,serif" font-size="14.00">transformation</text>
</g>
<!-- RDD3 -->
<g id="node4" class="node">
<title>RDD3</title>
<polygon fill="#eedd82" stroke="black" points="649.18,-36 595.18,-36 595.18,0 649.18,0 649.18,-36"></polygon>
<text text-anchor="middle" x="622.18" y="-13.8" font-family="Times,serif" font-size="14.00">RDD3</text>
</g>
<!-- RDD2&#45;&gt;RDD3 -->
<g id="edge3" class="edge">
<title>RDD2-&gt;RDD3</title>
<path fill="none" stroke="black" d="M477.01,-18C505.87,-18 552.42,-18 584.79,-18"></path>
<polygon fill="black" stroke="black" points="585.17,-21.5 595.17,-18 585.17,-14.5 585.17,-21.5"></polygon>
<text text-anchor="middle" x="535.97" y="-22.2" font-family="Times,serif" font-size="14.00">transformation</text>
</g>
<!-- Result -->
<g id="node5" class="node">
<title>Result</title>
<ellipse fill="white" stroke="black" cx="773.88" cy="-18" rx="54.49" ry="18"></ellipse>
<text text-anchor="middle" x="773.88" y="-13.8" font-family="Times,serif" font-size="14.00" fill="blue">–†–µ–∑—É–ª—å—Ç–∞—Ç</text>
</g>
<!-- RDD3&#45;&gt;Result -->
<g id="edge4" class="edge">
<title>RDD3-&gt;Result</title>
<path fill="none" stroke="black" d="M649.26,-18C665.81,-18 688.01,-18 709.03,-18"></path>
<polygon fill="black" stroke="black" points="709.22,-21.5 719.22,-18 709.22,-14.5 709.22,-21.5"></polygon>
<text text-anchor="middle" x="684.28" y="-22.2" font-family="Times,serif" font-size="14.00">action</text>
</g>
</g>
</svg>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
<section id="map-1" class="slide level2 tiny">
<h2><code>map()</code></h2>
<ul>
<li>–ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è <code>map()</code> –∑–∞—Å—Ç–æ—Å–æ–≤—É—î —Ñ—É–Ω–∫—Ü—ñ—é –¥–æ –≤—Å—ñ—Ö –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ —É RDD</li>
</ul>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<svg width="960" height="480" viewbox="0.00 0.00 250.23 206.00" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none; display: block; margin: auto auto auto auto">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 202)">
<title>MapTransformation</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-202 246.23,-202 246.23,4 -4,4"></polygon>
<!-- A1 -->
<g id="node1" class="node">
<title>A1</title>
<ellipse fill="deepskyblue" stroke="black" cx="27" cy="-180" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="27" y="-175.8" font-family="Times,serif" font-size="14.00" fill="white">1</text>
</g>
<!-- MAP -->
<g id="node5" class="node">
<title>MAP</title>
<ellipse fill="dodgerblue" stroke="black" cx="121.11" cy="-99" rx="31.23" ry="31.23"></ellipse>
<text text-anchor="middle" x="121.11" y="-103.2" font-family="Times,serif" font-size="14.00" fill="white">map</text>
<text text-anchor="middle" x="121.11" y="-86.4" font-family="Times,serif" font-size="14.00" fill="white">x * x</text>
</g>
<!-- A1&#45;&gt;MAP -->
<g id="edge1" class="edge">
<title>A1-&gt;MAP</title>
<path fill="none" stroke="black" d="M44.04,-165.89C56.51,-154.93 74.17,-139.4 89.34,-126.06"></path>
<polygon fill="black" stroke="black" points="91.8,-128.55 97,-119.32 87.18,-123.3 91.8,-128.55"></polygon>
</g>
<!-- A2 -->
<g id="node2" class="node">
<title>A2</title>
<ellipse fill="deepskyblue" stroke="black" cx="27" cy="-126" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="27" y="-121.8" font-family="Times,serif" font-size="14.00" fill="white">2</text>
</g>
<!-- A2&#45;&gt;MAP -->
<g id="edge3" class="edge">
<title>A2-&gt;MAP</title>
<path fill="none" stroke="black" d="M52.2,-118.91C61.16,-116.28 71.55,-113.24 81.47,-110.33"></path>
<polygon fill="black" stroke="black" points="82.55,-113.66 91.16,-107.49 80.58,-106.94 82.55,-113.66"></polygon>
</g>
<!-- A3 -->
<g id="node3" class="node">
<title>A3</title>
<ellipse fill="deepskyblue" stroke="black" cx="27" cy="-72" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="27" y="-67.8" font-family="Times,serif" font-size="14.00" fill="white">3</text>
</g>
<!-- A3&#45;&gt;MAP -->
<g id="edge5" class="edge">
<title>A3-&gt;MAP</title>
<path fill="none" stroke="black" d="M52.2,-79.09C61.16,-81.72 71.55,-84.76 81.47,-87.67"></path>
<polygon fill="black" stroke="black" points="80.58,-91.06 91.16,-90.51 82.55,-84.34 80.58,-91.06"></polygon>
</g>
<!-- A4 -->
<g id="node4" class="node">
<title>A4</title>
<ellipse fill="deepskyblue" stroke="black" cx="27" cy="-18" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="27" y="-13.8" font-family="Times,serif" font-size="14.00" fill="white">4</text>
</g>
<!-- A4&#45;&gt;MAP -->
<g id="edge7" class="edge">
<title>A4-&gt;MAP</title>
<path fill="none" stroke="black" d="M44.04,-32.11C56.51,-43.07 74.17,-58.6 89.34,-71.94"></path>
<polygon fill="black" stroke="black" points="87.18,-74.7 97,-78.68 91.8,-69.45 87.18,-74.7"></polygon>
</g>
<!-- B1 -->
<g id="node6" class="node">
<title>B1</title>
<ellipse fill="deepskyblue" stroke="black" cx="215.23" cy="-180" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="215.23" y="-175.8" font-family="Times,serif" font-size="14.00" fill="white">1</text>
</g>
<!-- MAP&#45;&gt;B1 -->
<g id="edge2" class="edge">
<title>MAP-&gt;B1</title>
<path fill="none" stroke="black" d="M145.36,-119.44C159.17,-131.58 176.64,-146.95 190.53,-159.16"></path>
<polygon fill="black" stroke="black" points="188.42,-161.97 198.24,-165.94 193.04,-156.71 188.42,-161.97"></polygon>
</g>
<!-- B2 -->
<g id="node7" class="node">
<title>B2</title>
<ellipse fill="deepskyblue" stroke="black" cx="215.23" cy="-126" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="215.23" y="-121.8" font-family="Times,serif" font-size="14.00" fill="white">4</text>
</g>
<!-- MAP&#45;&gt;B2 -->
<g id="edge4" class="edge">
<title>MAP-&gt;B2</title>
<path fill="none" stroke="black" d="M151.26,-107.54C160.57,-110.27 170.95,-113.31 180.55,-116.13"></path>
<polygon fill="black" stroke="black" points="179.62,-119.5 190.2,-118.96 181.59,-112.79 179.62,-119.5"></polygon>
</g>
<!-- B3 -->
<g id="node8" class="node">
<title>B3</title>
<ellipse fill="deepskyblue" stroke="black" cx="215.23" cy="-72" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="215.23" y="-67.8" font-family="Times,serif" font-size="14.00" fill="white">9</text>
</g>
<!-- MAP&#45;&gt;B3 -->
<g id="edge6" class="edge">
<title>MAP-&gt;B3</title>
<path fill="none" stroke="black" d="M151.26,-90.46C160.57,-87.73 170.95,-84.69 180.55,-81.87"></path>
<polygon fill="black" stroke="black" points="181.59,-85.21 190.2,-79.04 179.62,-78.5 181.59,-85.21"></polygon>
</g>
<!-- B4 -->
<g id="node9" class="node">
<title>B4</title>
<ellipse fill="deepskyblue" stroke="black" cx="215.23" cy="-18" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="215.23" y="-13.8" font-family="Times,serif" font-size="14.00" fill="white">16</text>
</g>
<!-- MAP&#45;&gt;B4 -->
<g id="edge8" class="edge">
<title>MAP-&gt;B4</title>
<path fill="none" stroke="black" d="M145.36,-78.56C159.17,-66.42 176.64,-51.05 190.53,-38.84"></path>
<polygon fill="black" stroke="black" points="193.04,-41.29 198.24,-32.06 188.42,-36.03 193.04,-41.29"></polygon>
</g>
</g>
</svg>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<div id="ebcb9007" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="" aria-hidden="true" tabindex="-1"></a>RDD <span class="op">=</span> sc.parallelize([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>])</span>
<span id="cb28-2"><a href="" aria-hidden="true" tabindex="-1"></a>RDD_map <span class="op">=</span> RDD.<span class="bu">map</span>(<span class="kw">lambda</span> x: x <span class="op">*</span> x)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="filter-1" class="slide level2 tiny">
<h2><code>filter()</code></h2>
<ul>
<li><code>filter()</code> –ø–æ–≤–µ—Ä—Ç–∞—î –Ω–æ–≤–∏–π RDD –∑ –µ–ª–µ–º–µ–Ω—Ç–∞–º–∏, —è–∫—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å —É–º–æ–≤—ñ</li>
</ul>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<svg width="960" height="480" viewbox="0.00 0.00 250.79 206.00" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none; display: block; margin: auto auto auto auto">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 202)">
<title>FilterTransformation</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-202 246.79,-202 246.79,4 -4,4"></polygon>
<!-- A1 -->
<g id="node1" class="node">
<title>A1</title>
<ellipse fill="deepskyblue" stroke="black" cx="27" cy="-180" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="27" y="-175.8" font-family="Times,serif" font-size="14.00" fill="white">1</text>
</g>
<!-- FILTER -->
<g id="node5" class="node">
<title>FILTER</title>
<polygon fill="dodgerblue" stroke="black" points="152.68,-119.6 90.11,-119.6 90.11,-78.4 152.68,-78.4 152.68,-119.6"></polygon>
<text text-anchor="middle" x="121.39" y="-103.2" font-family="Times,serif" font-size="14.00" fill="white">filter</text>
<text text-anchor="middle" x="121.39" y="-86.4" font-family="Times,serif" font-size="14.00" fill="white">x : x &gt; 2</text>
</g>
<!-- A1&#45;&gt;FILTER -->
<g id="edge1" class="edge">
<title>A1-&gt;FILTER</title>
<path fill="none" stroke="black" d="M44.09,-165.89C56.51,-155.01 74.06,-139.62 89.2,-126.34"></path>
<polygon fill="black" stroke="black" points="91.65,-128.85 96.86,-119.63 87.03,-123.59 91.65,-128.85"></polygon>
</g>
<!-- A2 -->
<g id="node2" class="node">
<title>A2</title>
<ellipse fill="deepskyblue" stroke="black" cx="27" cy="-126" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="27" y="-121.8" font-family="Times,serif" font-size="14.00" fill="white">2</text>
</g>
<!-- A2&#45;&gt;FILTER -->
<g id="edge2" class="edge">
<title>A2-&gt;FILTER</title>
<path fill="none" stroke="black" d="M52.28,-118.91C60.85,-116.4 70.73,-113.51 80.26,-110.73"></path>
<polygon fill="black" stroke="black" points="81.38,-114.05 90,-107.88 79.42,-107.33 81.38,-114.05"></polygon>
</g>
<!-- A3 -->
<g id="node3" class="node">
<title>A3</title>
<ellipse fill="deepskyblue" stroke="black" cx="27" cy="-72" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="27" y="-67.8" font-family="Times,serif" font-size="14.00" fill="white">3</text>
</g>
<!-- A3&#45;&gt;FILTER -->
<g id="edge3" class="edge">
<title>A3-&gt;FILTER</title>
<path fill="none" stroke="black" d="M52.28,-79.09C60.85,-81.6 70.73,-84.49 80.26,-87.27"></path>
<polygon fill="black" stroke="black" points="79.42,-90.67 90,-90.12 81.38,-83.95 79.42,-90.67"></polygon>
</g>
<!-- A4 -->
<g id="node4" class="node">
<title>A4</title>
<ellipse fill="deepskyblue" stroke="black" cx="27" cy="-18" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="27" y="-13.8" font-family="Times,serif" font-size="14.00" fill="white">4</text>
</g>
<!-- A4&#45;&gt;FILTER -->
<g id="edge5" class="edge">
<title>A4-&gt;FILTER</title>
<path fill="none" stroke="black" d="M44.09,-32.11C56.51,-42.99 74.06,-58.38 89.2,-71.66"></path>
<polygon fill="black" stroke="black" points="87.03,-74.41 96.86,-78.37 91.65,-69.15 87.03,-74.41"></polygon>
</g>
<!-- B3 -->
<g id="node6" class="node">
<title>B3</title>
<ellipse fill="deepskyblue" stroke="black" cx="215.79" cy="-126" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="215.79" y="-121.8" font-family="Times,serif" font-size="14.00" fill="white">3</text>
</g>
<!-- FILTER&#45;&gt;B3 -->
<g id="edge4" class="edge">
<title>FILTER-&gt;B3</title>
<path fill="none" stroke="black" d="M152.9,-107.92C161.93,-110.56 171.87,-113.46 181.1,-116.15"></path>
<polygon fill="black" stroke="black" points="180.16,-119.53 190.74,-118.97 182.13,-112.81 180.16,-119.53"></polygon>
</g>
<!-- B4 -->
<g id="node7" class="node">
<title>B4</title>
<ellipse fill="deepskyblue" stroke="black" cx="215.79" cy="-72" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="215.79" y="-67.8" font-family="Times,serif" font-size="14.00" fill="white">4</text>
</g>
<!-- FILTER&#45;&gt;B4 -->
<g id="edge6" class="edge">
<title>FILTER-&gt;B4</title>
<path fill="none" stroke="black" d="M152.9,-90.08C161.93,-87.44 171.87,-84.54 181.1,-81.85"></path>
<polygon fill="black" stroke="black" points="182.13,-85.19 190.74,-79.03 180.16,-78.47 182.13,-85.19"></polygon>
</g>
</g>
</svg>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<div id="2bef54ef" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="" aria-hidden="true" tabindex="-1"></a>RDD <span class="op">=</span> sc.parallelize([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>])</span>
<span id="cb29-2"><a href="" aria-hidden="true" tabindex="-1"></a>RDD_filter <span class="op">=</span> RDD.<span class="bu">filter</span>(<span class="kw">lambda</span> x: x <span class="op">&gt;</span> <span class="dv">2</span>)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="flatmap" class="slide level2 tiny">
<h2><code>flatMap()</code></h2>
<ul>
<li><code>flatMap()</code> –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î RDD —É –Ω–æ–≤–∏–π RDD, –¥–µ –∫–æ–∂–µ–Ω –µ–ª–µ–º–µ–Ω—Ç –º–æ–∂–µ –±—É—Ç–∏ —Ä–æ–∑–≥–æ—Ä–Ω—É—Ç–∏–π —É –∫—ñ–ª—å–∫–∞ –µ–ª–µ–º–µ–Ω—Ç—ñ–≤</li>
</ul>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<svg width="960" height="480" viewbox="0.00 0.00 221.84 193.60" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none; display: block; margin: auto auto auto auto">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 189.6)">
<title>FlatMapTransformation</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-189.6 217.84,-189.6 217.84,4 -4,4"></polygon>
<!-- A1 -->
<g id="node1" class="node">
<title>A1</title>
<polygon fill="deepskyblue" stroke="black" points="201.12,-185.6 12.72,-185.6 12.72,-149.6 201.12,-149.6 201.12,-185.6"></polygon>
<text text-anchor="middle" x="106.92" y="-163.4" font-family="Times,serif" font-size="14.00" fill="white">['Hello world', 'How are you?']</text>
</g>
<!-- FLATMAP -->
<g id="node2" class="node">
<title>FLATMAP</title>
<polygon fill="green" stroke="black" points="150.3,-113.4 63.54,-113.4 63.54,-72.2 150.3,-72.2 150.3,-113.4"></polygon>
<text text-anchor="middle" x="106.92" y="-97" font-family="Times,serif" font-size="14.00" fill="white">flatMap</text>
<text text-anchor="middle" x="106.92" y="-80.2" font-family="Times,serif" font-size="14.00" fill="white">x : x.split(' ')</text>
</g>
<!-- A1&#45;&gt;FLATMAP -->
<g id="edge1" class="edge">
<title>A1-&gt;FLATMAP</title>
<path fill="none" stroke="black" d="M106.92,-149.35C106.92,-141.69 106.92,-132.46 106.92,-123.74"></path>
<polygon fill="black" stroke="black" points="110.42,-123.5 106.92,-113.5 103.42,-123.5 110.42,-123.5"></polygon>
</g>
<!-- B1 -->
<g id="node3" class="node">
<title>B1</title>
<polygon fill="deepskyblue" stroke="black" points="213.76,-36 0.08,-36 0.08,0 213.76,0 213.76,-36"></polygon>
<text text-anchor="middle" x="106.92" y="-13.8" font-family="Times,serif" font-size="14.00" fill="white">['Hello', 'world', 'How', 'are', 'you?']</text>
</g>
<!-- FLATMAP&#45;&gt;B1 -->
<g id="edge2" class="edge">
<title>FLATMAP-&gt;B1</title>
<path fill="none" stroke="black" d="M106.92,-71.91C106.92,-64.09 106.92,-54.99 106.92,-46.56"></path>
<polygon fill="black" stroke="black" points="110.42,-46.39 106.92,-36.39 103.42,-46.39 110.42,-46.39"></polygon>
</g>
</g>
</svg>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<div id="b955838f" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="" aria-hidden="true" tabindex="-1"></a>RDD <span class="op">=</span> sc.parallelize([<span class="st">"hello world"</span>, <span class="st">"how are you"</span>])</span>
<span id="cb30-2"><a href="" aria-hidden="true" tabindex="-1"></a>RDD_flatmap <span class="op">=</span> RDD.flatMap(<span class="kw">lambda</span> x: x.split(<span class="st">" "</span>))</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="union" class="slide level2 tiny">
<h2><code>union()</code></h2>
<ul>
<li><code>union()</code> –æ–±‚Äô—î–¥–Ω—É—î –¥–≤–∞ RDD –≤ –æ–¥–∏–Ω</li>
</ul>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<svg width="960" height="480" viewbox="0.00 0.00 211.62 332.00" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none; display: block; margin: auto auto auto auto">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 328)">
<title>RDD_Pipeline</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-328 207.62,-328 207.62,4 -4,4"></polygon>
<!-- inputRDD -->
<g id="node1" class="node">
<title>inputRDD</title>
<polygon fill="#2980b9" stroke="black" points="134.63,-324 58.25,-324 58.25,-288 134.63,-288 134.63,-324"></polygon>
<text text-anchor="middle" x="96.44" y="-301.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="white">inputRDD</text>
</g>
<!-- filter1 -->
<g id="node5" class="node">
<title>filter1</title>
<polygon fill="#a93226" stroke="black" points="87.44,-252 33.44,-252 33.44,-216 87.44,-216 87.44,-252"></polygon>
<text text-anchor="middle" x="60.44" y="-229.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="white">Filter</text>
</g>
<!-- inputRDD&#45;&gt;filter1 -->
<g id="edge1" class="edge">
<title>inputRDD-&gt;filter1</title>
<path fill="none" stroke="black" d="M87.55,-287.7C83.45,-279.73 78.5,-270.1 73.95,-261.26"></path>
<polygon fill="black" stroke="black" points="76.93,-259.4 69.24,-252.1 70.7,-262.6 76.93,-259.4"></polygon>
</g>
<!-- filter2 -->
<g id="node6" class="node">
<title>filter2</title>
<polygon fill="#a93226" stroke="black" points="169.44,-252 115.44,-252 115.44,-216 169.44,-216 169.44,-252"></polygon>
<text text-anchor="middle" x="142.44" y="-229.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="white">Filter</text>
</g>
<!-- inputRDD&#45;&gt;filter2 -->
<g id="edge3" class="edge">
<title>inputRDD-&gt;filter2</title>
<path fill="none" stroke="black" d="M107.82,-287.7C113.16,-279.56 119.65,-269.69 125.56,-260.7"></path>
<polygon fill="black" stroke="black" points="128.64,-262.38 131.2,-252.1 122.79,-258.54 128.64,-262.38"></polygon>
</g>
<!-- errorsRDD -->
<g id="node2" class="node">
<title>errorsRDD</title>
<polygon fill="#2980b9" stroke="black" points="82.83,-180 0.06,-180 0.06,-144 82.83,-144 82.83,-180"></polygon>
<text text-anchor="middle" x="41.44" y="-157.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="white">errorsRDD</text>
</g>
<!-- union -->
<g id="node7" class="node">
<title>union</title>
<polygon fill="#a93226" stroke="black" points="123.44,-108 69.44,-108 69.44,-72 123.44,-72 123.44,-108"></polygon>
<text text-anchor="middle" x="96.44" y="-85.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="white">Union</text>
</g>
<!-- errorsRDD&#45;&gt;union -->
<g id="edge5" class="edge">
<title>errorsRDD-&gt;union</title>
<path fill="none" stroke="black" d="M55.04,-143.7C61.57,-135.39 69.51,-125.28 76.69,-116.14"></path>
<polygon fill="black" stroke="black" points="79.58,-118.13 83.01,-108.1 74.08,-113.81 79.58,-118.13"></polygon>
</g>
<!-- warningsRDD -->
<g id="node3" class="node">
<title>warningsRDD</title>
<polygon fill="#2980b9" stroke="black" points="203.8,-180 101.09,-180 101.09,-144 203.8,-144 203.8,-180"></polygon>
<text text-anchor="middle" x="152.44" y="-157.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="white">warningsRDD</text>
</g>
<!-- warningsRDD&#45;&gt;union -->
<g id="edge7" class="edge">
<title>warningsRDD-&gt;union</title>
<path fill="none" stroke="black" d="M138.6,-143.7C131.96,-135.39 123.87,-125.28 116.56,-116.14"></path>
<polygon fill="black" stroke="black" points="119.11,-113.73 110.13,-108.1 113.64,-118.1 119.11,-113.73"></polygon>
</g>
<!-- badlinesRDD -->
<g id="node4" class="node">
<title>badlinesRDD</title>
<polygon fill="#2980b9" stroke="black" points="145.93,-36 46.96,-36 46.96,0 145.93,0 145.93,-36"></polygon>
<text text-anchor="middle" x="96.44" y="-13.8" font-family="Helvetica,sans-Serif" font-size="14.00" fill="white">badlinesRDD</text>
</g>
<!-- filter1&#45;&gt;errorsRDD -->
<g id="edge2" class="edge">
<title>filter1-&gt;errorsRDD</title>
<path fill="none" stroke="black" d="M55.75,-215.7C53.63,-207.9 51.08,-198.51 48.73,-189.83"></path>
<polygon fill="black" stroke="black" points="52.08,-188.84 46.09,-180.1 45.33,-190.67 52.08,-188.84"></polygon>
</g>
<!-- filter2&#45;&gt;warningsRDD -->
<g id="edge4" class="edge">
<title>filter2-&gt;warningsRDD</title>
<path fill="none" stroke="black" d="M144.92,-215.7C146.02,-207.98 147.34,-198.71 148.57,-190.11"></path>
<polygon fill="black" stroke="black" points="152.05,-190.5 150,-180.1 145.12,-189.51 152.05,-190.5"></polygon>
</g>
<!-- union&#45;&gt;badlinesRDD -->
<g id="edge6" class="edge">
<title>union-&gt;badlinesRDD</title>
<path fill="none" stroke="black" d="M96.44,-71.7C96.44,-63.98 96.44,-54.71 96.44,-46.11"></path>
<polygon fill="black" stroke="black" points="99.94,-46.1 96.44,-36.1 92.94,-46.1 99.94,-46.1"></polygon>
</g>
</g>
</svg>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<div id="5646b5cb" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="" aria-hidden="true" tabindex="-1"></a>inputRDD <span class="op">=</span> sc.textFile(<span class="st">"logs.txt"</span>)</span>
<span id="cb31-2"><a href="" aria-hidden="true" tabindex="-1"></a>errorRDD <span class="op">=</span> inputRDD.<span class="bu">filter</span>(<span class="kw">lambda</span> x: <span class="st">"error"</span> <span class="kw">in</span> x.split())</span>
<span id="cb31-3"><a href="" aria-hidden="true" tabindex="-1"></a>warningsRDD <span class="op">=</span> inputRDD.<span class="bu">filter</span>(<span class="kw">lambda</span> x: <span class="st">"warnings"</span> <span class="kw">in</span> x.split())</span>
<span id="cb31-4"><a href="" aria-hidden="true" tabindex="-1"></a>combinedRDD <span class="op">=</span> errorRDD.union(warningsRDD)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="rdd-actions" class="slide level2">
<h2>RDD Actions</h2>
<p>–¶–µ –æ–ø–µ—Ä–∞—Ü—ñ—ó, —è–∫—ñ –ø–æ–≤–µ—Ä—Ç–∞—é—Ç—å –∑–Ω–∞—á–µ–Ω–Ω—è –ø—ñ—Å–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –æ–±—á–∏—Å–ª–µ–Ω—å –Ω–∞ RDD</p>
<ul>
<li>–ë–∞–∑–æ–≤—ñ –¥—ñ—ó –∑ RDD
<ul>
<li><code>collect()</code></li>
<li><code>take(N)</code></li>
<li><code>first()</code></li>
<li><code>count()</code></li>
</ul></li>
</ul>
</section>
<section id="collect-—Ç–∞-take" class="slide level2">
<h2><code>collect()</code> —Ç–∞ <code>take()</code></h2>
<ul>
<li><code>collect()</code> –ø–æ–≤–µ—Ä—Ç–∞—î –≤—Å—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ –Ω–∞–±–æ—Ä—É –¥–∞–Ω–∏—Ö —É –≤–∏–≥–ª—è–¥—ñ –º–∞—Å–∏–≤—É</li>
<li><code>take(N)</code> –ø–æ–≤–µ—Ä—Ç–∞—î –º–∞—Å–∏–≤ –ø–µ—Ä—à–∏—Ö <code>N</code> –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ –Ω–∞–±–æ—Ä—É –¥–∞–Ω–∏—Ö</li>
</ul>
<div id="6b77442c" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="" aria-hidden="true" tabindex="-1"></a>RDD_map.collect()</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>[1, 4, 9, 16]</code></pre>
</div>
</div>
<div id="031f2008" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="" aria-hidden="true" tabindex="-1"></a>RDD_map.take(<span class="dv">2</span>)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>[1, 4]</code></pre>
</div>
</div>
</section>
<section id="first-—Ç–∞-count" class="slide level2">
<h2><code>first()</code> —Ç–∞ <code>count()</code></h2>
<ul>
<li><code>first()</code> –≤–∏–≤–æ–¥–∏—Ç—å –ø–µ—Ä—à–∏–π –µ–ª–µ–º–µ–Ω—Ç RDD</li>
</ul>
<div id="2d8e8fbc" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="" aria-hidden="true" tabindex="-1"></a>RDD_map.first()</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>1</code></pre>
</div>
</div>
<ul>
<li><code>count()</code> –ø–æ–≤–µ—Ä—Ç–∞—î –∫—ñ–ª—å–∫—ñ—Å—Ç—å –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ —É RDD</li>
</ul>
<div id="c93e01d8" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="" aria-hidden="true" tabindex="-1"></a>RDD_flatmap.count()</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>5</code></pre>
</div>
</div>
</section></section>
<section>
<section id="—Ä–æ–±–æ—Ç–∞-–∑-pair-rdd-–≤-pyspark" class="title-slide slide level1 unnumbered unlisted center">
<h1>–†–æ–±–æ—Ç–∞ –∑ Pair RDD –≤ PySpark</h1>

</section>
<section id="–≤—Å—Ç—É–ø-–¥–æ-pair-rdd-—É-pyspark" class="slide level2">
<h2>–í—Å—Ç—É–ø –¥–æ Pair RDD —É PySpark</h2>
<ul>
<li>–†–µ–∞–ª—å–Ω—ñ –Ω–∞–±–æ—Ä–∏ –¥–∞–Ω–∏—Ö –∑–∞–∑–≤–∏—á–∞–π —î –ø–∞—Ä–∞–º–∏ –∫–ª—é—á/–∑–Ω–∞—á–µ–Ω–Ω—è</li>
<li>–ö–æ–∂–µ–Ω —Ä—è–¥–æ–∫ —î –∫–ª—é—á–µ–º —ñ —Å–ø—ñ–≤–≤—ñ–¥–Ω–æ—Å–∏—Ç—å—Å—è –∑ –æ–¥–Ω–∏–º –∞–±–æ –¥–µ–∫—ñ–ª—å–∫–æ–º–∞ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏</li>
<li>Pair RDD ‚Äî —Ü–µ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–∏—Ö –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ —Ç–∞–∫–∏–º–∏ –Ω–∞–±–æ—Ä–∞–º–∏ –¥–∞–Ω–∏—Ö</li>
<li>Pair RDD: –∫–ª—é—á ‚Äî —Ü–µ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä, –∞ –∑–Ω–∞—á–µ–Ω–Ω—è ‚Äî —Ü–µ –¥–∞–Ω—ñ</li>
</ul>
</section>
<section id="—Å—Ç–≤–æ—Ä–µ–Ω–Ω—è-pair-rdd" class="slide level2 smaller">
<h2>–°—Ç–≤–æ—Ä–µ–Ω–Ω—è Pair RDD</h2>
<ul>
<li>–î–≤–∞ –Ω–∞–π–ø–æ—à–∏—Ä–µ–Ω—ñ—à—ñ —Å–ø–æ—Å–æ–±–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–∞—Ä–Ω–∏—Ö RDD
<ul>
<li>–ó—ñ —Å–ø–∏—Å–∫—É –∫–æ—Ä—Ç–µ–∂—É –∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–Ω—è</li>
<li>–ó—ñ –∑–≤–∏—á–∞–π–Ω–æ–≥–æ RDD</li>
</ul></li>
<li>–û—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö —É —Ñ–æ—Ä–º—ñ –∫–ª—é—á/–∑–Ω–∞—á–µ–Ω–Ω—è –¥–ª—è –ø–∞—Ä–Ω–æ–≥–æ RDD</li>
</ul>
<div id="6624e382" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="" aria-hidden="true" tabindex="-1"></a>my_tuple <span class="op">=</span> [(<span class="st">'Sam'</span>, <span class="dv">23</span>), (<span class="st">'Mary'</span>, <span class="dv">34</span>), (<span class="st">'Peter'</span>, <span class="dv">25</span>)]</span>
<span id="cb40-2"><a href="" aria-hidden="true" tabindex="-1"></a>pairRDD_tuple <span class="op">=</span> sc.parallelize(my_tuple)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br>
</p>
<div id="5d81af48" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="" aria-hidden="true" tabindex="-1"></a>my_list <span class="op">=</span> [<span class="st">'Sam 23'</span>, <span class="st">'Mary 34'</span>, <span class="st">'Peter 25'</span>]</span>
<span id="cb41-2"><a href="" aria-hidden="true" tabindex="-1"></a>regularRDD <span class="op">=</span> sc.parallelize(my_list)</span>
<span id="cb41-3"><a href="" aria-hidden="true" tabindex="-1"></a>pairRDD_RDD <span class="op">=</span> regularRDD.<span class="bu">map</span>(<span class="kw">lambda</span> s: (s.split(<span class="st">' '</span>)[<span class="dv">0</span>], s.split(<span class="st">' '</span>)[<span class="dv">1</span>]))</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="–ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è-pair-rdd" class="slide level2">
<h2>–ü–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è Pair RDD</h2>
<ul>
<li>–í—Å—ñ —Ä–µ–≥—É–ª—è—Ä–Ω—ñ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø—Ä–∞—Ü—é—é—Ç—å –Ω–∞ –ø–∞—Ä—ñ RDD</li>
<li>–ü–æ—Ç—Ä—ñ–±–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—ó, —è–∫—ñ –æ–ø–µ—Ä—É—é—Ç—å –ø–∞—Ä–∞–º–∏ –∑–Ω–∞—á–µ–Ω—å –∫–ª—é—á—ñ–≤, –∞ –Ω–µ –æ–∫—Ä–µ–º–∏–º–∏ –µ–ª–µ–º–µ–Ω—Ç–∞–º–∏</li>
<li>–ü—Ä–∏–∫–ª–∞–¥–∏ –ø–∞—Ä–Ω–∏—Ö –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω—å RDD
<ul>
<li><code>reduceByKey(func)</code>: –û–±‚Äô—î–¥–Ω—É—î –∑–Ω–∞—á–µ–Ω–Ω—è –∑ –æ–¥–Ω–∞–∫–æ–≤–∏–º –∫–ª—é—á–µ–º</li>
<li><code>groupByKey()</code>: –ó–≥—Ä—É–ø—É–≤–∞—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è –∑ –æ–¥–Ω–∞–∫–æ–≤–∏–º –∫–ª—é—á–µ–º</li>
<li><code>sortByKey()</code>: –ü–æ–≤–µ—Ä–Ω—É—Ç–∏ RDD, –≤—ñ–¥—Å–æ—Ä—Ç–æ–≤–∞–Ω–∏–π –∑–∞ –∫–ª—é—á–µ–º</li>
<li><code>join()</code>: –û–±‚Äô—î–¥–Ω–∞—Ç–∏ –¥–≤—ñ –ø–∞—Ä–∏ RDD –Ω–∞ –æ—Å–Ω–æ–≤—ñ —ó—Ö –∫–ª—é—á–∞</li>
</ul></li>
</ul>
</section>
<section id="reducebykeyfunc" class="slide level2">
<h2><code>reduceByKey(func)</code></h2>
<ul>
<li><code>reduceByKey(func)</code> –æ–±‚Äô—î–¥–Ω—É—î –∑–Ω–∞—á–µ–Ω–Ω—è –∑ –æ–¥–Ω–∞–∫–æ–≤–∏–º –∫–ª—é—á–µ–º</li>
<li>–í—ñ–Ω –≤–∏–∫–æ–Ω—É—î –ø–∞—Ä–∞–ª–µ–ª—å–Ω—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –∫–ª—é—á–∞ –≤ –Ω–∞–±–æ—Ä—ñ –¥–∞–Ω–∏—Ö</li>
<li>–¶–µ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è, –∞ –Ω–µ –¥—ñ—è</li>
</ul>
<div id="362fec9b" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="" aria-hidden="true" tabindex="-1"></a>regularRDD <span class="op">=</span> sc.parallelize([(<span class="st">"Messi"</span>, <span class="dv">23</span>), (<span class="st">"Ronaldo"</span>, <span class="dv">34</span>),</span>
<span id="cb42-2"><a href="" aria-hidden="true" tabindex="-1"></a>                              (<span class="st">"Neymar"</span>, <span class="dv">22</span>), (<span class="st">"Messi"</span>, <span class="dv">24</span>)])</span>
<span id="cb42-3"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="" aria-hidden="true" tabindex="-1"></a>pairRDD_reducebykey <span class="op">=</span> regularRDD.reduceByKey(<span class="kw">lambda</span> x,y : x <span class="op">+</span> y)</span>
<span id="cb42-5"><a href="" aria-hidden="true" tabindex="-1"></a>pairRDD_reducebykey.collect()</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>[('Neymar', 22), ('Messi', 47), ('Ronaldo', 34)]</code></pre>
</div>
</div>
</section>
<section id="sortbykey" class="slide level2">
<h2><code>sortByKey()</code></h2>
<ul>
<li><code>sortByKey()</code> –ø–æ–≤–µ—Ä—Ç–∞—î RDD, –≤—ñ–¥—Å–æ—Ä—Ç–æ–≤–∞–Ω–∏–π –∑–∞ –∫–ª—é—á–µ–º</li>
</ul>
<div id="0eaf6237" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="" aria-hidden="true" tabindex="-1"></a>pairRDD_reducebykey_rev <span class="op">=</span> pairRDD_reducebykey.<span class="bu">map</span>(<span class="kw">lambda</span> x: (x[<span class="dv">1</span>], x[<span class="dv">0</span>]))</span>
<span id="cb44-2"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="" aria-hidden="true" tabindex="-1"></a>pairRDD_reducebykey_rev.sortByKey(ascending<span class="op">=</span><span class="va">False</span>).collect()</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>[(47, 'Messi'), (34, 'Ronaldo'), (22, 'Neymar')]</code></pre>
</div>
</div>
</section>
<section id="groupbykey" class="slide level2">
<h2><code>groupByKey()</code></h2>
<ul>
<li><code>groupByKey()</code> –∑–≥—Ä—É–ø–æ–≤—É—î –∑–Ω–∞—á–µ–Ω–Ω—è –∑ –æ–¥–Ω–∞–∫–æ–≤–∏–º –∫–ª—é—á–µ–º</li>
</ul>
<div id="27a6f24f" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="" aria-hidden="true" tabindex="-1"></a>airports <span class="op">=</span> [(<span class="st">"US"</span>, <span class="st">"JFK"</span>),(<span class="st">"UK"</span>, <span class="st">"LHR"</span>),(<span class="st">"FR"</span>, <span class="st">"CDG"</span>),(<span class="st">"US"</span>, <span class="st">"SFO"</span>)]</span>
<span id="cb46-2"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="" aria-hidden="true" tabindex="-1"></a>regularRDD <span class="op">=</span> sc.parallelize(airports)</span>
<span id="cb46-4"><a href="" aria-hidden="true" tabindex="-1"></a>pairRDD_group <span class="op">=</span> regularRDD.groupByKey().collect()</span>
<span id="cb46-5"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-6"><a href="" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> cont, air <span class="kw">in</span> pairRDD_group:</span>
<span id="cb46-7"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(cont, <span class="bu">list</span>(air))</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>US ['JFK', 'SFO']
UK ['LHR']
FR ['CDG']</code></pre>
</div>
</div>
</section>
<section id="join" class="slide level2">
<h2><code>join()</code></h2>
<ul>
<li><code>join()</code> –æ–±‚Äô—î–¥–Ω—É—î –¥–≤—ñ –ø–∞—Ä–∏ RDD –Ω–∞ –æ—Å–Ω–æ–≤—ñ —ó—Ö –∫–ª—é—á–∞</li>
</ul>
<div id="4ee8e313" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="" aria-hidden="true" tabindex="-1"></a>RDD1 <span class="op">=</span> sc.parallelize([(<span class="st">"Messi"</span>, <span class="dv">34</span>),(<span class="st">"Ronaldo"</span>, <span class="dv">32</span>),(<span class="st">"Neymar"</span>, <span class="dv">24</span>)])</span>
<span id="cb48-2"><a href="" aria-hidden="true" tabindex="-1"></a>RDD2 <span class="op">=</span> sc.parallelize([(<span class="st">"Ronaldo"</span>, <span class="dv">80</span>),(<span class="st">"Neymar"</span>, <span class="dv">120</span>),(<span class="st">"Messi"</span>, <span class="dv">100</span>)])</span>
<span id="cb48-3"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="" aria-hidden="true" tabindex="-1"></a>RDD1.join(RDD2).collect()</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>[('Ronaldo', (32, 80)), ('Neymar', (24, 120)), ('Messi', (34, 100))]</code></pre>
</div>
</div>
</section></section>
<section>
<section id="–¥–æ–¥–∞—Ç–∫–æ–≤—ñ-–¥—ñ—ó-actions" class="title-slide slide level1 unnumbered unlisted center">
<h1>–î–æ–¥–∞—Ç–∫–æ–≤—ñ –¥—ñ—ó (actions)</h1>

</section>
<section id="reduce" class="slide level2">
<h2><code>reduce()</code></h2>
<ul>
<li><code>reduce()</code> –æ–±‚Äô—î–¥–Ω—É—î –≤—Å—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ RDD –≤ –æ–¥–∏–Ω</li>
<li>–§—É–Ω–∫—Ü—ñ—è –ø–æ–≤–∏–Ω–Ω–∞ –±—É—Ç–∏ –∫–æ–º—É—Ç–∞—Ç–∏–≤–Ω–æ—é (–∑–º—ñ–Ω–∞ –ø–æ—Ä—è–¥–∫—É –æ–ø–µ—Ä–∞–Ω–¥—ñ–≤ –Ω–µ –∑–º—ñ–Ω—é—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç) —Ç–∞ –∞—Å–æ—Ü—ñ–∞—Ç–∏–≤–Ω–æ—é</li>
</ul>
<div id="49bda63f" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> [<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">6</span>]</span>
<span id="cb50-2"><a href="" aria-hidden="true" tabindex="-1"></a>RDD <span class="op">=</span> sc.parallelize(x)</span>
<span id="cb50-3"><a href="" aria-hidden="true" tabindex="-1"></a>RDD.<span class="bu">reduce</span>(<span class="kw">lambda</span> x, y : x <span class="op">+</span> y)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>14</code></pre>
</div>
</div>
</section>
<section id="saveastextfile" class="slide level2">
<h2><code>saveAsTextFile()</code></h2>
<ul>
<li><code>saveAsTextFile()</code> –∑–±–µ—Ä—ñ–≥–∞—î RDD —É —Ç–µ–∫—Å—Ç–æ–≤–æ–º—É —Ñ–∞–π–ª—ñ</li>
</ul>
<div id="c593916e" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="" aria-hidden="true" tabindex="-1"></a>RDD.saveAsTextFile(<span class="st">"tempFile"</span>)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><code>coalesce()</code> –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è RDD —É –≤–∏–≥–ª—è–¥—ñ –æ–¥–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Ñ–∞–π–ª—É</li>
</ul>
<div id="fa3af2ba" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="" aria-hidden="true" tabindex="-1"></a>RDD.coalesce(<span class="dv">1</span>).saveAsTextFile(<span class="st">"tempFile"</span>)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="action-–æ–ø–µ—Ä–∞—Ü—ñ—ó-–Ω–∞–¥-–ø–∞—Ä–∞–º–∏-rdd" class="slide level2">
<h2>Action –æ–ø–µ—Ä–∞—Ü—ñ—ó –Ω–∞–¥ –ø–∞—Ä–∞–º–∏ RDD</h2>
<ul>
<li>Action RDD, –¥–æ—Å—Ç—É–ø–Ω—ñ –¥–ª—è –ø–∞—Ä–Ω–∏—Ö RDD —É PySpark</li>
<li>–ü–∞—Ä–Ω—ñ –¥—ñ—ó RDD –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å –¥–∞–Ω—ñ –∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–Ω—è</li>
<li>–ö—ñ–ª—å–∫–∞ –ø—Ä–∏–∫–ª–∞–¥—ñ–≤ –¥—ñ–π –ø–∞—Ä–Ω–æ–≥–æ RDD –≤–∫–ª—é—á–∞—é—Ç—å
<ul>
<li><code>countByKey()</code></li>
<li><code>collectAsMap()</code></li>
</ul></li>
</ul>
</section>
<section id="countbykey" class="slide level2">
<h2><code>countByKey()</code></h2>
<ul>
<li><code>countByKey()</code> –¥–æ—Å—Ç—É–ø–Ω–∏–π —Ç—ñ–ª—å–∫–∏ –¥–ª—è —Ç–∏–ø—É Pair RDD</li>
<li><code>countByKey()</code> –ø—ñ–¥—Ä–∞—Ö–æ–≤—É—î –∫—ñ–ª—å–∫—ñ—Å—Ç—å –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –∫–ª—é—á–∞</li>
</ul>
<div id="e1eef0f9" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="" aria-hidden="true" tabindex="-1"></a>rdd <span class="op">=</span> sc.parallelize([(<span class="st">"a"</span>, <span class="dv">1</span>), (<span class="st">"b"</span>, <span class="dv">1</span>), (<span class="st">"a"</span>, <span class="dv">1</span>)])</span>
<span id="cb54-2"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> kee, val <span class="kw">in</span> rdd.countByKey().items():</span>
<span id="cb54-4"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(kee, val)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>a 2
b 1</code></pre>
</div>
</div>
</section>
<section id="collectasmap" class="slide level2">
<h2><code>collectAsMap()</code></h2>
<ul>
<li><code>collectAsMap()</code> –ø–æ–≤–µ—Ä–Ω—É—Ç–∏ –ø–∞—Ä–∏ –∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–Ω—è –≤ RDD —É –≤–∏–≥–ª—è–¥—ñ —Å–ª–æ–≤–Ω–∏–∫–∞</li>
</ul>
<div id="3c4195c1" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="" aria-hidden="true" tabindex="-1"></a>sc.parallelize([(<span class="dv">1</span>, <span class="dv">2</span>), (<span class="dv">3</span>, <span class="dv">4</span>)]).collectAsMap()</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>{1: 2, 3: 4}</code></pre>
</div>
</div>
</section>
<section id="pyspark-sql-—Ç–∞-dataframes" class="slide level2">
<h2>PySpark SQL —Ç–∞ DataFrames</h2>
</section>
<section id="pyspark-dataframes" class="slide level2">
<h2>PySpark DataFrames</h2>
<ul>
<li>PySpark SQL ‚Äî —Ü–µ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ Spark –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω–∏—Ö –¥–∞–Ω–∏—Ö. –í–æ–Ω–∞ –Ω–∞–¥–∞—î –±—ñ–ª—å—à–µ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–∏—Ö —Ç–∞ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è</li>
<li>PySpark DataFrame ‚Äî –Ω–µ–∑–º—ñ–Ω–Ω–∞ —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω–∞ –∫–æ–ª–µ–∫—Ü—ñ—è –¥–∞–Ω–∏—Ö –∑ —ñ–º–µ–Ω–æ–≤–∞–Ω–∏–º–∏ —Å—Ç–æ–≤–ø—Ü—è–º–∏</li>
<li>–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –æ–±—Ä–æ–±–∫–∏ —è–∫ —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω–∏—Ö (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —Ä–µ–ª—è—Ü—ñ–π–Ω–∞ –±–∞–∑–∞ –¥–∞–Ω–∏—Ö), —Ç–∞–∫ —ñ –Ω–∞–ø—ñ–≤—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω–∏—Ö –¥–∞–Ω–∏—Ö (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, JSON)</li>
<li>API —Ñ—Ä–µ–π–º—ñ–≤ –¥–∞–Ω–∏—Ö –¥–æ—Å—Ç—É–ø–Ω–∏–π —É Python, R, Scala —Ç–∞ Java</li>
<li>DataFrames –≤ PySpark –ø—ñ–¥—Ç—Ä–∏–º—É—é—Ç—å —è–∫ SQL –∑–∞–ø–∏—Ç–∏ ( <code>SELECT * from table</code> ), —Ç–∞–∫ —ñ –≤–∏—Ä–∞–∑–∏ –º–µ—Ç–æ–¥–∏ ( <code>df.select()</code> )</li>
</ul>
</section>
<section id="sparksession-—Ç–æ—á–∫–∞-–≤—Ö–æ–¥—É-–¥–ª—è-api-dataframe" class="slide level2">
<h2>SparkSession ‚Äî —Ç–æ—á–∫–∞ –≤—Ö–æ–¥—É –¥–ª—è API DataFrame</h2>
<ul>
<li>SparkContext —î –æ—Å–Ω–æ–≤–Ω–æ—é —Ç–æ—á–∫–æ—é –≤—Ö–æ–¥—É –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è RDD</li>
<li>SparkSession –∑–∞–±–µ–∑–ø–µ—á—É—î —î–¥–∏–Ω—É —Ç–æ—á–∫—É –≤—Ö–æ–¥—É –¥–ª—è –≤–∑–∞—î–º–æ–¥—ñ—ó –∑ —Ñ—Ä–µ–π–º–∞–º–∏ –¥–∞–Ω–∏—Ö Spark</li>
<li>SparkSession –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è DataFrame, —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó DataFrame, –≤–∏–∫–æ–Ω–∞–Ω–Ω—è SQL –∑–∞–ø–∏—Ç—ñ–≤</li>
<li>SparkSession –¥–æ—Å—Ç—É–ø–Ω–∏–π –≤ –æ–±–æ–ª–æ–Ω—Ü—ñ PySpark —è–∫ spark</li>
</ul>
</section>
<section id="—Å—Ç–≤–æ—Ä–µ–Ω–Ω—è-dataframe" class="slide level2">
<h2>–°—Ç–≤–æ—Ä–µ–Ω–Ω—è DataFrame</h2>
<ul>
<li>–î–≤–∞ —Ä—ñ–∑–Ω—ñ –º–µ—Ç–æ–¥–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è DataFrame –≤ PySpark
<ul>
<li>–ó —ñ—Å–Ω—É—é—á–∏—Ö RDD –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –º–µ—Ç–æ–¥—É <code>createDataFrame()</code> SparkSession</li>
<li>–ó —Ä—ñ–∑–Ω–∏—Ö –¥–∂–µ—Ä–µ–ª –¥–∞–Ω–∏—Ö (CSV, JSON, TXT) –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –º–µ—Ç–æ–¥—É <code>read()</code> SparkSession</li>
</ul></li>
<li>–°—Ö–µ–º–∞ –∫–æ–Ω—Ç—Ä–æ–ª—é—î –¥–∞–Ω—ñ —ñ –¥–æ–ø–æ–º–∞–≥–∞—î DataFrames –æ–ø—Ç–∏–º—ñ–∑—É–≤–∞—Ç–∏ –∑–∞–ø–∏—Ç–∏</li>
<li>–°—Ö–µ–º–∞ –Ω–∞–¥–∞—î —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –Ω–∞–∑–≤—É —Å—Ç–æ–≤–ø—Ü—è, —Ç–∏–ø –¥–∞–Ω–∏—Ö —É —Å—Ç–æ–≤–ø—Ü—ñ, –ø–æ—Ä–æ–∂–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è —Ç–æ—â–æ.</li>
</ul>
</section>
<section id="—Å—Ç–≤–æ—Ä–µ–Ω–Ω—è-dataframe-1" class="slide level2">
<h2>–°—Ç–≤–æ—Ä–µ–Ω–Ω—è DataFrame</h2>
<div id="216317eb" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyspark.sql <span class="im">import</span> SparkSession</span>
<span id="cb58-2"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="" aria-hidden="true" tabindex="-1"></a>spark <span class="op">=</span> SparkSession.builder.appName(<span class="st">"DataFrame"</span>).getOrCreate()</span>
<span id="cb58-4"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-5"><a href="" aria-hidden="true" tabindex="-1"></a>iphones_RDD <span class="op">=</span> sc.parallelize([</span>
<span id="cb58-6"><a href="" aria-hidden="true" tabindex="-1"></a>  (<span class="st">"XS"</span>, <span class="dv">2018</span>, <span class="fl">5.65</span>, <span class="fl">2.79</span>, <span class="fl">6.24</span>),</span>
<span id="cb58-7"><a href="" aria-hidden="true" tabindex="-1"></a>  (<span class="st">"XR"</span>, <span class="dv">2018</span>, <span class="fl">5.94</span>, <span class="fl">2.98</span>, <span class="fl">6.84</span>),</span>
<span id="cb58-8"><a href="" aria-hidden="true" tabindex="-1"></a>  (<span class="st">"X10"</span>, <span class="dv">2017</span>, <span class="fl">5.65</span>, <span class="fl">2.79</span>, <span class="fl">6.13</span>),</span>
<span id="cb58-9"><a href="" aria-hidden="true" tabindex="-1"></a>  (<span class="st">"8Plus"</span>, <span class="dv">2017</span>, <span class="fl">6.23</span>, <span class="fl">3.07</span>, <span class="fl">7.12</span>)</span>
<span id="cb58-10"><a href="" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb58-11"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-12"><a href="" aria-hidden="true" tabindex="-1"></a>names <span class="op">=</span> [<span class="st">'Model'</span>, <span class="st">'Year'</span>, <span class="st">'Height'</span>, <span class="st">'Width'</span>, <span class="st">'Weight'</span>]</span>
<span id="cb58-13"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-14"><a href="" aria-hidden="true" tabindex="-1"></a>iphones_df <span class="op">=</span> spark.createDataFrame(iphones_RDD, schema<span class="op">=</span>names)</span>
<span id="cb58-15"><a href="" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(iphones_df)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>pyspark.sql.dataframe.DataFrame</code></pre>
</div>
</div>
</section>
<section id="dataframe-–∑-csvjsontxt" class="slide level2">
<h2>DataFrame –∑ CSV/JSON/TXT</h2>
<div id="27106250" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="" aria-hidden="true" tabindex="-1"></a>df_csv <span class="op">=</span> spark.read.csv(<span class="st">"people.csv"</span>, header<span class="op">=</span><span class="va">True</span>, inferSchema<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb60-2"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="" aria-hidden="true" tabindex="-1"></a>df_json <span class="op">=</span> spark.read.json(<span class="st">"people.json"</span>)</span>
<span id="cb60-4"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="" aria-hidden="true" tabindex="-1"></a>df_txt <span class="op">=</span> spark.read.txt(<span class="st">"people.txt"</span>)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>–®–ª—è—Ö –¥–æ —Ñ–∞–π–ª—É —Ç–∞ –¥–≤–∞ –Ω–µ–æ–±–æ–≤‚Äô—è–∑–∫–æ–≤—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏</li>
<li>–î–≤–∞ –Ω–µ–æ–±–æ–≤‚Äô—è–∑–∫–æ–≤—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏
<ul>
<li><code>header=True</code></li>
<li><code>inferSchema=True</code></li>
</ul></li>
</ul>
</section></section>
<section>
<section id="–≤–∑–∞—î–º–æ–¥—ñ—è-–∑-dataframe" class="title-slide slide level1 unnumbered unlisted center">
<h1>–í–∑–∞—î–º–æ–¥—ñ—è –∑ DataFrame</h1>

</section>
<section id="–æ–ø–µ—Ä–∞—Ç–æ—Ä–∏-dataframe-—É-pyspark" class="slide level2 tiny">
<h2>–û–ø–µ—Ä–∞—Ç–æ—Ä–∏ DataFrame —É PySpark</h2>
<ul>
<li>–û–ø–µ—Ä–∞—Ü—ñ—ó –∑ DataFrame: –ü–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞ –¥—ñ—ó</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>–ü–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ñ—Ä–µ–π–º—É –¥–∞–Ω–∏—Ö:
<ul>
<li><code>select()</code></li>
<li><code>filter()</code></li>
<li><code>groupby()</code></li>
<li><code>orderby()</code></li>
<li><code>dropDuplicates()</code></li>
<li><code>withColumnRenamed()</code></li>
</ul></li>
</ul>
</div><div class="column" style="width:50%;">
<ul>
<li>–î—ñ—ó –∑ —Ñ—Ä–µ–π–º–æ–º –¥–∞–Ω–∏—Ö:
<ul>
<li><code>head()</code></li>
<li><code>show()</code></li>
<li><code>count()</code></li>
<li><code>columns</code></li>
<li><code>describe()</code></li>
</ul></li>
</ul>
</div></div>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>–ü—Ä–∏–º—ñ—Ç–∫–∞</strong></p>
</div>
<div class="callout-content">
<p><code>printSchema()</code> —î –º–µ—Ç–æ–¥–æ–º –¥–ª—è –±—É–¥—å-—è–∫–æ–≥–æ –Ω–∞–±–æ—Ä—É –¥–∞–Ω–∏—Ö/—Ñ—Ä–µ–π–º—É –¥–∞–Ω–∏—Ö Spark</p>
</div>
</div>
</div>
</section>
<section id="select-—Ç–∞-show" class="slide level2 smaller">
<h2><code>select()</code> —Ç–∞ <code>show()</code></h2>
<ul>
<li><code>select()</code> –≤–∏–±–∏—Ä–∞—î —Å—Ç–æ–≤–ø—Ü—ñ –∑ DataFrame</li>
<li><code>show()</code> –≤–∏–≤–æ–¥–∏—Ç—å –ø–µ—Ä—à—ñ —Ä—è–¥–∫–∏ DataFrame</li>
</ul>
<div id="4fc046be" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyspark.sql <span class="im">import</span> SparkSession</span>
<span id="cb61-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> date <span class="im">as</span> sysdate</span>
<span id="cb61-3"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-4"><a href="" aria-hidden="true" tabindex="-1"></a>spark <span class="op">=</span> SparkSession.builder.appName(<span class="st">"DataFrame"</span>).getOrCreate()</span>
<span id="cb61-5"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-6"><a href="" aria-hidden="true" tabindex="-1"></a>people <span class="op">=</span> spark.read.csv(<span class="st">"data/people.csv"</span>, header<span class="op">=</span><span class="va">True</span>, inferSchema<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb61-7"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-8"><a href="" aria-hidden="true" tabindex="-1"></a>people.select(<span class="st">'name'</span>).show(<span class="dv">5</span>)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>+--------------+
|          name|
+--------------+
|Penelope Lewis|
| David Anthony|
|     Ida Shipp|
|  Joanna Moore|
|Lisandra Ortiz|
+--------------+
only showing top 5 rows
</code></pre>
</div>
</div>
</section>
<section id="filter-2" class="slide level2">
<h2><code>filter()</code></h2>
<ul>
<li><code>filter()</code> –≤–∏–±–∏—Ä–∞—î —Ä—è–¥–∫–∏ –∑ DataFrame, —è–∫—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å —É–º–æ–≤—ñ</li>
</ul>
<div id="450f98bc" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="" aria-hidden="true" tabindex="-1"></a>people.<span class="bu">filter</span>(people.sex <span class="op">==</span> <span class="st">'female'</span>).show(<span class="dv">5</span>)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>+---+---------+-----------------+------+-------------------+
|_c0|person_id|             name|   sex|      date of birth|
+---+---------+-----------------+------+-------------------+
|  0|      100|   Penelope Lewis|female|1990-08-31 00:00:00|
|  2|      102|        Ida Shipp|female|1962-05-24 00:00:00|
|  3|      103|     Joanna Moore|female|2017-03-10 00:00:00|
|  4|      104|   Lisandra Ortiz|female|2020-08-05 00:00:00|
| 11|      111|Annabelle Rosseau|female|1989-07-13 00:00:00|
+---+---------+-----------------+------+-------------------+
only showing top 5 rows
</code></pre>
</div>
</div>
</section>
<section id="groupby-—Ç–∞-count" class="slide level2">
<h2><code>groupby()</code> —Ç–∞ <code>count()</code></h2>
<div id="6acf39c0" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="" aria-hidden="true" tabindex="-1"></a>people.groupby(<span class="st">'sex'</span>).count().show()</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>+------+-----+
|   sex|count|
+------+-----+
|  NULL| 1920|
|female|49014|
|  male|49066|
+------+-----+
</code></pre>
</div>
</div>
</section>
<section id="orderby" class="slide level2">
<h2><code>orderby()</code></h2>
<div id="503ba61a" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="" aria-hidden="true" tabindex="-1"></a>people.orderBy(<span class="st">'date of birth'</span>).show(<span class="dv">5</span>)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>+-----+---------+---------------+------+-------------------+
|  _c0|person_id|           name|   sex|      date of birth|
+-----+---------+---------------+------+-------------------+
|57359|    57459|   Sharon Perez|female|1899-08-28 00:00:00|
|62233|    62333|Martina Morison|female|1901-04-21 00:00:00|
|96318|    96418|   Lisa Garrett|female|1901-05-09 00:00:00|
|39703|    39803|    Naomi Davis|female|1902-04-25 00:00:00|
|64563|    64663|  Brenda French|female|1902-07-27 00:00:00|
+-----+---------+---------------+------+-------------------+
only showing top 5 rows
</code></pre>
</div>
</div>
</section>
<section id="dropduplicates" class="slide level2">
<h2><code>dropDuplicates()</code></h2>
<div id="45a4ff95" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(people.select(<span class="st">'name'</span>).count())</span>
<span id="cb69-2"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-3"><a href="" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(people.select(<span class="st">'name'</span>).dropDuplicates().count())</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>100000
92712</code></pre>
</div>
</div>
</section>
<section id="withcolumnrenamed" class="slide level2">
<h2><code>withColumnRenamed()</code></h2>
<ul>
<li><code>withColumnRenamed()</code> –ø–µ—Ä–µ–π–º–µ–Ω–æ–≤—É—î —Å—Ç–æ–≤–ø–µ—Ü—å —É DataFrame</li>
</ul>
<div id="abab145f" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="" aria-hidden="true" tabindex="-1"></a>people <span class="op">=</span> people.withColumnRenamed(<span class="st">"date of birth"</span>, <span class="st">"dob"</span>)</span>
<span id="cb71-2"><a href="" aria-hidden="true" tabindex="-1"></a>people.show(<span class="dv">5</span>)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>+---+---------+--------------+------+-------------------+
|_c0|person_id|          name|   sex|                dob|
+---+---------+--------------+------+-------------------+
|  0|      100|Penelope Lewis|female|1990-08-31 00:00:00|
|  1|      101| David Anthony|  male|1971-10-14 00:00:00|
|  2|      102|     Ida Shipp|female|1962-05-24 00:00:00|
|  3|      103|  Joanna Moore|female|2017-03-10 00:00:00|
|  4|      104|Lisandra Ortiz|female|2020-08-05 00:00:00|
+---+---------+--------------+------+-------------------+
only showing top 5 rows
</code></pre>
</div>
</div>
</section>
<section id="printschema" class="slide level2">
<h2><code>printSchema()</code></h2>
<div id="16ae2092" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="" aria-hidden="true" tabindex="-1"></a>people.printSchema()</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>root
 |-- _c0: integer (nullable = true)
 |-- person_id: integer (nullable = true)
 |-- name: string (nullable = true)
 |-- sex: string (nullable = true)
 |-- dob: timestamp (nullable = true)
</code></pre>
</div>
</div>
</section>
<section id="columns" class="slide level2">
<h2><code>columns</code></h2>
<ul>
<li><code>columns</code> –ø–æ–≤–µ—Ä—Ç–∞—î —Å–ø–∏—Å–æ–∫ —Å—Ç–æ–≤–ø—Ü—ñ–≤ —É DataFrame</li>
</ul>
<div id="988af47b" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="" aria-hidden="true" tabindex="-1"></a>people.columns</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>['_c0', 'person_id', 'name', 'sex', 'dob']</code></pre>
</div>
</div>
</section>
<section id="describe" class="slide level2">
<h2><code>describe()</code></h2>
<ul>
<li><code>describe()</code> –ø–æ–≤–µ—Ä—Ç–∞—î —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –¥–ª—è —á–∏—Å–ª–æ–≤–∏—Ö —Å—Ç–æ–≤–ø—Ü—ñ–≤ —É DataFrame</li>
</ul>
<div id="eaa8ae70" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="" aria-hidden="true" tabindex="-1"></a>people.describe().show()</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>+-------+-----------------+-----------------+-------------+------+
|summary|              _c0|        person_id|         name|   sex|
+-------+-----------------+-----------------+-------------+------+
|  count|           100000|           100000|       100000| 98080|
|   mean|          49999.5|          50099.5|         NULL|  NULL|
| stddev|28867.65779668774|28867.65779668774|         NULL|  NULL|
|    min|                0|              100|Aaron Addesso|female|
|    max|            99999|           100099|  Zulma Biggs|  male|
+-------+-----------------+-----------------+-------------+------+
</code></pre>
</div>
</div>
</section></section>
<section>
<section id="pyspark-sql" class="title-slide slide level1 center">
<h1>PySpark SQL</h1>

</section>
<section id="dataframe-api-vs-sql-–∑–∞–ø–∏—Ç–∏" class="slide level2">
<h2>DataFrame API vs SQL –∑–∞–ø–∏—Ç–∏</h2>
<ul>
<li>–£ PySpark –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∑–∞—î–º–æ–¥—ñ—è—Ç–∏ –∑ SparkSQL —á–µ—Ä–µ–∑ DataFrame API —Ç–∞ SQL –∑–∞–ø–∏—Ç–∏</li>
<li>DataFrame API –Ω–∞–¥–∞—î –ø—Ä–æ–≥—Ä–∞–º–Ω—É –º–æ–≤—É, —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω—É –¥–ª—è –¥–æ–º–µ–Ω—É (DSL) –¥–ª—è –¥–∞–Ω–∏—Ö</li>
<li>–ü–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞ –¥—ñ—ó DataFrame –ª–µ–≥—à–µ –∫–æ–Ω—Å—Ç—Ä—É—é–≤–∞—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º–Ω–æ</li>
<li>SQL-–∑–∞–ø–∏—Ç–∏ –º–æ–∂—É—Ç—å –±—É—Ç–∏ —Å—Ç–∏—Å–ª–∏–º–∏, –ø—Ä–æ—Å—Ç—ñ—à–∏–º–∏ –¥–ª—è —Ä–æ–∑—É–º—ñ–Ω–Ω—è —Ç–∞ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–Ω—è</li>
<li>–û–ø–µ—Ä–∞—Ü—ñ—ó –Ω–∞–¥ DataFrame —Ç–∞–∫–æ–∂ –º–æ–∂–Ω–∞ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é SQL –∑–∞–ø–∏—Ç—ñ–≤</li>
</ul>
</section>
<section id="sql-–∑–∞–ø–∏—Ç–∏" class="slide level2">
<h2>SQL –∑–∞–ø–∏—Ç–∏</h2>
<ul>
<li>–ú–µ—Ç–æ–¥ SparkSession <code>sql()</code> –≤–∏–∫–æ–Ω—É—î SQL-–∑–∞–ø–∏—Ç</li>
<li>–ú–µ—Ç–æ–¥ <code>sql()</code> –æ—Ç—Ä–∏–º—É—î SQL-–∑–∞–ø–∏—Ç —è–∫ –∞—Ä–≥—É–º–µ–Ω—Ç —ñ –ø–æ–≤–µ—Ä—Ç–∞—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç —É –≤–∏–≥–ª—è–¥—ñ DataFrame</li>
</ul>
<div id="a1d55819" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="" aria-hidden="true" tabindex="-1"></a>people.createOrReplaceTempView(<span class="st">"people"</span>)</span>
<span id="cb79-2"><a href="" aria-hidden="true" tabindex="-1"></a>df_sql <span class="op">=</span> spark.sql(<span class="st">"SELECT * FROM people LIMIT 5"</span>)</span>
<span id="cb79-3"><a href="" aria-hidden="true" tabindex="-1"></a>df_sql.show()</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>+---+---------+--------------+------+-------------------+
|_c0|person_id|          name|   sex|                dob|
+---+---------+--------------+------+-------------------+
|  0|      100|Penelope Lewis|female|1990-08-31 00:00:00|
|  1|      101| David Anthony|  male|1971-10-14 00:00:00|
|  2|      102|     Ida Shipp|female|1962-05-24 00:00:00|
|  3|      103|  Joanna Moore|female|2017-03-10 00:00:00|
|  4|      104|Lisandra Ortiz|female|2020-08-05 00:00:00|
+---+---------+--------------+------+-------------------+
</code></pre>
</div>
</div>
</section>
<section id="sql-–∑–∞–ø–∏—Ç" class="slide level2">
<h2>SQL-–∑–∞–ø–∏—Ç</h2>
<div id="f42f9510" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="" aria-hidden="true" tabindex="-1"></a>query <span class="op">=</span> <span class="st">'''SELECT name FROM people LIMIT 5'''</span></span>
<span id="cb81-2"><a href="" aria-hidden="true" tabindex="-1"></a>df_sql <span class="op">=</span> spark.sql(query)</span>
<span id="cb81-3"><a href="" aria-hidden="true" tabindex="-1"></a>df_sql.show()</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>+--------------+
|          name|
+--------------+
|Penelope Lewis|
| David Anthony|
|     Ida Shipp|
|  Joanna Moore|
|Lisandra Ortiz|
+--------------+
</code></pre>
</div>
</div>
</section>
<section id="–≥—Ä—É–ø—É–≤–∞–Ω–Ω—è-—Ç–∞-–∞–≥—Ä–µ–≥–∞—Ü—ñ—è" class="slide level2">
<h2>–ì—Ä—É–ø—É–≤–∞–Ω–Ω—è —Ç–∞ –∞–≥—Ä–µ–≥–∞—Ü—ñ—è</h2>
<div id="c42deeeb" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="" aria-hidden="true" tabindex="-1"></a>query <span class="op">=</span> <span class="st">'''SELECT sex, COUNT(*) as count FROM people GROUP BY sex'''</span></span>
<span id="cb83-2"><a href="" aria-hidden="true" tabindex="-1"></a>df_sql <span class="op">=</span> spark.sql(query)</span>
<span id="cb83-3"><a href="" aria-hidden="true" tabindex="-1"></a>df_sql.show()</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>+------+-----+
|   sex|count|
+------+-----+
|  NULL| 1920|
|female|49014|
|  male|49066|
+------+-----+
</code></pre>
</div>
</div>
</section>
<section id="—Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è" class="slide level2">
<h2>–§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è</h2>
<div id="3ea4329c" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="" aria-hidden="true" tabindex="-1"></a>query <span class="op">=</span> <span class="st">'''SELECT * FROM people WHERE dob &gt; '2000-01-01' '''</span></span>
<span id="cb85-2"><a href="" aria-hidden="true" tabindex="-1"></a>df_sql <span class="op">=</span> spark.sql(query)</span>
<span id="cb85-3"><a href="" aria-hidden="true" tabindex="-1"></a>df_sql.show(<span class="dv">5</span>)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>+---+---------+-----------------+------+-------------------+
|_c0|person_id|             name|   sex|                dob|
+---+---------+-----------------+------+-------------------+
|  3|      103|     Joanna Moore|female|2017-03-10 00:00:00|
|  4|      104|   Lisandra Ortiz|female|2020-08-05 00:00:00|
|  9|      109|   Everett Vadala|  male|2005-05-24 00:00:00|
| 10|      110| Freddie Claridge|  male|2002-05-07 00:00:00|
| 17|      117|Florence Eberhart|female|2024-06-01 00:00:00|
+---+---------+-----------------+------+-------------------+
only showing top 5 rows
</code></pre>
</div>
</div>
</section></section>
<section>
<section id="–≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è-–¥–∞–Ω–∏—Ö-—É-pyspark" class="title-slide slide level1 unnumbered unlisted center">
<h1>–í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è –¥–∞–Ω–∏—Ö —É PySpark</h1>

</section>
<section id="–≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è-–¥–∞–Ω–∏—Ö-—É-pyspark-1" class="slide level2">
<h2>–í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è –¥–∞–Ω–∏—Ö —É PySpark</h2>
<p>–ü–æ–±—É–¥–æ–≤–∞ –≥—Ä–∞—Ñ—ñ–∫—ñ–≤ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ñ—Ä–µ–π–º—ñ–≤ –¥–∞–Ω–∏—Ö PySpark –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è —Ç—Ä—å–æ–º–∞ –º–µ—Ç–æ–¥–∞–º–∏</p>
<ul>
<li>–±—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ <code>pyspark_dist_explore</code></li>
<li><code>toPandas()</code></li>
<li>–±—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ <code>HandySpark</code></li>
</ul>
</section>
<section id="pyspark_dist_explore" class="slide level2">
<h2><code>pyspark_dist_explore</code></h2>
<ul>
<li><code>pyspark_dist_explore</code> ‚Äî —Ü–µ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ –¥–ª—è –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—ó –¥–∞–Ω–∏—Ö —É PySpark</li>
<li>–ù–∞—Ä–∞–∑—ñ –¥–æ—Å—Ç—É–ø–Ω—ñ —Ç—Ä–∏ —Ñ—É–Ω–∫—Ü—ñ—ó: <code>hist()</code> , <code>distplot()</code> —Ç–∞ <code>pandas_histogram()</code></li>
</ul>
<div id="cd2b5810" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyspark_dist_explore <span class="im">import</span> hist</span>
<span id="cb87-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb87-3"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-4"><a href="" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> spark.read.csv(<span class="st">"data/salaries.csv"</span>, header<span class="op">=</span><span class="va">True</span>, inferSchema<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb87-5"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-6"><a href="" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb87-7"><a href="" aria-hidden="true" tabindex="-1"></a>hist(ax, df.select(<span class="st">'salary_in_usd'</span>), bins <span class="op">=</span> <span class="dv">20</span>)<span class="op">;</span></span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</section>
<section id="pyspark_dist_explore-output" class="slide level2 output-location-slide"><h2><code>pyspark_dist_explore</code></h2><div class="cell output-location-slide" data-execution_count="52">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src=".02_files/figure-revealjs/cell-53-output-1.svg"></p>
</figure>
</div>
</div>
</div></section><section id="topandas" class="slide level2">
<h2><code>toPandas()</code></h2>
<div id="0f8f1aba" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="" aria-hidden="true" tabindex="-1"></a>df_pandas <span class="op">=</span> df.toPandas()</span>
<span id="cb88-2"><a href="" aria-hidden="true" tabindex="-1"></a>df_pandas.hist(column<span class="op">=</span><span class="st">'salary_in_usd'</span>, bins<span class="op">=</span><span class="dv">20</span>)<span class="op">;</span></span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src=".02_files/figure-revealjs/cell-54-output-1.svg" class="r-stretch"><div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>–ü—Ä–∏–º—ñ—Ç–∫–∞</strong></p>
</div>
<div class="callout-content">
<p>–Ø–∫—â–æ –≤–∏ –º–∞—î—Ç–µ –≤–µ–ª–∏–∫—ñ –æ–±—Å—è–≥–∏ –¥–∞–Ω–∏—Ö, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ <code>toPandas()</code> –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è</p>
</div>
</div>
</div>
</section>
<section id="pandas-vs-pyspark" class="slide level2">
<h2>Pandas vs PySpark</h2>
<ul>
<li>Pandas DataFrames ‚Äî —Ü–µ –æ–¥–Ω–æ—Å–µ—Ä–≤–µ—Ä–Ω—ñ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –≤ –ø–∞–º‚Äô—è—Ç—ñ, —â–æ –±–∞–∑—É—é—Ç—å—Å—è –Ω–∞ –æ–¥–Ω–æ–º—É —Å–µ—Ä–≤–µ—Ä—ñ, –∞ –æ–ø–µ—Ä–∞—Ü—ñ—ó –Ω–∞–¥ PySpark –≤–∏–∫–æ–Ω—É—é—Ç—å—Å—è –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ</li>
<li>–†–µ–∑—É–ª—å—Ç–∞—Ç –≥–µ–Ω–µ—Ä—É—î—Ç—å—Å—è, –∫–æ–ª–∏ –º–∏ –∑–∞—Å—Ç–æ—Å–æ–≤—É—î–º–æ –±—É–¥—å-—è–∫—É –æ–ø–µ—Ä–∞—Ü—ñ—é –≤ Pandas, –≤ —Ç–æ–π —á–∞—Å —è–∫ –æ–ø–µ—Ä–∞—Ü—ñ—ó –≤ PySpark DataFrame —î –ª—ñ–Ω–∏–≤–∏–º–∏</li>
<li>Pandas DataFrame —î –∑–º—ñ–Ω—é–≤–∞–Ω–∏–º, –∞ PySpark DataFrame —î –Ω–µ–∑–º—ñ–Ω–Ω–∏–º</li>
<li>Pandas API –ø—ñ–¥—Ç—Ä–∏–º—É—î –±—ñ–ª—å—à–µ –æ–ø–µ—Ä–∞—Ü—ñ–π, –Ω—ñ–∂ PySpark Dataframe API</li>
</ul>
</section></section>
<section>
<section id="pyspark-mllib" class="title-slide slide level1 center">
<h1>PySpark MLlib</h1>

</section>
<section id="–æ–≥–ª—è–¥-pyspark-mllib" class="slide level2">
<h2>–û–≥–ª—è–¥ PySpark MLlib</h2>
<ul>
<li>MLlib - —Ü–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç Apache Spark –¥–ª—è –º–∞—à–∏–Ω–Ω–æ–≥–æ –Ω–∞–≤—á–∞–Ω–Ω—è</li>
<li>–î–æ —Å–∫–ª–∞–¥—É MLlib –≤—Ö–æ–¥—è—Ç—å —Ä—ñ–∑–Ω–æ–º–∞–Ω—ñ—Ç–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏:
<ul>
<li>–ê–ª–≥–æ—Ä–∏—Ç–º–∏ ML: —Å–ø—ñ–ª—å–Ω–∞ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è, –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—è —Ç–∞ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü—ñ—è</li>
<li>–§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—ñ–∑–∞—Ü—ñ—è: –≤–∏–ª—É—á–µ–Ω–Ω—è –æ–∑–Ω–∞–∫, –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è, –∑–º–µ–Ω—à–µ–Ω–Ω—è —Ä–æ–∑–º—ñ—Ä–Ω–æ—Å—Ç—ñ —Ç–∞ –≤–∏–±—ñ—Ä–∫–∞</li>
<li>–ö–æ–Ω–≤–µ—î—Ä–∏: —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –¥–ª—è –ø–æ–±—É–¥–æ–≤–∏, –æ—Ü—ñ–Ω–∫–∏ —Ç–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∫–æ–Ω–≤–µ—î—Ä—ñ–≤ ML</li>
</ul></li>
</ul>
</section>
<section id="—á–æ–º—É-pyspark-mllib" class="slide level2">
<h2>–ß–æ–º—É PySpark MLlib?</h2>
<ul>
<li>Scikit-learn - –ø–æ–ø—É–ª—è—Ä–Ω–∞ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ Python –¥–ª—è —ñ–Ω—Ç–µ–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É –¥–∞–Ω–∏—Ö —Ç–∞ –º–∞—à–∏–Ω–Ω–æ–≥–æ –Ω–∞–≤—á–∞–Ω–Ω—è</li>
<li>–ê–ª–≥–æ—Ä–∏—Ç–º–∏ Scikit-learn –ø—Ä–∞—Ü—é—é—Ç—å —Ç—ñ–ª—å–∫–∏ –¥–ª—è –Ω–µ–≤–µ–ª–∏–∫–∏—Ö –Ω–∞–±–æ—Ä—ñ–≤ –¥–∞–Ω–∏—Ö –Ω–∞ –æ–¥–Ω—ñ–π –º–∞—à–∏–Ω—ñ</li>
<li>–ê–ª–≥–æ—Ä–∏—Ç–º–∏ MLlib Spark –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—ñ –¥–ª—è –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ—ó –æ–±—Ä–æ–±–∫–∏ –Ω–∞ –∫–ª–∞—Å—Ç–µ—Ä—ñ</li>
<li>–ü—ñ–¥—Ç—Ä–∏–º—É—î —Ç–∞–∫—ñ –º–æ–≤–∏, —è–∫ Scala, Java —Ç–∞ R</li>
<li>–ù–∞–¥–∞—î –≤–∏—Å–æ–∫–æ—Ä—ñ–≤–Ω–µ–≤–∏–π API –¥–ª—è –ø–æ–±—É–¥–æ–≤–∏ –∫–æ–Ω–≤–µ—î—Ä—ñ–≤ –º–∞—à–∏–Ω–Ω–æ–≥–æ –Ω–∞–≤—á–∞–Ω–Ω—è</li>
</ul>
</section>
<section id="–∞–ª–≥–æ—Ä–∏—Ç–º–∏-pyspark-mllib" class="slide level2">
<h2>–ê–ª–≥–æ—Ä–∏—Ç–º–∏ PySpark MLlib</h2>
<ul>
<li>–ö–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—è (–±—ñ–Ω–∞—Ä–Ω–∞ —Ç–∞ –±–∞–≥–∞—Ç–æ–∫–ª–∞—Å–æ–≤–∞) —Ç–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è: –õLinear SVMs, logistic regression, decision trees, random forests, gradient-boosted trees, naive Bayes, linear least squares, Lasso, ridge regression, isotonic regression</li>
<li>–ö–æ–ª–∞–±–æ—Ä–∞—Ç–∏–≤–Ω–∞ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è: –ê–ª–≥–æ—Ä–∏—Ç–º –∑–º—ñ–Ω–Ω–∏—Ö –Ω–∞–π–º–µ–Ω—à–∏—Ö –∫–≤–∞–¥—Ä–∞—Ç—ñ–≤ (Alternating least squares, ALS)</li>
<li>–ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü—ñ—è: K-means, Gaussian mixture, Bisecting K-means and Streaming K-Means</li>
</ul>
</section>
<section id="—Ç—Ä–∏-—Å-–º–∞—à–∏–Ω–Ω–æ–≥–æ-–Ω–∞–≤—á–∞–Ω–Ω—è-–≤-pyspark-mllib" class="slide level2">
<h2>–¢—Ä–∏ ¬´–°¬ª –º–∞—à–∏–Ω–Ω–æ–≥–æ –Ω–∞–≤—á–∞–Ω–Ω—è –≤ PySpark MLlib</h2>
<ul>
<li>Collaborative filtering (—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ–π–Ω—ñ —Å–∏—Å—Ç–µ–º–∏): –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ–π</li>
<li>Classification: –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è, –¥–æ —è–∫–æ—ó –∑ –∫–∞—Ç–µ–≥–æ—Ä—ñ–π –Ω–∞–ª–µ–∂–∏—Ç—å –Ω–æ–≤–µ —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è</li>
<li>Clustering: –ì—Ä—É–ø—É–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Å—Ö–æ–∂–∏—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫</li>
</ul>
</section>
<section id="pyspark-mllib-imports" class="slide level2">
<h2>PySpark MLlib imports</h2>
<ul>
<li>Collaborative filtering</li>
</ul>
<div id="16ffe826" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyspark.mllib.recommendation <span class="im">import</span> ALS</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Classification</li>
</ul>
<div id="e38b280d" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyspark.mllib.classification <span class="im">import</span> LogisticRegressionWithLBFGS</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Clustering</li>
</ul>
<div id="d5e5586f" class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyspark.mllib.clustering <span class="im">import</span> KMeans</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section>
<section>
<section id="–≤—Å—Ç—É–ø-–¥–æ-collaborative-filtering" class="title-slide slide level1 unnumbered unlisted center">
<h1>–í—Å—Ç—É–ø –¥–æ Collaborative filtering</h1>

</section>
<section id="collaborative-filtering" class="slide level2">
<h2>Collaborative filtering</h2>
<ul>
<li>–ö–æ–ª–∞–±–æ—Ä–∞—Ç–∏–≤–Ω–∞ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è ‚Äî —Ü–µ –ø–æ—à—É–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, —è–∫—ñ –º–∞—é—Ç—å —Å–ø—ñ–ª—å–Ω—ñ —ñ–Ω—Ç–µ—Ä–µ—Å–∏</li>
<li>–ö–æ–ª–∞–±–æ—Ä–∞—Ç–∏–≤–Ω–∞ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –∑–∞–∑–≤–∏—á–∞–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ–π–Ω–∏—Ö —Å–∏—Å—Ç–µ–º</li>
<li>–ü—ñ–¥—Ö–æ–¥–∏ –¥–æ —Å–ø—ñ–ª—å–Ω–æ—ó —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó:
<ul>
<li>User-User: –ó–Ω–∞—Ö–æ–¥–∏—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, —Å—Ö–æ–∂–∏—Ö –Ω–∞ —Ü—ñ–ª—å–æ–≤–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞</li>
<li>Item-Item: –ó–Ω–∞—Ö–æ–¥–∏—Ç—å —ñ —Ä–µ–∫–æ–º–µ–Ω–¥—É—î –µ–ª–µ–º–µ–Ω—Ç–∏, —Å—Ö–æ–∂—ñ –Ω–∞ –µ–ª–µ–º–µ–Ω—Ç–∏ –∑ —Ü—ñ–ª—å–æ–≤–∏–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º</li>
</ul></li>
</ul>
</section>
<section id="–∫–ª–∞—Å-rating-—É-pyspark.mllib.recommendations" class="slide level2">
<h2>–ö–ª–∞—Å <code>Rating</code> —É <code>pyspark.mllib.recommendations</code></h2>
<ul>
<li>–ö–ª–∞—Å <code>Rating</code> ‚Äî —Ü–µ –æ–±–≥–æ—Ä—Ç–∫–∞ –Ω–∞–≤–∫–æ–ª–æ –∫–æ—Ä—Ç–µ–∂—É (–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á, —Ç–æ–≤–∞—Ä —ñ —Ä–µ–π—Ç–∏–Ω–≥)</li>
<li>–ö–æ—Ä–∏—Å–Ω–∏–π –¥–ª—è —Ä–æ–∑–±–æ—Ä—É RDD —Ç–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–æ—Ä—Ç–µ–∂—É –∑ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —Ç–æ–≤–∞—Ä—É —Ç–∞ —Ä–µ–π—Ç–∏–Ω–≥—É</li>
</ul>
<div id="126b37bd" class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyspark.mllib.recommendation <span class="im">import</span> Rating</span>
<span id="cb92-2"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-3"><a href="" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> Rating(user <span class="op">=</span> <span class="dv">1</span>, product <span class="op">=</span> <span class="dv">2</span>, rating <span class="op">=</span> <span class="fl">5.0</span>)</span>
<span id="cb92-4"><a href="" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(r)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rating(user=1, product=2, rating=5.0)</code></pre>
</div>
</div>
</section>
<section id="randomsplit" class="slide level2">
<h2><code>randomSplit()</code></h2>
<ul>
<li>–ú–µ—Ç–æ–¥ <code>randomSplit()</code> PySpark –≤–∏–ø–∞–¥–∫–æ–≤–∏–º —á–∏–Ω–æ–º —Ä–æ–∑–±–∏–≤–∞—î –¥–∞–Ω—ñ —ñ–∑ –∑–∞–¥–∞–Ω–∏–º–∏ –≤–∞–≥–∞–º–∏ —ñ –ø–æ–≤–µ—Ä—Ç–∞—î –¥–µ–∫—ñ–ª—å–∫–∞ RDD</li>
</ul>
<div id="0bfda9e9" class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> sc.parallelize([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>])</span>
<span id="cb94-2"><a href="" aria-hidden="true" tabindex="-1"></a>training, test<span class="op">=</span>data.randomSplit([<span class="fl">0.6</span>, <span class="fl">0.4</span>])</span>
<span id="cb94-3"><a href="" aria-hidden="true" tabindex="-1"></a>training.collect()</span>
<span id="cb94-4"><a href="" aria-hidden="true" tabindex="-1"></a>test.collect()</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<pre><code>[1, 3, 5, 7]</code></pre>
</div>
</div>
</section>
<section id="alternating-least-squares-als" class="slide level2">
<h2>Alternating Least Squares (ALS)</h2>
<ul>
<li>ALS —É <code>spark.mllib</code> –∑–∞–±–µ–∑–ø–µ—á—É—î –∫–æ–ª–∞–±–æ—Ä–∞—Ç–∏–≤–Ω—É —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—é</li>
<li><code>ALS.train(ratings, rank, iterations)</code></li>
</ul>
<div id="2d286511" class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="" aria-hidden="true" tabindex="-1"></a>r1 <span class="op">=</span> Rating(<span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">1.0</span>)</span>
<span id="cb96-2"><a href="" aria-hidden="true" tabindex="-1"></a>r2 <span class="op">=</span> Rating(<span class="dv">1</span>, <span class="dv">2</span>, <span class="fl">2.0</span>)</span>
<span id="cb96-3"><a href="" aria-hidden="true" tabindex="-1"></a>r3 <span class="op">=</span> Rating(<span class="dv">2</span>, <span class="dv">1</span>, <span class="fl">2.0</span>)</span>
<span id="cb96-4"><a href="" aria-hidden="true" tabindex="-1"></a>ratings <span class="op">=</span> sc.parallelize([r1, r2, r3])</span>
<span id="cb96-5"><a href="" aria-hidden="true" tabindex="-1"></a>ratings.collect()</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="51">
<pre><code>[Rating(user=1, product=1, rating=1.0),
 Rating(user=1, product=2, rating=2.0),
 Rating(user=2, product=1, rating=2.0)]</code></pre>
</div>
</div>
<div id="8db1801f" class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ALS.train(ratings, rank<span class="op">=</span><span class="dv">10</span>, iterations<span class="op">=</span><span class="dv">10</span>)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="predictall" class="slide level2">
<h2><code>predictAll()</code></h2>
<ul>
<li>–ú–µ—Ç–æ–¥ <code>predictAll()</code> –ø–æ–≤–µ—Ä—Ç–∞—î —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–≥–Ω–æ–∑–æ–≤–∞–Ω–∏—Ö –æ—Ü—ñ–Ω–æ–∫ –¥–ª—è –≤—Ö—ñ–¥–Ω–æ—ó –ø–∞—Ä–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á —ñ —Ç–æ–≤–∞—Ä</li>
<li>–ú–µ—Ç–æ–¥ –æ—Ç—Ä–∏–º—É—î RDD –±–µ–∑ –æ—Ü—ñ–Ω–æ–∫, —â–æ–± –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ —Ä–µ–π—Ç–∏–Ω–≥–∏</li>
</ul>
<div id="371adf99" class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="" aria-hidden="true" tabindex="-1"></a>unrated_RDD <span class="op">=</span> sc.parallelize([(<span class="dv">1</span>, <span class="dv">2</span>), (<span class="dv">1</span>, <span class="dv">1</span>)])</span>
<span id="cb99-2"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-3"><a href="" aria-hidden="true" tabindex="-1"></a>predictions <span class="op">=</span> model.predictAll(unrated_RDD)</span>
<span id="cb99-4"><a href="" aria-hidden="true" tabindex="-1"></a>predictions.collect()</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">
<pre><code>[Rating(user=1, product=1, rating=1.0000327845217156),
 Rating(user=1, product=2, rating=1.9890339755906339)]</code></pre>
</div>
</div>
</section>
<section id="–æ—Ü—ñ–Ω–∫–∞-–º–æ–¥–µ–ª—ñ" class="slide level2 smaller">
<h2>–û—Ü—ñ–Ω–∫–∞ –º–æ–¥–µ–ª—ñ</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div id="dcde5dce" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="" aria-hidden="true" tabindex="-1"></a>rates <span class="op">=</span> ratings.<span class="bu">map</span>(<span class="kw">lambda</span> x: ((x[<span class="dv">0</span>], x[<span class="dv">1</span>]), x[<span class="dv">2</span>]))</span>
<span id="cb101-2"><a href="" aria-hidden="true" tabindex="-1"></a>rates.collect()</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="54">
<pre><code>[((1, 1), 1.0), ((1, 2), 2.0), ((2, 1), 2.0)]</code></pre>
</div>
</div>
<p><br>
</p>
<div id="59b8a18d" class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="" aria-hidden="true" tabindex="-1"></a>preds <span class="op">=</span> predictions.<span class="bu">map</span>(<span class="kw">lambda</span> x: ((x[<span class="dv">0</span>], x[<span class="dv">1</span>]), x[<span class="dv">2</span>]))</span>
<span id="cb103-2"><a href="" aria-hidden="true" tabindex="-1"></a>preds.collect()</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">
<pre><code>[((1, 1), 1.0000327845217156), ((1, 2), 1.9890339755906339)]</code></pre>
</div>
</div>
<p><br>
</p>
<div id="dbd30272" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="" aria-hidden="true" tabindex="-1"></a>rates_preds <span class="op">=</span> rates.join(preds)</span>
<span id="cb105-2"><a href="" aria-hidden="true" tabindex="-1"></a>rates_preds.collect()</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="56">
<pre><code>[((1, 2), (2.0, 1.9890339755906339)), ((1, 1), (1.0, 1.0000327845217156))]</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div id="64b57ed6" class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="" aria-hidden="true" tabindex="-1"></a>MSE <span class="op">=</span> rates_preds.<span class="bu">map</span>(<span class="kw">lambda</span> r: (r[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">-</span> r[<span class="dv">1</span>][<span class="dv">1</span>])<span class="op">**</span><span class="dv">2</span>).mean()</span>
<span id="cb107-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Mean Squared Error = "</span> <span class="op">+</span> <span class="bu">str</span>(MSE))</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean Squared Error = 6.012738308583879e-05</code></pre>
</div>
</div>
</div></div>
</section></section>
<section>
<section id="–∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—è" class="title-slide slide level1 unnumbered unlisted center">
<h1>–ö–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—è</h1>

</section>
<section id="—Ä–æ–±–æ—Ç–∞-–∑-–≤–µ–∫—Ç–æ—Ä–∞–º–∏" class="slide level2 smaller">
<h2>–†–æ–±–æ—Ç–∞ –∑ –≤–µ–∫—Ç–æ—Ä–∞–º–∏</h2>
<ul>
<li>PySpark MLlib –º—ñ—Å—Ç–∏—Ç—å —Å–ø–µ—Ü—ñ–∞–ª—å–Ω—ñ —Ç–∏–ø–∏ –¥–∞–Ω–∏—Ö <code>Vectors</code> —Ç–∞ <code>LabelledPoint</code></li>
<li>–î–≤–∞ —Ç–∏–ø–∏ –≤–µ–∫—Ç–æ—Ä—ñ–≤
<ul>
<li>Dense Vector: –∑–±–µ—Ä—ñ–≥–∞—î –≤—Å—ñ —Å–≤–æ—ó –∑–∞–ø–∏—Å–∏ –≤ –º–∞—Å–∏–≤—ñ —á–∏—Å–µ–ª –∑ –ø–ª–∞–≤–∞—é—á–æ—é –∫–æ–º–æ—é</li>
<li>Sparse Vector: –∑–±–µ—Ä—ñ–≥–∞—î –ª–∏—à–µ –Ω–µ–Ω—É–ª—å–æ–≤—ñ –∑–Ω–∞—á–µ–Ω–Ω—è —Ç–∞ —ó—Ö–Ω—ñ —ñ–Ω–¥–µ–∫—Å–∏</li>
</ul></li>
</ul>
<div id="343938d1" class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyspark.mllib.linalg <span class="im">import</span> Vectors, SparseVector, DenseVector</span>
<span id="cb109-2"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-3"><a href="" aria-hidden="true" tabindex="-1"></a>denseVec <span class="op">=</span> Vectors.dense([<span class="fl">1.0</span>, <span class="fl">2.0</span>, <span class="fl">3.0</span>])</span>
<span id="cb109-4"><a href="" aria-hidden="true" tabindex="-1"></a>sparseVec <span class="op">=</span> Vectors.sparse(<span class="dv">3</span>, {<span class="dv">0</span>: <span class="fl">1.0</span>, <span class="dv">2</span>: <span class="fl">3.0</span>})</span>
<span id="cb109-5"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-6"><a href="" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(denseVec)</span>
<span id="cb109-7"><a href="" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sparseVec)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1.0,2.0,3.0]
(3,[0,2],[1.0,3.0])</code></pre>
</div>
</div>
</section>
<section id="labeledpoint" class="slide level2">
<h2><code>LabeledPoint</code></h2>
<ul>
<li><code>LabeledPoint</code> ‚Äî —Ü–µ –æ–±–≥–æ—Ä—Ç–∫–∞ –¥–ª—è –≤—Ö—ñ–¥–Ω–∏—Ö –æ–∑–Ω–∞–∫ —ñ –ø—Ä–æ–≥–Ω–æ–∑–æ–≤–∞–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–Ω—è</li>
<li>–î–ª—è –±—ñ–Ω–∞—Ä–Ω–æ—ó –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –ª–æ–≥—ñ—Å—Ç–∏—á–Ω–æ—ó —Ä–µ–≥—Ä–µ—Å—ñ—ó –º—ñ—Ç–∫–æ—é —î –∞–±–æ 0 (–≤—ñ–¥‚Äô—î–º–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è), –∞–±–æ 1 (–¥–æ–¥–∞—Ç–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è)</li>
</ul>
<div id="fa255f8b" class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyspark.mllib.regression <span class="im">import</span> LabeledPoint</span>
<span id="cb111-2"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-3"><a href="" aria-hidden="true" tabindex="-1"></a>positive <span class="op">=</span> LabeledPoint(<span class="fl">1.0</span>, [<span class="fl">1.0</span>, <span class="fl">0.0</span>, <span class="fl">3.0</span>])</span>
<span id="cb111-4"><a href="" aria-hidden="true" tabindex="-1"></a>negative <span class="op">=</span> LabeledPoint(<span class="fl">0.0</span>, [<span class="fl">2.0</span>, <span class="fl">1.0</span>, <span class="fl">1.0</span>])</span>
<span id="cb111-5"><a href="" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(positive)</span>
<span id="cb111-6"><a href="" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(negative)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(1.0,[1.0,0.0,3.0])
(0.0,[2.0,1.0,1.0])</code></pre>
</div>
</div>
</section>
<section id="hashingtf" class="slide level2">
<h2><code>HashingTF</code></h2>
<ul>
<li>–ê–ª–≥–æ—Ä–∏—Ç–º <code>HashingTF()</code> –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –∑—ñ—Å—Ç–∞–≤–ª–µ–Ω–Ω—è –∑–Ω–∞—á–µ–Ω–Ω—è –æ–∑–Ω–∞–∫–∏ –∑ —ñ–Ω–¥–µ–∫—Å–∞–º–∏ —É –≤–µ–∫—Ç–æ—Ä—ñ –æ–∑–Ω–∞–∫</li>
</ul>
<div id="bf1a556b" class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyspark.mllib.feature <span class="im">import</span> HashingTF</span>
<span id="cb113-2"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-3"><a href="" aria-hidden="true" tabindex="-1"></a>sentence <span class="op">=</span> <span class="st">"hello hello world"</span></span>
<span id="cb113-4"><a href="" aria-hidden="true" tabindex="-1"></a>words <span class="op">=</span> sentence.split()</span>
<span id="cb113-5"><a href="" aria-hidden="true" tabindex="-1"></a>tf <span class="op">=</span> HashingTF(<span class="dv">10000</span>)</span>
<span id="cb113-6"><a href="" aria-hidden="true" tabindex="-1"></a>tf.transform(words)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="60">
<pre><code>SparseVector(10000, {1593: 2.0, 5690: 1.0})</code></pre>
</div>
</div>
</section>
<section id="–ª–æ–≥—ñ—Å—Ç–∏—á–Ω–∞-—Ä–µ–≥—Ä–µ—Å—ñ—è-–∑-–≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º-logisticregressionwithlbfgs" class="slide level2">
<h2>–õ–æ–≥—ñ—Å—Ç–∏—á–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º <code>LogisticRegressionWithLBFGS</code></h2>
<div id="766c31bf" class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [</span>
<span id="cb115-2"><a href="" aria-hidden="true" tabindex="-1"></a>  LabeledPoint(<span class="fl">0.0</span>, [<span class="fl">0.0</span>, <span class="fl">1.0</span>]),</span>
<span id="cb115-3"><a href="" aria-hidden="true" tabindex="-1"></a>  LabeledPoint(<span class="fl">1.0</span>, [<span class="fl">1.0</span>, <span class="fl">0.0</span>]),</span>
<span id="cb115-4"><a href="" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb115-5"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-6"><a href="" aria-hidden="true" tabindex="-1"></a>RDD <span class="op">=</span> sc.parallelize(data)</span>
<span id="cb115-7"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-8"><a href="" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> LogisticRegressionWithLBFGS.train(RDD, iterations<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb115-9"><a href="" aria-hidden="true" tabindex="-1"></a>model.predict([<span class="fl">0.0</span>, <span class="fl">1.0</span>])</span>
<span id="cb115-10"><a href="" aria-hidden="true" tabindex="-1"></a>model.predict([<span class="fl">1.0</span>, <span class="fl">0.0</span>])</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="61">
<pre><code>1</code></pre>
</div>
</div>
</section></section>
<section>
<section id="–∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü—ñ—è" class="title-slide slide level1 unnumbered unlisted center">
<h1>–ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü—ñ—è</h1>

</section>
<section id="–∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü—ñ—è-1" class="slide level2">
<h2>–ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü—ñ—è</h2>
<p>–ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ PySpark MLlib –Ω–∞—Ä–∞–∑—ñ –ø—ñ–¥—Ç—Ä–∏–º—É—î –Ω–∞—Å—Ç—É–ø–Ω—ñ –º–æ–¥–µ–ª—ñ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü—ñ—ó</p>
<ul>
<li>K-means</li>
<li>Gaussian mixture</li>
<li>Power iteration clustering (PIC)</li>
<li>Bisecting k-means</li>
<li>Streaming k-means</li>
</ul>
</section>
<section id="k-means" class="slide level2">
<h2>K-means</h2>
<div id="74aa4886" class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb117-1"><a href="" aria-hidden="true" tabindex="-1"></a>RDD <span class="op">=</span> sc.textFile(<span class="st">"data/wine_data.csv"</span>) <span class="op">\</span></span>
<span id="cb117-2"><a href="" aria-hidden="true" tabindex="-1"></a>  .<span class="bu">filter</span>(<span class="kw">lambda</span> line: <span class="kw">not</span> line.startswith(<span class="st">"class_label"</span>)) <span class="op">\</span></span>
<span id="cb117-3"><a href="" aria-hidden="true" tabindex="-1"></a>  .<span class="bu">map</span>(<span class="kw">lambda</span> x: x.split(<span class="st">","</span>)) <span class="op">\</span></span>
<span id="cb117-4"><a href="" aria-hidden="true" tabindex="-1"></a>  .<span class="bu">map</span>(<span class="kw">lambda</span> x: [<span class="bu">float</span>(x[<span class="dv">0</span>]), <span class="bu">float</span>(x[<span class="dv">1</span>]), <span class="bu">float</span>(x[<span class="dv">2</span>])])</span>
<span id="cb117-5"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-6"><a href="" aria-hidden="true" tabindex="-1"></a>RDD.take(<span class="dv">5</span>)</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="62">
<pre><code>[[1.0, 14.23, 1.71],
 [1.0, 13.2, 1.78],
 [1.0, 13.16, 2.36],
 [1.0, 14.37, 1.95],
 [1.0, 13.24, 2.59]]</code></pre>
</div>
</div>
</section>
<section id="–Ω–∞–≤—á–∞–Ω–Ω—è-k-means" class="slide level2">
<h2>–ù–∞–≤—á–∞–Ω–Ω—è K-means</h2>
<div id="70b3964e" class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyspark.mllib.clustering <span class="im">import</span> KMeans</span>
<span id="cb119-2"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3"><a href="" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> KMeans.train(RDD, k <span class="op">=</span> <span class="dv">3</span>, maxIterations <span class="op">=</span> <span class="dv">10</span>)</span>
<span id="cb119-4"><a href="" aria-hidden="true" tabindex="-1"></a>model.clusterCenters</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="63">
<pre><code>[array([ 2.12121212, 12.27030303,  1.62227273]),
 array([ 2.62962963, 13.0737037 ,  3.77259259]),
 array([ 1.0862069 , 13.76362069,  1.81172414])]</code></pre>
</div>
</div>
</section>
<section id="–æ—Ü—ñ–Ω–∫–∞-–º–æ–¥–µ–ª—ñ-1" class="slide level2">
<h2>–û—Ü—ñ–Ω–∫–∞ –º–æ–¥–µ–ª—ñ</h2>
<div id="e0889347" class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> sqrt</span>
<span id="cb121-2"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-3"><a href="" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> error(point):</span>
<span id="cb121-4"><a href="" aria-hidden="true" tabindex="-1"></a>  center <span class="op">=</span> model.centers[model.predict(point)]</span>
<span id="cb121-5"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> sqrt(<span class="bu">sum</span>([x<span class="op">**</span><span class="dv">2</span> <span class="cf">for</span> x <span class="kw">in</span> (point <span class="op">-</span> center)]))</span>
<span id="cb121-6"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-7"><a href="" aria-hidden="true" tabindex="-1"></a>WSSSE <span class="op">=</span> RDD.<span class="bu">map</span>(<span class="kw">lambda</span> point: error(point)).<span class="bu">reduce</span>(<span class="kw">lambda</span> x, y: x <span class="op">+</span> y)</span>
<span id="cb121-8"><a href="" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Within Set Sum of Squared Error = "</span> <span class="op">+</span> <span class="bu">str</span>(WSSSE))</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Within Set Sum of Squared Error = 136.79460814030136</code></pre>
</div>
</div>
</section>
<section id="–≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è" class="slide level2">
<h2>–í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è</h2>
<div id="c548182b" class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyspark.sql <span class="im">import</span> SparkSession</span>
<span id="cb123-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb123-3"><a href="" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb123-4"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-5"><a href="" aria-hidden="true" tabindex="-1"></a>spark <span class="op">=</span> SparkSession.builder.appName(<span class="st">"KMeans"</span>).getOrCreate()</span>
<span id="cb123-6"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-7"><a href="" aria-hidden="true" tabindex="-1"></a>wine_data_df <span class="op">=</span> spark.createDataFrame(RDD, schema<span class="op">=</span>[<span class="st">"col0"</span>, <span class="st">"col1"</span>, <span class="st">"col2"</span>])</span>
<span id="cb123-8"><a href="" aria-hidden="true" tabindex="-1"></a>wine_data_df_pandas <span class="op">=</span> wine_data_df.toPandas()</span>
<span id="cb123-9"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-10"><a href="" aria-hidden="true" tabindex="-1"></a>cluster_centers_pandas <span class="op">=</span> pd.DataFrame(</span>
<span id="cb123-11"><a href="" aria-hidden="true" tabindex="-1"></a>    [center[<span class="dv">1</span>:] <span class="cf">for</span> center <span class="kw">in</span> model.clusterCenters],  <span class="co"># –ø—Ä–æ–ø—É—Å–∫–∞—î–º–æ col0</span></span>
<span id="cb123-12"><a href="" aria-hidden="true" tabindex="-1"></a>    columns<span class="op">=</span>[<span class="st">"col1"</span>, <span class="st">"col2"</span>]</span>
<span id="cb123-13"><a href="" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb123-14"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-15"><a href="" aria-hidden="true" tabindex="-1"></a>plt.scatter(wine_data_df_pandas[<span class="st">"col1"</span>], wine_data_df_pandas[<span class="st">"col2"</span>], c<span class="op">=</span>wine_data_df_pandas[<span class="st">"col0"</span>])</span>
<span id="cb123-16"><a href="" aria-hidden="true" tabindex="-1"></a>plt.scatter(cluster_centers_pandas[<span class="st">"col1"</span>], cluster_centers_pandas[<span class="st">"col2"</span>], c<span class="op">=</span><span class="st">"red"</span>, marker<span class="op">=</span><span class="st">"x"</span>)</span>
<span id="cb123-17"><a href="" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"KMeans Clustering"</span>)</span>
<span id="cb123-18"><a href="" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</section><section id="–≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è-output" class="slide level2 output-location-slide"><h2>–í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è</h2><div class="cell output-location-slide" data-execution_count="73">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src=".02_files/figure-revealjs/cell-74-output-1.svg"></p>
</figure>
</div>
</div>
</div></section></section>
<section id="–¥—è–∫—É—é-–∑–∞-—É–≤–∞–≥—É" class="title-slide slide level1 unnumbered unlisted center" data-background-iframe=".02_files/libs/colored-particles/index.html">
<h1>–î—è–∫—É—é –∑–∞ —É–≤–∞–≥—É!</h1>
<p><br> <br></p>
<p><iconify-icon inline="" icon="solar:book-bold"></iconify-icon> <a href="https://aranaur.rbind.io/lectures/mm_big_data/">–ú–∞—Ç–µ—Ä—ñ–∞–ª–∏ –∫—É—Ä—Å—É</a></p>
<p><iconify-icon inline="" icon="mdi:envelope"></iconify-icon> ihor.miroshnychenko@knu.ua</p>
<p><iconify-icon inline="" icon="ic:baseline-telegram"></iconify-icon> <a href="https://t.me/araprof">Data Mirosh</a></p>
<p><iconify-icon inline="" icon="mdi:linkedin"></iconify-icon> <a href="https://www.linkedin.com/in/ihormiroshnychenko/">@ihormiroshnychenko</a></p>
<p><iconify-icon inline="" icon="mdi:github"></iconify-icon> <a href="https://github.com/Aranaur">@aranaur</a></p>
<p><iconify-icon inline="" icon="ion:home"></iconify-icon> <a href="https://aranaur.rbind.io">aranaur.rbind.io</a></p>

</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="fit.png" class="slide-logo"></p>
<div class="footer footer-default">
<p><a href="https://aranaur.rbind.io/lectures/mm_big_data/">üîó–ú–æ–¥–µ–ª—ñ —Ç–∞ –º–µ—Ç–æ–¥–∏ –æ–±—Ä–æ–±–∫–∏ –≤–µ–ª–∏–∫–∏—Ö –¥–∞–Ω–∏—Ö</a></p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src=".02_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src=".02_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src=".02_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src=".02_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src=".02_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src=".02_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src=".02_files/libs/revealjs/plugin/verticator/verticator.js"></script>
  <script src=".02_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src=".02_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src=".02_files/libs/revealjs/plugin/search/search.js"></script>
  <script src=".02_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src=".02_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'verticator': {"themetag":"h1","color":"","inversecolor":"","skipuncounted":false,"clickable":true,"position":"auto","offset":"3vmin","autogenerate":true,"tooltip":false,"scale":1},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'h.v',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'default',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: true,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: true,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'fade',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1350,

        height: 759.375,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, Verticator, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "–°–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "–°–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>