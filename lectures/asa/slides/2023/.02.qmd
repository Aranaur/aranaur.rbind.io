---
title: "–ú–Ω–æ–∂–∏–Ω–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è"
subtitle: "–ü—Ä–∏–∫–ª–∞–¥–Ω–∏–π —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–∏–π –∞–Ω–∞–ª—ñ–∑"
author: "–Ü–≥–æ—Ä –ú—ñ—Ä–æ—à–Ω–∏—á–µ–Ω–∫–æ"
institute: –ö–ù–£ —ñ–º–µ–Ω—ñ –¢–∞—Ä–∞—Å–∞ –®–µ–≤—á–µ–Ω–∫–∞ | –§–Ü–¢
# date: today
# date-format: iso
from: markdown+emoji
title-slide-attributes:
  data-background-iframe: .02_files/libs/colored-particles/index.html
#   data-background-color: "#eef3f8"
language: _language-ua.yml
footer: üîó <a href="https://aranaur.rbind.io/lectures/asa/">–ú–∞—Ç–µ—Ä—ñ–∞–ª–∏ –∫—É—Ä—Å—É</a>
format: 
  revealjs:
    transition: fade
    chalkboard: true
    logo: img/fit.png
    code-line-numbers: false
    slide-number: c/t
    mouse-wheel: true
    width: 1350  
    height: 759.375
    # highlight-style: github
    pdf-separate-fragments: true
    theme: [default, custom.scss]
    fig-width: 15
    fig-height: 7.5
knitr: 
  opts_chunk: 
    fig.align: center
    echo: true
    warnings: false
    message: false
editor_options: 
  chunk_output_type: console
---

```{python}
#| label: setup
#| include: false

# Import libraries
import numpy as np
import pandas as pd
import statsmodels.api as sm
import matplotlib.pyplot as plt
import seaborn as sns
from scipy.stats import norm, uniform

from IPython.display import Markdown
from tabulate import tabulate

# Set seaborn default style
sns.set_style('whitegrid')
sns.set_palette('colorblind')

# Define colors
red_pink   = "#e64173"
turquoise  = "#20B2AA"
orange     = "#FFA500"
red        = "#fb6107"
blue       = "#181485"
navy       = "#150E37FF"
green      = "#8bb174"
yellow     = "#D8BD44"
grey_light = "grey70"
grey_mid   = "grey50"
grey_dark  = "grey20"
purple     = "#6A5ACD"
slate      = "#314f4f"
```

# –ú–Ω–æ–∂–∏–Ω–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è

## –ë—ñ–ª—å—à–µ –ø–æ—è—Å–Ω—é–≤–∞–ª—å–Ω–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö

–ú–∏ –ø–µ—Ä–µ—Ö–æ–¥–∏–º–æ –≤—ñ–¥ **–ø—Ä–æ—Å—Ç–æ—ó –ª—ñ–Ω—ñ–π–Ω–æ—ó —Ä–µ–≥—Ä–µ—Å—ñ—ó** (–æ–¥–Ω–∞ [–Ω–µ–∑–∞–ª–µ–∂–Ω–∞]{.purple} –∑–º—ñ–Ω–Ω–∞ —Ç–∞ –æ–¥–Ω–∞ [–∑–∞–ª–µ–∂–Ω–∞]{.pink})

$$ \color{#e64173}{y_i} = \beta_0 + \beta_1 \color{#6A5ACD}{x_i} + u_i $$

–¥–æ **–º–Ω–æ–∂–∏–Ω–Ω–æ—ó –ª—ñ–Ω—ñ–π–Ω–æ—ó —Ä–µ–≥—Ä–µ—Å—ñ—ó** (–¥–µ–∫—ñ–ª—å–∫–∞ [–Ω–µ–∑–∞–ª–µ–∂–Ω–∏—Ö]{.purple} —Ç–∞ –æ–¥–Ω–∞ [–∑–∞–ª–µ–∂–Ω–∞]{.pink} –∑–º—ñ–Ω–Ω—ñ)

$$ \color{#e64173}{y_i} = \beta_0 + \beta_1 \color{#6A5ACD}{x_{1i}} + \beta_2 \color{#6A5ACD}{x_{2i}} + \cdots + \beta_k \color{#6A5ACD}{x_{ki}} + u_i $$

**–ß–æ–º—É?**

. . .

–ú–∏ –º–æ–∂–µ–º–æ –∫—Ä–∞—â–µ –ø–æ—è—Å–Ω–∏—Ç–∏ –≤–∞—Ä—ñ–∞—Ü—ñ—é $y$, –ø–æ–∫—Ä–∞—â–∏—Ç–∏ –ø—Ä–æ–≥–Ω–æ–∑–∏, —É–Ω–∏–∫–Ω—É—Ç–∏ –∑–º—ñ—â–µ–Ω–Ω—è –ø—Ä–æ–ø—É—â–µ–Ω–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö ...

## –ú–Ω–æ–∂–∏–Ω–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è

```{python}
#| label: gen-data
#| include: false

n = 100
np.random.seed(123)

gen_df = pd.DataFrame({
    'x1': np.random.uniform(-3, 3, n)
})
gen_df['x2'] = np.random.choice([True, False], n, replace=True)
gen_df['u'] = np.random.normal(0, 1, n)
gen_df['y'] = -0.5 + gen_df['x1'] + gen_df['x2'] * 4 + gen_df['u']

mean_a = gen_df[gen_df['x2'] == False]['y'].mean()
mean_b = gen_df[gen_df['x2'] == True]['y'].mean()

gen_df['y_dm'] = gen_df['y'] - mean_a * (gen_df['x2'] == False) - mean_b * (gen_df['x2'] == True)
```

$y_i = \beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i} + u_i \quad$ $x_1$ —î –Ω–µ–ø–µ—Ä–µ—Ä–≤–Ω–∏–º $\quad x_2$ —î –∫–∞—Ç–µ–≥–æ—Ä—ñ–∞–ª—å–Ω–∏–º

```{python}
#| label: plot-data
#| echo: false

graph = sns.scatterplot(x='x1', y='y', hue='x2', data=gen_df, palette=sns.color_palette(["darkslategrey", red_pink]))
graph.axvline(0, color='grey', alpha=0.8)
graph.axhline(0, color='grey', alpha=0.8)
plt.tick_params(left = False, right = False , labelleft = False , 
                labelbottom = False, bottom = False)
plt.ylabel('')
plt.xlabel('')
plt.annotate(text='y', xy = (0, 0), xytext = (-0.2, 4.5))
plt.annotate(text='x', xy = (0, 0), xytext = (3.5, -0.2))
plt.box(False)
plt.grid(None)
plt.show()
```

## –ú–Ω–æ–∂–∏–Ω–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è

$\beta_0$ —Ç–∞ –∫–∞—Ç–µ–≥–æ—Ä—ñ–∞–ª—å–Ω–∞ –∑–º—ñ–Ω–Ω–∞ $x_2$ –∫–µ—Ä—É—é—Ç—å —Å–µ—Ä–µ–¥–Ω—ñ–º–∏ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏ –≥—Ä—É–ø.

```{python}
#| label: plot-data2
#| echo: false

graph = sns.scatterplot(x='x1', y='y', hue='x2', data=gen_df, palette=sns.color_palette(["darkslategrey", red_pink]))
graph.axvline(0, color='grey')
graph.axhline(mean_a, color="darkslategrey", alpha=0.2)
graph.axhline(mean_b, color=red_pink, alpha=0.2)
graph.axhline(0, color='grey')
plt.tick_params(left = False, right = False , labelleft = False , 
                labelbottom = False, bottom = False)
plt.ylabel('')
plt.xlabel('')
plt.annotate(text='y', xy = (0, 0), xytext = (-0.2, 8.5))
plt.annotate(text='x', xy = (0, 0), xytext = (3.5, -0.2))
plt.box(False)
plt.grid(None)
plt.show()
```

## –ú–Ω–æ–∂–∏–Ω–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è

–Ø–∫—â–æ –ø—Ä–∏–±—Ä–∞—Ç–∏ —Å–µ—Ä–µ–¥–Ω—î –∑–Ω–∞—á–µ–Ω–Ω—è –≥—Ä—É–ø:

```{python}
#| label: plot-data3
#| echo: false

graph = sns.scatterplot(x='x1', y='y_dm', hue='x2', data=gen_df, palette=sns.color_palette(["darkslategrey", red_pink]))
graph.axvline(0, color='grey')
graph.axhline(0, color='grey')
plt.tick_params(left = False, right = False , labelleft = False , 
                labelbottom = False, bottom = False)
plt.ylabel('')
plt.xlabel('')
plt.annotate(text='y', xy = (0, 0), xytext = (-0.2, 4.5))
plt.annotate(text='x', xy = (0, 0), xytext = (3.5, -0.2))
plt.ylabel('y')
plt.box(False)
plt.grid(None)
plt.show()
```

## –ú–Ω–æ–∂–∏–Ω–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è

$\hat{\beta}_1$ –æ—Ü—ñ–Ω—é—î —Å–ø—ñ–≤–≤—ñ–¥–Ω–æ—à–µ–Ω–Ω—è –º—ñ–∂ $y$ —ñ $x_1$ –ø—ñ—Å–ª—è –≤—Ä–∞—Ö—É–≤–∞–Ω–Ω—è $x_2$.

```{python}
#| label: plot-data4
#| echo: false

graph = sns.scatterplot(x='x1', y='y_dm', hue='x2', data=gen_df, palette=sns.color_palette(["darkslategrey", red_pink]))
sns.regplot(x='x1', y='y_dm', data=gen_df, scatter=False, color=orange, ci=None)
graph.axvline(0, color='grey')
graph.axhline(0, color='grey')
plt.tick_params(left = False, right = False , labelleft = False , 
                labelbottom = False, bottom = False)
plt.ylabel('')
plt.xlabel('')
plt.annotate(text='y', xy = (0, 0), xytext = (-0.2, 4.5))
plt.annotate(text='x', xy = (0, 0), xytext = (3.5, -0.2))
plt.box(False)
plt.grid(None)
plt.show()
```

## –ú–Ω–æ–∂–∏–Ω–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è

–Ü–Ω—à–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç –ø–æ–≥–ª—è–Ω—É—Ç–∏ –Ω–∞ —Ü–µ:

```{python}
#| label: plot-data5
#| echo: false
#| eval: false

sns.lmplot(x='x1', y='y', hue='x2', data=gen_df, scatter=True, ci=None, palette=sns.color_palette(["darkslategrey", red_pink]))
plt.axvline(0, color='grey')
plt.axhline(0, color='grey')
plt.tick_params(left = False, right = False , labelleft = False , 
                labelbottom = False, bottom = False)
plt.ylabel('')
plt.xlabel('')
plt.annotate(text='y', xy = (0, 0), xytext = (-0.2, 4.5))
plt.annotate(text='x', xy = (0, 0), xytext = (3.5, -0.2))
plt.gcf().set_size_inches(15, 7.5)
plt.ylabel('y')
plt.box(False)
plt.grid(False)
plt.show()
```

![](img/plot-data5-10.png){fig-align="center"}


## –ú–Ω–æ–∂–∏–Ω–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è

–ü–æ–≥–ª—è–Ω–µ–º–æ –Ω–∞ –æ—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –º–æ–¥–µ–ª—ñ...

–î–ª—è –ø—Ä–æ—Å—Ç–æ—ó –ª—ñ–Ω—ñ–π–Ω–æ—ó —Ä–µ–≥—Ä–µ—Å—ñ—ó $y_i = \beta_0 + \beta_1 x_i + u_i$

$$
\begin{aligned}
  \hat{\beta}_1 &= \\[0.3em]
  &= \dfrac{\sum_i \left( x_i - \overline{x} \right) \left( y_i - \overline{y} \right)}{\sum_i \left( x_i -\overline{x} \right)} \\[0.3em]
  &= \dfrac{\sum_i \left( x_i - \overline{x} \right) \left( y_i - \overline{y} \right)/(n-1)}{\sum_i \left( x_i -\overline{x} \right) / (n-1)} \\[0.3em]
  &= \dfrac{\mathop{\hat{\text{Cov}}}(x,\,y)}{\mathop{\hat{\text{Var}}} \left( x \right)}
\end{aligned}
$$

## –ú–Ω–æ–∂–∏–Ω–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è

–ü—Ä–æ—Å—Ç–∞ –ª—ñ–Ω—ñ–π–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è:

$$ \hat{\beta}_1 = \dfrac{\mathop{\hat{\text{Cov}}}(x,\,y)}{\mathop{\hat{\text{Var}}} \left( x \right)} $$

–ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥—ñ –¥–æ –º–Ω–æ–∂–∏–Ω–Ω–æ—ó –ª—ñ–Ω—ñ–π–Ω–æ—ó —Ä–µ–≥—Ä–µ—Å—ñ—ó –æ—Ü—ñ–Ω–∫–∞ —Ç—Ä–æ—Ö–∏ –∑–º—ñ–Ω—é—î—Ç—å—Å—è:

$$ \hat{\beta}_1 = \dfrac{\mathop{\hat{\text{Cov}}}(\color{#e64173}{\tilde{x}_1},\,y)}{\mathop{\hat{\text{Var}}} \left( \color{#e64173}{\tilde{x}_1} \right)} $$

–¥–µ $\color{#e64173}{\tilde{x}_1}$ ‚Äî *–∑–∞–ª–∏—à–∫–æ–≤–∞* –∑–º—ñ–Ω–Ω–∞ $x_1$ ‚Äî –∑–º—ñ–Ω–∞, —â–æ –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è –≤ $x$ –ø—ñ—Å–ª—è –≤—Ä–∞—Ö—É—ñ–≤–Ω–Ω—è —ñ–Ω—à–∏—Ö –ø–æ—è—Å–Ω—é–≤–∞–ª—å–Ω–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö.

## –ú–Ω–æ–∂–∏–Ω–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è

–ë—ñ–ª—å—à —Ñ–æ—Ä–º–∞–ª—å–Ω–æ —Ä–æ–∑–≥–ª—è–Ω–µ–º–æ –º–æ–¥–µ–ª—å –º–Ω–æ–∂–∏–Ω–Ω–æ—ó —Ä–µ–≥—Ä–µ—Å—ñ—ó

$$ y_i = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \beta_3 x_3 + u_i $$

–ù–∞—à–∞ –∑–∞–ª–∏—à–∫–æ–≤–∞ $x_{1}$ (—è–∫—É –º–∏ –Ω–∞–∑–≤–∞–ª–∏ $\color{#e64173}{\tilde{x}_1}$) –ø–æ—Ö–æ–¥–∏—Ç—å –≤—ñ–¥ —Ä–µ–≥—Ä–µ—Å—ñ—ó $x_1$ –∑ intercept —Ç–∞ –≤—Å—ñ—Ö —ñ–Ω—à–∏—Ö –ø–æ—è—Å–Ω—é–≤–∞–ª—å–Ω–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö —ñ –∑–±–∏—Ä–∞—î –∑–∞–ª–∏—à–∫–∏, _—Ç–æ–±—Ç–æ_,

$$
\begin{aligned}
  \hat{x}_{1i} &= \hat{\gamma}_0 + \hat{\gamma}_2 \, x_{2i} + \hat{\gamma}_3 \, x_{3i} \\
  \color{#e64173}{\tilde{x}_{1i}} &= x_{1i} - \hat{x}_{1i}
\end{aligned}
$$

. . .

—â–æ –¥–æ–∑–≤–æ–ª—è—î –Ω–∞–º –∫—Ä–∞—â–µ –∑—Ä–æ–∑—É–º—ñ—Ç–∏ –Ω–∞—à—É –æ—Ü—ñ–Ω–∫—É –ú–ù–ö –º–Ω–æ–∂–∏–Ω–Ω–æ—ó —Ä–µ–≥—Ä–µ—Å—ñ—ó

$$ \hat{\beta}_1 = \dfrac{\mathop{\hat{\text{Cov}}}(\color{#e64173}{\tilde{x}_1},\,y)}{\mathop{\hat{\text{Var}}} \left( \color{#e64173}{\tilde{x}_1} \right)} $$

---

```{python}
#| label: venn
#| echo: false
#| warning: false

import matplotlib.pyplot as plt
import matplotlib.patches as patches
import pandas as pd

# Colors
venn_colors = ['purple', 'red', 'grey', 'orange']

# Circle locations
venn_df = pd.DataFrame({
    'x': [0.0, -0.5, 1.5, -1.0],
    'y': [0.0, -2.5, -1.8, 2.0],
    'r': [1.9, 1.5, 1.5, 1.3],
    'l': ["$Y$", "$X_1$", "$X_2$", "$X_3$"],
    'xl': [0.0, -0.5, 1.6, -1.0],
    'yl': [0.0, -2.5, -1.9, 2.2]
})

# Create figure and axis
fig, ax = plt.subplots()

# Draw circles
for i in range(len(venn_df)):
    circle = patches.Circle((venn_df['x'][i], venn_df['y'][i]), venn_df['r'][i],
                            fill=True, color=venn_colors[i], alpha=0.3, edgecolor=venn_colors[i], linewidth=0.75)
    ax.add_patch(circle)

# Plot text labels
for i in range(len(venn_df)):
    ax.text(venn_df['xl'][i], venn_df['yl'][i], venn_df['l'][i], size=14, va='center', ha='center')

# Set axis properties
ax.annotate("–ú–Ω–æ–∂–∏–Ω–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è", xy=(-5.5, 3.3), size=14, ha='left')

ax.set_xlim(-5.5, 4.5);
ax.set_ylim(-4.2, 3.4);
ax.set_aspect('equal', adjustable='box')  # Equal aspect ratio

# Remove axes
ax.axis('off');

plt.show()
```

## –û—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è –º–æ–¥–µ–ª—ñ

–ü–æ–∫–∞–∑–Ω–∏–∫–∏ *—Ö–æ—Ä–æ—à–æ—ó –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ* (–∞–Ω–≥. *goodness of fit*) –Ω–∞–º–∞–≥–∞—é—Ç—å—Å—è –ø—Ä–æ–∞–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏, –Ω–∞—Å–∫—ñ–ª—å–∫–∏ –¥–æ–±—Ä–µ –Ω–∞—à–∞ –º–æ–¥–µ–ª—å –æ–ø–∏—Å—É—î (*–≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î*) –¥–∞–Ω–∏–º.

**–ü–æ–ø—É–ª—è—Ä–Ω–∏–π –ø–æ–∫–∞–∑–Ω–∏–∫:** $R^2$ [R-–∫–≤–∞–¥—Ä–∞—Ç] (*–≤—ñ–Ω –∂–µ* –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –¥–µ—Ç–µ—Ä–º—ñ–Ω–∞—Ü—ñ—ó)

$$ R^2 = \dfrac{\sum_i (\hat{y}_i - \overline{y})^2}{\sum_i \left( y_i - \overline{y} \right)^2} = 1 - \dfrac{\sum_i \left( y_i - \hat{y}_i \right)^2}{\sum_i \left( y_i - \overline{y} \right)^2} $$

–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É –Ω–∞ –Ω–∞—à–æ–≥–æ —Å—Ç–∞—Ä–æ–≥–æ –¥—Ä—É–≥–∞ ESS: $\sum_i \left( y_i - \hat{y}_i \right)^2 = \sum_i e_i^2$.

. . .

$R^2$ –±—É–∫–≤–∞–ª—å–Ω–æ –≤–∫–∞–∑—É—î –Ω–∞–º —á–∞—Å—Ç–∫—É –¥–∏—Å–ø–µ—Ä—Å—ñ—ó –≤ $y$, —è–∫—É –≤—Ä–∞—Ö–æ–≤—É—î –Ω–∞—à–∞ –º–æ–¥–µ–ª—å. –¢–∞–∫–∏–º —á–∏–Ω–æ–º $0 \leq R^2 \leq 1$.

## –ú–Ω–æ–∂–∏–Ω–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è {.smaller}

**–ü—Ä–æ–±–ª–µ–º–∞:** –∫–æ–ª–∏ –º–∏ –¥–æ–¥–∞—î–º–æ –∑–º—ñ–Ω–Ω—ñ –¥–æ –Ω–∞—à–æ—ó –º–æ–¥–µ–ª—ñ, $R^2$ *–ø–æ—Å—Ç—ñ–π–Ω–æ* –∑–±—ñ–ª—å—à—É—î—Ç—å—Å—è.

. . .

–©–æ–± –ø–æ–±–∞—á–∏—Ç–∏ —Ü—é –ø—Ä–æ–±–ª–µ–º—É, –º–∏ –º–æ–∂–µ–º–æ –∑–º–æ–¥–µ–ª—é–≤–∞—Ç–∏ –Ω–∞–±—ñ—Ä –¥–∞–Ω–∏—Ö —ñ–∑ 10 000 —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω—å –∑–∞ $y$ —ñ 1000 –≤–∏–ø–∞–¥–∫–æ–≤–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö $x_k$. **–ù–µ–º–∞—î –∑–≤‚Äô—è–∑–∫—É –º—ñ–∂ $y$ —ñ $x_k$!**

–ü—Å–µ–≤–¥–æ–∫–æ–¥ —Å–∏–º—É–ª—è—Ü—ñ—ó:

. . .

- –ó–≥–µ–Ω–µ—Ä—É–π—Ç–µ 10 000 —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω—å $y$
- –ó–≥–µ–Ω–µ—Ä—É–π—Ç–µ 10 000 —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω—å –∑–∞ –∑–º—ñ–Ω–Ω–∏–º–∏ –≤—ñ–¥ $x_1$ –¥–æ $x_{1000}$
- –†–µ–≥—Ä–µ—Å—ñ—è:
    - LM~1~: —Ä–µ–≥—Ä–µ—Å—ñ—è $y$ –Ω–∞ $x_1$; –∑–∞–ø–∏—Å R^2^
    - LM~2~: —Ä–µ–≥—Ä–µ—Å—ñ—è $y$ –Ω–∞ $x_1$ —ñ $x_2$; –∑–∞–ø–∏—Å R^2^
    - LM~1000~: —Ä–µ–≥—Ä–µ—Å—ñ—è $y$ –Ω–∞ $x_1$, $x_2$ —ñ $x_3$; –∑–∞–ø–∏—Å R^2^
    - ...
    - LM<sub>1000</sub>: —Ä–µ–≥—Ä–µ—Å—ñ—è $y$ –Ω–∞ $x_1$, $x_2$, ..., $x_{1000}$; –∑–∞–ø–∏—Å R^2^`

## –ú–Ω–æ–∂–∏–Ω–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è {.smaller}

**–ü—Ä–æ–±–ª–µ–º–∞:** –∫–æ–ª–∏ –º–∏ –¥–æ–¥–∞—î–º–æ –∑–º—ñ–Ω–Ω—ñ –¥–æ –Ω–∞—à–æ—ó –º–æ–¥–µ–ª—ñ, $R^2$ *–ø–æ—Å—Ç—ñ–π–Ω–æ* –∑–±—ñ–ª—å—à—É—î—Ç—å—Å—è.

`Python` –∫–æ–¥ –¥–ª—è —Å–∏–º—É–ª—è—Ü—ñ—ó:

```{python}
#| label: r2-sim
#| eval: false

import numpy as np
import pandas as pd
from sklearn.linear_model import LinearRegression
from joblib import Parallel, delayed

np.random.seed(1234)

n = 1000
k = 1000

y = np.random.normal(size=n)
x = np.random.normal(size=(n, k))

def calculate_r2(i):
    model = LinearRegression()
    model.fit(x[:, :i+2], y)
    r2 = model.score(x[:, :i+2], y)
    adj_r2 = 1 - (1 - r2) * (len(y) - 1) / (len(y) - (i+2))
    return pd.DataFrame({'k': [i+2], 'r2': [r2], 'r2_adj': [adj_r2]})

result = Parallel(n_jobs=-1)(delayed(calculate_r2)(i) for i in range(k))

r_df = pd.concat(result, ignore_index=True)
```

## –ú–Ω–æ–∂–∏–Ω–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è {.smaller}

**–ü—Ä–æ–±–ª–µ–º–∞:** –∫–æ–ª–∏ –º–∏ –¥–æ–¥–∞—î–º–æ –∑–º—ñ–Ω–Ω—ñ –¥–æ –Ω–∞—à–æ—ó –º–æ–¥–µ–ª—ñ, $R^2$ *–ø–æ—Å—Ç—ñ–π–Ω–æ* –∑–±—ñ–ª—å—à—É—î—Ç—å—Å—è.

```{python}
#| label: r2-sim-import
#| include: false

r_df = pd.read_csv('data/r2-sim.csv')
```

```{python}
#| label: r2-plot
#| echo: false

plt.plot(r_df['k'], r_df['r2'], linewidth=4, alpha=0.75, color='darkslategrey')

plt.axhline(y=0, color='black')
plt.axvline(x=0, color='black')

plt.xlabel('–ö—ñ–ª—å–∫—ñ—Å—Ç—å –Ω–µ–∑–∞–ª–µ–∂–Ω–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö (k)')
plt.ylabel(r'$R^2$')
plt.title(r'$R^2$ vs. –ö—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ—è—Å–Ω—é–≤–∞–ª—å–Ω–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö')

plt.show()
```

## –ú–Ω–æ–∂–∏–Ω–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è {.smaller}

–©–æ —Ä–æ–±–∏—Ç–∏?
**–†—ñ—à–µ–Ω–Ω—è –ø–µ—Ä—à–µ:** [–°–∫–æ—Ä–∏–≥–æ–≤–∞–Ω–∏–π]{.pink} $\color{#e64173}{R^2}$

```{python}
#| label: r2-adj-plot
#| echo: false

plt.plot(r_df['k'], r_df['r2'], linewidth=4, alpha=0.15, color='darkslategrey')
plt.plot(r_df['k'], r_df['r2_adj'], linewidth=4, alpha=0.85, color=red_pink)

plt.axhline(y=0, color='black')
plt.axvline(x=0, color='black')

plt.xlabel('–ö—ñ–ª—å–∫—ñ—Å—Ç—å –Ω–µ–∑–∞–ª–µ–∂–Ω–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö (k)')
plt.ylabel(r'$R^2$')
plt.title(r'$R^2$ vs. $R^2_{adj}$ vs. –ö—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ—è—Å–Ω—é–≤–∞–ª—å–Ω–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö')

plt.show()
```

## –ú–Ω–æ–∂–∏–Ω–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è {.smaller}

**–ü—Ä–æ–±–ª–µ–º–∞:** –∫–æ–ª–∏ –º–∏ –¥–æ–¥–∞—î–º–æ –∑–º—ñ–Ω–Ω—ñ –¥–æ –Ω–∞—à–æ—ó –º–æ–¥–µ–ª—ñ, $R^2$ *–ø–æ—Å—Ç—ñ–π–Ω–æ* –∑–±—ñ–ª—å—à—É—î—Ç—å—Å—è.

**–†—ñ—à–µ–Ω–Ω—è –ø–µ—Ä—à–µ:** –®—Ç—Ä–∞—Ñ—É–≤–∞—Ç–∏ –∑–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∑–º—ñ–Ω–Ω–∏—Ö, _–Ω–∞–ø—Ä–∏–∫–ª–∞–¥_, —Å–∫–æ—Ä–µ–≥–æ–≤–∞–Ω–∏–π $R^2$:

$$ \overline{R}^2 = 1 - \dfrac{\sum_i \left( y_i - \hat{y}_i \right)^2/(n-k-1)}{\sum_i \left( y_i - \overline{y} \right)^2/(n-1)} $$

::: {.callout-note}
–°–∫–æ—Ä–∏–≥–æ–≤–∞–Ω–∏–π $R^2$ –Ω–µ –æ–±–æ–≤'—è–∑–∫–æ–≤–æ –ø–æ–≤–∏–Ω–µ–Ω –±—É—Ç–∏ –≤—ñ–¥ 0 –¥–æ 1.
:::

## –ö–æ–º–ø—Ä–æ–º—ñ—Å–∏ {.smaller}

–Ñ –∫–æ–º–ø—Ä–æ–º—ñ—Å–∏, –ø—Ä–æ —è–∫—ñ —Å–ª—ñ–¥ –ø–∞–º'—è—Ç–∞—Ç–∏, –∫–æ–ª–∏ –º–∏ –¥–æ–¥–∞—î–º–æ/–≤–∏–¥–∞–ª—è—î–º–æ –∑–º—ñ–Ω–Ω—ñ:

**–ú–µ–Ω—à–µ –∑–º—ñ–Ω–Ω–∏—Ö**

- –ü–æ—è—Å–Ω—é—î –º–µ–Ω—à–µ –≤–∞—Ä—ñ–∞—Ü—ñ—ó $y$
- –ü—Ä–æ—Å—Ç–æ—Ç–∞ —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—ó —Ç–∞ –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—ó
- –ú–æ–∂–ª–∏–≤–æ, –¥–æ–≤–µ–¥–µ—Ç—å—Å—è –ø–æ—Ç—É—Ä–±—É–≤–∞—Ç–∏—Å—è –ø—Ä–æ –∑–º—ñ—â–µ–Ω–Ω—è –ø—Ä–æ–ø—É—â–µ–Ω–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö

**–ë—ñ–ª—å—à–µ –∑–º—ñ–Ω–Ω–∏—Ö**

- –ë—ñ–ª—å—à–∞ –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å –∑–Ω–∞–π—Ç–∏ *—Ö–∏–±–Ω—ñ* –∑–≤'—è–∑–∫–∏ (—Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–æ –∑–Ω–∞—á—É—â—ñ —á–µ—Ä–µ–∑ –≤–∏–ø–∞–¥–∫–æ–≤—ñ—Å—Ç—å ‚Äî –Ω–µ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—é—Ç—å —Å–ø—Ä–∞–≤–∂–Ω—å–æ–≥–æ –∑–≤'—è–∑–∫—É –Ω–∞ —Ä—ñ–≤–Ω—ñ –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ—ó —Å—É–∫—É–ø–Ω–æ—Å—Ç—ñ)
- –°–∫–ª–∞–¥–Ω—ñ—à–µ –ø—Ä–æ–≤–æ–¥–∏—Ç–∏ —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—é —Ç–∞ –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—é
- –í–∏ –≤—Å–µ —â–µ –º–æ–∂–µ—Ç–µ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç–∏ –≤–∞–∂–ª–∏–≤—ñ –∑–º—ñ–Ω–Ω—ñ ‚Äî –∑–º—ñ—â–µ–Ω–Ω—è –ø—Ä–æ–ø—É—â–µ–Ω–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö

# –ó–º—ñ—â–µ–Ω–Ω—è –ø—Ä–∏ –Ω–µ–≤—Ä–∞—Ö—É–≤–∞–Ω–Ω—ñ –≤–ø–ª–∏–≤–æ–≤–æ—ó –∑–º—ñ–Ω–Ω–æ—ó {background-color="#eef3f8"}


# –î—è–∫—É—é –∑–∞ —É–≤–∞–≥—É! {background-color="#eef3f8"}

<br>
<br>

{{< iconify ic baseline-telegram >}} [Data Mirosh](https://t.me/araprof)

{{< iconify mdi github >}} [aranaur](https://github.com/Aranaur)

{{< iconify mdi envelope >}} ihor.miroshnychenko\@knu.ua

{{< iconify mdi linkedin >}} [ihormiroshnychenko](https://www.linkedin.com/in/ihormiroshnychenko/)

{{< iconify ion home >}} [aranaur.rbind.io](https://aranaur.rbind.io)