---
title: "–õ—ñ–Ω—ñ–π–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è"
subtitle: "–ü—Ä–∏–∫–ª–∞–¥–Ω–∏–π —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–∏–π –∞–Ω–∞–ª—ñ–∑"
author: "–Ü–≥–æ—Ä –ú—ñ—Ä–æ—à–Ω–∏—á–µ–Ω–∫–æ"
institute: –ö–ù–£ —ñ–º–µ–Ω—ñ –¢–∞—Ä–∞—Å–∞ –®–µ–≤—á–µ–Ω–∫–∞ | –§–Ü–¢
# date: today
# date-format: iso
from: markdown+emoji
title-slide-attributes:
  data-background-iframe: .01_files/libs/colored-particles/index.html
#   data-background-color: "#eef3f8"
language: _language-ua.yml
footer: üîó <a href="https://aranaur.rbind.io/lectures/asa/">–ú–∞—Ç–µ—Ä—ñ–∞–ª–∏ –∫—É—Ä—Å—É</a>
format: 
  revealjs:
    transition: fade
    chalkboard: true
    logo: img/fit.png
    code-line-numbers: false
    slide-number: c/t
    mouse-wheel: true
    width: 1350  
    height: 759.375
    # highlight-style: github
    pdf-separate-fragments: true
    theme: [default, custom.scss]
    fig-width: 15
    # fig-height: 7.5
knitr: 
  opts_chunk: 
    fig.align: center
    echo: true
    warnings: false
    message: false
editor_options: 
  chunk_output_type: console
---

```{python}
#| label: setup
#| include: false

# Import libraries
import numpy as np
import pandas as pd
import statsmodels.api as sm
import matplotlib.pyplot as plt
import seaborn as sns
from scipy.stats import norm, uniform

from IPython.display import Markdown
from tabulate import tabulate

# Set seaborn default style
sns.set_style('whitegrid')
sns.set_palette('colorblind')

# Define colors
red_pink   = "#e64173"
turquoise  = "#20B2AA"
orange     = "#FFA500"
red        = "#fb6107"
blue       = "#181485"
navy       = "#150E37FF"
green      = "#8bb174"
yellow     = "#D8BD44"
grey_light = "grey70"
grey_mid   = "grey50"
grey_dark  = "grey20"
purple     = "#6A5ACD"
slate      = "#314f4f"
```

# –ü—Ä–æ –º–µ–Ω–µ {.unnumbered .unlisted .smaller}

::: nonincremental
-   –ú—ñ—Ä–æ—à–Ω–∏—á–µ–Ω–∫–æ –Ü–≥–æ—Ä –í—ñ–∫—Ç–æ—Ä–æ–≤–∏—á
-   –∫–∞–Ω–¥–∏–¥–∞—Ç –µ–∫–æ–Ω–æ–º—ñ—á–Ω–∏—Ö –Ω–∞—É–∫, –¥–æ—Ü–µ–Ω—Ç
-   –¥–æ—Ü–µ–Ω—Ç –∫–∞—Ñ–µ–¥—Ä–∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ–π —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –ö–ù–£ —ñ–º–µ–Ω—ñ –¢–∞—Ä–∞—Å–∞ –®–µ–≤—á–µ–Ω–∫–∞
-   –¥–æ—Ü–µ–Ω—Ç –∫–∞—Ñ–µ–¥—Ä–∏ –º–∞—Ç–µ–º–∞—Ç–∏—á–Ω–æ–≥–æ –º–æ–¥–µ–ª—é–≤–∞–Ω–Ω—è —ñ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ö–ù–ï–£
-   –≤–∏–∫–ª–∞–¥–∞—á –ú—ñ–∂–Ω–∞—Ä–æ–¥–Ω–æ–≥–æ —ñ–Ω—Å—Ç–∏—Ç—É—Ç—É –±—ñ–∑–Ω–µ—Å—É (MBA)

{{< iconify ic baseline-telegram >}} [Data Mirosh](https://t.me/araprof)

{{< iconify mdi github >}} [aranaur](https://github.com/Aranaur)

{{< iconify mdi envelope >}} ihor.miroshnychenko\@knu.ua

{{< iconify mdi linkedin >}} [ihormiroshnychenko](https://www.linkedin.com/in/ihormiroshnychenko/)

{{< iconify ion home >}} [aranaur.rbind.io](https://aranaur.rbind.io)

:::

# DataCamp {.unnumbered .unlisted–á}

![](img/datacamp-logo.png)

## DataCamp {.unlisted}

:::: {.columns}

::: {.column}
![](img/datacamp-1.png)
:::

::: {.column}
![](img/datacamp-2.png)
:::

::::

## DataCamp {.unlisted .smaller}

:::: {.columns}

::: {.column width=60%}
![](img/datacamp-cert.png)
:::

::: {.column width=40%}
**–Ø–∫ –¥–æ–ª—É—á–∏—Ç–∏—Å—è?**

1. –ü—ñ–¥–ø–∏—Å–∞—Ç–∏—Å—è –Ω–∞ –∫–∞–Ω–∞–ª {{< iconify ic baseline-telegram >}} [Data Mirosh](https://t.me/araprof/46)
2. –ó–∞—Ä–µ—î—Å—Ç—Ä—É–π—Ç–µ—Å—å –Ω–∞ [DataCamp](http://datacamp.com)
3. –ü—Ä–∏—î–¥–Ω–∞–π—Ç–µ—Å—å –¥–æ –∫–ª–∞—Å—É –∑–∞ [–ø–æ—Å–∏–ª–∞–Ω–Ω—è–º](https://www.datacamp.com/groups/shared_links/defc08e8ea50d1b0bdaacbc7241cf24ad966ff57c5b993e8b45106ca939b81b8)

:::

::::

. . .

::: {.callout-note}
–ö–ª–∞—Å –±—É–¥–µ –¥—ñ—è—Ç–∏ –¥–æ 11 –∫–≤—ñ—Ç–Ω—è 2024 —Ä–æ–∫—É, –ø—ñ—Å–ª—è —á–æ–≥–æ –±—É–¥–µ –±—É–¥–µ –≤—ñ–¥–∫—Ä–∏—Ç–æ –Ω–∞—Å—Ç—É–ø–Ω–∏–π –ø–æ—Ç—ñ–∫.

–°–ª—ñ–¥–∫—É–π—Ç–µ –∑–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è–º–∏.
:::

# –ö–æ—Ä–µ–ª—è—Ü—ñ—è {background-color="#eef3f8"}

## –ü–æ–Ω—è—Ç—Ç—è –∫–æ—Ä–µ–ª—è—Ü—ñ—ó

[–ö–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –∫–æ—Ä–µ–ª—è—Ü—ñ—ó]{.hi} —É —Å–≤–æ—î–º—É —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–æ–º—É —Å–µ–Ω—Å—ñ –ø–æ–∑–Ω–∞—á–∞—î —Å–∏–ª—É —ñ —Ö–∞—Ä–∞–∫—Ç–µ—Ä [–≤–∑–∞—î–º–æ–∑–≤'—è–∑–∫—É]{.hi-purple} –º—ñ–∂ –¥–≤–æ–º–∞ –∫—ñ–ª—å–∫—ñ—Å–Ω–∏–º–∏ –∑–º—ñ–Ω–Ω–∏–º–∏.

```{python}
#| label: corr-1
#| echo: false

# Set a random seed for reproducibility
np.random.seed(42)

# Function to generate datasets with specified correlation
def generate_dataset(correlation):
    mean = [0, 0]
    cov_matrix = [[1, correlation], [correlation, 1]]
    
    # Generate random data with the specified correlation
    data = np.random.multivariate_normal(mean, cov_matrix, 100)
    
    # Create a DataFrame
    df = pd.DataFrame(data, columns=['x', 'y'])
    
    return df

# Generate datasets with positive, negative, and no correlation
positive_corr_data = generate_dataset(0.8)
negative_corr_data = generate_dataset(-0.8)
no_corr_data = generate_dataset(0)

# Plot the datasets with regression lines
# plt.figure(figsize=(15, 4))

# Positive Correlation
plt.subplot(131)
sns.regplot(x='x', y='y', data=positive_corr_data, color='blue', ci=None)
plt.title('–ü–æ–∑–∏—Ç–∏–≤–Ω–∞ –∫–æ—Ä–µ–ª—è—Ü—ñ—è')

# Negative Correlation
plt.subplot(132)
sns.regplot(x='x', y='y', data=negative_corr_data, color='red', ci=None)
plt.title('–ù–µ–≥–∞—Ç–∏–≤–Ω–∞ –∫–æ—Ä–µ–ª—è—Ü—ñ—è')

# No Correlation
plt.subplot(133)
sns.regplot(x='x', y='y', data=no_corr_data, color='green', ci=None)
plt.title('–í—ñ–¥—Å—É—Ç–Ω—è –∫–æ—Ä–µ–ª—è—Ü—ñ—è')

plt.tight_layout()
plt.show()
```

## –ö–æ–≤–∞—Ä—ñ–∞—Ü—ñ—è {.smaller}

[–ö–æ–≤–∞—Ä—ñ–∞—Ü—ñ—è]{.hi} - —Ü–µ –º—ñ—Ä–∞ –≤–∑–∞—î–º–æ–∑–≤'—è–∑–∫—É –º—ñ–∂ –¥–≤–æ–º–∞ –∑–º—ñ–Ω–Ω–∏–º–∏, —è–∫–∞ –≤–∏–∑–Ω–∞—á–∞—î—Ç—å—Å—è —è–∫ –æ—á—ñ–∫—É–≤–∞–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è –¥–æ–±—É—Ç–∫—É –≤—ñ–¥—Ö–∏–ª–µ–Ω—å –≤—ñ–¥ —Å–µ—Ä–µ–¥–Ω—ñ—Ö –∑–Ω–∞—á–µ–Ω—å.

–ü—Ä–∏–ø—É—Å—Ç–∏–º–æ, –Ω–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ —Ä–æ–∑—Ä–∞—Ö—É–≤–∞—Ç–∏ –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –∫–æ—Ä–µ–ª—è—Ü—ñ—ó –¥–ª—è –¥–≤–æ—Ö –∫—ñ–ª—å–∫—ñ—Å–Ω–∏—Ö –≤–µ–ª–∏—á–∏–Ω $X$ —ñ $Y$. –í—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ, —Å–µ—Ä–µ–¥–Ω—î –∑–∞ –≤–∏–±—ñ—Ä–∫–æ—é –¥–ª—è –∫–æ–∂–Ω–æ—ó –∑ —Ü–∏—Ö –≤–µ–ª–∏—á–∏–Ω –±—É–¥–µ $\bar{X}$ —ñ $\bar{Y}$. –¢–æ–¥—ñ –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –∫–æ–≤–∞—Ä—ñ–∞—Ü—ñ—ó:

$$ \text{cov}(X, Y) = \frac{\sum_{i=1}^{n} (X_i - \bar{X})(Y_i - \bar{Y})}{N-1}  $$

–¥–µ  $N$ - –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω—å —É –≤–∏–±—ñ—Ä—Ü—ñ;<br>
    $X_i$ - –∑–Ω–∞—á–µ–Ω–Ω—è $X$ –¥–ª—è $i$-–≥–æ —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è;<br>
    $Y_i$ - –∑–Ω–∞—á–µ–Ω–Ω—è $Y$ –¥–ª—è $i$-–≥–æ —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è;

. . .

::: {.callout-important}
–ö–æ–≤–∞—Ä—ñ–∞—Ü—ñ—è –∑–º—ñ–Ω—é—î—Ç—å—Å—è –≤ –¥–æ–≤—ñ–ª—å–Ω–æ–º—É —Ä–æ–∑–∫–∏–¥—ñ –∑–Ω–∞—á–µ–Ω—å => —Å–∫–ª–∞–¥–Ω–æ —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç—É–≤–∞—Ç–∏ —Å–∏–ª—É –≤–∑–∞—î–º–æ–∑–≤'—è–∑–∫—É.
:::

## –ö–æ—Ä–µ–ª—è—Ü—ñ—è {.smaller}

[–ö–æ—Ä–µ–ª—è—Ü—ñ—è]{.hi} - —Ü–µ –Ω–æ—Ä–º–∞–ª—ñ–∑–æ–≤–∞–Ω–∞ –º—ñ—Ä–∞ –≤–∑–∞—î–º–æ–∑–≤'—è–∑–∫—É –º—ñ–∂ –¥–≤–æ–º–∞ –∑–º—ñ–Ω–Ω–∏–º–∏, —è–∫–∞ –≤–∏–∑–Ω–∞—á–∞—î—Ç—å—Å—è —è–∫ –∫–æ–≤–∞—Ä—ñ–∞—Ü—ñ—è, –ø–æ–¥—ñ–ª–µ–Ω–∞ –Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–µ –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è –∫–æ–∂–Ω–æ—ó –∑–º—ñ–Ω–Ω–æ—ó.

$$ \text{corr}(X, Y) = \frac{\text{cov}(X, Y)}{\sigma_X \sigma_Y} $$

–¥–µ $\sigma_X$ - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–µ –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è $X$;<br>
    $\sigma_Y$ - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–µ –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è $Y$.

. . .

::: {.callout-important}
–ö–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –∫–æ—Ä–µ–ª—è—Ü—ñ—ó –∑–∞–≤–∂–¥–∏ –ª–µ–∂–∏—Ç—å –≤ –¥—ñ–∞–ø–∞–∑–æ–Ω—ñ $[-1, 1]$.
:::

## –ö–æ—Ä–µ–ª—è—Ü—ñ—è

–Ü–Ω–æ–¥—ñ –º–æ–∂–Ω–∞ –∑—É—Å—Ç—Ä—ñ—Ç–∏ —Ç–∞–∫—É —Ñ–æ—Ä–º—É–ª—É –¥–ª—è –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç–∞ –∫–æ—Ä–µ–ª—è—Ü—ñ—ó:

$$
r_{xy} = \frac{\sum{(x_i - \bar{x})(y_i - \bar{y})}}{\sqrt{\sum{(x_i - \bar{x})^2} \sum{(y_i - \bar{y})^2}}}
$$

–£ –ø—ñ–¥—Ä—É—á–Ω–∏–∫–∞—Ö –∑—ñ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —á–∞—Å—Ç–æ –∑—É—Å—Ç—Ä—ñ—á–∞—î—Ç—å—Å—è —Ç–µ—Ä–º—ñ–Ω [–∫–æ—Ä–µ–ª—è—Ü—ñ–π–Ω–∏–π –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –ü—ñ—Ä—Å–æ–Ω–∞]{.hi}, —è–∫–∏–π —î —á–∞—Å—Ç–Ω–∏–º –≤–∏–ø–∞–¥–∫–æ–º –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç–∞ –∫–æ—Ä–µ–ª—è—Ü—ñ—ó. –¶–µ —Ç–æ–π —Å–∞–º–∏–π –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –∫–æ—Ä–µ–ª—è—Ü—ñ—ó, —è–∫–∏–π –º–∏ —Ä–æ–∑–≥–ª—è–¥–∞—î–º–æ –≤ —Ü—å–æ–º—É –∫—É—Ä—Å—ñ.

::: footer
–î–æ–¥–∞—Ç–æ–∫, –¥–µ –º–æ–∂–Ω–∞ –ø–æ–≥—Ä–∞—Ç–∏—Å—è –∑ –∫–æ—Ä–µ–ª—è—Ü—ñ—î—é: üîó[Interpreting Correlations](https://rpsychologist.com/correlation/)
:::

## –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≥—ñ–ø–æ—Ç–µ–∑–∏ –ø—Ä–æ –∫–æ—Ä–µ–ª—è—Ü—ñ—é {.smaller}

–Ü–¥–µ—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –≥—ñ–ø–æ—Ç–µ–∑–∏ –ø—Ä–æ –∫–æ—Ä–µ–ª—è—Ü—ñ—é –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, —â–æ –º–∏ –ø–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ –≤—ñ–¥—Ä—ñ–∑–Ω—è—î—Ç—å—Å—è –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –∫–æ—Ä–µ–ª—è—Ü—ñ—ó –≤—ñ–¥ –Ω—É–ª—è. –Ø–∫—â–æ –Ω—É–ª—å–æ–≤–∞ –≥—ñ–ø–æ—Ç–µ–∑–∞ –≤—ñ–¥—Ö–∏–ª—è—î—Ç—å—Å—è, —Ç–æ –º–∏ –º–æ–∂–µ–º–æ —Å—Ç–≤–µ—Ä–¥–∂—É–≤–∞—Ç–∏, —â–æ –º—ñ–∂ –∑–º—ñ–Ω–Ω–∏–º–∏ —ñ—Å–Ω—É—î –≤–∑–∞—î–º–æ–∑–≤'—è–∑–æ–∫.

–û—Å–Ω–æ–≤–Ω–∞ –≥—ñ–ø–æ—Ç–µ–∑–∞: $H_0: r = 0$<br>
–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞ –≥—ñ–ø–æ—Ç–µ–∑–∞: $H_1: r \neq 0$

–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫—Ä–∏—Ç–µ—Ä—ñ—é:

$$
t = \frac{r \sqrt{n-2}}{\sqrt{1 - r^2}}
$$

–¥–µ $r$ - –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –∫–æ—Ä–µ–ª—è—Ü—ñ—ó –ü—ñ—Ä—Å–æ–Ω–∞;<br>
    $n$ - –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω—å —É –≤–∏–±—ñ—Ä—Ü—ñ.

. . .

::: {.callout-important}
–ö—Ä–∏—Ç–∏—á–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è –∫—Ä–∏—Ç–µ—Ä—ñ—é –°—Ç—å—é–¥–µ–Ω—Ç–∞ –¥–ª—è —Ä—ñ–≤–Ω—è –∑–Ω–∞—á—É—â–æ—Å—Ç—ñ $\alpha = 0.05$ —ñ $n-2$ —Å—Ç—É–ø–µ–Ω—ñ–≤ —Å–≤–æ–±–æ–¥–∏: $t_{\alpha/2, n-2} = 2.045$

–Ø–∫—â–æ $|t| > t_{\alpha/2, n-2}$, —Ç–æ –Ω—É–ª—å–æ–≤—É –≥—ñ–ø–æ—Ç–µ–∑—É –≤—ñ–¥—Ö–∏–ª—è—é—Ç—å.
:::

## –£–º–æ–≤–∏ –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è –∫—Ä–∏—Ç–µ—Ä—ñ—é –°—Ç—å—é–¥–µ–Ω—Ç–∞ {.smaller}

1.  –í–∑–∞—î–º–æ–∑–≤'—è–∑–æ–∫ –º—ñ–∂ –∑–º—ñ–Ω–Ω–∏–º–∏ –º–∞—î –±—É—Ç–∏ –ª—ñ–Ω—ñ–π–Ω–∏–º —ñ –º–æ–Ω–æ—Ç–æ–Ω–Ω–∏–º (–∑—Ä–æ—Å—Ç–∞—î –∞–±–æ —Å–ø–∞–¥–∞—î —É –æ–¥–Ω–æ–º—É –Ω–∞–ø—Ä—è–º–∫—É).
2.  –í—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –≤–∏–∫–∏–¥—ñ–≤
3.  –ù–æ—Ä–º–∞–ª—å–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª –∑–º—ñ–Ω–Ω–∏—Ö

–£ —Ä–∞–∑—ñ –ø–æ—Ä—É—à–µ–Ω–Ω—è —Ü–∏—Ö –ø—Ä–∏–ø—É—â–µ–Ω—å –º–æ–∂—É—Ç—å –±—É—Ç–∏ –∫–æ—Ä–∏—Å–Ω–∏–º–∏ –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç–∏ –∫–æ—Ä–µ–ª—è—Ü—ñ—ó –°–ø—ñ—Ä–º–µ–Ω–∞ —ñ –ö–µ–Ω–¥–∞–ª–ª–∞, —è–∫—ñ –∑–∞–º—ñ—Å—Ç—å —Ä–µ–∞–ª—å–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å –∞–Ω–∞–ª—ñ–∑—É—é—Ç—å —ó—Ö–Ω—ñ —Ä–∞–Ω–≥–∏.

::: {.callout-note}
–ù—ñ —Ç–µ, –Ω—ñ —ñ–Ω—à–µ –Ω–µ —î –ø–∞–Ω–∞—Ü–µ—î—é, —ñ –∑–∞ –æ—Å–æ–±–ª–∏–≤–æ —Å–∏–ª—å–Ω–∏—Ö –ø–æ—Ä—É—à–µ–Ω—å –ø—Ä–∏–ø—É—â–µ–Ω—å (–æ—Å–æ–±–ª–∏–≤–æ –ø–µ—Ä—à–æ–≥–æ) –≤–æ–Ω–∏ —Ç–∞–∫–æ–∂ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –Ω–µ–∞–¥–µ–∫–≤–∞—Ç–Ω–∏–º–∏. –£–≤–∞–∂–Ω–æ –≤–∏–≤—á–∞–π—Ç–µ —Å–≤–æ—ó –¥–∞–Ω—ñ —Ç–∞ —ó—Ö–Ω—ñ–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä!
:::

## –ö–≤–∞—Ä—Ç–µ—Ä –ï–Ω—Å–∫–æ–º–±–∞ {.smaller}

–û–¥–∏–Ω —ñ–∑ –∫–ª–∞—Å–∏—á–Ω–∏—Ö –ø—Ä–∏–∫–ª–∞–¥—ñ–≤ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ—Å—Ç—ñ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –ø—Ä–∏–ø—É—â–µ–Ω—å (—ñ –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—ó –¥–∞–Ω–∏—Ö –ø–µ—Ä–µ–¥ –∞–Ω–∞–ª—ñ–∑–æ–º) - [–∫–≤–∞—Ä—Ç–µ—Ç –ï–Ω—Å–∫–æ–º–±–∞]{.hi}. 

–£ –≤—Å—ñ—Ö —á–æ—Ç–∏—Ä—å–æ—Ö –Ω–∞–±–æ—Ä—ñ–≤ –¥–∞–Ω–∏—Ö –æ–¥–Ω–∞–∫–æ–≤–∏–π –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –∫–æ—Ä–µ–ª—è—Ü—ñ—ó –ü—ñ—Ä—Å–æ–Ω–∞, —Ö–æ—á–∞ —ó—Ö–Ω—ñ–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä –æ—á–µ–≤–∏–¥–Ω–æ —Ä—ñ–∑–Ω–∏–π.

```{python}
#| label: anscombe
#| echo: false

# Load the data
anscombe = sns.load_dataset('anscombe')

# Plot the data
# plt.figure(figsize=(15, 4))

# First dataset
plt.subplot(141)
sns.regplot(x='x', y='y', data=anscombe.loc[anscombe['dataset'] == 'I'], color='#447099', ci=None)
plt.title('–ù–∞–±—ñ—Ä –¥–∞–Ω–∏—Ö I')

# Second dataset

plt.subplot(142)
sns.regplot(x='x', y='y', data=anscombe.loc[anscombe['dataset'] == 'II'], color='#C10000', ci=None)
plt.title('–ù–∞–±—ñ—Ä –¥–∞–Ω–∏—Ö II')

# Third dataset
plt.subplot(143)
sns.regplot(x='x', y='y', data=anscombe.loc[anscombe['dataset'] == 'III'], color='#00891A', ci=None)
plt.title('–ù–∞–±—ñ—Ä –¥–∞–Ω–∏—Ö III')

# Fourth dataset
plt.subplot(144)
sns.regplot(x='x', y='y', data=anscombe.loc[anscombe['dataset'] == 'IV'], color='#f45100', ci=None)
plt.title('–ù–∞–±—ñ—Ä –¥–∞–Ω–∏—Ö IV')

plt.tight_layout()
plt.show()
```

## Datasaurus Dozen {.smaller}

–©–µ –æ–¥–∏–Ω –∫–ª–∞—Å–∏—á–Ω–∏–π –ø—Ä–∏–∫–ª–∞–¥ - [Datasaurus Dozen]{.hi}.

–£ –≤—Å—ñ—Ö –¥–∞–Ω–∏—Ö –æ–¥–Ω–∞–∫–æ–≤–∏–π –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –∫–æ—Ä–µ–ª—è—Ü—ñ—ó –ü—ñ—Ä—Å–æ–Ω–∞, —Ö–æ—á–∞ —ó—Ö–Ω—ñ–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä –æ—á–µ–≤–∏–¥–Ω–æ —Ä—ñ–∑–Ω–∏–π.

```{python}
#| label: datasaurus
#| echo: false

# Load the data
datasaurus = pd.read_csv('https://raw.githubusercontent.com/Aranaur/aranaur.rbind.io/main/datasets/datasaurus/datasaurus.csv')

# Plot the data
# plt.figure(figsize=(15, 4))

# First dataset
plt.subplot(131)
sns.regplot(x='x', y='y', data=datasaurus.loc[datasaurus['dataset'] == 'dino'], color='#447099', ci=None)
plt.title('–î–∏–Ω–æ–∑–∞–≤—Ä')

# Second dataset
plt.subplot(132)
sns.regplot(x='x', y='y', data=datasaurus.loc[datasaurus['dataset'] == 'star'], color='#C10000', ci=None)
plt.title('–ó—ñ—Ä–∫–∞')

# Third dataset
plt.subplot(133)
sns.regplot(x='x', y='y', data=datasaurus.loc[datasaurus['dataset'] == 'h_lines'], color='#00891A', ci=None)
plt.title('–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ñ –ª—ñ–Ω—ñ—ó')

plt.tight_layout()
plt.show()
```

## –ö–æ—Ä–µ–ª—è—Ü—ñ—è –≤ Python {.smaller}

```{python}
#| label: vgsales

vgsales = pd.read_csv("https://raw.githubusercontent.com/Aranaur/aranaur.rbind.io/main/datasets/video_games_sales/vgsales.csv")

vgsales.head()
```

::: {.panel-tabset}

### NumPy

```{python}
#| label: corr-np

import numpy as np

np_corr_p = np.corrcoef(vgsales['NA_Sales'], vgsales['Global_Sales'])[0, 1]
print(f'–ö–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –∫–æ—Ä–µ–ª—è—Ü—ñ—ó: {np_corr_p:.3f}')
```

### SciPy

```{python}
#| label: corr-scipy

import scipy.stats as st

st_corr_p = st.pearsonr(vgsales['NA_Sales'], vgsales['Global_Sales'])
st_corr_s = st.spearmanr(vgsales['NA_Sales'], vgsales['Global_Sales'])
st_corr_k = st.kendalltau(vgsales['NA_Sales'], vgsales['Global_Sales'])

print(f'–ö–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –∫–æ—Ä–µ–ª—è—Ü—ñ—ó –ü—ñ—Ä—Å–æ–Ω–∞: {st_corr_p[0]:.3f} (p-value: {st_corr_p[1]:.3f})')
print(f'–ö–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –∫–æ—Ä–µ–ª—è—Ü—ñ—ó –°–ø—ñ—Ä–º–µ–Ω–∞: {st_corr_s[0]:.3f} (p-value: {st_corr_s[1]:.3f})')
print(f'–ö–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –∫–æ—Ä–µ–ª—è—Ü—ñ—ó –ö–µ–Ω–¥–∞–ª–ª–∞: {st_corr_k[0]:.3f} (p-value: {st_corr_k[1]:.3f})')
```

### Pandas

```{python}
#| label: corr-pandas

import pandas as pd

pd_corr_p = vgsales[['NA_Sales', 'Global_Sales']].corr(method='pearson').iloc[0, 1]
pd_corr_s = vgsales[['NA_Sales', 'Global_Sales']].corr(method='spearman').iloc[0, 1]
pd_corr_k = vgsales[['NA_Sales', 'Global_Sales']].corr(method='kendall').iloc[0, 1]

print(f'–ö–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –∫–æ—Ä–µ–ª—è—Ü—ñ—ó –ü—ñ—Ä—Å–æ–Ω–∞: {pd_corr_p:.3f}')
print(f'–ö–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –∫–æ—Ä–µ–ª—è—Ü—ñ—ó –°–ø—ñ—Ä–º–µ–Ω–∞: {pd_corr_s:.3f}')
print(f'–ö–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –∫–æ—Ä–µ–ª—è—Ü—ñ—ó –ö–µ–Ω–¥–∞–ª–ª–∞: {pd_corr_k:.3f}')
```

:::

## Maximal Information-based Nonparametric Exploration

[Maximal Information-based Nonparametric Exploration (MINE)]{.hi} - —Ü–µ –∞–ª–≥–æ—Ä–∏—Ç–º, —è–∫–∏–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è –Ω–µ–ª—ñ–Ω—ñ–π–Ω–∏—Ö –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π –º—ñ–∂ –∑–º—ñ–Ω–Ω–∏–º–∏.

![](img/mic.jpg){fig-align="center"}

::: footer
üîó[minepy - Maximal Information-based Nonparametric Exploration](https://minepy.readthedocs.io/en/latest/)
:::

# –ì–µ–Ω–µ—Ä–∞–ª—å–Ω–∞ —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å —ñ –≤–∏–±—ñ—Ä–∫–∞ {background-color="#eef3f8"}

## –ì–µ–Ω–µ—Ä–∞–ª—å–Ω–∞ —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å —ñ –≤–∏–±—ñ—Ä–∫–∞ {.smaller}

[–ì–µ–Ω–µ—Ä–∞–ª—å–Ω–∞ —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å]{.hi} - —Ü–µ —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å –≤—Å—ñ—Ö –æ–±'—î–∫—Ç—ñ–≤, —è–∫—ñ –º–∏ –≤–∏–≤—á–∞—î–º–æ.

[–í–∏–±—ñ—Ä–∫–∞]{.hi} - —Ü–µ –ø—ñ–¥–º–Ω–æ–∂–∏–Ω–∞ –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ—ó —Å—É–∫—É–ø–Ω–æ—Å—Ç—ñ, —è–∫–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ –≥–µ–Ω–µ—Ä–∞–ª—å–Ω—É —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å.

. . .

–ú–∏ –∑–∞–ø–∏—à–µ–º–æ [–ø—Ä–æ—Å—Ç—É]{.hi} –º–æ–¥–µ–ª—å –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ—ó —Å—É–∫—É–ø–Ω–æ—Å—Ç—ñ

$$ y_i = \beta_0 + \beta_1 x_i + u_i $$

–¥–µ $y_i$ - –∑–∞–ª–µ–∂–Ω–∞ –∑–º—ñ–Ω–Ω–∞;<br>
    $x_i$ - –Ω–µ–∑–∞–ª–µ–∂–Ω–∞ –∑–º—ñ–Ω–Ω–∞;<br>
    $\beta_0$ - –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞ (–ø–µ—Ä–µ—Ö–æ–ø–ª–µ–Ω–Ω—è);<br>
    $\beta_1$ - –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç —Ä–µ–≥—Ä–µ—Å—ñ—ó;<br>
    $u_i$ - –ø–æ–º–∏–ª–∫–∞ (–≤–∏–ø–∞–¥–∫–æ–≤–∞ —Å–∫–ª–∞–¥–æ–≤–∞).

. . .

–¢–æ–¥—ñ –Ω–∞—à–∞ [–º–æ–¥–µ–ª—å —Ä–µ–≥—Ä–µ—Å—ñ—ó]{.hi} –Ω–∞ –æ—Å–Ω–æ–≤—ñ –≤–∏–±—ñ—Ä–∫–∏:

$$ y_i = \hat{\beta}_0 + \hat{\beta}_1 x_i + e_i $$

–¥–µ $e_i$ - –ø–æ–º–∏–ª–∫–∞ –æ—Ü—ñ–Ω–∫–∏.

## –ì–µ–Ω–µ—Ä–∞–ª—å–Ω–∞ —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å —ñ –≤–∏–±—ñ—Ä–∫–∞ {.smaller}

–†–æ–∑—Ä–∞—Ö—É–Ω–∫–æ–≤–∞ —Ä–µ–≥—Ä–µ—Å—ñ–π–Ω–∞ –º–æ–¥–µ–ª—å –¥–∞—î [–æ—Ü—ñ–Ω–∫–∏]{.hi} –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è:

$$ \hat{y}_i = \hat{\beta}_0 + \hat{\beta}_1 x_i $$

–¥–µ $\hat{y}_i$ - –ø—Ä–æ–≥–Ω–æ–∑–æ–≤–∞–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—ó –∑–º—ñ–Ω–Ω–æ—ó.

—â–æ –¥–∞—î –Ω–∞–º _–Ω–∞–π–∫—Ä–∞—â—É_ –ª—ñ–Ω—ñ—é –≤ –Ω–∞—à–æ–º—É –Ω–∞–±–æ—Ä—ñ –¥–∞–Ω–∏—Ö.

## –ì–µ–Ω–µ—Ä–∞–ª—å–Ω–∞ —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å —ñ –≤–∏–±—ñ—Ä–∫–∞ {.smaller}

```{python}
#| label: ols-gen
#| include: false

# Set population and sample sizes
n_p = 100
n_s = 30

np.random.seed(42)

# Function to generate datasets with specified correlation
def generate_dataset(correlation):
    mean = [0, 0]
    cov_matrix = [[1, correlation], [correlation, 1]]
    
    # Generate random data with the specified correlation
    data = np.random.multivariate_normal(mean, cov_matrix, 100)
    
    # Create a DataFrame
    df = pd.DataFrame(data, columns=['x', 'y'])
    
    return df

# Generate datasets with positive, negative, and no correlation
pop_df = generate_dataset(0.8)

pop_df['row'] = np.repeat(np.arange(1, np.sqrt(n_p) + 1), np.sqrt(n_p))
pop_df['col'] = np.tile(np.arange(1, int(np.sqrt(n_p)) + 1), int(np.sqrt(n_p)))
pop_df['s1'] = np.random.choice([True, False], size=n_p, p=[n_s / n_p, (n_p - n_s) / n_p])
pop_df['s2'] = np.random.choice([True, False], size=n_p, p=[n_s / n_p, (n_p - n_s) / n_p])
pop_df['s3'] = np.random.choice([True, False], size=n_p, p=[n_s / n_p, (n_p - n_s) / n_p])

# Regressions
lm0 = sm.OLS(pop_df['y'], sm.add_constant(pop_df['x'])).fit()
lm1 = sm.OLS(pop_df.loc[pop_df['s1'], 'y'], sm.add_constant(pop_df.loc[pop_df['s1'], 'x'])).fit()
lm2 = sm.OLS(pop_df.loc[pop_df['s2'], 'y'], sm.add_constant(pop_df.loc[pop_df['s2'], 'x'])).fit()
lm3 = sm.OLS(pop_df.loc[pop_df['s3'], 'y'], sm.add_constant(pop_df.loc[pop_df['s3'], 'x'])).fit()
```

**–ü–∏—Ç–∞–Ω–Ω—è:** –ß–æ–º—É –º–∏ —Å–ø—ñ–≤—Å—Ç–∞–≤–ª—è—î–º–æ *–≥–µ–Ω–µ—Ä–∞–ª—å–Ω—É —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å —ñ –≤–∏–±—ñ—Ä–∫—É*?

. . .

:::: {.columns}

::: {.column}

```{python}
#| label: pop1
#| echo: false

# plt.figure(figsize=(5, 3))
plt.scatter(pop_df['row'], pop_df['col'], color='darkslategray', s=100)

plt.tick_params(axis='both', labelsize=0, length = 0)
plt.box(False)
plt.grid(None)

# Display the plot
plt.show()
```

**–ì–µ–Ω–µ—Ä–∞–ª—å–Ω–∞ —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å**

:::

::: {.column}
```{python}
#| label: scatter1
#| echo: false

# plt.figure(figsize=(5, 3))
plt.scatter(pop_df['x'], pop_df['y'], color='darkslategray', s=60)
plt.axline((0, lm0.params[0]), slope=lm0.params[1], color=red_pink, linewidth=2)
plt.box(False)
plt.grid(None)

plt.show()
```

**–ó–≤'—è–∑–æ–∫ —É –≥–µ–Ω–µ—Ä–∞–ª—å–Ω—ñ–π —Å—É–∫—É–ø–Ω–æ—Å—Ç—ñ**

```{python}
#| label: formula1
#| echo: false

Markdown(f"""
$$ y_i = {round(lm0.params[0], 2)} + {round(lm0.params[1], 2)} x_i + u_i $$
$$ y_i = \\beta_0 + \\beta_1 x_i + u_i $$
""")
```

:::

::::

## –ì–µ–Ω–µ—Ä–∞–ª—å–Ω–∞ —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å —ñ –≤–∏–±—ñ—Ä–∫–∞ {.smaller}

**–ü–∏—Ç–∞–Ω–Ω—è:** –ß–æ–º—É –º–∏ —Å–ø—ñ–≤—Å—Ç–∞–≤–ª—è—î–º–æ *–≥–µ–Ω–µ—Ä–∞–ª—å–Ω—É —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å —ñ –≤–∏–±—ñ—Ä–∫—É*?

:::: {.columns}

::: {.column}

```{python}
#| label: sample1
#| echo: false

# plt.figure(figsize=(5, 3))
plt.scatter(pop_df.loc[pop_df['s1'], 'row'], pop_df.loc[pop_df['s1'], 'col'], color='darkslategray', s=100, marker='o')
plt.scatter(pop_df.loc[~pop_df['s1'], 'row'], pop_df.loc[~pop_df['s1'], 'col'], facecolors='none', s=100, edgecolors='darkslategray', alpha=0.3)


plt.tick_params(axis='both', labelsize=0, length = 0)
plt.box(False)
plt.grid(None)

# Display the plot
plt.show()
```

**–ì–µ–Ω–µ—Ä–∞–ª—å–Ω–∞ —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å**

:::

::: {.column}
```{python}
#| label: sample1-scatter
#| echo: false

# plt.figure(figsize=(5, 3))
plt.scatter(pop_df.loc[pop_df['s1'], 'x'], pop_df.loc[pop_df['s1'], 'y'], color='darkslategray', s=60)
plt.scatter(pop_df.loc[~pop_df['s1'], 'x'], pop_df.loc[~pop_df['s1'], 'y'], facecolors='none', s=60, edgecolors='darkslategray', alpha=0.3)
plt.axline((0, lm0.params[0]), slope=lm0.params[1], color=red_pink, linewidth=2, alpha=0.3)
plt.axline((0, lm1.params[0]), slope=lm1.params[1], linestyle='dashed', color='black', linewidth=2)
plt.box(False)
plt.grid(None)

plt.show()
```

**–ó–≤'—è–∑–æ–∫ —É –≥–µ–Ω–µ—Ä–∞–ª—å–Ω—ñ–π —Å—É–∫—É–ø–Ω–æ—Å—Ç—ñ**

```{python}
#| label: formula2
#| echo: false

Markdown(f"""
$$ y_i = {round(lm0.params[0], 2)} + {round(lm0.params[1], 2)} x_i + u_i $$
""")
```

**–ó–≤'—è–∑–æ–∫ —É –≤–∏–±—ñ—Ä—Ü—ñ**

```{python}
#| label: formula3
#| echo: false

Markdown(f"""
$$ \\hat{{y_i}} = {round(lm1.params[0], 2)} + {round(lm1.params[1], 2)} x_i $$
""")
```

:::

::::

## –ì–µ–Ω–µ—Ä–∞–ª—å–Ω–∞ —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å —ñ –≤–∏–±—ñ—Ä–∫–∞ {.smaller}

**–ü–∏—Ç–∞–Ω–Ω—è:** –ß–æ–º—É –º–∏ —Å–ø—ñ–≤—Å—Ç–∞–≤–ª—è—î–º–æ *–≥–µ–Ω–µ—Ä–∞–ª—å–Ω—É —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å —ñ –≤–∏–±—ñ—Ä–∫—É*?

:::: {.columns}

::: {.column}

```{python}
#| label: sample2
#| echo: false

# plt.figure(figsize=(5, 3))
plt.scatter(pop_df.loc[pop_df['s2'], 'row'], pop_df.loc[pop_df['s2'], 'col'], color='darkslategray', s=100, marker='o')
plt.scatter(pop_df.loc[~pop_df['s2'], 'row'], pop_df.loc[~pop_df['s2'], 'col'], facecolors='none', s=100, edgecolors='darkslategray', alpha=0.3)


plt.tick_params(axis='both', labelsize=0, length = 0)
plt.box(False)
plt.grid(None)

# Display the plot
plt.show()
```

**–ì–µ–Ω–µ—Ä–∞–ª—å–Ω–∞ —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å**

:::

::: {.column}
```{python}
#| label: sample2-scatter
#| echo: false

# plt.figure(figsize=(5, 3))
plt.scatter(pop_df.loc[pop_df['s2'], 'x'], pop_df.loc[pop_df['s2'], 'y'], color='darkslategray', s=60)
plt.scatter(pop_df.loc[~pop_df['s2'], 'x'], pop_df.loc[~pop_df['s2'], 'y'], facecolors='none', s=60, edgecolors='darkslategray', alpha=0.3)
plt.axline((0, lm0.params[0]), slope=lm0.params[1], color=red_pink, linewidth=2, alpha=0.3)
plt.axline((0, lm1.params[0]), slope=lm1.params[1], linestyle='dashed', color='black', linewidth=2, alpha=0.3)
plt.axline((0, lm2.params[0]), slope=lm2.params[1], linestyle='dashed', color='black', linewidth=2)
plt.box(False)
plt.grid(None)

plt.show()
```

**–ó–≤'—è–∑–æ–∫ —É –≥–µ–Ω–µ—Ä–∞–ª—å–Ω—ñ–π —Å—É–∫—É–ø–Ω–æ—Å—Ç—ñ**

```{python}
#| label: formula4
#| echo: false

Markdown(f"""
$$ y_i = {round(lm0.params[0], 2)} + {round(lm0.params[1], 2)} x_i + u_i $$
""")
```

**–ó–≤'—è–∑–æ–∫ —É –≤–∏–±—ñ—Ä—Ü—ñ**

```{python}
#| label: formula5
#| echo: false

Markdown(f"""
$$ \\hat{{y_i}} = {round(lm2.params[0], 2)} + {round(lm2.params[1], 2)} x_i $$
""")
```

:::

::::

## –ì–µ–Ω–µ—Ä–∞–ª—å–Ω–∞ —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å —ñ –≤–∏–±—ñ—Ä–∫–∞ {.smaller}

**–ü–∏—Ç–∞–Ω–Ω—è:** –ß–æ–º—É –º–∏ —Å–ø—ñ–≤—Å—Ç–∞–≤–ª—è—î–º–æ *–≥–µ–Ω–µ—Ä–∞–ª—å–Ω—É —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å —ñ –≤–∏–±—ñ—Ä–∫—É*?

:::: {.columns}

::: {.column}

```{python}
#| label: sample3
#| echo: false

# plt.figure(figsize=(5, 3))
plt.scatter(pop_df.loc[pop_df['s2'], 'row'], pop_df.loc[pop_df['s2'], 'col'], color='darkslategray', s=100, marker='o')
plt.scatter(pop_df.loc[~pop_df['s2'], 'row'], pop_df.loc[~pop_df['s2'], 'col'], facecolors='none', s=100, edgecolors='darkslategray', alpha=0.3)


plt.tick_params(axis='both', labelsize=0, length = 0)
plt.box(False)
plt.grid(None)

# Display the plot
plt.show()
```

**–ì–µ–Ω–µ—Ä–∞–ª—å–Ω–∞ —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å**

:::

::: {.column}
```{python}
#| label: sample3-scatter
#| echo: false

# plt.figure(figsize=(5, 3))
plt.scatter(pop_df.loc[pop_df['s3'], 'x'], pop_df.loc[pop_df['s3'], 'y'], color='darkslategray', s=60)
plt.scatter(pop_df.loc[~pop_df['s3'], 'x'], pop_df.loc[~pop_df['s3'], 'y'], facecolors='none', s=60, edgecolors='darkslategray', alpha=0.3)
plt.axline((0, lm0.params[0]), slope=lm0.params[1], color=red_pink, linewidth=2, alpha=0.3)
plt.axline((0, lm1.params[0]), slope=lm1.params[1], linestyle='dashed', color='black', linewidth=2, alpha=0.3)
plt.axline((0, lm2.params[0]), slope=lm2.params[1], linestyle='dashed', color='black', linewidth=2, alpha=0.3)
plt.axline((0, lm3.params[0]), slope=lm3.params[1], linestyle='dashed', color='black', linewidth=2)
plt.box(False)
plt.grid(None)

plt.show()
```

**–ó–≤'—è–∑–æ–∫ —É –≥–µ–Ω–µ—Ä–∞–ª—å–Ω—ñ–π —Å—É–∫—É–ø–Ω–æ—Å—Ç—ñ**

```{python}
#| label: formula6
#| echo: false

Markdown(f"""
$$ y_i = {round(lm0.params[0], 2)} + {round(lm0.params[1], 2)} x_i + u_i $$
""")
```

**–ó–≤'—è–∑–æ–∫ —É –≤–∏–±—ñ—Ä—Ü—ñ**

```{python}
#| label: formula7
#| echo: false

Markdown(f"""
$$ \\hat{{y_i}} = {round(lm3.params[0], 2)} + {round(lm3.params[1], 2)} x_i $$
""")
```

:::

::::

---

–î–∞–≤–∞–π—Ç–µ –ø–æ–≤—Ç–æ—Ä–∏–º–æ —Ü–µ **10 000 —Ä–∞–∑—ñ–≤**.

–¶—è –Ω–∞–∑–∏–≤–∞—î—Ç—å—Å—è –º–æ–¥–µ–ª—é–≤–∞–Ω–Ω—è–º (–ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ).

---

## –ì–µ–Ω–µ—Ä–∞–ª—å–Ω–∞ —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å —ñ –≤–∏–±—ñ—Ä–∫–∞

```{python}
#| label: gen-dataset-2
#| include: false

# Simulation
np.random.seed(12468)

# Function to fit linear regression and return tidy summary
def fit_linear_regression(size):
    sampled_data = pop_df.sample(n=size)
    model = sm.OLS(sampled_data['y'], sm.add_constant(sampled_data['x'])).fit()
    return model.params

# Perform linear regression simulations and concatenate results
sim_results = [fit_linear_regression(size=n_s) for _ in range(int(1e4))]
sim_df = pd.concat([pd.DataFrame(result) for result in sim_results], ignore_index=True, axis=1).T

# Display the result
print(sim_df)
```

```{python}
#| label: gen-dataset-2-plot
#| echo: false
#| fig-dpi: 300

# plt.figure(figsize=(10, 6))

for intercept, slope in zip(sim_df['const'], sim_df['x']):
    plt.axline((0, intercept), slope=slope, color='black', linewidth=0.1, alpha=0.1)

plt.scatter(pop_df['x'], pop_df['y'], color='darkslategray', s=60)
plt.axline((0, lm0.params[0]), slope=lm0.params[1], color=red_pink, linewidth=2)

plt.box(False)
plt.grid(None)

plt.show()
```

## –ì–µ–Ω–µ—Ä–∞–ª—å–Ω–∞ —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å —ñ –≤–∏–±—ñ—Ä–∫–∞

**–ü–∏—Ç–∞–Ω–Ω—è:** –ß–æ–º—É –º–∏ —Å–ø—ñ–≤—Å—Ç–∞–≤–ª—è—î–º–æ *–≥–µ–Ω–µ—Ä–∞–ª—å–Ω—É —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å —ñ –≤–∏–±—ñ—Ä–∫—É*?

:::: {.columns}

::: {.column}
```{python}
#| label: gen-dataset-2-plot-2
#| echo: false
#| fig-dpi: 300

# plt.figure(figsize=(10, 6))

for intercept, slope in zip(sim_df['const'], sim_df['x']):
    plt.axline((0, intercept), slope=slope, color='black', linewidth=0.1, alpha=0.1)

plt.scatter(pop_df['x'], pop_df['y'], color='darkslategray', s=60)
plt.axline((0, lm0.params[0]), slope=lm0.params[1], color=red_pink, linewidth=2)

plt.box(False)
plt.grid(None)

plt.show()
```
:::

::: {.column}
- –£ **—Å–µ—Ä–µ–¥–Ω—å–æ–º—É** –Ω–∞—à—ñ –ª—ñ–Ω—ñ—ó —Ä–µ–≥—Ä–µ—Å—ñ—ó –¥—É–∂–µ –¥–æ–±—Ä–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å –ª—ñ–Ω—ñ—ó –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ—ó —Å—É–∫—É–ø–Ω–æ—Å—Ç—ñ

- –û–¥–Ω–∞–∫ **–æ–∫—Ä–µ–º—ñ –ª—ñ–Ω—ñ—ó** (–∑—Ä–∞–∑–∫–∏) –º–æ–∂—É—Ç—å –ø—Ä–æ–º–∞—Ö–Ω—É—Ç–∏—Å—è.

- –í—ñ–¥–º—ñ–Ω–Ω–æ—Å—Ç—ñ –º—ñ–∂ –æ–∫—Ä–µ–º–∏–º–∏ –≤–∏–±—ñ—Ä–∫–∞–º–∏ —Ç–∞ –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ—é —Å—É–∫—É–ø–Ω—ñ—Å—Ç—é –ø—Ä–∏–∑–≤–æ–¥—è—Ç—å –¥–æ **–Ω–µ–≤–∏–∑–Ω–∞—á–µ–Ω–æ—Å—Ç—ñ**.
:::

::::

## –ì–µ–Ω–µ—Ä–∞–ª—å–Ω–∞ —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å —ñ –≤–∏–±—ñ—Ä–∫–∞

**–ü–∏—Ç–∞–Ω–Ω—è:** –ß–æ–º—É –º–∏ —Å–ø—ñ–≤—Å—Ç–∞–≤–ª—è—î–º–æ *–≥–µ–Ω–µ—Ä–∞–ª—å–Ω—É —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å —ñ –≤–∏–±—ñ—Ä–∫—É*?

**–í—ñ–¥–ø–æ–≤—ñ–¥—å:** –ù–µ–≤–∏–∑–Ω–∞—á–µ–Ω—ñ—Å—Ç—å –º–∞—î –∑–Ω–∞—á–µ–Ω–Ω—è.

$\hat{\beta}$  —Å–∞–º–∞ –ø–æ —Å–æ–±—ñ —î –≤–∏–ø–∞–¥–∫–æ–≤–æ—é –∑–º—ñ–Ω–Ω–æ—é, —è–∫–∞ –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ –≤–∏–ø–∞–¥–∫–æ–≤–æ—ó –≤–∏–±—ñ—Ä–∫–∏. –ö–æ–ª–∏ –º–∏ –±–µ—Ä–µ–º–æ –∑—Ä–∞–∑–æ–∫ —ñ –∑–∞–ø—É—Å–∫–∞—î–º–æ —Ä–µ–≥—Ä–µ—Å—ñ—é, –º–∏ –Ω–µ –∑–Ω–∞—î–º–æ, —á–∏ —Ü–µ ¬´—Ö–æ—Ä–æ—à–∏–π¬ª –∑—Ä–∞–∑–æ–∫ ($\hat{\beta}$ –±–ª–∏–∑—å–∫–∏–π –¥–æ $\beta$) —á–∏ ¬´–ø–æ–≥–∞–Ω–∏–π –∑—Ä–∞–∑–æ–∫¬ª (–Ω–∞—à –∑—Ä–∞–∑–æ–∫ —Å–∏–ª—å–Ω–æ –≤—ñ–¥—Ä—ñ–∑–Ω—è—î—Ç—å—Å—è –≤—ñ–¥ –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ—ó —Å—É–∫—É–ø–Ω–æ—Å—Ç—ñ).

# –û—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ —Ä–µ–≥—Ä–µ—Å—ñ—ó {background-color="#eef3f8"}

## –û—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ —Ä–µ–≥—Ä–µ—Å—ñ—ó {.smaller}

–ú–∏ –º–æ–∂–µ–º–æ –æ—Ü—ñ–Ω–∏—Ç–∏ –ª—ñ–Ω—ñ—é —Ä–µ–≥—Ä–µ—Å—ñ—ó –≤ Python:

`lm = sm.OLS(y, sm.add_constant(x)).fit()`

–ê–ª–µ –∑–≤—ñ–¥–∫–∏ —Ç–∞–∫—ñ –æ—Ü—ñ–Ω–∫–∏?

–ö—ñ–ª—å–∫–∞ —Å–ª–∞–π–¥—ñ–≤ –Ω–∞–∑–∞–¥:

> $$ \hat{y}_i = \hat{\beta}_0 + \hat{\beta}_1 x_i $$
> —â–æ –¥–∞—î –Ω–∞–º *–Ω–∞–π–∫—Ä–∞—â–∏–π* —Ä—è–¥–æ–∫ —á–µ—Ä–µ–∑ –Ω–∞—à –Ω–∞–±—ñ—Ä –¥–∞–Ω–∏—Ö.

–ê–ª–µ —â–æ –º–∏ –º–∞—î–º–æ –Ω–∞ —É–≤–∞–∑—ñ –ø—ñ–¥ ¬´–Ω–∞–π–∫—Ä–∞—â–æ—é –ª—ñ–Ω—ñ—î—é¬ª?

## –ë—É—Ç–∏ ¬´–Ω–∞–π–∫—Ä–∞—â–∏–º¬ª{.smaller}

**–ü–∏—Ç–∞–Ω–Ω—è:** –©–æ –º–∏ –º–∞—î–º–æ –Ω–∞ —É–≤–∞–∑—ñ –ø—ñ–¥ *–Ω–∞–π–∫—Ä–∞—â–æ—é –ª—ñ–Ω—ñ—î—é*?

**–í—ñ–¥–ø–æ–≤—ñ–¥—ñ:**

- –ó–∞–≥–∞–ª–æ–º (—É –µ–∫–æ–Ω–æ–º–µ—Ç—Ä–∏—Ü—ñ), *–Ω–∞–π–∫—Ä–∞—â–∞ –ª—ñ–Ω—ñ—è* –æ–∑–Ω–∞—á–∞—î –ª—ñ–Ω—ñ—é, —è–∫–∞ –º—ñ–Ω—ñ–º—ñ–∑—É—î —Å—É–º—É –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–∏—Ö –ø–æ–º–∏–ª–æ–∫ (ESS):

$$ \text{ESS} = \sum_{i = 1}^{n} e_i^2\quad $$

–¥–µ $\quad e_i = y_i - \hat{y}_i$

- –ó–≤–∏—á–∞–π–Ω–∏–π –º–µ—Ç–æ–¥ **–Ω–∞–π–º–µ–Ω—à–∏—Ö –∫–≤–∞–¥—Ä–∞—Ç—ñ–≤** (**OLS**) –º—ñ–Ω—ñ–º—ñ–∑—É—î —Å—É–º—É –∫–≤–∞–¥—Ä–∞—Ç—ñ–≤ –ø–æ–º–∏–ª–æ–∫.
- –ù–∞ –æ—Å–Ω–æ–≤—ñ –Ω–∏–∑–∫–∏ (–∑–¥–µ–±—ñ–ª—å—à–æ–≥–æ –ø—Ä–∏–π–Ω—è—Ç–Ω–∏—Ö) –ø—Ä–∏–ø—É—â–µ–Ω—å, OLS
   - –Ñ –Ω–µ–∑–º—ñ—â–µ–Ω–Ω–∏–º
   - –¶–µ *–Ω–∞–π–∫—Ä–∞—â–∏–π* (–º—ñ–Ω—ñ–º–∞–ª—å–Ω–∞ –¥–∏—Å–ø–µ—Ä—Å—ñ—è) –ª—ñ–Ω—ñ–π–Ω–∏–π –Ω–µ–∑–º—ñ—â–µ–Ω–∏–π –æ—Ü—ñ–Ω—é–≤–∞—á

## –ú–ù–ö {.smaller}

–î–∞–≤–∞–π—Ç–µ —Ä–æ–∑–≥–ª—è–Ω–µ–º–æ –Ω–∞–±—ñ—Ä –¥–∞–Ω–∏—Ö, —è–∫–∏–π –º–∏ –∑–≥–µ–Ω–µ—Ä—É–≤–∞–ª–∏ —Ä–∞–Ω—ñ—à–µ.

```{python}
#| label: ols-plot-1
#| echo: false

plt.scatter(pop_df['x'], pop_df['y'], color='darkslategray', s=60)
plt.box(False)
plt.grid(None)

plt.show()
```

## –ú–ù–ö {.smaller}

–î–ª—è –±—É–¥—å-—è–∫–æ—ó –ª—ñ–Ω—ñ—ó $\hat{y} = \hat{\beta}_0 + \hat{\beta}_1 x$

```{python}
#| label: ols-plot-2
#| echo: false

# Define line's parameters
b0 = 0.5
b1 = 0.2

# Create a scatter plot
plt.scatter(pop_df['x'], pop_df['y'], color='darkslategray', s=50, alpha=0.9)
plt.axline((0, b0), slope=b1, color=orange, linewidth=2)
plt.box(False)
plt.grid(None)

plt.show()
```

## –ú–ù–ö {.smaller}

–î–ª—è –±—É–¥—å-—è–∫–æ—ó –ª—ñ–Ω—ñ—ó $\hat{y} = \hat{\beta}_0 + \hat{\beta}_1 x$ –º–∏ –º–æ–∂–µ–º–æ –æ–±—á–∏—Å–ª–∏—Ç–∏ –ø–æ–º–∏–ª–∫–∏: $e_i = y_i - \hat{y}_i$

```{python}
#| label: ols-plot-3
#| echo: false

# Define line's parameters
b0 = 0.5
b1 = 0.2

pop_df['bestfit'] = b0 + b1 * pop_df['x']

# Create a scatter plot
plt.scatter(pop_df['x'], pop_df['y'], color='darkslategray', s=50, alpha=0.9)
plt.axline((0, b0), slope=b1, color=orange, linewidth=2)

for x_val, y_val, y_hat_val in zip(pop_df['x'], pop_df['y'], pop_df['bestfit']):
    plt.plot([x_val, x_val], [y_val, y_hat_val], color='darkslategray', linewidth=0.5)

plt.box(False)
plt.grid(None)

plt.show()
```

## –ú–ù–ö {.smaller}
–î–ª—è –±—É–¥—å-—è–∫–æ—ó –ª—ñ–Ω—ñ—ó $\hat{y} = \hat{\beta}_0 + \hat{\beta}_1 x$ –º–∏ –º–æ–∂–µ–º–æ –æ–±—á–∏—Å–ª–∏—Ç–∏ –ø–æ–º–∏–ª–∫–∏: $e_i = y_i - \hat{y}_i$

```{python}
#| label: ols-plot-4
#| echo: false

# Define line's parameters
b0 = 0.1
b1 = 0.2

pop_df['bestfit'] = b0 + b1 * pop_df['x']

# Create a scatter plot
plt.scatter(pop_df['x'], pop_df['y'], color='darkslategray', s=50, alpha=0.9)
plt.axline((0, b0), slope=b1, color=orange, linewidth=2)

for x_val, y_val, y_hat_val in zip(pop_df['x'], pop_df['y'], pop_df['bestfit']):
    plt.plot([x_val, x_val], [y_val, y_hat_val], color='darkslategray', linewidth=0.5)

plt.box(False)
plt.grid(None)

plt.show()
```

## –ú–ù–ö {.smaller}
–î–ª—è –±—É–¥—å-—è–∫–æ—ó –ª—ñ–Ω—ñ—ó $\hat{y} = \hat{\beta}_0 + \hat{\beta}_1 x$ –º–∏ –º–æ–∂–µ–º–æ –æ–±—á–∏—Å–ª–∏—Ç–∏ –ø–æ–º–∏–ª–∫–∏: $e_i = y_i - \hat{y}_i$

```{python}
#| label: ols-plot-5
#| echo: false

# Define line's parameters
b0 = 2
b1 = -0.8

pop_df['bestfit'] = b0 + b1 * pop_df['x']

# Create a scatter plot
plt.scatter(pop_df['x'], pop_df['y'], color='darkslategray', s=50, alpha=0.9)
plt.axline((0, b0), slope=b1, color=orange, linewidth=2)

for x_val, y_val, y_hat_val in zip(pop_df['x'], pop_df['y'], pop_df['bestfit']):
    plt.plot([x_val, x_val], [y_val, y_hat_val], color='darkslategray', linewidth=0.5)

plt.box(False)
plt.grid(None)

plt.show()
```

## –ú–ù–ö {.smaller}

ESS –∑–≤–æ–¥–∏—Ç—å –ø–æ–º–∏–ª–∫–∏ –≤ –∫–≤–∞–¥—Ä–∞—Ç $\sum e_i^2$: –±—ñ–ª—å—à—ñ –ø–æ–º–∏–ª–∫–∏ –æ—Ç—Ä–∏–º—É—é—Ç—å –±—ñ–ª—å—à—ñ —à—Ç—Ä–∞—Ñ–∏.

```{python}
#| label: ols-plot-6
#| echo: false

# Define line's parameters
b0 = 1
b1 = -0.8

pop_df['bestfit'] = b0 + b1 * pop_df['x']

# Create a scatter plot
plt.scatter(pop_df['x'], pop_df['y'], color='darkslategray', s=50, alpha=0.9)
plt.axline((0, b0), slope=b1, color=orange, linewidth=2)

for x_val, y_val, y_hat_val in zip(pop_df['x'], pop_df['y'], pop_df['bestfit']):
    plt.plot([x_val, x_val], [y_val, y_hat_val], color='darkslategray', linewidth=0.5)

plt.box(False)
plt.grid(None)

plt.show()
```

## –ú–ù–ö {.smaller}

–û—Ü—ñ–Ω–∫–∞ –ú–ù–ö ‚Äî —Ü–µ –∫–æ–º–±—ñ–Ω–∞—Ü—ñ—è $\hat{\beta}_0$ —ñ $\hat{\beta}_1$, —è–∫—ñ –º—ñ–Ω—ñ–º—ñ–∑—É—é—Ç—å ESS.

```{python}
#| label: ols-plot-7
#| echo: false

pop_df['bestfit'] = lm0.fittedvalues

# Create a scatter plot
plt.scatter(pop_df['x'], pop_df['y'], color='darkslategray', s=50, alpha=0.9)
plt.axline((0, lm0.params[0]), slope=lm0.params[1], color=orange, linewidth=2)

for x_val, y_val, y_hat_val in zip(pop_df['x'], pop_df['y'], pop_df['bestfit']):
    plt.plot([x_val, x_val], [y_val, y_hat_val], color='darkslategray', linewidth=0.5)

plt.box(False)
plt.grid(None)

plt.show()
```

## –ú–ù–ö {.smaller}



–£ –ø—Ä–æ—Å—Ç—ñ–π –ª—ñ–Ω—ñ–π–Ω—ñ–π —Ä–µ–≥—Ä–µ—Å—ñ—ó –æ—Ü—ñ–Ω—é–≤–∞—á –ú–ù–ö –≤–∏—Ö–æ–¥–∏—Ç—å —ñ–∑ –≤–∏–±–æ—Ä—É $\hat{\beta}_0$ —ñ $\hat{\beta}_1$, —è–∫—ñ –º—ñ–Ω—ñ–º—ñ–∑—É—é—Ç—å —Å—É–º—É –∫–≤–∞–¥—Ä–∞—Ç—ñ–≤ –ø–æ–º–∏–ª–æ–∫ (ESS), _—Ç–æ–±—Ç–æ_,

$$ \min_{\hat{\beta}_0,\, \hat{\beta}_1} \text{ESS} $$

. . .

–∞–ª–µ –º–∏ –≤–∂–µ –∑–Ω–∞—î–º–æ $\text{ESS} = \sum_i e_i^2$. –¢–µ–ø–µ—Ä —Å–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ—Å—è –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è–º–∏ $e_i$ —ñ $\hat{y}$.

$$
\begin{aligned}
   e_i^2 &= \left( y_i - \hat{y}_i \right)^2 = \left( y_i - \hat{\beta}_0 - \hat{\beta}_1 x_i \right)^2 \\
   &= y_i^2 - 2 y_i \hat{\beta}_0 - 2 y_i \hat{\beta}_1 x_i + \hat{\beta}_0^2 + 2 \hat{\beta}_0 \hat{\beta }_1 x_i + \hat{\beta}_1^2 x_i^2
\end{aligned}
$$

## –ú–ù–ö {.smaller}



–ú–∏ –Ω–∞–±–ª–∏–∂–∞—î–º–æ—Å—å. –ù–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ **–º—ñ–Ω—ñ–º—ñ–∑—É–≤–∞—Ç–∏ ESS**. –ú–∏ –ø–æ–∫–∞–∑–∞–ª–∏, —è–∫ ESS –ø–æ–≤'—è–∑–∞–Ω–æ –∑ –Ω–∞—à–æ—é –≤–∏–±—ñ—Ä–∫–æ—é (–Ω–∞—à—ñ –¥–∞–Ω—ñ: $x$ —ñ $y$) —ñ –Ω–∞—à–∏–º–∏ –æ—Ü—ñ–Ω–∫–∞–º–∏ (_—Ç–æ–±—Ç–æ_, $\hat{\beta}_0$ —ñ $\hat{\beta}_1$).

$$ \text{ESS} = \sum_i e_i^2 = \sum_i \left( y_i^2 - 2 y_i \hat{\beta}_0 - 2 y_i \hat{\beta}_1 x_i + \hat{\beta} _0^2 + 2 \hat{\beta}_0 \hat{\beta}_1 x_i + \hat{\beta}_1^2 x_i^2 \right) $$

–î–ª—è —É–º–æ–≤ –º—ñ–Ω—ñ–º—ñ–∑–∞—Ü—ñ—ó —Ç–µ–ø–µ—Ä –±–µ—Ä–µ–º–æ –ø–µ—Ä—à—ñ –ø–æ—Ö—ñ–¥–Ω—ñ ESS –≤—ñ–¥–Ω–æ—Å–Ω–æ $\hat{\beta}_0$ —ñ $\hat{\beta}_1$.

$$
\begin{aligned}
   \dfrac{\partial \text{ESS}}{\partial \hat{\beta}_0} &= \sum_i \left( 2 \hat{\beta}_0 + 2 \hat{\beta}_1 x_i - 2 y_i \right) = 2n \hat{\beta}_0 + 2 \hat{\beta}_1 \sum_i x_i - 2 \sum_i y_i \\
   &= 2n \hat{\beta}_0 + 2n \hat{\beta}_1 \overline{x} - 2n \overline{y}
\end{aligned}
$$

–¥–µ $\overline{x} = \frac{\sum x_i}{n}$ —ñ $\overline{y} = \frac{\sum y_i}{n}$ —î –≤–∏–±—ñ—Ä–∫–æ–≤–∏–º–∏ —Å–µ—Ä–µ–¥–Ω—ñ–º–∏ $x$ —ñ $y$ ( —Ä–æ–∑–º—ñ—Ä $n$).

## –ú–ù–ö {.smaller}



–ü—Ä–∏—Ä—ñ–≤–Ω—é—î–º–æ –ø–æ—Ö—ñ–¥–Ω—É –¥–æ –Ω—É–ª—è:

$$ \dfrac{\partial \text{ESS}}{\partial \hat{\beta}_0} = 2n \hat{\beta}_0 + 2n \hat{\beta}_1 \overline{x} - 2n \overline{y} = 0 $$

—â–æ –æ–∑–Ω–∞—á–∞—î

::: recap
$$ \hat{\beta}_0 = \overline{y} - \hat{\beta}_1 \overline{x} $$
:::

–¢–µ–ø–µ—Ä –ø—Ä–æ $\hat{\beta}_1$...

## –ú–ù–ö {.smaller}



–í—ñ–∑—å–º—ñ—Ç—å –ø–æ—Ö—ñ–¥–Ω—É ESS –≤—ñ–¥–Ω–æ—Å–Ω–æ $\hat{\beta}_1$

$$
\begin{aligned}
   \dfrac{\partial \text{ESS}}{\partial \hat{\beta}_1} &= \sum_i \left( 2 \hat{\beta}_0 x_i + 2 \hat{\beta}_1 x_i^2 - 2 y_i x_i \right) = 2 \hat{\beta}_0 \sum_i x_i + 2 \hat{\beta}_1 \sum_i x_i^2 - 2 \sum_i y_i x_i \\
   &= 2n \hat{\beta}_0 \overline{x} + 2 \hat{\beta}_1 \sum_i x_i^2 - 2 \sum_i y_i x_i
\end{aligned}
$$

–≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –π–æ–≥–æ —Ä—ñ–≤–Ω–∏–º –Ω—É–ª—é

$$ \dfrac{\partial \text{ESS}}{\partial \hat{\beta}_1} = 2n \hat{\beta}_0 \overline{x} + 2 \hat{\beta}_1 \sum_i x_i ^2 - 2 \sum_i y_i x_i = 0 $$

–∑–∞–º—ñ–Ω—é—î–º–æ $\hat{\beta}_0$, _—Ç–æ–±—Ç–æ_, $\hat{\beta}_0 = \overline{y} - \hat{\beta}_1 \overline{x}$ . –¢–∞–∫–∏–º —á–∏–Ω–æ–º,

$$
  2n \left(\overline{y} - \hat{\beta}_1 \overline{x}\right) \overline{x} + 2 \hat{\beta}_1 \sum_i x_i^2 - 2 \sum_i y_i x_i = 0
$$

## –ú–ù–ö {.smaller}



–ü—Ä–æ–¥–æ–≤–∂—É—é—á–∏ –∑ –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ —Å–ª–∞–π–¥–∞

$$ 2n \left(\overline{y} - \hat{\beta}_1 \overline{x}\right) \overline{x} + 2 \hat{\beta}_1 \sum_i x_i^2 - 2 \sum_i y_i x_i = 0 $$

—Ä–æ–∑–∫—Ä–∏–≤–∞—î–º–æ –¥—É–∂–∫–∏

$$ 2n \overline{y}\,\overline{x} - 2n \hat{\beta}_1 \overline{x}^2 + 2 \hat{\beta}_1 \sum_i x_i^2 - 2 \sum_i y_i x_i = 0 $$

$$ \implies 2 \hat{\beta}_1 \left( \sum_i x_i^2 - n \overline{x}^2 \right) = 2 \sum_i y_i x_i - 2n \overline{y}\,\overline{ x} $$

::: recap
$$ \implies \hat{\beta}_1 = \dfrac{\sum_i y_i x_i - 2n \overline{y}\,\overline{x}}{\sum_i x_i^2 - n \overline{x}^2} = \dfrac{\sum_i (x_i - \overline{x})(y_i - \overline{y})}{\sum_i (x_i - \overline{x})^2} $$
:::

## –ú–ù–ö {.smaller}



–ì–æ—Ç–æ–≤–æ!

–¢–µ–ø–µ—Ä —É –Ω–∞—Å —î –æ—Ü—ñ–Ω—é–≤–∞—á—ñ –ú–ù–ö –¥–ª—è –Ω–∞—Ö–∏–ª—É

$$ \hat{\beta}_1 = \dfrac{\sum_i (x_i - \overline{x})(y_i - \overline{y})}{\sum_i (x_i - \overline{x})^2}$$

—ñ –ø–µ—Ä–µ—Ç–∏–Ω—É

$$ \hat{\beta}_0 = \overline{y} - \hat{\beta}_1 \overline{x} $$

–¢–µ–ø–µ—Ä –º–∏ –ø–æ–≤–µ—Ä–Ω–µ–º–æ—Å—è –¥–æ –ø—Ä–∏–ø—É—â–µ–Ω—å —ñ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç–µ–π OLS.

# –ú–ù–ö: –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ —Ç–∞ –ø—Ä–∏–ø—É—â–µ–Ω–Ω—è {background-color="#eef3f8"}

## –í–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ

**–ó–≥–∞–¥—É—î–º–æ:** –§—É–Ω–∫—Ü—ñ—ó —â—ñ–ª—å–Ω–æ—Å—Ç—ñ

–ü–∞–º'—è—Ç–∞–π—Ç–µ, —â–æ –º–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ **—Ñ—É–Ω–∫—Ü—ñ—ó —â—ñ–ª—å–Ω–æ—Å—Ç—ñ –π–º–æ–≤—ñ—Ä–Ω–æ—Å—Ç—ñ** (PDF) –¥–ª—è –æ–ø–∏—Å—É –π–º–æ–≤—ñ—Ä–Ω–æ—Å—Ç—ñ —Ç–æ–≥–æ, —â–æ **–Ω–µ–ø–µ—Ä–µ—Ä–≤–Ω–∞ –≤–∏–ø–∞–¥–∫–æ–≤–∞ –∑–º—ñ–Ω–Ω–∞** –ø—Ä–∏–π–º–∞—î –¥—ñ–∞–ø–∞–∑–æ–Ω –∑–Ω–∞—á–µ–Ω—å. (–ü–ª–æ—â–∞ = 1.)

–¶—ñ PDF-–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏–∑—É—é—Ç—å —Ä–æ–∑–ø–æ–¥—ñ–ª–∏ –π–º–æ–≤—ñ—Ä–Ω–æ—Å—Ç–µ–π, –∞ –Ω–∞–π–ø–æ—à–∏—Ä–µ–Ω—ñ—à—ñ/–≤—ñ–¥–æ–º—ñ/–ø–æ–ø—É–ª—è—Ä–Ω—ñ —Ä–æ–∑–ø–æ–¥—ñ–ª–∏ –º–∞—é—Ç—å –Ω–∞–∑–≤–∏ (_–Ω–∞–ø—Ä–∏–∫–ª–∞–¥_, –Ω–æ—Ä–º–∞–ª—å–Ω–∏–π, *t*, –ì–∞–º–º–∞).

## –í–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ

**–ó–≥–∞–¥—É—î–º–æ:** –§—É–Ω–∫—Ü—ñ—ó —â—ñ–ª—å–Ω–æ—Å—Ç—ñ

–Ü–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å —Ç–æ–≥–æ, —â–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–∞ –≤–∏–ø–∞–¥–∫–æ–≤–∞ –∑–º—ñ–Ω–Ω–∞ –Ω–∞–±—É–≤–∞—î –∑–Ω–∞—á–µ–Ω–Ω—è –≤—ñ–¥ -2 –¥–æ 0: $\mathop{\text{P}}\left(-2 \leq X \leq 0\right) = 0,48$

```{python}
#| label: normal-pdf
#| echo: false

# Generate data for density's polygon
x = np.arange(-4, 4.01, 0.01)
y = norm.pdf(x)
# Plot it
plt.fill_between(x, y, 0, color='grey', alpha=0.8)
plt.fill_between(x[(x > -2) & (x < 0)], norm.pdf(x[(x > -2) & (x < 0)]), 0, color=red_pink)
plt.box(False)
plt.grid(None)

plt.show()
```

## –í–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ

–Ü–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å —Ç–æ–≥–æ, —â–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–∞ –≤–∏–ø–∞–¥–∫–æ–≤–∞ –∑–º—ñ–Ω–Ω–∞ –Ω–∞–±—É–≤–∞—î –∑–Ω–∞—á–µ–Ω–Ω—è –≤—ñ–¥ -1,96 –¥–æ 1,96: $\mathop{\text{P}}\left(-1,96 \leq X \leq 1,96\right) = 0,95$

```{python}
#| label: normal-pdf-2
#| echo: false

# Plot it
plt.fill_between(x, y, 0, color='grey', alpha=0.8)
plt.fill_between(x[(x > -1.96) & (x < 1.96)], norm.pdf(x[(x > -1.96) & (x < 1.96)]), 0, color=red_pink)
plt.box(False)
plt.grid(None)

plt.show()
```

## –í–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ

–Ü–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å —Ç–æ–≥–æ, —â–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–∞ –≤–∏–ø–∞–¥–∫–æ–≤–∞ –∑–º—ñ–Ω–Ω–∞ –Ω–∞–±—É–≤–∞—î –∑–Ω–∞—á–µ–Ω–Ω—è –±—ñ–ª—å—à–µ 2: $\mathop{\text{P}}\left(X > 2\right) = 0,023$

```{python}
#| label: normal-pdf-3
#| echo: false

# Plot it
plt.fill_between(x, y, 0, color='grey', alpha=0.8)
plt.fill_between(x[x > 2], norm.pdf(x[x > 2]), 0, color=red_pink)
plt.box(False)
plt.grid(None)

plt.show()
```

## –í–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ

–£—è–≤—ñ—Ç—å, —â–æ –º–∏ –Ω–∞–º–∞–≥–∞—î–º–æ—Å—è –æ—Ü—ñ–Ω–∏—Ç–∏ –Ω–µ–≤—ñ–¥–æ–º–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä $\beta$, —ñ –Ω–∞–º –≤—ñ–¥–æ–º—ñ —Ä–æ–∑–ø–æ–¥—ñ–ª–∏ —Ç—Ä—å–æ—Ö –∫–æ–Ω–∫—É—Ä—É—é—á–∏—Ö –æ—Ü—ñ–Ω—é–≤–∞—á—ñ–≤.

–Ø–∫–∏–π –±–∏ –º–∏ –æ–±—Ä–∞–ª–∏?

```{python}
#| label: three-estimators
#| echo: false

# Generate data for density's polygon
x = np.arange(-4, 4.01, 0.01)
y = norm.pdf(x)
y_unif = uniform.pdf(x, loc=-0.5, scale=1.5)
y_norm_2 = norm.pdf(x, loc=1, scale=0.5)
# Plot it
plt.fill_between(x, y, 0, color='darkslategray', alpha=0.6)
plt.fill_between(x, y_unif, 0, color=red_pink, alpha=0.65)
plt.fill_between(x, y_norm_2, 0, color='orange', alpha=0.8)
# add vetical dashed lines at 0
plt.axvline(0, color='black', linewidth=1, linestyle='dashed')
plt.tick_params(left = False, right = False , labelleft = False , 
                labelbottom = False, bottom = False) 
plt.xlabel(r'$\beta$', fontsize=20)
plt.box(False)
plt.grid(None)

plt.show()
```

## –í–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ

**–ü–∏—Ç–∞–Ω–Ω—è:** –Ø–∫—ñ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∞–∂–ª–∏–≤—ñ –¥–ª—è –æ—Ü—ñ–Ω—é–≤–∞—á–∞?

. . .

**–í—ñ–¥–ø–æ–≤—ñ–¥—å –ø–µ—Ä—à–∞: –∑–º—ñ—â–µ–Ω–Ω—è (Bias)**

–ß–∏ –≤ —Å–µ—Ä–µ–¥–Ω—å–æ–º—É (–ø—ñ—Å–ª—è *–±–∞–≥–∞—Ç—å–æ—Ö* –≤–∏–±—ñ—Ä–æ–∫) –æ—Ü—ñ–Ω—é–≤–∞—á –Ω–∞–±–ª–∏–∂–∞—î—Ç—å—Å—è –¥–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–Ω—è?

**–ë—ñ–ª—å—à —Ñ–æ—Ä–º–∞–ª—å–Ω–æ:** –ß–∏ –¥–æ—Ä—ñ–≤–Ω—é—î —Å–µ—Ä–µ–¥–Ω—î –∑–Ω–∞—á–µ–Ω–Ω—è —Ä–æ–∑–ø–æ–¥—ñ–ª—É –æ—Ü—ñ–Ω—é–≤–∞—á–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä—É, —è–∫–∏–π –≤—ñ–Ω –æ—Ü—ñ–Ω—é—î?

$$ \mathop{\text{Bias}}_\beta \left( \hat{\beta} \right) = \mathop{\boldsymbol{E}}\left[ \hat{\beta} \right] - \beta $$

## –í–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ

**–í—ñ–¥–ø–æ–≤—ñ–¥—å –ø–µ—Ä—à–∞: –∑–º—ñ—â–µ–Ω–Ω—è (Bias)**

:::: {.columns}

::: {.column}
**–ù–µ–∑–º—ñ—â–µ–Ω–Ω–∞ –æ—Ü—ñ–Ω–∫–∞:** $\mathop{\boldsymbol{E}}\left[ \hat{\beta} \right] = \beta$

```{python}
#| label: unbiased-pdf
#| echo: false

plt.fill_between(x, y, 0, color=red_pink, alpha=0.9)
# add vetical dashed lines at 0
plt.axvline(0, color='black', linewidth=1, linestyle='dashed')
plt.tick_params(left = False, right = False , labelleft = False , 
                labelbottom = False, bottom = False) 
plt.xlabel(r'$\beta$', fontsize=20)

plt.box(False)
plt.grid(None)

plt.show()
```
:::

::: {.column}
**–ó–º—ñ—â–µ–Ω–Ω–∞ –æ—Ü—ñ–Ω–∫–∞:** $\mathop{\boldsymbol{E}}\left[ \hat{\beta} \right] \neq \beta$

```{python}
#| label: biased-pdf
#| echo: false
fig, ax = plt.subplots()
plt.fill_between(x, y, 0, color='darkslategray', alpha=0.9)
# add vetical dashed lines at 0
plt.axvline(-2, color='black', linewidth=1, linestyle='dashed')
plt.tick_params(left = False, right = False , labelleft = False , 
                labelbottom = False, bottom = False) 
ax.set_xlabel(r'$\beta$', fontsize=20)
ax.xaxis.set_label_coords(.27, 0)
plt.box(False)
plt.grid(None)

plt.show()
```
:::

::::

## –í–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ

**–í—ñ–¥–ø–æ–≤—ñ–¥—å –¥—Ä—É–≥–∞: –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è/–¥–∏—Å–ø–µ—Ä—Å—ñ—è (Variance).**

. . .

–í–∞–∂–ª–∏–≤—ñ –Ω–µ –ª–∏—à–µ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ñ —Ç–µ–Ω–¥–µ–Ω—Ü—ñ—ó –∫–æ–Ω–∫—É—Ä—É—é—á–∏—Ö —Ä–æ–∑–ø–æ–¥—ñ–ª—ñ–≤. 

–ú–∏ —Ç–∞–∫–æ–∂ –¥–±–∞—î–º–æ –ø—Ä–æ **–¥–∏—Å–ø–µ—Ä—Å—ñ—é** –æ—Ü—ñ–Ω—é–≤–∞—á–∞.

$$ \mathop{\text{Var}} \left( \hat{\beta} \right) = \mathop{\boldsymbol{E}}\left[ \left( \hat{\beta} - \mathop{\boldsymbol{E}}\left[ \hat{\beta} \right] \right)^2 \right] $$

–ú–µ–Ω—à—ñ –æ—Ü—ñ–Ω–∫–∏ –¥–∏—Å–ø–µ—Ä—Å—ñ—ó –æ–∑–Ω–∞—á–∞—é—Ç—å, —â–æ –º–∏ –æ—Ç—Ä–∏–º—É—î–º–æ –æ—Ü—ñ–Ω–∫–∏ –±–ª–∏–∂—á–µ –¥–æ —Å–µ—Ä–µ–¥–Ω—å–æ–≥–æ –≤ –∫–æ–∂–Ω—ñ–π –≤–∏–±—ñ—Ä—Ü—ñ.

## –í–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ

**–í—ñ–¥–ø–æ–≤—ñ–¥—å –¥—Ä—É–≥–∞: –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è/–¥–∏—Å–ø–µ—Ä—Å—ñ—è (Variance).**

```{python}
#| label: variance-pdf
#| echo: false

# Generate data for density's polygon
x = np.arange(-4, 4.01, 0.01)
y = norm.pdf(x)
y_norm_2 = norm.pdf(x, loc=0, scale=0.5)
# Plot it
plt.fill_between(x, y_norm_2, 0, color=red_pink, alpha=0.8)
plt.fill_between(x, y, 0, color='darkslategray', alpha=0.6)
# add vetical dashed lines at 0
plt.axvline(0, color='black', linewidth=1, linestyle='dashed')
plt.tick_params(left = False, right = False , labelleft = False , 
                labelbottom = False, bottom = False) 
plt.xlabel(r'$\beta$', fontsize=20)
plt.box(False)
plt.grid(None)

plt.show()
```

## –í–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ

**–í—ñ–¥–ø–æ–≤—ñ–¥—å –ø–µ—Ä—à–∞: –∑–º—ñ—â–µ–Ω–Ω—è**

**–í—ñ–¥–ø–æ–≤—ñ–¥—å –¥—Ä—É–≥–∞: –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è.**

**–¢–æ–Ω–∫–æ—â—ñ:** –ö–æ–º–ø—Ä–æ–º—ñ—Å –∑–º—ñ—â–µ–Ω–Ω—è-–¥–∏—Å–ø–µ—Ä—Å—ñ—ó (*bias-variance tradeoff*).

–ß–∏ –≥–æ—Ç–æ–≤—ñ –º–∏ –ø—Ä–∏–π–Ω—è—Ç–∏ –∑–º—ñ—â–µ–Ω–Ω—è, —â–æ–± –∑–º–µ–Ω—à–∏—Ç–∏ –¥–∏—Å–ø–µ—Ä—Å—ñ—é?

–í –µ–∫–æ–Ω–æ–º–µ—Ç—Ä–∏—Ü—ñ/—Å—Ç–∞—Ç–∏—Å—Ç–∏—Ü—ñ –º–∏ –∑–∞–∑–≤–∏—á–∞–π –¥–æ—Ç—Ä–∏–º—É—î–º–æ—Å—è –Ω–µ–∑–º—ñ—â–µ–Ω–∏—Ö –æ—Ü—ñ–Ω–æ–∫. –ê–ª–µ —ñ–Ω—à—ñ –¥–∏—Å—Ü–∏–ø–ª—ñ–Ω–∏ (–æ—Å–æ–±–ª–∏–≤–æ —É —Å—Ñ–µ—Ä—ñ ML) –±—ñ–ª—å—à–µ –¥—É–º–∞—é—Ç—å –ø—Ä–æ —Ü–µ–π –∫–æ–º–ø—Ä–æ–º—ñ—Å.

## The bias-variance tradeoff.

```{python}
#| label: variance-bias
#| echo: false

# Generate data for density's polygon
x = np.arange(-4, 4.01, 0.01)
y = norm.pdf(x)
y_norm_2 = norm.pdf(x, loc=0.5, scale=0.5)
# Plot it
plt.fill_between(x, y_norm_2, 0, color=red_pink, alpha=0.8)
plt.fill_between(x, y, 0, color='darkslategray', alpha=0.6)
# add vetical dashed lines at 0
plt.axvline(0, color='black', linewidth=1, linestyle='dashed')
plt.tick_params(left = False, right = False , labelleft = False , 
                labelbottom = False, bottom = False) 
plt.xlabel(r'$\beta$', fontsize=20)
plt.box(False)
plt.grid(None)

plt.show()
```

## –í–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ

–Ø–∫ –≤–∏ –≤–∂–µ –º–æ–≥–ª–∏ –∑–¥–æ–≥–∞–¥–∞—Ç–∏—Å—è,

- –ú–ù–ö —î **–Ω–µ–∑–º—ñ—â–µ–Ω–æ—é –æ—Ü—ñ–Ω–∫–æ—é**.
- –ú–ù–ö –º–∞—î **–º—ñ–Ω—ñ–º–∞–ª—å–Ω–µ –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è** —Å–µ—Ä–µ–¥ —É—Å—ñ—Ö –Ω–µ–∑–º—ñ—â–µ–Ω–∏—Ö –ª—ñ–Ω—ñ–π–Ω–∏—Ö –æ—Ü—ñ–Ω—é–≤–∞—á—ñ–≤.

## –í–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ

–ê–ª–µ... —Ü—ñ (–¥—É–∂–µ –≥–∞—Ä–Ω—ñ) –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ –∑–∞–ª–µ–∂–∞—Ç—å –≤—ñ–¥ —Ä—è–¥—É –ø—Ä–∏–ø—É—â–µ–Ω—å:

1. –ó–≤'—è–∑–æ–∫ –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ—ó —Å—É–∫—É–ø–Ω–æ—Å—Ç—ñ —î –ª—ñ–Ω—ñ–π–Ω–∏–º.

2. –ù–∞—à–∞ –∑–º—ñ–Ω–Ω–∞ $X$ —î **–µ–∫–∑–æ–≥–µ–Ω–Ω–æ—é**, _—Ç–æ–±—Ç–æ_, $\mathop{\boldsymbol{E}}\left[ u \mid X \right] = 0$.

3. –ó–º—ñ–Ω–Ω–∞ $X$ –º–∞—î –≤–∞—Ä—ñ–∞—Ü—ñ—é. –Ü —è–∫—â–æ —ñ—Å–Ω—É—î –∫—ñ–ª—å–∫–∞ –ø–æ—è—Å–Ω—é–≤–∞–ª—å–Ω–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö, –≤–æ–Ω–∏ –Ω–µ —î –∞–±—Å–æ–ª—é—Ç–Ω–æ –∫–æ–ª—ñ–Ω–µ–∞—Ä–Ω–∏–º–∏.

4. –ó–±—É—Ä–µ–Ω–Ω—è –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ—ó —Å—É–∫—É–ø–Ω–æ—Å—Ç—ñ $u_i$ –Ω–µ–∑–∞–ª–µ–∂–Ω–æ —Ç–∞ –æ–¥–Ω–∞–∫–æ–≤–æ —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω—ñ –∑–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–∏–º –∑–∞–∫–æ–Ω–æ–º —Ä–æ–∑–ø–æ–¥—ñ–ª—É —ñ–∑ —Å–µ—Ä–µ–¥–Ω—ñ–º –≤ –Ω—É–ª—ñ $\left( \mathop{\boldsymbol{E}}\left[ u \right] = 0 \right)$ —Ç–∞ –¥–∏—Å–ø–µ—Ä—Å—ñ—î—é $\sigma^2$ (_—Ç–æ–±—Ç–æ_, $\mathop{\boldsymbol{E}}\left[ u^2 \right] = \sigma^2$).

::: footer
üîó[Diagnostics for simple linear regression](https://gallery.shinyapps.io/slr_diag/)
:::

## –ü—Ä–∏–ø—É—â–µ–Ω–Ω—è

–†—ñ–∑–Ω—ñ –ø—Ä–∏–ø—É—â–µ–Ω–Ω—è –≥–∞—Ä–∞–Ω—Ç—É—é—Ç—å —Ä—ñ–∑–Ω—ñ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ:

- –ü—Ä–∏–ø—É—â–µ–Ω–Ω—è (1), (2) —ñ (3) —Ä–æ–±–ª—è—Ç—å OLS –Ω–µ–∑–º—ñ—â–µ–Ω–∏–º.

- –ü—Ä–∏–ø—É—â–µ–Ω–Ω—è (4) –¥–∞—î –Ω–∞–º –Ω–µ–∑–º—ñ—â–µ–Ω—É –æ—Ü—ñ–Ω–∫—É –¥–ª—è –¥–∏—Å–ø–µ—Ä—Å—ñ—ó –Ω–∞—à–∏—Ö –æ—Ü—ñ–Ω–æ–∫ –ú–ù–ö.

## –£–º–æ–≤–Ω–µ —Å–ø–æ–¥—ñ–≤–∞–Ω–Ω—è {.smaller}

–î–ª—è –±–∞–≥–∞—Ç—å–æ—Ö –≤–∏–ø–∞–¥–∫—ñ–≤, –Ω–∞—à–∏–º –Ω–∞–π–≤–∞–∂–ª–∏–≤—ñ—à–∏–º –ø—Ä–∏–ø—É—â–µ–Ω–Ω—è–º —î **–µ–∫–∑–æ–≥–µ–Ω–Ω—ñ—Å—Ç—å**, _—Ç–æ–±—Ç–æ_,
$$
\begin{align}
   \mathop{E}\left[ u \mid X \right] = 0
\end{align}
$$
–∞–ª–µ —â–æ —Ü–µ –Ω–∞—Å–ø—Ä–∞–≤–¥—ñ –æ–∑–Ω–∞—á–∞—î?

. . .

–û–¥–∏–Ω —ñ–∑ —Å–ø–æ—Å–æ–±—ñ–≤ –ø–æ–¥—É–º–∞—Ç–∏ –ø—Ä–æ —Ü–µ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è:

> –î–ª—è *–±—É–¥—å-—è–∫–æ–≥–æ* –∑–Ω–∞—á–µ–Ω–Ω—è $X$ —Å–µ—Ä–µ–¥–Ω—î –∑–Ω–∞—á–µ–Ω–Ω—è –∑–∞–ª–∏—à–∫—ñ–≤ –º–∞—î –¥–æ—Ä—ñ–≤–Ω—é–≤–∞—Ç–∏ –Ω—É–ª—é.

- _–ù–∞–ø—Ä–∏–∫–ª–∞–¥_, $\mathop{E}\left[ u \mid X=1 \right]=0$ *—ñ* $\mathop{E}\left[ u \mid X=100 \right]= 0$

- _–ù–∞–ø—Ä–∏–∫–ª–∞–¥_, $\mathop{E}\left[ u \mid X_2=\text{–ñ—ñ–Ω–∫–∞} \right]=0$ *—ñ* $\mathop{E}\left[ u \mid X_2=\text{–ß–æ–ª–æ–≤—ñ–∫} \right]=0$

---

–ì—Ä–∞—Ñ—ñ—á–Ω–æ...

---

–î—ñ–π—Å–Ω–∞ –µ–∫–∑–æ–≥–µ–Ω–Ω—ñ—Å—Ç—å, _—Ç–æ–±—Ç–æ_, $\mathop{E}\left[ u \mid X \right] = 0$

```{python}
#| label: ex-good-exog
#| echo: false

import joypy

np.random.seed(123)

n = 1000

# Sample data
df = pd.DataFrame({'var1': np.random.normal(0, 0.5, n),
                   'group': [i for i in np.random.choice(list(range(4, -5, -1)), n)]})



fig, ax = joypy.joyplot(df, by = "group", column = "var1")
plt.xlabel('u')
plt.ylabel('X')
plt.show() 
```

---

–ù–µ–¥—ñ–π—Å–Ω–∞ –µ–∫–∑–æ–≥–µ–Ω–Ω—ñ—Å—Ç—å, _i.e._, $\mathop{E}\left[ u \mid X \right] \neq 0$

```{python}
#| label: ex-bad-exog
#| echo: false

# Add Bais to the data
df['var2'] = df['var1'] + 0.5 * df['group']

fig, ax = joypy.joyplot(df, by = "group", column = "var2")
plt.xlabel('u')
plt.ylabel('X')
plt.show() 
```

# –ù–µ–≤–∏–∑–Ω–∞—á–µ–Ω—ñ—Å—Ç—å —Ç–∞ –ø–æ–º–∏–ª–∫–∏ {background-color="#eef3f8"}

## –©–æ—Å—å —â–µ?

–î–æ —Ü—å–æ–≥–æ –º–æ–º–µ–Ω—Ç—É –º–∏ –∑–Ω–∞—î–º–æ, —â–æ –ú–ù–ö –º–∞—î –¥–µ—è–∫—ñ —Ö–æ—Ä–æ—à—ñ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ, —ñ –º–∏ –∑–Ω–∞—î–º–æ, —è–∫ –æ—Ü—ñ–Ω–∏—Ç–∏ –ø–µ—Ä–µ—Ç–∏–Ω —ñ –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –Ω–∞—Ö–∏–ª—É –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –ú–ù–ö.

–ù–∞—à –ø–æ—Ç–æ—á–Ω–∏–π —Ä–æ–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å:

- –û—Ç—Ä–∏–º–∞—Ç–∏ –¥–∞–Ω—ñ (—Ç–æ—á–∫–∏ –∑—ñ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏ $x$ —ñ $y$)
- –ü–æ–±—É–¥—É–≤–∞—Ç–∏ –º–æ–¥–µ–ª—å $y$ –Ω–∞ $x$
- –ü–æ–±—É–¥—É–π—Ç–µ –ª—ñ–Ω—ñ—é –ú–ù–ö (_—Ç–æ–±—Ç–æ_, $\hat{y} = \hat{\beta}_0 + \hat{\beta}_1$)
- –ì–æ—Ç–æ–≤–æ?

–ê–ª–µ —á–æ–≥–æ –º–∏ **–Ω–∞–≤—á–∏–º–æ—Å—è** –∑ —Ü—ñ—î—ó –≤–ø—Ä–∞–≤–∏?

## –©–æ—Å—å —â–µ? –¢–∞–∫!

–ê–ª–µ —á–æ–≥–æ –º–∏ **–Ω–∞–≤—á–∏–º–æ—Å—è** –∑ —Ü—ñ—î—ó –≤–ø—Ä–∞–≤–∏?

- –ù–∞—Å–∫—ñ–ª—å–∫–∏ –º–∏ –ø–æ–≤–∏–Ω–Ω—ñ –±—É—Ç–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ –≤ —Ç–æ—á–Ω–æ—Å—Ç—ñ –Ω–∞—à–∏—Ö –æ—Ü—ñ–Ω–æ–∫?
- –ù–∞—Å–∫—ñ–ª—å–∫–∏ –¥–æ–±—Ä–µ –Ω–∞—à–∞ –º–æ–¥–µ–ª—å –ø–æ—è—Å–Ω—é—î –∑–º—ñ–Ω—É $y$?

–ú–∏ –ø–æ–≤–∏–Ω–Ω—ñ –≤–º—ñ—Ç–∏ —Å–ø—Ä–∞–≤–ª—è—Ç–∏—Å—è –∑ –Ω–µ–≤–∏–∑–Ω–∞—á–µ–Ω—ñ—Å—Ç—é. 

## –í—á–∏–º–æ—Å—è –Ω–∞ –ø–æ–º–∏–ª–∫–∞—Ö

–Ø–∫ –ø–æ–∫–∞–∑–∞–ª–æ –Ω–∞—à–µ –ø–æ–ø–µ—Ä–µ–¥–Ω—î –º–æ–¥–µ–ª—é–≤–∞–Ω–Ω—è, –Ω–∞—à–∞ –ø—Ä–æ–±–ª–µ–º–∞ –∑ **–Ω–µ–≤–∏–∑–Ω–∞—á–µ–Ω—ñ—Å—Ç—é** –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, —â–æ –º–∏ –Ω–µ –∑–Ω–∞—î–º–æ, —á–∏ –Ω–∞—à–∞ –≤–∏–±—ñ—Ä–∫–æ–≤–∞ –æ—Ü—ñ–Ω–∫–∞ *–±–ª–∏–∑—å–∫–∞* —á–∏ *–¥–∞–ª–µ–∫–∞* –≤—ñ–¥ –Ω–µ–≤—ñ–¥–æ–º–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ—ó —Å—É–∫—É–ø–Ω–æ—Å—Ç—ñ.

–ü—Ä–æ—Ç–µ —â–µ –Ω–µ –≤—Å–µ –≤—Ç—Ä–∞—á–µ–Ω–æ. –ú–∏ –º–æ–∂–µ–º–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –ø–æ–º–∏–ª–∫–∏ $\left(e_i = y_i - \hat{y}_i\right)$, —â–æ–± –∑—Ä–æ–∑—É–º—ñ—Ç–∏, –Ω–∞—Å–∫—ñ–ª—å–∫–∏ –¥–æ–±—Ä–µ –Ω–∞—à–∞ –º–æ–¥–µ–ª—å –ø–æ—è—Å–Ω—é—î –≤–∞—Ä—ñ–∞—Ü—ñ—é $y$.

–ö–æ–ª–∏ –∑–¥–∞—î—Ç—å—Å—è, —â–æ –Ω–∞—à–∞ –º–æ–¥–µ–ª—å –≤–∏–∫–æ–Ω—É—î ¬´–≥–∞—Ä–Ω—É¬ª —Ä–æ–±–æ—Ç—É, –º–∏ –º–æ–∂–µ–º–æ –∑ –±—ñ–ª—å—à–æ—é –≤–ø–µ–≤–Ω–µ–Ω—ñ—Å—Ç—é –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —ó—ó, —â–æ–± –¥—ñ–∑–Ω–∞—Ç–∏—Å—è –ø—Ä–æ –∑–≤'—è–∑–æ–∫ –º—ñ–∂ $y$ —ñ $x$.

–¢–µ–ø–µ—Ä –Ω–∞–º –ø—Ä–æ—Å—Ç–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ —Ñ–æ—Ä–º–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –≤–∏—â–µ–∑–∞–∑–Ω–∞—á–µ–Ω–µ.

## –í—á–∏–º–æ—Å—è –Ω–∞ –ø–æ–º–∏–ª–∫–∞—Ö

–°–ø–æ—á–∞—Ç–∫—É –º–∏ –æ—Ü—ñ–Ω–∏–º–æ –¥–∏—Å–ø–µ—Ä—Å—ñ—é $u_i$ (–Ω–∞–≥–∞–¥–∞—î–º–æ: $\mathop{\text{Var}} \left( u_i \right) = \sigma^2$), –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –Ω–∞—à—ñ –∫–≤–∞–¥—Ä–∞—Ç–∏ –ø–æ–º–∏–ª–æ–∫, _—Ç–æ–±—Ç–æ_,

$$ s^2 = \dfrac{\sum_i e_i^2}{n - k} $$

–¥–µ $k$ –¥–∞—î –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –º–æ–¥–µ–ª—ñ, —è–∫—É –º–∏ –æ—Ü—ñ–Ω—é—î–º–æ (_–Ω–∞–ø—Ä–∏–∫–ª–∞–¥_, $\beta_0$ —ñ $\beta_1$ –¥–∞–¥—É—Ç—å $k=2$).

$s^2$ —î –Ω–µ–∑–º—ñ—â–µ–Ω–æ—é –æ—Ü—ñ–Ω–∫–æ—é $\sigma^2$.

## –í—á–∏–º–æ—Å—è –Ω–∞ –ø–æ–º–∏–ª–∫–∞—Ö

–î–∏—Å–ø–µ—Ä—Å—ñ—è $\hat{\beta}_1$ (–¥–ª—è –ø—Ä–æ—Å—Ç–æ—ó –ª—ñ–Ω—ñ–π–Ω–æ—ó —Ä–µ–≥—Ä–µ—Å—ñ—ó) –¥–æ—Ä—ñ–≤–Ω—é—î

$$ \mathop{\text{Var}} \left( \hat{\beta}_1 \right) = \dfrac{s^2}{\sum_i \left( x_i - \overline{x} \right)^2 } $$

—è–∫–∏–π –ø–æ–∫–∞–∑—É—î, —â–æ –¥–∏—Å–ø–µ—Ä—Å—ñ—è –Ω–∞—à–æ–≥–æ –æ—Ü—ñ–Ω—é–≤–∞—á–∞ –Ω–∞—Ö–∏–ª—É

1. –∑–±—ñ–ª—å—à—É—î—Ç—å—Å—è, –æ—Å–∫—ñ–ª—å–∫–∏ –Ω–∞—à—ñ –∑–±—É—Ä–µ–Ω–Ω—è —Å—Ç–∞—é—Ç—å —à—É–º–Ω—ñ—à–∏–º–∏

2. –∑–º–µ–Ω—à—É—î—Ç—å—Å—è –∑—ñ –∑–±—ñ–ª—å—à–µ–Ω–Ω—è–º –¥–∏—Å–ø–µ—Ä—Å—ñ—ó $x$

## –í—á–∏–º–æ—Å—è –Ω–∞ –ø–æ–º–∏–ª–∫–∞—Ö

*–ù–∞–π—á–∞—Å—Ç—ñ—à–µ:* **—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞ –ø–æ–º–∏–ª–∫–∞** $\hat{\beta}_1$

$$ \mathop{\hat{\text{SE}}} \left( \hat{\beta}_1 \right) = \sqrt{\dfrac{s^2}{\sum_i \left( x_i - \overline{ x} \right)^2}} $$

*–ù–∞–≥–∞–¥—É—î–º–æ:* –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞ –ø–æ–º–∏–ª–∫–∞ –æ—Ü—ñ–Ω—é–≤–∞—á–∞ ‚Äî —Ü–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–µ –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è —Ä–æ–∑–ø–æ–¥—ñ–ª—É –æ—Ü—ñ–Ω—é–≤–∞—á–∞.

## –ú–ù–ö –≤ Python {.smaller}

::: {.panel-tabset}

### Statsmodels v1

```{python}
#| label: lm-statsmodels-2

import statsmodels.formula.api as smf

results = smf.ols('Global_Sales ~ NA_Sales', vgsales).fit()
print(results.summary())
```

### Statsmodels v2

```{python}
#| label: lm-statsmodels-1

import statsmodels.api as sm

X = sm.add_constant(vgsales.NA_Sales)
model = sm.OLS(vgsales.Global_Sales, X)
result = model.fit()
print(result.summary())
```

### SciPy

[–¢—ñ–ª—å–∫–∏ –ø–∞—Ä–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è]{.red}

```{python}
#| label: lm-scipy

from scipy import stats

stats.linregress(x=vgsales.NA_Sales, y=vgsales.Global_Sales)
```

### Sklearn

```{python}
#| label: lm-sklearn

from sklearn.linear_model import LinearRegression

X = vgsales[['NA_Sales']]
y = vgsales['Global_Sales']

model = LinearRegression()
model.fit(X, y)
print(model.intercept_, model.coef_, model.score(X, y))
```
:::

## –í—á–∏–º–æ—Å—è –Ω–∞ –ø–æ–º–∏–ª–∫–∞—Ö

–ú–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É –ø–æ–º–∏–ª–∫—É $\hat{SE_{\hat{\beta}_1}}$ —Ä–∞–∑–æ–º —ñ–∑ —Å–∞–º–∏–º $\hat{\beta}_1$, —â–æ–± –¥—ñ–∑–Ω–∞—Ç–∏—Å—è –ø—Ä–æ –ø–∞—Ä–∞–º–µ—Ç—Ä $\beta_1$.

–ü—ñ—Å–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —Ä–æ–∑–ø–æ–¥—ñ–ª—É $\hat{\beta}_1$, —É –Ω–∞—Å —î –¥–≤–∞ (–ø–æ–≤'—è–∑–∞–Ω–∏—Ö) –≤–∞—Ä—ñ–∞–Ω—Ç–∏ —Ñ–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–æ–≥–æ –≤–∏—Å–Ω–æ–≤–∫—É —â–æ–¥–æ –Ω–∞—à–æ–≥–æ –Ω–µ–≤—ñ–¥–æ–º–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ $\beta_1$:

- **–î–æ–≤—ñ—Ä—á—ñ —ñ–Ω—Ç–µ—Ä–≤–∞–ª–∏:** –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –æ—Ü—ñ–Ω–∫—É —Ç–∞ —ó—ó —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É –ø–æ–º–∏–ª–∫—É, —â–æ–± —Å—Ç–≤–æ—Ä–∏—Ç–∏ —ñ–Ω—Ç–µ—Ä–≤–∞–ª, —è–∫–∏–π –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–µ–Ω–Ω—ñ –∑–∞–∑–≤–∏—á–∞–π –º—ñ—Å—Ç–∏—Ç–∏–º–µ —Å–ø—Ä–∞–≤–∂–Ω—ñ–π –ø–∞—Ä–∞–º–µ—Ç—Ä.

- **–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≥—ñ–ø–æ—Ç–µ–∑–∏:** –í–∏–∑–Ω–∞—á—Ç–µ, —á–∏ —î —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–æ –∑–Ω–∞—á—É—â—ñ –¥–æ–∫–∞–∑–∏ –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è –≥—ñ–ø–æ—Ç–µ—Ç–∏—á–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–Ω—è –∞–±–æ –¥—ñ–∞–ø–∞–∑–æ–Ω—É –∑–Ω–∞—á–µ–Ω—å.

# –î–æ–≤—ñ—Ä—á—ñ —ñ–Ω—Ç–µ—Ä–≤–∞–ª–∏ {background-color="#eef3f8"}

## –î–æ–≤—ñ—Ä—á—ñ —ñ–Ω—Ç–µ—Ä–≤–∞–ª–∏

–ë—É–¥—É—î–º–æ –¥–æ–≤—ñ—Ä—á—ñ —ñ–Ω—Ç–µ—Ä–≤–∞–ª–∏ —Ä—ñ–≤–Ω—è $(1-\alpha)$ –¥–ª—è $\beta_1$
$$ \hat{\beta_1}\ \pm t_{\alpha/2,\text{df}} \, \mathop{\hat{\text{SE}}} \left( \hat{\beta_1} \right) $$

$t_{\alpha/2,\text{df}}$ –ø–æ–∑–Ω–∞—á–∞—î $\alpha/2$ –∫–≤–∞–Ω—Ç–∏–ª—å $t$ —Ä–æ–∑–ø–æ–¥—ñ–ª—É –∑ $n-k$ —Å—Ç—É–ø–µ–Ω—è–º–∏ —Å–≤–æ–±–æ–¥–∏.

## –î–æ–≤—ñ—Ä—á—ñ —ñ–Ω—Ç–µ—Ä–≤–∞–ª–∏ {.smaller}

–ë—É–¥—É—î–º–æ –¥–æ–≤—ñ—Ä—á—ñ —ñ–Ω—Ç–µ—Ä–≤–∞–ª–∏ —Ä—ñ–≤–Ω—è $(1-\alpha)$ –¥–ª—è $\beta_1$
$$ \hat{\beta_1}\ \pm t_{\alpha/2,\text{df}} \, \mathop{\hat{\text{SE}}} \left( \hat{\beta_1} \right) $$

–ù–∞–ø—Ä–∏–∫–ª–∞–¥, 100 —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω—å, –¥–≤–∞ –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç–∏ (_—Ç–æ–±—Ç–æ_, $\hat{\beta}_0$ —ñ $\hat{\beta}_1 \implies k = 2$), —ñ $\alpha = 0,05$ ( –¥–ª—è 95% –¥–æ–≤—ñ—Ä—á–æ–≥–æ —ñ–Ω—Ç–µ—Ä–≤–∞–ª—É) –¥–∞—î –Ω–∞–º $t_{0,025,\,98} = `r round(qt(0.025, 98), 2)`$

```{python}
#| label: t-dist
#| echo: false

x = np.arange(-4, 4.01, 0.01)
y = stats.t.pdf(x, df=98)

plt.fill_between(x[(x > -4) & (x < -1.98)], stats.t.pdf(x[(x > -4) & (x < -1.98)], df=98), 0, color=red_pink)
plt.fill_between(x[(x > -1.98) & (x < 4)], stats.t.pdf(x[(x > -1.98) & (x < 4)], df=98), 0, color='gray', alpha=0.6)
plt.axvline(-1.98, color='black', linewidth=1)
plt.tick_params(left = False, right = False , labelleft = False , 
                labelbottom = True, bottom = False)
plt.box(False)
plt.grid(None)
plt.show()
```

## –î–æ–≤—ñ—Ä—á—ñ —ñ–Ω—Ç–µ—Ä–≤–∞–ª–∏ {.smaller}

–ë—É–¥—É—î–º–æ –¥–æ–≤—ñ—Ä—á—ñ —ñ–Ω—Ç–µ—Ä–≤–∞–ª–∏ —Ä—ñ–≤–Ω—è $(1-\alpha)$ –¥–ª—è $\beta_1$

:::: {.columns}

::: {.column width="70%"}
```{python}
#| label: ci-py-output
#| echo: true

results = smf.ols('y ~ x', pop_df).fit()
print(results.summary())
```
:::

::: {.column width="30%"}

$$ \hat{\beta_1}\ \pm t_{\alpha/2,\text{df}} \, \mathop{\hat{\text{SE}}} \left( \hat{\beta_1} \right) $$

–û—Ç–∂–µ, –Ω–∞—à 95% –¥–æ–≤—ñ—Ä—á–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª —Å—Ç–∞–Ω–æ–≤–∏—Ç—å $0.7216 \pm 1.98 \times 0.067 = \left[ 0.589,\, 0.854 \right]$
:::

::::

## –î–æ–≤—ñ—Ä—á—ñ —ñ–Ω—Ç–µ—Ä–≤–∞–ª–∏

–û—Ç–∂–µ, –º–∏ –º–∞—î–º–æ –¥–æ–≤—ñ—Ä—á–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è $\beta_1$, _—Ç–æ–±—Ç–æ_, $\left[ 0.589,\, 0.854 \right]$.

–©–æ —Ü–µ –æ–∑–Ω–∞—á–∞—î?

. . .

**–ù–µ–æ—Ñ—ñ—Ü—ñ–π–Ω–æ:** –î–æ–≤—ñ—Ä—á–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª –¥–∞—î –Ω–∞–º –æ–±–ª–∞—Å—Ç—å (—ñ–Ω—Ç–µ—Ä–≤–∞–ª), –≤ —è–∫—ñ–π –º–∏ –º–æ–∂–µ–º–æ –ø–µ–≤–Ω–æ—é –º—ñ—Ä–æ—é –¥–æ–≤—ñ—Ä—è—Ç–∏ —â–æ–¥–æ –≤–º—ñ—Å—Ç—É –ø–∞—Ä–∞–º–µ—Ç—Ä–∞.

. . .

**–ë—ñ–ª—å—à —Ñ–æ—Ä–º–∞–ª—å–Ω–æ:** –Ø–∫—â–æ –Ω–µ–æ–¥–Ω–æ—Ä–∞–∑–æ–≤–æ —Ä–æ–±–∏—Ç–∏ –≤–∏–±—ñ—Ä–∫—É –∑ –Ω–∞—à–æ—ó —Å—É–∫—É–ø–Ω–æ—Å—Ç—ñ —Ç–∞ –±—É–¥—É–≤–∞—Ç–∏ –¥–æ–≤—ñ—Ä—á—ñ —ñ–Ω—Ç–µ—Ä–≤–∞–ª–∏ –¥–ª—è –∫–æ–∂–Ω–æ—ó –∑ —Ü–∏—Ö –≤–∏–±—ñ—Ä–æ–∫, $(1-\alpha)$ –≤—ñ–¥—Å–æ—Ç–∫—ñ–≤ –Ω–∞—à–∏—Ö —ñ–Ω—Ç–µ—Ä–≤–∞–ª—ñ–≤ (*–Ω–∞–ø—Ä–∏–∫–ª–∞–¥*, 95%) –º—ñ—Å—Ç–∏—Ç–∏–º–µ –ø–∞—Ä–∞–º–µ—Ç—Ä –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ—ó —Å—É–∫—É–ø–Ω–æ—Å—Ç—ñ *–¥–µ—Å—å –≤ —ñ–Ω—Ç–µ—Ä–≤–∞–ª—ñ*.

. . .

–¢–µ–ø–µ—Ä –ø–æ–≤–µ—Ä–Ω–µ–º–æ—Å—è –¥–æ –Ω–∞—à–æ—ó —Å–∏–º—É–ª—è—Ü—ñ—ó...

## –î–æ–≤—ñ—Ä—á—ñ —ñ–Ω—Ç–µ—Ä–≤–∞–ª–∏

–ú–∏ –≤—ñ–¥—ñ–±—Ä–∞–ª–∏ 10 000 –≤–∏–±—ñ—Ä–æ–∫ (–∫–æ–∂–Ω–∞ —Ä–æ–∑–º—ñ—Ä–æ–º $n = 30$) —ñ–∑ –Ω–∞—à–æ—ó —Å—É–∫—É–ø–Ω–æ—Å—Ç—ñ —Ç–∞ –æ—Ü—ñ–Ω–∏–ª–∏ –Ω–∞—à—É —Ä–µ–≥—Ä–µ—Å—ñ–π–Ω—É –º–æ–¥–µ–ª—å –¥–ª—è –∫–æ–∂–Ω–æ—ó –∑ —Ü–∏—Ö —Å–∏–º—É–ª—è—Ü—ñ–π:

$$ y_i = \hat{\beta}_0 + \hat{\beta}_1 x_i + e_i $$
<center>(–ø–æ–≤—Ç–æ—Ä—é—î—Ç—å—Å—è 10 000 —Ä–∞–∑—ñ–≤)</center>

–¢–µ–ø–µ—Ä –¥–∞–≤–∞–π—Ç–µ –æ—Ü—ñ–Ω–∏–º–æ 95% –¥–æ–≤—ñ—Ä—á—ñ —ñ–Ω—Ç–µ—Ä–≤–∞–ª–∏ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –∑ —Ü–∏—Ö —ñ–Ω—Ç–µ—Ä–≤–∞–ª—ñ–≤...

## –î–æ–≤—ñ—Ä—á—ñ —ñ–Ω—Ç–µ—Ä–≤–∞–ª–∏

**–ó –Ω–∞—à–æ–≥–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ –º–æ–¥–µ–ª—é–≤–∞–Ω–Ω—è:** 97.5% 95% –¥–æ–≤—ñ—Ä—á–∏—Ö —ñ–Ω—Ç–µ—Ä–≤–∞–ª—ñ–≤ –º—ñ—Å—Ç—è—Ç—å —Å–ø—Ä–∞–≤–∂–Ω—î –∑–Ω–∞—á–µ–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ $\beta_1$.

![](img/simulation-ci-1.png){fig-align="center"}

# –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –≥—ñ–ø–æ—Ç–µ–∑ {background-color="#eef3f8"}

## –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –≥—ñ–ø–æ—Ç–µ–∑ {.smaller}

–£ –±–∞–≥–∞—Ç—å–æ—Ö –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è—Ö –º–∏ —Ö–æ—á–µ–º–æ –∑–Ω–∞—Ç–∏ –±—ñ–ª—å—à–µ, –Ω—ñ–∂ —Ç–æ—á–∫–æ–≤—É –æ—Ü—ñ–Ω–∫—É –∞–±–æ –¥—ñ–∞–ø–∞–∑–æ–Ω –∑–Ω–∞—á–µ–Ω—å. –ú–∏ —Ö–æ—á–µ–º–æ –∑–Ω–∞—Ç–∏, —â–æ –Ω–∞—à—ñ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω—ñ –¥–∞–Ω—ñ –≥–æ–≤–æ—Ä—è—Ç—å –ø—Ä–æ —ñ—Å–Ω—É—é—á—ñ —Ç–µ–æ—Ä—ñ—ó.

–ú–∏ —Ö–æ—á–µ–º–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –≥—ñ–ø–æ—Ç–µ–∑–∏, –≤–∏—Å—É–Ω—É—Ç—ñ —á–∏–Ω–æ–≤–Ω–∏–∫–∞–º–∏, –ø–æ–ª—ñ—Ç–∏–∫–∞–º–∏, –µ–∫–æ–Ω–æ–º—ñ—Å—Ç–∞–º–∏, –Ω–∞—É–∫–æ–≤—Ü—è–º–∏, –¥—Ä—É–∑—è–º–∏, –¥–∏–≤–Ω–∏–º–∏ —Å—É—Å—ñ–¥–∞–º–∏ —Ç–æ—â–æ.

**–ü—Ä–∏–∫–ª–∞–¥–∏**

- –ó–±—ñ–ª—å—à–µ–Ω–Ω—è –ø—Ä–∏—Å—É—Ç–Ω–æ—Å—Ç—ñ –ø–æ–ª—ñ—Ü—ñ—ó **–∑–º–µ–Ω—à—É—î –∑–ª–æ—á–∏–Ω–Ω—ñ—Å—Ç—å**?

- –ë—É–¥—ñ–≤–Ω–∏—Ü—Ç–≤–æ –≥—ñ–≥–∞–Ω—Ç—Å—å–∫–æ—ó —Å—Ç—ñ–Ω–∏ **–∑–º–µ–Ω—à—É—î –∑–ª–æ—á–∏–Ω–Ω—ñ—Å—Ç—å**?

- –†–æ–∑–ø—É—Å–∫ —É—Ä—è–¥—É **–∑–≥—É–±–Ω–æ –≤–ø–ª–∏–≤–∞—î –Ω–∞ –µ–∫–æ–Ω–æ–º—ñ–∫—É**?

- –ß–∏ –ª–µ–≥–∞–ª—å–Ω–∏–π –∫–∞–Ω–∞–±—ñ—Å **–∑–º–µ–Ω—à—É—î –≤–æ–¥—ñ–Ω–Ω—è –≤ –Ω–µ—Ç–≤–µ—Ä–µ–∑–æ–º—É —Å—Ç–∞–Ω—ñ** –∞–±–æ **–∑–º–µ–Ω—à—É—î –≤–∂–∏–≤–∞–Ω–Ω—è –æ–ø—ñ–æ—ó–¥—ñ–≤**?

- –ß–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏ —è–∫–æ—Å—Ç—ñ –ø–æ–≤—ñ—Ç—Ä—è **–ø–æ–∫—Ä–∞—â—É—é—Ç—å –∑–¥–æ—Ä–æ–≤'—è** —Ç–∞/–∞–±–æ **–∑–º–µ–Ω—à—É—é—Ç—å –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ä–æ–±–æ—á—ñ—Ö –º—ñ—Å—Ü—å**?

## –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –≥—ñ–ø–æ—Ç–µ–∑ {.smaller}

–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≥—ñ–ø–æ—Ç–µ–∑ —Å–ø–∏—Ä–∞—î—Ç—å—Å—è –Ω–∞ –¥—É–∂–µ —Å—Ö–æ–∂—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ —Ç–∞ —ñ–Ω—Ç—É—ó—Ü—ñ—é.

–•–æ—á–∞ –Ω–µ–≤–∏–∑–Ω–∞—á–µ–Ω—ñ—Å—Ç—å, –∑–≤–∏—á–∞–π–Ω–æ, —ñ—Å–Ω—É—î, –º–∏ –≤—Å–µ —â–µ –º–æ–∂–µ–º–æ –ø–æ–±—É–¥—É–≤–∞—Ç–∏ *–Ω–∞–¥—ñ–π–Ω—ñ* —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω—ñ —Ç–µ—Å—Ç–∏ (–≤—ñ–¥–∫–∏–¥–∞—é—á–∏ –∞–±–æ –Ω–µ –≤—ñ–¥—Ö–∏–ª—è—é—á–∏ –≤–∏—Å—É–Ω—É—Ç—É –≥—ñ–ø–æ—Ç–µ–∑—É).

. . .

**–ú–ù–ö *t* —Ç–µ—Å—Ç**: –ù–∞—à–∞ (–Ω—É–ª—å–æ–≤–∞) –≥—ñ–ø–æ—Ç–µ–∑–∞ —Å—Ç–≤–µ—Ä–¥–∂—É—î, —â–æ $\beta_1$ –¥–æ—Ä—ñ–≤–Ω—é—î –∑–Ω–∞—á–µ–Ω–Ω—é $c$, _—Ç–æ–±—Ç–æ_, $H_o:\: \beta_1 = c$

–ó –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç–µ–π –ú–ù–ö –º–∏ –º–æ–∂–µ–º–æ –ø–æ–∫–∞–∑–∞—Ç–∏, —â–æ —Ç–µ—Å—Ç–æ–≤–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

$$ t_\text{stat} = \dfrac{\hat{\beta}_1 - c}{\mathop{\hat{\text{SE}}} \left( \hat{\beta}_1 \right)} $$

—Å–ª—ñ–¥—É—î —Ä–æ–∑–ø–æ–¥—ñ–ª—É $t$ –∑ $n-k$ —Å—Ç—É–ø–µ–Ω—è–º–∏ —Å–≤–æ–±–æ–¥–∏.

## –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –≥—ñ–ø–æ—Ç–µ–∑ {.smaller}

–î–ª—è **–¥–≤–æ—Å—Ç–æ—Ä–æ–Ω–Ω—å–æ–≥–æ** —Ç–µ—Å—Ç—É —Ä—ñ–≤–Ω—è $\alpha$ –º–∏ –≤—ñ–¥—Ö–∏–ª—è—î–º–æ –Ω—É–ª—å–æ–≤—É –≥—ñ–ø–æ—Ç–µ–∑—É (—ñ –∑–∞–≤–µ—Ä—à—É—î–º–æ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—É –≥—ñ–ø–æ—Ç–µ–∑—É), –∫–æ–ª–∏

$$ \left|t_\text{stat}\right| > \left|t_{1-\alpha/2,\,df}\right| $$

—Ü–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –Ω–∞—à–∞ **—Ç–µ—Å—Ç–æ–≤–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —î –±—ñ–ª—å—à –µ–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω–æ—é, –Ω—ñ–∂ –∫—Ä–∏—Ç–∏—á–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è**.

–ö—Ä—ñ–º —Ç–æ–≥–æ, –º–∏ –º–æ–∂–µ–º–æ –æ–±—á–∏—Å–ª–∏—Ç–∏ **p-–∑–Ω–∞—á–µ–Ω–Ω—è**, —è–∫–µ —Å—É–ø—Ä–æ–≤–æ–¥–∂—É—î –Ω–∞—à—É —Ç–µ—Å—Ç–æ–≤—É —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É, —â–æ —Ñ–∞–∫—Ç–∏—á–Ω–æ –¥–∞—î –Ω–∞–º —ñ–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å –ø–æ–±–∞—á–∏—Ç–∏ –Ω–∞—à—É —Ç–µ—Å—Ç–æ–≤—É —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É *–∞–±–æ –±—ñ–ª—å—à –µ–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—É —Ç–µ—Å—Ç–æ–≤—É —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É*, —è–∫—â–æ –Ω—É–ª—å–æ–≤–∞ –≥—ñ–ø–æ—Ç–µ–∑–∞ –≤—ñ—Ä–Ω–∞.

–î—É–∂–µ –º–∞–ª—ñ p-–∑–Ω–∞—á–µ–Ω–Ω—è (–∑–∞–∑–≤–∏—á–∞–π < 0,05) –æ–∑–Ω–∞—á–∞—é—Ç—å, —â–æ –º–∏ –Ω–∞–≤—Ä—è–¥ —á–∏ –ø–æ–±–∞—á–∏–º–æ –Ω–∞—à—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏, —è–∫–±–∏ –Ω—É–ª—å–æ–≤–∞ –≥—ñ–ø–æ—Ç–µ–∑–∞ –¥—ñ–π—Å–Ω–æ –±—É–ª–∞ –≤—ñ—Ä–Ω–æ—é ‚Äî –º–∏ —Å—Ö–∏–ª—å–Ω—ñ –≤—ñ–¥—Ö–∏–ª—è—Ç–∏ –Ω—É—å–ª–æ–≤—É –≥—ñ–ø–æ—Ç–µ–∑—É –¥–ª—è p-–∑–Ω–∞—á–µ–Ω—å –Ω–∏–∂—á–µ 0,05.

## –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –≥—ñ–ø–æ—Ç–µ–∑ {.smaller}

:::: {.columns}

::: {.column width="70%"}
```{python}
#| label: hypothesis-test
#| echo: true

import statsmodels.formula.api as smf

results = smf.ols('y ~ x', pop_df).fit()
print(results.summary())
```

:::

::: {.column width="30%"}
$H_0$: $\beta_1 = 0$ *vs.* $H_a$: $\beta_1 \neq 0$

$t_\text{stat} = 10.811$ —Ç–∞ $t_\text{0.975, 98} = `r round(qt(0.975, 98), 2)`$

*p*-–∑–Ω–∞—á–µ–Ω–Ω—è $< 0,05$

**–¢–æ–º—É –º–∏ –≤—ñ–¥–∫–∏–¥–∞—î–º–æ $H_0$!**

:::

::::

## –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –≥—ñ–ø–æ—Ç–µ–∑

–ü–æ–≤–µ—Ä—Ç–∞—î–º–æ—Å—è –¥–æ –Ω–∞—à–æ—ó —Å–∏–º—É–ª—è—Ü—ñ—ó! –î–∞–≤–∞–π—Ç–µ –ø–æ–¥–∏–≤–∏–º–æ—Å—è, —â–æ –Ω–∞—Å–ø—Ä–∞–≤–¥—ñ —Ä–æ–±–∏—Ç—å –Ω–∞—à–∞ $t$ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞.

–£ —Ü—ñ–π —Å–∏—Ç—É–∞—Ü—ñ—ó –º–∏ —Ñ–∞–∫—Ç–∏—á–Ω–æ –º–æ–∂–µ–º–æ –∑–Ω–∞—Ç–∏ (—ñ –∑–∞–±–µ–∑–ø–µ—á–∏—Ç–∏) –Ω—É–ª—å–æ–≤—É –≥—ñ–ø–æ—Ç–µ–∑—É, –æ—Å–∫—ñ–ª—å–∫–∏ –º–∏ –∑–≥–µ–Ω–µ—Ä—É–≤–∞–ª–∏ –¥–∞–Ω—ñ.

–î–ª—è –∫–æ–∂–Ω–æ–≥–æ –∑ 10 000 –∑—Ä–∞–∑–∫—ñ–≤ –º–∏ –æ–±—á–∏—Å–ª–∏–º–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É $t$, –∞ –ø–æ—Ç—ñ–º –ø–æ–±–∞—á–∏–º–æ, —Å–∫—ñ–ª—å–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–∏—Ö –¥–∞–Ω–∏—Ö $t$ –ø–µ—Ä–µ–≤–∏—â—É—î –Ω–∞—à–µ –∫—Ä–∏—Ç–∏—á–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è (`r round(qt(0.975, 28), 2)`, —è–∫ –≤–∏—â–µ).

–í—ñ–¥–ø–æ–≤—ñ–¥—å –º–∞—î –±—É—Ç–∏ –ø—Ä–∏–±–ª–∏–∑–Ω–æ 5 –≤—ñ–¥—Å–æ—Ç–∫—ñ–≤ ‚Äî –Ω–∞—à —Ä—ñ–≤–µ–Ω—å $\alpha$.

## –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –≥—ñ–ø–æ—Ç–µ–∑

–£ –Ω–∞—à–æ–º—É –º–æ–¥–µ–ª—é–≤–∞–Ω–Ω—ñ 2.1% –Ω–∞—à–æ—ó —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ $t$ –≤—ñ–¥—Ö–∏–ª—è—î –Ω—É–ª—å–æ–≤—É –≥—ñ–ø–æ—Ç–µ–∑—É.

–†–æ–∑–ø–æ–¥—ñ–ª –Ω–∞—à–æ—ó —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ $t$ (–∑–∞—à—Ç—Ä–∏—Ö—É–≤–∞–Ω–Ω—è –æ–±–ª–∞—Å—Ç–µ–π –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è).

![](img/simulation-t-plot-1.png){fig-align="center"}

---

–í—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ, 2.1% –Ω–∞—à–∏—Ö –∑–Ω–∞—á–µ–Ω—å $p$ –≤—ñ–¥—Ö–∏–ª—è—î –Ω—É–ª—å–æ–≤—É –≥—ñ–ø–æ—Ç–µ–∑—É.

–†–æ–∑–ø–æ–¥—ñ–ª –Ω–∞—à–∏—Ö –∑–Ω–∞—á–µ–Ω—å $p$ (–∑–∞—à—Ç—Ä–∏—Ö—É–≤–∞–Ω–Ω—è –∑–Ω–∞—á–µ–Ω—å $p$ –Ω–∏–∂—á–µ 0,05).

![](img/simulation-p-plot-1.png){fig-align="center"}

## F-—Ç–µ—Å—Ç

–Ü–Ω–æ–¥—ñ –º–æ–∂–Ω–∞ –∑—É—Å—Ç—Ä—ñ—Ç–∏ $F$-—Ç–µ—Å—Ç–∏.

–ú–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ $F$-—Ç–µ—Å—Ç–∏ –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –≥—ñ–ø–æ—Ç–µ–∑, —è–∫—ñ –≤–∫–ª—é—á–∞—é—Ç—å –∫—ñ–ª—å–∫–∞ –≤–∏–ø–∞–¥–∫—ñ–≤
<br>‚ÄÉ(_–Ω–∞–ø—Ä–∏–∫–ª–∞–¥_, $\beta_1 = \beta_2$ –∞–±–æ $\beta_3 + \beta_4 = 1$),

–∞ –Ω–µ –æ–¥–Ω–∞ –ø—Ä–æ—Å—Ç–∞ –≥—ñ–ø–æ—Ç–µ–∑–∞
<br>(_–Ω–∞–ø—Ä–∏–∫–ª–∞–¥_, $\beta_1 = 0$, –¥–ª—è —è–∫–æ–≥–æ –º–∏ –ø—Ä–æ—Å—Ç–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—î–º–æ —Ç–µ—Å—Ç $t$).

## F-—Ç–µ—Å—Ç

**–ü—Ä–∏–∫–ª–∞–¥**

–ï–∫–æ–Ω–æ–º—ñ—Å—Ç–∏ –ª—é–±–ª—è—Ç—å –∫–∞–∑–∞—Ç–∏: ¬´–ì—Ä–æ—à—ñ –≤–∑–∞—î–º–æ–∑–∞–º—ñ–Ω–Ω—ñ¬ª.

–£—è–≤—ñ—Ç—å —Å–æ–±—ñ, —â–æ –º–∏ –º–æ–∂–µ–º–æ –∑–∞—Ö–æ—Ç—ñ—Ç–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –¥—ñ–π—Å–Ω–æ –≥—Ä–æ—à—ñ, –æ—Ç—Ä–∏–º–∞–Ω—ñ —è–∫ –¥–æ—Ö—ñ–¥, –º–∞—é—Ç—å —Ç–∞–∫–∏–π –∂–µ –≤–ø–ª–∏–≤ –Ω–∞ —Å–ø–æ–∂–∏–≤–∞–Ω–Ω—è, —è–∫ –≥—Ä–æ—à—ñ, –æ—Ç—Ä–∏–º–∞–Ω—ñ –≤—ñ–¥ –ø–æ–¥–∞—Ç–∫–æ–≤–∏—Ö –∑–Ω–∏–∂–æ–∫.

$$ \text{–°–ø–æ–∂–∏–≤–∞–Ω–Ω—è}_i = \beta_0 + \beta_1 \text{–î–æ—Ö—ñ–¥}_{i} + \beta_2 \text{–ó–Ω–∏–∂–∫–∞}_i + u_i $$

## F-—Ç–µ—Å—Ç

**–ü—Ä–∏–∫–ª–∞–¥, –ø—Ä–æ–¥–æ–≤–∂–µ–Ω–Ω—è**

–ú–∏ –º–æ–∂–µ–º–æ –∑–∞–ø–∏—Å–∞—Ç–∏ –Ω–∞—à—É –Ω—É–ª—å–æ–≤—É –≥—ñ–ø–æ—Ç–µ–∑—É —è–∫

$$ H_o:\: \beta_1 = \beta_2 \iff H_o :\: \beta_1 - \beta_2 = 0 $$

–ù–∞–∫–ª–∞–¥–µ–Ω–Ω—è —Ü—ñ—î—ó –Ω—É–ª—å–æ–≤–æ—ó –≥—ñ–ø–æ—Ç–µ–∑–∏ –¥–∞—î –Ω–∞–º **–æ–±–º–µ–∂–µ–Ω—É –º–æ–¥–µ–ª—å**

$$ \text{–°–ø–æ–∂–∏–≤–∞–Ω–Ω—è}_i = \beta_0 + \beta_1 \text{–î–æ—Ö—ñ–¥}_{i} + \beta_1 \text{–ó–Ω–∏–∂–∫–∞}_i + u_i $$
$$ \text{–°–ø–æ–∂–∏–≤–∞–Ω–Ω—è}_i = \beta_0 + \beta_1 \left( \text{–î–æ—Ö—ñ–¥}_{i} + \text{–ó–Ω–∏–∂–∫–∞}_i \right) + u_i $$

## F-—Ç–µ—Å—Ç

**–ü—Ä–∏–∫–ª–∞–¥, –ø—Ä–æ–¥–æ–≤–∂–µ–Ω–Ω—è**

–©–æ–± –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –Ω—É–ª—å–æ–≤—É –≥—ñ–ø–æ—Ç–µ–∑—É $H_o :\: \beta_1 = \beta_2$ –ø—Ä–æ—Ç–∏ $H_a :\: \beta_1 \neq \beta_2$,
<br>–º–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É $F$
$$
\begin{align}
   F_{q,\,n-k-1} = \dfrac{\left(\text{ESS}_r - \text{ESS}_u\right)/q}{\text{ESS}_u/(n-k-1)}
\end{align}
$$
—è–∫–∏–π (—è–∫ –≤–∏–ø–ª–∏–≤–∞—î –∑ –Ω–∞–∑–≤–∏) –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î —Ä–æ–∑–ø–æ–¥—ñ–ª—É $F$ —ñ–∑ —Å—Ç—É–ø–µ–Ω—è–º–∏ —Å–≤–æ–±–æ–¥–∏ –≤ —á–∏—Å–µ–ª—å–Ω–∏–∫—É $q$ —ñ —Å—Ç—É–ø–µ–Ω—è–º–∏ —Å–≤–æ–±–æ–¥–∏ –≤ –∑–Ω–∞–º–µ–Ω–Ω–∏–∫—É $n-k-1$.

–¢—É—Ç $q$ ‚Äî —Ü–µ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –æ–±–º–µ–∂–µ–Ω—å, —è–∫—ñ –º–∏ –Ω–∞–∫–ª–∞–¥–∞—î–º–æ —á–µ—Ä–µ–∑ $H_o$.

## F-—Ç–µ—Å—Ç {.smaller}

**–ü—Ä–∏–∫–ª–∞–¥, –ø—Ä–æ–¥–æ–≤–∂–µ–Ω–Ω—è**

$\text{ESS}_r$ ‚Äì —Ü–µ —Å—É–º–∞ –∫–≤–∞–¥—Ä–∞—Ç—ñ–≤ –ø–æ–º–∏–ª–æ–∫ (ESS) –∑ –Ω–∞—à–æ—ó **–æ–±–º–µ–∂–µ–Ω–æ—ó –º–æ–¥–µ–ª—ñ**
$$ \text{–°–ø–æ–∂–∏–≤–∞–Ω–Ω—è}_i = \beta_0 + \beta_1 \left( \text{–î–æ—Ö—ñ–¥}_{i} + \text{–ó–Ω–∏–∂–∫–∞}_i \right) + u_i $$

–∞ $\text{ESS}_u$ ‚Äì —Ü–µ —Å—É–º–∞ –∫–≤–∞–¥—Ä–∞—Ç—ñ–≤ –ø–æ–º–∏–ª–æ–∫ (ESS) –∑ –Ω–∞—à–æ—ó **–Ω–µ–æ–±–º–µ–∂–µ–Ω–æ—ó –º–æ–¥–µ–ª—ñ**
$$ \text{–°–ø–æ–∂–∏–≤–∞–Ω–Ω—è}_i = \beta_0 + \beta_1 \text{–î–æ—Ö—ñ–¥}_{i} + \beta_2 \text{–ó–Ω–∏–∂–∫–∞}_i + u_i $$

. . .

–¢–µ—Å—Ç $F$ –ø–æ—Ä—ñ–≤–Ω—é—î –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –Ω–µ–æ–±–º–µ–∂–µ–Ω–æ—ó –º–æ–¥–µ–ª—ñ –∑ –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –æ–±–º–µ–∂–µ–Ω–æ—ó –º–æ–¥–µ–ª—ñ, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —ó—Ö–Ω—ñ $\text{ESS}$.

. . .

$$
\begin{align}
   F_\text{stat} = \dfrac{\left(\text{ESS}_r - \text{ESS}_u\right)/q}{\text{ESS}_u/(n-k-1)} \sim F_{ q,\,n-k-1}
\end{align}
$$

# –î—è–∫—É—é –∑–∞ —É–≤–∞–≥—É! {background-color="#eef3f8"}

<br>
<br>

{{< iconify ic baseline-telegram >}} [Data Mirosh](https://t.me/araprof)

{{< iconify mdi github >}} [aranaur](https://github.com/Aranaur)

{{< iconify mdi envelope >}} ihor.miroshnychenko\@knu.ua

{{< iconify mdi linkedin >}} [ihormiroshnychenko](https://www.linkedin.com/in/ihormiroshnychenko/)

{{< iconify ion home >}} [aranaur.rbind.io](https://aranaur.rbind.io)