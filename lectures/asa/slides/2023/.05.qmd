---
title: "06 - –ì–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω—ñ—Å—Ç—å, —á–∞—Å—Ç–∏–Ω–∞ 2"
subtitle: "–ï–∫–æ–Ω–æ–º–µ—Ç—Ä–∏–∫–∞"
author: "–Ü–≥–æ—Ä –ú—ñ—Ä–æ—à–Ω–∏—á–µ–Ω–∫–æ"
date: "–æ–Ω–æ–≤–ª–µ–Ω–æ: `r Sys.Date()`"
institute: –ö–ù–ï–£::–Ü–Ü–¢–ï
crossref:
  fig-title: –†–∏—Å.     # (default is "Figure")
  tbl-title: –¢–∞–±.     # (default is "Table")
format:
  revealjs: 
    theme: [simple, custom.scss]
    # footer: <https://t.me/araprof>
    logo: img/logo.png
    chalkboard: true
    slide-number: true
    toc: true
    toc-title: –ó–ú–Ü–°–¢
    transition: fade
    mouse-wheel: true
    highlight-style: github
    mainfont: metropolis
    toc-depth: 1
editor: source
knitr: 
  opts_chunk: 
    echo: true
    warnings: false
    message: false
editor_options: 
  chunk_output_type: console
---

```{r}
#| label: setup
#| include: false

library(pacman)
p_load(broom, latex2exp, ggplot2, ggthemes, viridis, extrafont,
  kableExtra, dplyr, magrittr, knitr, parallel, fontawesome)

# Define pink color
red_pink   = "#e64173"
turquoise  = "#20B2AA"
orange     = "#FFA500"
red        = "#fb6107"
blue       = "#3b3b9a"
green      = "#8bb174"
grey_light = "grey70"
grey_mid   = "grey50"
grey_dark  = "grey20"
purple     = "#6A5ACD"
slate      = "#23373b"

# A blank theme for ggplot
theme_empty <- theme_bw() + theme(
  line = element_blank(),
  rect = element_blank(),
  strip.text = element_blank(),
  axis.text = element_blank(),
  plot.title = element_blank(),
  axis.title = element_blank(),
  plot.margin = structure(c(0, 0, -0.5, -1), unit = "lines", valid.unit = 3L, class = "unit"),
  legend.position = "none"
)
theme_simple <- theme_bw() + theme(
  line = element_blank(),
  panel.grid = element_blank(),
  rect = element_blank(),
  strip.text = element_blank(),
  axis.text.x = element_text(size = 18, family = "STIXGeneral"),
  axis.text.y = element_blank(),
  axis.ticks = element_blank(),
  plot.title = element_blank(),
  axis.title = element_blank(),
  # plot.margin = structure(c(0, 0, -1, -1), unit = "lines", valid.unit = 3L, class = "unit"),
  legend.position = "none"
)
theme_axes_math <- theme_void() + theme(
  text = element_text(family = "MathJax_Math"),
  axis.title = element_text(size = 22),
  axis.title.x = element_text(hjust = .95, margin = margin(0.15, 0, 0, 0, unit = "lines")),
  axis.title.y = element_text(vjust = .95, margin = margin(0, 0.15, 0, 0, unit = "lines")),
  axis.line = element_line(
    color = "grey70",
    size = 0.25,
    arrow = arrow(angle = 30, length = unit(0.15, "inches")
  )),
  plot.margin = structure(c(1, 0, 1, 0), unit = "lines", valid.unit = 3L, class = "unit"),
  legend.position = "none"
)
theme_axes_serif <- theme_void() + theme(
  text = element_text(family = "MathJax_Main"),
  axis.title = element_text(size = 22),
  axis.title.x = element_text(hjust = .95, margin = margin(0.15, 0, 0, 0, unit = "lines")),
  axis.title.y = element_text(vjust = .95, margin = margin(0, 0.15, 0, 0, unit = "lines")),
  axis.line = element_line(
    color = "grey70",
    size = 0.25,
    arrow = arrow(angle = 30, length = unit(0.15, "inches")
  )),
  plot.margin = structure(c(1, 0, 1, 0), unit = "lines", valid.unit = 3L, class = "unit"),
  legend.position = "none"
)
theme_axes <- theme_void() + theme(
  text = element_text(family = "Fira Sans Book"),
  axis.title = element_text(size = 18),
  axis.title.x = element_text(hjust = .95, margin = margin(0.15, 0, 0, 0, unit = "lines")),
  axis.title.y = element_text(vjust = .95, margin = margin(0, 0.15, 0, 0, unit = "lines")),
  axis.line = element_line(
    color = grey_light,
    size = 0.25,
    arrow = arrow(angle = 30, length = unit(0.15, "inches")
  )),
  plot.margin = structure(c(1, 0, 1, 0), unit = "lines", valid.unit = 3L, class = "unit"),
  legend.position = "none"
)
```

# –û–≥–ª—è–¥

## –û–≥–ª—è–¥

–¢—Ä–∏ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ñ –ø–∏—Ç–∞–Ω–Ω—è

**–ü–∏—Ç–∞–Ω–Ω—è 1:** –Ø–∫–∞ —Ä—ñ–∑–Ω–∏—Ü—è –º—ñ–∂ $u_i$ —ñ $e_i$?

**–ü–∏—Ç–∞–Ω–Ω—è 2:** –ú–∏ –≤–∏—Ç—Ä–∞—á–∞—î–º–æ *–±–∞–≥–∞—Ç–æ* —á–∞—Å—É –Ω–∞ –æ–±–≥–æ–≤–æ—Ä–µ–Ω–Ω—è $u_i^2$. –ß–æ–º—É?

**–ü–∏—Ç–∞–Ω–Ω—è 3:** –ú–∏ —Ç–∞–∫–æ–∂ –≤–∏—Ç—Ä–∞—á–∞—î–º–æ *–±–∞–≥–∞—Ç–æ* —á–∞—Å—É –Ω–∞ –æ–±–≥–æ–≤–æ—Ä–µ–Ω–Ω—è $e_i^2$. –ß–æ–º—É?

---

## –û–≥–ª—è–¥ {.smaller}

**–ü–∏—Ç–∞–Ω–Ω—è 1:** –Ø–∫–∞ —Ä—ñ–∑–Ω–∏—Ü—è –º—ñ–∂ $u_i$ —ñ $e_i$?

**–í—ñ–¥–ø–æ–≤—ñ–¥—å 1:**

. . .

<br> $\color{#e64173}{u_i}$ –¥–∞—î [–∑–±—É—Ä–µ–Ω–Ω—è –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ—ó —Å—É–∫—É–ø–Ω–æ—Å—Ç—ñ]{.hi} –¥–ª—è **$i$** —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è.

. . .

  $u_i$ –≤–∏–º—ñ—Ä—é—î, –Ω–∞—Å–∫—ñ–ª—å–∫–∏ –¥–∞–ª–µ–∫–æ **$i$** —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤—ñ–¥ –ª—ñ–Ω—ñ—ó [–≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ—ó —Å—É–∫—É–ø–Ω–æ—Å—Ç—ñ]{.hi}, _—Ç–æ–±—Ç–æ_,
  
$$u_i = y_i - \color{#e64173}{\left(\beta_0 + \beta_1 x_i\right)}$$

. . .

$\color{#6A5ACD}{e_i}$ —Ü–µ [–∑–∞–ª–∏—à–æ–∫–∏ —Ä–µ–≥—Ä–µ—Å—ñ—ó (–ø–æ–º–∏–ª–∫–∞)]{.hi-purple} –¥–ª—è **$i$** —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—å.

. . .

  $e_i$ –≤–∏–º—ñ—Ä—é—î, –Ω–∞—Å–∫—ñ–ª—å–∫–∏ –¥–∞–ª–µ–∫–æ **$i$** —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤—ñ–¥ –ª—ñ–Ω—ñ—ó [–≤–∏–±—ñ—Ä–∫–æ–≤–æ—ó —Ä–µ–≥—Ä–µ—Å—ñ—ó]{.hi-purple}, _—Ç–æ–±—Ç–æ_,

$$ e_i = y_i - \color{#6A5ACD}{\underbrace{\left(\hat{\beta}_0 + \hat{\beta}_1 x_i\right)}_{ \text{–í–∏–±—ñ—Ä–∫. —Ä–µ–≥—Ä–µ—Å. –ª—ñ–Ω—ñ—è} = \hat{y}}} = y_i - \color{#6A5ACD}{\hat{y}_i} $$

---

## –û–≥–ª—è–¥

**–ü–∏—Ç–∞–Ω–Ω—è 2:** –ú–∏ –≤–∏—Ç—Ä–∞—á–∞—î–º–æ *–±–∞–≥–∞—Ç–æ* —á–∞—Å—É –Ω–∞ –æ–±–≥–æ–≤–æ—Ä–µ–Ω–Ω—è $u_i^2$. –ß–æ–º—É?

**–í—ñ–¥–ø–æ–≤—ñ–¥—å 2:**

–û–¥–Ω–∏–º —ñ–∑ –æ—Å–Ω–æ–≤–Ω–∏—Ö –ø—Ä–∏–ø—É—â–µ–Ω—å —î —Ç–µ, —â–æ –Ω–∞—à—ñ –∑–±—É—Ä–µ–Ω–Ω—è ($u_i$) —î –≥–æ–º–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–∏–º–∏ (–≤–æ–Ω–∏ –º–∞—é—Ç—å –ø–æ—Å—Ç—ñ–π–Ω—É –¥–∏—Å–ø–µ—Ä—Å—ñ—é), _—Ç–æ–±—Ç–æ_, $\mathop{\text{Var}} \left(u_i \middle| x_i \right) = \sigma^2$.

–ú–∏ —Ç–∞–∫–æ–∂ –ø—Ä–∏–ø—É—Å–∫–∞—î–º–æ, —â–æ —Å–µ—Ä–µ–¥–Ω—î –∑–Ω–∞—á–µ–Ω–Ω—è —Ü–∏—Ö –∑–±—É—Ä–µ–Ω—å –¥–æ—Ä—ñ–≤–Ω—é—î –Ω—É–ª—é, $\color{#e64173}{\mathop{\boldsymbol{E}}\left[ u_i \middle| x_i \right] = 0}$.

–ó–∞ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è–º, $\mathop{\text{Var}} \left( u_i \middle| x_i \right) = \mathop{\boldsymbol{E}}\Big[ u_i^2 - \underbrace{\color{#e64173} {\mathop{\boldsymbol{E}}\left[ u_i \middle| x_i \right]}^2}_{\color{#e64173}{=0}} \Big| x_i \Big] = \mathop{\boldsymbol{E}}\left[ u_i^2 \middle| x_i \right]$

–¢–∞–∫–∏–º —á–∏–Ω–æ–º, —è–∫—â–æ –º–∏ —Ö–æ—á–µ–º–æ –¥—ñ–∑–Ω–∞—Ç–∏—Å—è –ø—Ä–æ –¥–∏—Å–ø–µ—Ä—Å—ñ—é $u_i$, –º–∏ –º–æ–∂–µ–º–æ –∑–æ—Å–µ—Ä–µ–¥–∏—Ç–∏—Å—è –Ω–∞ $u_i^2$.

---

## –û–≥–ª—è–¥

**–ü–∏—Ç–∞–Ω–Ω—è 3:** –ú–∏ —Ç–∞–∫–æ–∂ –≤–∏—Ç—Ä–∞—á–∞—î–º–æ *–±–∞–≥–∞—Ç–æ* —á–∞—Å—É –Ω–∞ –æ–±–≥–æ–≤–æ—Ä–µ–Ω–Ω—è $e_i^2$. –ß–æ–º—É?

**–í—ñ–¥–ø–æ–≤—ñ–¥—å 3:**

–ú–∏ –Ω–µ –º–æ–∂–µ–º–æ —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—Ç–∏ $u_i$ (–∞–±–æ $u_i^2$).

–ê–ª–µ $u_i^2$ –≥–æ–≤–æ—Ä–∏—Ç—å –Ω–∞–º –ø—Ä–æ –¥–∏—Å–ø–µ—Ä—Å—ñ—é $u_i$.

–ú–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ $e_i^2$, —â–æ–± –¥—ñ–∑–Ω–∞—Ç–∏—Å—è –ø—Ä–æ $u_i^2$ —ñ, –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ $\sigma_i^2$.

---

## –û–≥–ª—è–¥: –ø–æ—Ç–æ—á–Ω—ñ –ø—Ä–∏–ø—É—â–µ–Ω–Ω—è

1. –ù–∞—à–∞ –≤–∏–±—ñ—Ä–∫–∞ ($x_k$ —Ç–∞ $y_i$) –±—É–ª–∞ [–≤–∏–ø–∞–¥–∫–æ–≤–∏–º —á–∏–Ω–æ–º]{.hi} –≤—ñ–¥—ñ–±—Ä–∞–Ω–∞ –∑ —Å—É–∫—É–ø–Ω–æ—Å—Ç—ñ.

. . .

2. $y$ —î [–ª—ñ–Ω—ñ–π–Ω–æ—é —Ñ—É–Ω–∫—Ü—ñ—î—é]{.hi} $\beta_k$ —ñ $u_i$.

. . .

3. –£ –Ω–∞—à—ñ–π –≤–∏–±—ñ—Ä—Ü—ñ –Ω–µ–º–∞—î —ñ–¥–µ–∞–ª—å–Ω–æ—ó [–º—É–ª—å—Ç–∏–∫–æ–ª—ñ–Ω–µ–∞—Ä–Ω–æ—Å—Ç—ñ]{.hi}.

. . .

4. –ü–æ—è—Å–Ω—é–≤–∞–ª—å–Ω—ñ –∑–º—ñ–Ω–Ω—ñ —î [–µ–∫–∑–æ–≥–µ–Ω–Ω–∏–º–∏]{.hi}: $\mathop{\boldsymbol{E}}\left[ u \middle| X \right] = 0 \left(\implies \mathop{\boldsymbol{E}}\left[ u \right] = 0\right)$.

. . .

5. –ó–±—É—Ä–µ–Ω–Ω—è –º–∞—é—Ç—å [–ø–æ—Å—Ç—ñ–π–Ω—É –¥–∏—Å–ø–µ—Ä—Å—ñ—é]{.hi} $\sigma^2$ —ñ [–Ω—É–ª—å–æ–≤–∞ –∫–æ–≤–∞—Ä—ñ–∞—Ü—ñ—è]{.hi}, _—Ç–æ–±—Ç–æ_,

   - $\mathop{\boldsymbol{E}}\left[ u_i^2 \middle| X_i \right] = \mathop{\text{Var}} \left( u_i \middle| X_i \right) = \sigma^2 \implies \mathop{\text{Var}} \left( u_i \right) = \ —Å–∏–≥–º–∞^2$
   - $\mathop{\text{Cov}} \left( u_i, \, u_j \middle| X_i,\,X_j \right) = \mathop{\boldsymbol{E}}\left[ u_i u_j \middle| X_i,\,X_j \right] = 0$ –¥–ª—è $i\neq j$

. . .

6. –ó–±—É—Ä–µ–Ω–Ω—è –ø–æ—Ö–æ–¥—è—Ç—å –∑ [–Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ]{.hi} —Ä–æ–∑–ø–æ–¥—ñ–ª—É , _—Ç–æ–±—Ç–æ_, $u_i \overset{\text{iid}}{\sim} \mathop{\text{N}}\left( 0, \sigma^2 \right)$.

---

## –û–≥–ª—è–¥

–°—å–æ–≥–æ–¥–Ω—ñ –º–∏ –∑–æ—Å–µ—Ä–µ–¥–∂—É—î–º–æ—Å—å –Ω–∞ –ø—Ä–∏–ø—É—â–µ–Ω–Ω—ñ \#5:

> 5\. –ó–±—É—Ä–µ–Ω–Ω—è –º–∞—é—Ç—å [–ø–æ—Å—Ç—ñ–π–Ω—É –¥–∏—Å–ø–µ—Ä—Å—ñ—é]{.hi} $\sigma^2$ —ñ [–Ω—É–ª—å–æ–≤–∞ –∫–æ–≤–∞—Ä—ñ–∞—Ü—ñ—è]{.hi}, _—Ç–æ–±—Ç–æ_,

   - $\mathop{\boldsymbol{E}}\left[ u_i^2 \middle| X_i \right] = \mathop{\text{Var}} \left( u_i \middle| X_i \right) = \sigma^2 \implies \mathop{\text{Var}} \left( u_i \right) = \ —Å–∏–≥–º–∞^2$
   - $\mathop{\text{Cov}} \left( u_i, \, u_j \middle| X_i,\,X_j \right) = \mathop{\boldsymbol{E}}\left[ u_i u_j \middle| X_i,\,X_j \right] = 0$ –¥–ª—è $i\neq j$

. . .

–ó–æ–∫—Ä–µ–º–∞, –º–∏ –∑–æ—Å–µ—Ä–µ–¥–∏–º–æ—Å—è –Ω–∞ –ø—Ä–∏–ø—É—â–µ–Ω–Ω—ñ [–ø–æ—Å—Ç—ñ–π–Ω–∞ –¥–∏—Å–ø–µ—Ä—Å—ñ—è]{.hi} (—Ç–∞–∫–æ–∂ –≤—ñ–¥–æ–º–æ–º—É —è–∫ *–≥–æ–º–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω—ñ—Å—Ç—å*).

. . .

**–ü–æ—Ä—É—à–µ–Ω–Ω—è —Ü—å–æ–≥–æ –ø—Ä–∏–ø—É—â–µ–Ω–Ω—è:** –ù–∞—à—ñ –∑–±—É—Ä–µ–Ω–Ω—è –º–∞—é—Ç—å —Ä—ñ–∑–Ω—ñ –¥–∏—Å–ø–µ—Ä—Å—ñ—ó.

. . .

[–ì–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω—ñ—Å—Ç—å:]{.hi} $\mathop{\text{Var}} \left( u_i \right) = \sigma^2_i$ —ñ $\sigma^2_i \neq \sigma^2_j$ –¥–ª—è –¥–µ—è–∫–∏—Ö $i\neq j$ .

---

## –û–≥–ª—è–¥

–ö–ª–∞—Å–∏—á–Ω–∏–π –ø—Ä–∏–∫–ª–∞–¥ –≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–æ—Å—Ç—ñ: –≤–æ—Ä–æ–Ω–∫–∞

–î–∏—Å–ø–µ—Ä—Å—ñ—è $u$ –∑—Ä–æ—Å—Ç–∞—î —Ä–∞–∑–æ–º —ñ–∑ $x$

```{r, het ex1, dev = "svg", echo = F, fig.height = 4.5}
set.seed(12345)
ggplot(data = tibble(
  x = runif(1e3, -3, 3),
  e = rnorm(1e3, 0, sd = 4 + 1.5 * x)
), aes(x = x, y = e)) +
geom_point(color = "darkslategrey", size = 2.75, alpha = 0.5) +
labs(x = "x", y = "u") +
theme_axes_math
```

---

## –û–≥–ª—è–¥

–Ü–Ω—à–∏–π –ø—Ä–∏–∫–ª–∞–¥ –≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–æ—Å—Ç—ñ: (–ø–æ–¥–≤—ñ–π–Ω–∞ –≤–æ—Ä–æ–Ω–∫–∞?)

–î–∏—Å–ø–µ—Ä—Å—ñ—è $u$ –∑—Ä–æ—Å—Ç–∞—î –Ω–∞ –∫—Ä–∞–π–Ω—ñ—Ö –∑–Ω–∞—á–µ–Ω–Ω—è—Ö $x$

```{r, het ex2 , dev = "svg", echo = F, fig.height = 4.5}
set.seed(12345)
ggplot(data = tibble(
  x = runif(1e3, -3, 3),
  e = rnorm(1e3, 0, sd = 2 + x^2)
), aes(x = x, y = e)) +
geom_point(color = "darkslategrey", size = 2.75, alpha = 0.5) +
labs(x = "x", y = "u") +
theme_axes_math
```

---

## –û–≥–ª—è–¥

–Ü–Ω—à–∏–π –ø—Ä–∏–∫–ª–∞–¥ –≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–æ—Å—Ç—ñ:

–†—ñ–∑–Ω—ñ –¥–∏—Å–ø–µ—Ä—Å—ñ—ó $u$ –ø–æ –≥—Ä—É–ø–∞–º

```{r, het ex3 , dev = "svg", echo = F, fig.height = 4.5}
set.seed(12345)
ggplot(data = tibble(
  g = sample(c(F,T), 1e3, replace = T),
  x = runif(1e3, -3, 3),
  e = rnorm(1e3, 0, sd = 0.5 + 2 * g)
), aes(x = x, y = e, color = g, shape = g, alpha = g)) +
geom_point(size = 2.75) +
scale_color_manual(values = c("darkslategrey", red_pink)) +
scale_shape_manual(values = c(16, 1)) +
scale_alpha_manual(values = c(0.5, 0.8)) +
labs(x = "x", y = "u") +
theme_axes_math
```

---

## –û–≥–ª—è–¥

[–ì–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω—ñ—Å—Ç—å]{.hi} –ø—Ä–∏—Å—É—Ç–Ω—è, –∫–æ–ª–∏ –¥–∏—Å–ø–µ—Ä—Å—ñ—è $u$ –∑–º—ñ–Ω—é—î—Ç—å—Å—è –∑ –±—É–¥—å-—è–∫–æ—é –∫–æ–º–±—ñ–Ω–∞—Ü—ñ—î—é –Ω–∞—à–∏—Ö –ø–æ—è—Å–Ω—é–≤–∞–ª—å–Ω–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö –≤—ñ–¥ $x_1$ –¥–æ $x_k$.

---

## –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –Ω–∞ –≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–æ—Å—Ç—ñ{.smaller}

–£ –Ω–∞—Å —î –∫—ñ–ª—å–∫–∞ —Ç–µ—Å—Ç—ñ–≤, —è–∫—ñ –º–æ–∂—É—Ç—å –¥–æ–ø–æ–º–æ–≥—Ç–∏ –Ω–∞–º –≤–∏—è–≤–∏—Ç–∏ –≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω—ñ—Å—Ç—å.

- Goldfeld-Quandt
- White
- Breusch-Pagan

. . .

–©–æ –º–∏ —Ä–æ–±–∏–º–æ, —è–∫—â–æ –≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω—ñ—Å—Ç—å –ø—Ä–∏—Å—É—Ç–Ω—è?

# –ñ–∏—Ç—Ç—è –∑ –≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω—ñ—Å—Ç—é

## –ñ–∏—Ç—Ç—è –∑ –≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω—ñ—Å—Ç—é

–ü—Ä–∏ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ –≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–æ—Å—Ç—ñ –ú–ù–ö —î

- –≤—Å–µ —â–µ [–Ω–µ–∑–º—ñ—â–µ–Ω–æ—é]{.hi}
- [–±—ñ–ª—å—à–µ –Ω–µ –Ω–∞–π–µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—à–∏–π]{.hi} –Ω–µ–∑–º—ñ—â–µ–Ω–∏–π –ª—ñ–Ω—ñ–π–Ω–∏–π –æ—Ü—ñ–Ω—é–≤–∞—á

–£ —Å–µ—Ä–µ–¥–Ω—å–æ–º—É –º–∏ –æ—Ç—Ä–∏–º—É—î–º–æ –ø—Ä–∞–≤–∏–ª—å–Ω—É –≤—ñ–¥–ø–æ–≤—ñ–¥—å, –∞–ª–µ –∑ –±—ñ–ª—å—à–∏–º —à—É–º–æ–º (–º–µ–Ω—à–æ—é —Ç–æ—á–Ω—ñ—Å—Ç—é).
<br> *–¢–∞–∫–æ–∂:* –ù–∞—à—ñ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –ø–æ–º–∏–ª–∫–∏ —î –∑–º—ñ—â–µ–Ω–∏–º–∏

. . .

**–û–ø—Ü—ñ—ó:**

1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [—Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—é]{.hi} —Ä–µ–≥—Ä–µ—Å—ñ—ó .
2. –ó–Ω–∞–π–¥—ñ—Ç—å –Ω–æ–≤–∏–π, –±—ñ–ª—å—à –µ—Ñ–µ–∫—Ç–∏–≤–Ω–∏–π [–Ω–µ–∑–º—ñ—â–µ–Ω–∏–π –æ—Ü—ñ–Ω—é–≤–∞—á]{.hi} –¥–ª—è $\beta_j$.
3. –ñ–∏—Ç–∏ –∑ –Ω–µ–µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—é –ú–ù–ö; –∑–Ω–∞–π—Ç–∏ [–Ω–æ–≤–∏–π –∑–∞—Å—ñ–± –æ—Ü—ñ–Ω–∫–∏ –¥–∏—Å–ø–µ—Ä—Å—ñ—ó]{.hi}.
   - –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –ø–æ–º–∏–ª–∫–∏
   - –î–æ–≤—ñ—Ä—á—ñ —ñ–Ω—Ç–µ—Ä–≤–∞–ª–∏
   - –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≥—ñ–ø–æ—Ç–µ–∑

---

## –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞ —Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—è

–Ø–∫ –º–∏ –≤–∂–µ –æ–±–≥–æ–≤–æ—Ä—é–≤–∞–ª–∏, —Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—è –≤–∞—à–æ—ó –º–æ–¥–µ–ª—ñ —Ä–µ–≥—Ä–µ—Å—ñ—ó –º–∞—î –≤–µ–ª–∏–∫–µ –∑–Ω–∞—á–µ–Ω–Ω—è –¥–ª—è –Ω–µ—É–ø–µ—Ä–µ–¥–∂–µ–Ω–æ—Å—Ç—ñ —Ç–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –≤–∞—à–æ–≥–æ –æ—Ü—ñ–Ω—é–≤–∞—á–∞.

**–í—ñ–¥–ø–æ–≤—ñ–¥—å \#1:** –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –≤–∞—à–∞ —Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—è –Ω–µ –≤–∏–∫–ª–∏–∫–∞—î –≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–æ—Å—Ç—ñ.

---

## –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞ —Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—è

*–ü—Ä–∏–∫–ª–∞–¥:* –ù–µ—Ö–∞–π –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å —É –ì–° –±—É–¥–µ $$ y_i = \beta_0 + \beta_1 x_i + \beta_2 x_i^2 + u_i $$

–∑ $\mathop{\boldsymbol{E}}\left[ u_i \middle| x_i \right] = 0$ —ñ $\mathop{\text{Var}} \left( u_i \middle| x_i \right) = \sigma^2$.

–û–¥–Ω–∞–∫ –º–∏ –ø—Ä–æ–ø—É—Å–∫–∞—î–º–æ $x^2$ —ñ –æ—Ü—ñ–Ω—é—î–º–æ $$ y_i = \gamma_0 + \gamma_1 x_i + w_i $$

–¢–æ–¥—ñ $$ w_i = u_i + \beta_2 x_i^2 \implies \mathop{\text{Var}} \left( w_i \right) = f(x_i) $$

_–¢–æ–±—Ç–æ_, –¥–∏—Å–ø–µ—Ä—Å—ñ—è $w_i$ –∑–º—ñ–Ω—é—î—Ç—å—Å—è —Å–∏—Å—Ç–µ–º–∞—Ç–∏—á–Ω–æ –∑ $x_i$ (–≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω—ñ—Å—Ç—å).

---

## –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞ —Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—è

```{r, spec data, include = F}
# Set the seed
set.seed(1234)
# Generate data
spec_df <- tibble(x = runif(1e3, 0, 3), y = exp(0.5 + 0.6 * x + rnorm(1e3, sd = 0.3)))
# Add residuals ('w': wrong specification; 'c': correct specification)
spec_df %<>% mutate(
  e_w = lm(y ~ x, data = spec_df) %>% residuals(),
  e_c = lm(log(y) ~ x, data = spec_df) %>% residuals()
)
```

[–î—ñ–π—Å–Ω—ñ—Å—Ç—å:]{.pink} $\color{#e64173}{\log\left(y_i\right) = \beta_0 + \beta_1 x_i + u_i}$ ‚ÄÉ[**–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞:**]{.slate} $\color{#314f4f}{y_i = \beta_0 + \beta_1 x_i + v_i}$

```{r, spec plot1, echo = F, dev = "svg", fig.height = 5}
ggplot(data = spec_df, aes(x = x)) +
  geom_point(aes(y = e_w), color = "darkslategrey", size = 2.75, alpha = 0.5, shape = 16) +
  geom_point(aes(y = e_c), color = red_pink, size = 2.5, alpha = 0, shape = 19) +
  labs(x = "x", y = "e") +
  theme_axes_math
```

---

## –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞ —Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—è

[–î—ñ–π—Å–Ω—ñ—Å—Ç—å:]{.pink} $\color{#e64173}{\log\left(y_i\right) = \beta_0 + \beta_1 x_i + u_i}$ ‚ÄÉ[**–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞:**]{.slate} $\color{#314f4f}{y_i = \beta_0 + \beta_1 x_i + v_i}$

```{r, spec plot2, echo = F, dev = "svg", fig.height = 5}
ggplot(data = spec_df, aes(x = x)) +
  geom_point(aes(y = e_w), color = "darkslategrey", size = 2.75, alpha = 0.25, shape = 1) +
  geom_point(aes(y = e_c), color = red_pink, size = 2.5, alpha = 0.5, shape = 19) +
  labs(x = "x", y = "e") +
  theme_axes_math
```

---

## –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞ —Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—è

–ë—ñ–ª—å—à –∑–∞–≥–∞–ª—å–Ω–æ:

**–ü—Ä–æ–±–ª–µ–º–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ—ó —Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—ó:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞ —Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—è —Ä–µ–≥—Ä–µ—Å—ñ–π–Ω–æ—ó –º–æ–¥–µ–ª—ñ –º–æ–∂–µ —Å–ø—Ä–∏—á–∏–Ω–∏—Ç–∏ –≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω—ñ—Å—Ç—å (—Å–µ—Ä–µ–¥ —ñ–Ω—à–∏—Ö –ø—Ä–æ–±–ª–µ–º).

. . .

**–†—ñ—à–µ–Ω–Ω—è:** üí° –ó—Ä–æ–±—ñ—Ç—å —Ü–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ (_–Ω–∞–ø—Ä–∏–∫–ª–∞–¥_, –Ω–µ –ø—Ä–æ–ø—É—Å–∫–∞–π—Ç–µ $x^2$).

. . .

**–ù–æ–≤—ñ –ø—Ä–æ–±–ª–µ–º–∏:**

- –ú–∏ —á–∞—Å—Ç–æ –Ω–µ –∑–Ω–∞—î–º–æ *–ø—Ä–∞–≤–∏–ª—å–Ω–æ—ó* —Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—ó.
- –ú–∏ —Ö–æ—Ç—ñ–ª–∏ –± –±—ñ–ª—å—à —Ñ–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É –≤–∏—Ä—ñ—à–µ–Ω–Ω—è –ø—Ä–æ–±–ª–µ–º–∏ –≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–æ—Å—Ç—ñ.

. . .

**–í–∏—Å–Ω–æ–≤–æ–∫: ** –°–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—è —á–∞—Å—Ç–æ –Ω–µ ¬´–≤–∏—Ä—ñ—à–∏—Ç—å¬ª –≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω—ñ—Å—Ç—å.
<br> –û–¥–Ω–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–µ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –º–æ–¥–µ–ª—ñ –≤—Å–µ –æ–¥–Ω–æ —î –¥—É–∂–µ –≤–∞–∂–ª–∏–≤–∏–º.

---

## –ó–≤–∞–∂–µ–Ω–∏–π –ú–ù–ö

–ó–≤–∞–∂–µ–Ω–∏–π –ú–ù–ö (WLS) –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—î —ñ–Ω—à–∏–π –ø—ñ–¥—Ö—ñ–¥.

**–í—ñ–¥–ø–æ–≤—ñ–¥—å \#2:** –ü—ñ–¥–≤–∏—â–µ–Ω–Ω—è –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ —à–ª—è—Ö–æ–º –∑–≤–∞–∂—É–≤–∞–Ω–Ω—è –Ω–∞—à–∏—Ö —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω—å.

. . .

–ù–µ—Ö–∞–π –±—É–¥–µ —Å–ø—Ä–∞–≤–∂–Ω—ñ–º —Å–ø—ñ–≤–≤—ñ–¥–Ω–æ—à–µ–Ω–Ω—è–º –Ω–∞—Å–µ–ª–µ–Ω–Ω—è

$$
\begin{align}
   y_i = \beta_0 + \beta_1 x_{i} + u_i \tag{1}
\end{align}
$$

–∑ $u_i \sim \mathop{N} \left( 0,\, \sigma_i^2 \right)$.

. . .

–¢–µ–ø–µ—Ä –ø–µ—Ä–µ—Ç–≤–æ—Ä—ñ—Ç—å $(1)$, –ø–æ–¥—ñ–ª–∏–≤—à–∏ –¥–∞–Ω—ñ –∫–æ–∂–Ω–æ–≥–æ —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è –Ω–∞ $\sigma_i$, _—Ç–æ–±—Ç–æ_,

$$
\begin{align}
   \dfrac{y_i}{\sigma_i} &= \beta_0 \dfrac{1}{\sigma_i} + \beta_1 \dfrac{x_{i}}{\sigma_i} + \dfrac{u_i}{\sigma_i} \tag{ 2}
\end{align}
$$

---

## –ó–≤–∞–∂–µ–Ω–∏–π –ú–ù–ö

$$
\begin{align}
  y_i &= \beta_0 + \beta_1 x_{i} + u_i \tag{1} \\[1em]
  \dfrac{y_i}{\sigma_i} &= \beta_0 \dfrac{1}{\sigma_i} + \beta_1 \dfrac{x_{i}}{\sigma_i} + \dfrac{u_i}{\sigma_i} \tag{2}
\end{align}
$$

–¢–æ–¥—ñ —è–∫ $(1)$ —î –≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–∏–º, –∞ $\color{#e64173}{(2)}$ [–≥–æ–º–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–∏–º]{.hi}.

‚à¥ –ú–ù–ö –µ—Ñ–µ–∫—Ç–∏–≤–Ω–∏–π —ñ –Ω–µ–∑–º—ñ—â–µ–Ω–Ω–∏–π –¥–ª—è –æ—Ü—ñ–Ω–∫–∏ $\beta_k$ —É $(2)$!

. . .

–ß–æ–º—É $(2)$ —î –≥–æ–º–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–∏–º?

$\mathop{\text{Var}} \left( \dfrac{u_i}{\sigma_i} \middle| x_i \right) =$
 $\dfrac{1}{\sigma_i^2} \mathop{\text{Var}} \left( u_i \middle| x_i \right) =$
 $\dfrac{1}{\sigma_i^2} \sigma_i^2 =$
 $1$

---

## –ó–≤–∞–∂–µ–Ω–∏–π –ú–ù–ö

–ó–ú–ù–ö ‚Äî —Ü–µ —á—É–¥–æ–≤–æ, –∞–ª–µ –Ω–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–Ω–∞—Ç–∏ $\sigma_i^2$, —â–æ, —è–∫ –ø—Ä–∞–≤–∏–ª–æ, –º–∞–ª–æ–π–º–æ–≤—ñ—Ä–Ω–æ.

–ú–∏ –º–æ–∂–µ–º–æ *—Ç—Ä–æ—Ö–∏* –ø–æ—Å–ª–∞–±–∏—Ç–∏ —Ü—é –≤–∏–º–æ–≥—É ‚Äî –∑–∞–º—ñ—Å—Ç—å —Ç–æ–≥–æ, —â–æ–± –≤–∏–º–∞–≥–∞—Ç–∏

1. $\mathop{\text{Var}} \left( u_i | x_i \right) = \sigma_i^2 = \sigma^2 h(x_i)$

2. –ú–∏ –∑–Ω–∞—î–º–æ $h(x)$.

. . .

–Ø–∫ —ñ —Ä–∞–Ω—ñ—à–µ, –º–∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º—É—î–º–æ –Ω–∞—à—É –≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω—É –º–æ–¥–µ–ª—å —É –≥–æ–º–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω—É –º–æ–¥–µ–ª—å. –¶—å–æ–≥–æ —Ä–∞–∑—É –º–∏ –¥—ñ–ª–∏–º–æ –¥–∞–Ω—ñ –∫–æ–∂–Ω–æ–≥–æ —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è[^‚Ä†] –Ω–∞ $\sqrt{h(x_i)}$.

[^‚Ä†]: –†–æ–∑–¥—ñ–ª—ñ—Ç—å *—É—Å—ñ* –¥–∞–Ω—ñ –Ω–∞ $\sqrt{h(x_i)}$, –≤–∫–ª—é—á–Ω–æ –∑ intercept.

---

## –ó–≤–∞–∂–µ–Ω–∏–π –ú–ù–ö

$$
\begin{align}
  y_i &= \beta_0 + \beta_1 x_{i} + u_i \tag{1} \\[1em]
  \dfrac{y_i}{\sqrt{h(x_i)}} &= \beta_0 \dfrac{1}{\sqrt{h(x_i)}} + \beta_1 \dfrac{x_{i}}{\sqrt{h(x_i)}} + \dfrac{u_i}{\sqrt{h(x_i)}} \tag{2}
\end{align}
$$

–∑ $\mathop{\text{Var}} \left( u_i | x_i \right) = \sigma^2 h(x_i)$.

. . .

–¢–µ–ø–µ—Ä –¥–∞–≤–∞–π—Ç–µ –ø–µ—Ä–µ–≤—ñ—Ä–∏–º–æ, —â–æ $(2)$ —Å–ø—Ä–∞–≤–¥—ñ —î –≥–æ–º–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–∏–º.

$\mathop{\text{Var}} \left( \dfrac{u_i}{\sqrt{h(x_i)}} \middle| x_i \right) =$
  $\dfrac{1}{h(x_i)} \mathop{\text{Var}} \left( u_i \middle| x_i \right) =$
  $\dfrac{1}{h(x_i)} \sigma^2 h(x_i) =$
  $\color{#e64173}{\sigma^2}$

[–≥–æ–º–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω—ñ—Å—Ç—å!]{.hi}

---

## –ó–≤–∞–∂–µ–Ω–∏–π –ú–ù–ö {.smaller}

–û—Ü—ñ–Ω—é–≤–∞—á [WLS]{.hi} ‚Äî —Ü–µ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–∏–π –∫–ª–∞—Å –æ—Ü—ñ–Ω–æ–∫ [—É–∑–∞–≥–∞–ª—å–Ω–µ–Ω–∏—Ö –º–µ—Ç–æ–¥—ñ–≤ –Ω–∞–π–º–µ–Ω—à–∏—Ö –∫–≤–∞–¥—Ä–∞—Ç—ñ–≤]{.hi} (GLS), –∑–æ—Å–µ—Ä–µ–¥–∂–µ–Ω–∏—Ö –Ω–∞ –≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–æ—Å—Ç—ñ.

. . .

$$
  y_i = \beta_0 + \beta_1 x_{1i} + u_i \quad \color{#e64173}{\text{ vs. }} \quad
  \dfrac{y_i}{\sigma_i} = \beta_0 \dfrac{1}{\sigma_i} + \beta_1 \dfrac{x_{1i}}{\sigma_i} + \dfrac{u_i}{\sigma_i}
$$

*–ü—Ä–∏–º—ñ—Ç–∫–∏:*

1. WLS **–ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î** –≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω—É –º–æ–¥–µ–ª—å –Ω–∞ –≥–æ–º–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω—É –º–æ–¥–µ–ª—å.
2. **–ó–≤–∞–∂—É–≤–∞–Ω–Ω—è:** WLS –∑–Ω–∏–∂—É—î –≤–∞–≥—É —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω—å —ñ–∑ –≤–∏—â–æ—é –¥–∏—Å–ø–µ—Ä—Å—ñ—î—é $u_i$.
3. **–ó–Ω–∞—á–Ω–∞ –≤–∏–º–æ–≥–∞:** WLS –≤–∏–º–∞–≥–∞—î, —â–æ–± –º–∏ *–∑–Ω–∞–ª–∏* $\sigma_i^2$ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è.
4. WLS, —è–∫ –ø—Ä–∞–≤–∏–ª–æ, **–Ω–µ–º–æ–∂–ª–∏–≤–∏–π**. *–î–æ—Å—Ç—É–ø–Ω–∏–π* GLS (FGLS) –ø—Ä–æ–ø–æ–Ω—É—î —Ä—ñ—à–µ–Ω–Ω—è.
5. –ó–≥—ñ–¥–Ω–æ –∑ –ø—Ä–∏–ø—É—â–µ–Ω–Ω—è–º–∏: WLS —î **–Ω–∞–π–∫—Ä–∞—â–∏–º –ª—ñ–Ω—ñ–π–Ω–∏–º –Ω–µ–∑–º—ñ—â–µ–Ω–∏–º –æ—Ü—ñ–Ω—é–≤–∞—á–µ–º**.

---

## –ì–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–æ-—Ä–æ–±–∞—Å—Ç—ñ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –ø–æ–º–∏–ª–∫–∏

**Heteroskedasticity-robust standard errors**

**–í—ñ–¥–ø–æ–≤—ñ–¥—å \#3:**

- –Ü–≥–Ω–æ—Ä—É–≤–∞—Ç–∏ –Ω–µ–µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å OLS (–ø—Ä–∏ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ –≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–æ—Å—Ç—ñ).
- –ó–æ—Å–µ—Ä–µ–¥—å—Ç–µ—Å—è –Ω–∞ [–Ω–µ–∑–º—ñ—â–µ–Ω–æ—Å—Ç—ñ –æ—Ü—ñ–Ω–∫–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏—Ö –ø–æ–º–∏–ª–æ–∫]{.hi}.
- –Ø–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç: –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π –≤–∏—Å–Ω–æ–≤–æ–∫.

. . .

**Q:** –©–æ —Ç–∞–∫–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞ –ø–æ–º–∏–ª–∫–∞?
<br>**A:** [—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–µ –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è —Ä–æ–∑–ø–æ–¥—ñ–ª—É –æ—Ü—ñ–Ω—é–≤–∞—á–∞]{.hi}.

. . .

–û—Ü—ñ–Ω—é–≤–∞—á—ñ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, $\hat{\beta}_1$) —î –≤–∏–ø–∞–¥–∫–æ–≤–∏–º–∏ –≤–µ–ª–∏—á–∏–Ω–∞–º–∏, —Ç–æ–º—É –≤–æ–Ω–∏ –º–∞—é—Ç—å —Ä–æ–∑–ø–æ–¥—ñ–ª.

–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –ø–æ–º–∏–ª–∫–∏ –¥–∞—é—Ç—å –Ω–∞–º —É—è–≤–ª–µ–Ω–Ω—è –ø—Ä–æ —Ç–µ, –Ω–∞—Å–∫—ñ–ª—å–∫–∏ –≤–∞—Ä—ñ–∞—Ç–∏–≤–Ω–∏–º —î –Ω–∞—à –æ—Ü—ñ–Ω—é–≤–∞—á.

---

## –ì–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–æ-—Ä–æ–±–∞—Å—Ç—ñ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –ø–æ–º–∏–ª–∫–∏

*–ù–∞–≥–∞–¥—É—î–º–æ*: –º–∏ –º–æ–∂–µ–º–æ –∑–∞–ø–∏—Å–∞—Ç–∏ –æ—Ü—ñ–Ω–∫—É –ú–ù–ö –¥–ª—è $\beta_1$ —è–∫

$$ \hat{\beta}_1 = \beta_1 + \dfrac{\sum_i \left( x_i - \overline{x} \right) u_i}{\sum_i \left( x_i - \overline{x} \right)^2} = \beta_1 + \dfrac{\sum_i \left( x_i - \overline{x} \right) u_i}{\text{SST}_x} \tag{3} $$

. . .

–ù–µ—Ö–∞–π $\mathop{\text{Var}} \left( u_i \middle| x_i \right) = \sigma_i^2$.

. . .

–ú–∏ –º–æ–∂–µ–º–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ $(3)$, —â–æ–± –∑–∞–ø–∏—Å–∞—Ç–∏ –¥–∏—Å–ø–µ—Ä—Å—ñ—é $\hat{\beta}_1$, _—Ç–æ–±—Ç–æ_,

$$ \mathop{\text{Var}} \left( \hat{\beta}_1 \middle| x_i \right) = \dfrac{\sum_i \left( x_i - \overline{x} \right)^2 \ sigma_i^2}{\text{SST}_x^2} \tag{4} $$

---

## –ì–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–æ-—Ä–æ–±–∞—Å—Ç—ñ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –ø–æ–º–∏–ª–∫–∏

–Ø–∫—â–æ –º–∏ —Ö–æ—á–µ–º–æ –æ—Ç—Ä–∏–º–∞—Ç–∏ –Ω–µ–∑–º—ñ—â–µ–Ω—É –æ—Ü—ñ–Ω–∫—É —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏—Ö –ø–æ–º–∏–ª–æ–∫, –Ω–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–∞ –Ω–µ–∑–º—ñ—â–µ–Ω–∞ –æ—Ü—ñ–Ω–∫–∞

$$ \dfrac{\sum_i \left( x_i - \overline{x} \right)^2 \sigma_i^2}{\text{SST}_x^2} $$

–ù–∞—à —Å—Ç–∞—Ä–∏–π –¥—Ä—É–≥ –ì–µ–ª –£–∞–π—Ç –Ω–∞–¥–∞–≤ —Ç–∞–∫–∏–π –æ—Ü—ñ–Ω—é–≤–∞—á:[^‚Ä†]

$$ \widehat{\mathop{\text{Var}}} \left( \hat{\beta}_1 \right) = \dfrac{\sum_i \left( x_i - \overline{x} \right)^2 e_i ^2}{\text{SST}_x^2} $$

–¥–µ $e_i$ –ø–æ—Ö–æ–¥–∏—Ç—å –≤—ñ–¥ —Ä–µ–≥—Ä–µ—Å—ñ—ó –ú–ù–ö

[^‚Ä†]: –¶–µ —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–µ —Ä—ñ–≤–Ω—è–Ω–Ω—è –¥–ª—è –ø—Ä–æ—Å—Ç–æ—ó –ª—ñ–Ω—ñ–π–Ω–æ—ó —Ä–µ–≥—Ä–µ—Å—ñ—ó.

---

## –ì–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–æ-—Ä–æ–±–∞—Å—Ç—ñ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –ø–æ–º–∏–ª–∫–∏

–ù–∞—à—ñ —Å—Ç—ñ–π–∫—ñ –¥–æ –≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–æ—Å—Ç—ñ –æ—Ü—ñ–Ω–∫–∏ –¥–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ—ó –ø–æ–º–∏–ª–∫–∏ $\beta_j$.

[–í–∏–ø–∞–¥–æ–∫ 1]{.hi} –ü—Ä–æ—Å—Ç–∞ –ª—ñ–Ω—ñ–π–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è, $y_i = \beta_0 + \beta_1 x_i + u_i$

$$ \widehat{\mathop{\text{Var}}} \left( \hat{\beta}_1 \right) = \dfrac{\sum_i \left( x_i - \overline{x} \right)^2 e_i^2}{\text{SST}_x^2} $$

[–í–∏–ø–∞–¥–æ–∫ 2]{.hi} –ú–Ω–æ–∂–∏–Ω–Ω–∞ –ª—ñ–Ω—ñ–π–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è, $y_i = \beta_0 + \beta_1 x_{1i} + \cdots + \beta_k x_{ki} + u_i$

$$ \widehat{\mathop{\text{Var}}} \left( \hat{\beta}_j \right) = \dfrac{\sum_i \hat{r}_{ij}^2 e_i^2}{\text{SST}_{x_j^2}} $$

–¥–µ $\hat{r}_{ij}$ –ø–æ–∑–Ω–∞—á–∞—î $i$ –∑–∞–ª–∏—à–æ–∫ –≤—ñ–¥ —Ä–µ–≥—Ä–µ—Å—ñ—ó $x_j$ –¥–ª—è –≤—Å—ñ—Ö —ñ–Ω—à–∏—Ö –ø–æ—è—Å–Ω—é–≤–∞–ª—å–Ω–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö.

---

## –ì–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–æ-—Ä–æ–±–∞—Å—Ç—ñ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –ø–æ–º–∏–ª–∫–∏

–ó —Ü–∏–º–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–º–∏ –ø–æ–º–∏–ª–∫–∞–º–∏ –º–∏ –º–æ–∂–µ–º–æ –ø–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—è –¥–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–æ–≥–æ –≤–∏—Å–Ω–æ–≤–∫—É

_–ù–∞–ø—Ä–∏–∫–ª–∞–¥_, –º–∏ –º–æ–∂–µ–º–æ –æ–Ω–æ–≤–∏—Ç–∏ –Ω–∞—à—É –ø–æ–ø–µ—Ä–µ–¥–Ω—é —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω—É —Ñ–æ—Ä–º—É–ª—É $t$ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –Ω–∞—à–∏—Ö –Ω–æ–≤–∏—Ö —Å—Ç—ñ–π–∫–∏—Ö –¥–æ –≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–æ—Å—Ç—ñ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏—Ö –ø–æ–º–∏–ª–æ–∫.

$$ t = \dfrac{\text{Estimate} - \text{Hypothesized value}}{\text{Standard error}} $$

---

## –ì–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–æ-—Ä–æ–±–∞—Å—Ç—ñ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –ø–æ–º–∏–ª–∫–∏

**–ü—Ä–∏–º—ñ—Ç–∫–∏**

- –ú–∏ –≤—Å–µ —â–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ [OLS –æ—Ü—ñ–Ω–∫–∏ –¥–ª—è]{.hi} $\color{#e64173}{\beta_j}$
- –ù–∞—à—ñ —Ä–æ–±–∞—Å—Ç—ñ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –ø–æ–º–∏–ª–∫–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å [—ñ–Ω—à–∏–π –æ—Ü—ñ–Ω—é–≤–∞—á]{.hi}.
- –ì–æ–º–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω—ñ—Å—Ç—å
   - –ó–≤–∏—á–∞–π–Ω–∞ –æ—Ü—ñ–Ω–∫–∞ –¥–∏—Å–ø–µ—Ä—Å—ñ—ó OLS –±—ñ–ª—å—à –µ—Ñ–µ–∫—Ç–∏–≤–Ω–∞.
   - Het.-robust –≤—Å–µ —â–µ –Ω–µ–∑–º—ñ—â–µ–Ω–∞
- –ì–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω—ñ—Å—Ç—å
   - –ó–≤–∏—á–∞–π–Ω–∞ –æ—Ü—ñ–Ω–∫–∞ –¥–∏—Å–ø–µ—Ä—Å—ñ—ó –ú–ù–ö —î –∑–º—ñ—â–µ–Ω–æ—é.
   - Het.-—Ä–æ–±–∞—Å—Ç–Ω–∞ –æ—Ü—ñ–Ω–∫–∞ –¥–∏—Å–ø–µ—Ä—Å—ñ—ó —î –Ω–µ–∑–º—ñ—â–µ–Ω–æ—é.

---

## –ì–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–æ-—Ä–æ–±–∞—Å—Ç—ñ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –ø–æ–º–∏–ª–∫–∏

–¶—ñ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –ø–æ–º–∏–ª–∫–∏ –º–∞—é—Ç—å –±–∞–≥–∞—Ç–æ –Ω–∞–∑–≤

- Heteroskedasticity-robust standard errors
- Het.-robust standard errors
- White standard errors
- Eicker-White standard errors
- Huber standard errors
- Eicker-Huber-White standards errors
- (–¥–µ—è–∫—ñ —ñ–≥—à—ñ –∫–æ–º–±—ñ–Ω–∞—Ü—ñ—ó Eicker, Huber, and White)

# –ü—Ä–∏–∫–ª–∞–¥: –°–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—è –º–æ–¥–µ–ª—ñ

## –ü—Ä–∏–∫–ª–∞–¥

–ü–æ–≤–µ—Ä—Ç–∞—î–º–æ—Å—å –¥–æ –Ω–∞—à–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç—É‚Ä¶

```{r, ex test data}
# Load packages
library(pacman)
p_load(tidyverse, Ecdat)

test_df <- Caschool %>% select(
  test_score = testscr, ratio = str, income = avginc, enrollment = enrltot
) %>% as_tibble()

head(test_df, 2)
```

---

## –ü—Ä–∏–∫–ª–∞–¥: –°–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—è –º–æ–¥–µ–ª—ñ

–ú–∏ –≤–∏—è–≤–∏–ª–∏ –∑–Ω–∞—á–Ω—ñ –¥–æ–∫–∞–∑–∏ –≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–æ—Å—Ç—ñ.

–î–∞–≤–∞–π—Ç–µ –ø–µ—Ä–µ–≤—ñ—Ä–∏–º–æ, —á–∏ —Ü–µ —Å—Ç–∞–ª–æ—Å—è —á–µ—Ä–µ–∑ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—É —Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—é –Ω–∞—à–æ—ó –º–æ–¥–µ–ª—ñ.

---

## –ü—Ä–∏–∫–ª–∞–¥: –°–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—è –º–æ–¥–µ–ª—ñ

Model[1]{.sub}: $\text{Score}_i = \beta_0 + \beta_1 \text{Ratio}_i + \beta_2 \text{Income}_i + u_i$
<br>`lm(test_score ~ ratio + income, data = test_df)`

```{r, ex spec1, echo = F, dev = "svg", fig.height = 4.75}
# Model 1: test ~ ratio + income
test_df %<>% mutate(e1 = lm(test_score ~ ratio + income, data = test_df) %>% residuals())
# Plot
ggplot(data = test_df, aes(x = income, y = e1)) +
geom_point(size = 3, alpha = 0.5, color = red_pink) +
labs(x = "Income", y = TeX("\\textit{e}")) +
theme_axes_serif
```

---

## –ü—Ä–∏–∫–ª–∞–¥: –°–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—è –º–æ–¥–µ–ª—ñ

Model[2]{.sub}: $\log\left(\text{Score}_i\right) = \beta_0 + \beta_1 \text{Ratio}_i + \beta_2 \text{Income}_i + u_i$
<br>`lm(log(test_score) ~ ratio + income, data = test_df)`


```{r, ex spec2, echo = F, dev = "svg", fig.height = 4.75}
# Model 1: test ~ ratio + income
test_df %<>% mutate(e2 = lm(log(test_score) ~ ratio + income, data = test_df) %>% residuals())
# Plot
ggplot(data = test_df, aes(x = income)) +
geom_point(aes(y = e2), size = 3, alpha = 0.5, color = red_pink) +
labs(x = "Income", y = TeX("\\textit{e}")) +
theme_axes_serif
```

---

## –ü—Ä–∏–∫–ª–∞–¥: –°–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—è –º–æ–¥–µ–ª—ñ

Model[3]{.sub}: $\log\left(\text{Score}_i\right) = \beta_0 + \beta_1 \text{Ratio}_i + \beta_2 \log\left(\text{Income}_i\right) + u_i$
<br>`lm(log(test_score) ~ ratio + log(income), data = test_df)`

```{r, ex spec3, echo = F, dev = "svg", fig.height = 4.75}
# Model 1: test ~ ratio + income
test_df %<>% mutate(e3 = lm(log(test_score) ~ ratio + log(income), data = test_df) %>% residuals())
# Plot
ggplot(data = test_df, aes(x = log(income))) +
geom_point(aes(y = e3), size = 3, alpha = 0.5, color = red_pink) +
labs(x = "Log(Income)", y = TeX("\\textit{e}")) +
theme_axes_serif
```

---

## –ü—Ä–∏–∫–ª–∞–¥: –°–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—è –º–æ–¥–µ–ª—ñ

–î–∞–≤–∞–π—Ç–µ –ø–µ—Ä–µ–≤—ñ—Ä–∏–º–æ —Ü—é –Ω–æ–≤—É —Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—é –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ç–µ—Å—Ç—É –£–∞–π—Ç–∞ –Ω–∞ –≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω—ñ—Å—Ç—å.

Model[3]{.sub}: $\log\left(\text{Score}_i\right) = \beta_0 + \beta_1 \text{Ratio}_i + \beta_2 \log\left(\text{Income}_i\right) + u_i$

```{r, ex spec test, include = F}
white_r2_spec <- lm(e3^2 ~
  ratio * log(income) + I(ratio^2) + I(log(income)^2),
  data = test_df
) %>% summary() %$% r.squared
white_stat_spec <- white_r2_spec %>% multiply_by(420)
```

. . .

–†–µ–≥—Ä–µ—Å—ñ—è –¥–ª—è —Ç–µ—Å—Ç—É –£–∞–π—Ç–∞

. . .

$$
\begin{align}
  e_i^2 = &\alpha_0 + \alpha_1 \text{Ratio}_i + \alpha_2 \log\left(\text{Income}_i\right) + \alpha_3 \text{Ratio}_i^2 + \alpha_4 \left(\log\left(\text{Income}_i\right)\right)^2 \\
  &+ \alpha_5 \left(\text{Ratio}_i\times\log\left(\text{Income}_i\right)\right) + v_i
\end{align}
$$

. . .

 $R_e^2\approx`r round(white_r2_spec, 3)`$
—ñ —Ç–µ—Å—Ç–æ–≤–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
 $\widehat{\text{LM}} = n\times R_e^2 \approx `r round(white_stat_spec, 1)`$.

. . .

H~0~ $\text{LM}$ —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω–∞ —è–∫ $\chi_5^2$ $\implies$ *p*-value $\approx$ `r pchisq(white_stat_spec, 5, lower.tail = F) %>% round(3)`.

. . .

‚à¥ [–í—ñ–¥—Ö–∏–ª—è—î–º–æ H~0~]{.hi} [–í–∏—Å–Ω–æ–≤–æ–∫:]{.hi}  –Ü—Å–Ω—É—é—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–æ –∑–Ω–∞—á—É—â—ñ –¥–æ–∫–∞–∑–∏ –≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–æ—Å—Ç—ñ –Ω–∞ –ø‚Äô—è—Ç–∏–≤—ñ–¥—Å–æ—Ç–∫–æ–≤–æ–º—É —Ä—ñ–≤–Ω—ñ.

---

## –ü—Ä–∏–∫–ª–∞–¥: –°–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—è –º–æ–¥–µ–ª—ñ

–ì–∞—Ä–∞–∑–¥, –º–∏ —Å–ø—Ä–æ–±—É–≤–∞–ª–∏ —Å–∫–æ—Ä–µ–≥—É–≤–∞—Ç–∏ –Ω–∞—à—É —Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—é, –∞–ª–µ –≤—Å–µ —â–µ —î –¥–æ–∫–∞–∑–∏ –≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–æ—Å—Ç—ñ.

**–î–∞–ª—ñ:** –ó–∞–≥–∞–ª–æ–º, –≤–∏ –∑–≤–µ—Ä–Ω–µ—Ç–µ—Å—è –¥–æ —Å—Ç—ñ–π–∫–∏—Ö –¥–æ –≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–æ—Å—Ç—ñ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏—Ö –ø–æ–º–∏–ª–æ–∫.

- OLS –≤—Å–µ —â–µ –Ω–µ—É–ø–µ—Ä–µ–¥–∂–µ–Ω–∏–π –¥–ª—è [–∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç—ñ–≤]{.hi} ($\beta_j$')

- –°—Ç—ñ–π–∫—ñ –¥–æ –≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–æ—Å—Ç—ñ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –ø–æ–º–∏–ª–∫–∏ —î –Ω–µ–∑–º—ñ—â–µ–Ω–∏–º–∏ –¥–ª—è [—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏—Ö –ø–æ–º–∏–ª–æ–∫]{.hi} $\hat{\beta}_j$, _—Ç–æ–±—Ç–æ_, $\sqrt{\mathop{\text{Var}} \left( \hat{\beta}_j \right)}$.

# –ü—Ä–∏–∫–ª–∞–¥: Het.-robust standard errors

## –ü—Ä–∏–∫–ª–∞–¥: Het.-robust standard errors

–ü–æ–≤–µ—Ä—Ç–∞—î–º–æ—Å—å –¥–æ –º–æ–¥–µ–ª—ñ

$$ \text{Score}_i = \beta_0 + \beta_1 \text{Ratio}_i + \beta_2 \text{Income}_i + u_i $$
–ú–∏ –º–æ–∂–µ–º–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –ø–∞–∫–µ—Ç `fixest` —É `R` –¥–ª—è –æ–±—á–∏—Å–ª–µ–Ω–Ω—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏—Ö –ø–æ–º–∏–ª–æ–∫.

---

## –ü—Ä–∏–∫–ª–∞–¥: Het.-robust standard errors

$$ \text{Score}_i = \beta_0 + \beta_1 \text{Ratio}_i + \beta_2 \text{Income}_i + u_i $$

1\. –ó–∞–ø—É—Å—Ç—ñ—Ç—å —Ä–µ–≥—Ä–µ—Å—ñ—é –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `feols()` (–∑–∞–º—ñ—Å—Ç—å `lm()`)

```{r, fixest1}
# Load 'fixest' package
p_load(fixest)
# Regress log score on ratio and log income
test_reg <- feols(test_score ~ ratio + income, data = test_df)
```

. . .

*–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É*, —â–æ `feols()` –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Ç–æ–π —Å–∞–º–∏–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å, —â–æ —ñ `lm()` –¥–ª—è —Ü—ñ—î—ó —Ä–µ–≥—Ä–µ—Å—ñ—ó.

---

## –ü—Ä–∏–∫–ª–∞–¥: Het.-robust standard errors

$$ \text{Score}_i = \beta_0 + \beta_1 \text{Ratio}_i + \beta_2 \text{Income}_i + u_i $$
2\. –û—Ü—ñ–Ω—ñ—Ç—å het.-robust standard errors –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –æ–ø—Ü—ñ—ó `vcov = 'hetero'` –≤ `summary()`

```{r, fixest2a, eval = F}
# Het-robust standard errors with 'vcov = 'hetero''
summary(test_reg, vcov = 'hetero')
```

```{r, fixest2b, echo = F}
test_het_out <- summary(test_reg, vcov = 'hetero') %>% capture.output()
test_het_out[4:7] %>% paste0("\n") %>% cat()
```

---

## –ü—Ä–∏–∫–ª–∞–¥: Het.-robust standard errors

–ö–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç–∏ —Ç–∞ **–≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–æ-—Ä–æ–±–∞—Å—Ç—ñ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –ø–æ–º–∏–ª–∫–∏**:

```{r, fixest3, eval = F}
summary(test_reg, vcov = 'hetero')
```

```{r, fixest4, echo = F}
test_het_out <- summary(test_reg, vcov = 'hetero') %>% capture.output()
test_het_out[4:7] %>% paste0("\n") %>% cat()
```

–ö–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç–∏ —Ç–∞ **–ø—Ä–æ—Å—Ç—ñ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –ø–æ–º–∏–ª–∫–∏ OLS** (–ø—Ä–∏–ø—É—Å–∫–∞—î—Ç—å—Å—è –≥–æ–º–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω—ñ—Å—Ç—å):

```{r, fixest5, eval = F}
summary(test_reg, vcov = 'iid')
```

```{r, fixest6, echo = F}
test_hom_out <- summary(test_reg, vcov = 'iid') %>% capture.output()
test_hom_out[4:7] %>% paste0("\n") %>% cat()
```

# –ü—Ä–∏–∫–ª–∞–¥: WLS

## –ü—Ä–∏–∫–ª–∞–¥: WLS

–ú–∏ –∑–≥–∞–¥—É–≤–∞–ª–∏, —â–æ WLS —á–∞—Å—Ç–æ –Ω–µ–º–æ–∂–ª–∏–≤–∏–π ‚Äî –Ω–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–Ω–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—É —Ñ–æ—Ä–º—É –≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–æ—Å—Ç—ñ ‚Äî –∞–±–æ

**A**\. $\sigma_i^2$

–∞–±–æ

**B**\. $h(x_i)$, –¥–µ $\sigma_i^2 = \sigma^2 h(x_i)$

. . .

–Ñ –≤–∏–ø–∞–¥–∫–∏, –∫–æ–ª–∏ –º–∏ –º–æ–∂–µ–º–æ –∑–Ω–∞—Ç–∏ $h(x_i)$.

---

## –ü—Ä–∏–∫–ª–∞–¥: WLS

–£—è–≤—ñ—Ç—å, —â–æ –æ–∫—Ä–µ–º—ñ –æ—Å–æ–±–∏ –≤ –ø–æ–ø—É–ª—è—Ü—ñ—ó –º–∞—é—Ç—å –≥–æ–º–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω—ñ —Ä–æ–∑–ª–∞–¥–∏.

–û–¥–Ω–∞–∫ –∑–∞–º—ñ—Å—Ç—å —Ç–æ–≥–æ, —â–æ–± —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—Ç–∏ –∑–∞ —ñ–Ω–¥–∏–≤—ñ–¥—É–∞–ª—å–Ω–∏–º–∏ –¥–∞–Ω–∏–º–∏, –º–∏ —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—î–º–æ (—É –¥–∞–Ω–∏—Ö) —Å–µ—Ä–µ–¥–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –¥–ª—è –≥—Ä—É–ø (_–Ω–∞–ø—Ä–∏–∫–ª–∞–¥_, –º—ñ—Å—Ç, –æ–∫—Ä—É–≥—ñ–≤, —à–∫—ñ–ª—å–Ω–∏—Ö –æ–∫—Ä—É–≥—ñ–≤).

–Ø–∫—â–æ —Ü—ñ –≥—Ä—É–ø–∏ –º–∞—é—Ç—å —Ä—ñ–∑–Ω—ñ —Ä–æ–∑–º—ñ—Ä–∏, —Ç–æ–¥—ñ –Ω–∞—à –Ω–∞–±—ñ—Ä –¥–∞–Ω–∏—Ö –±—É–¥–µ –≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–∏–º ‚Äî –ø–µ—Ä–µ–¥–±–∞—á—É–≤–∞–Ω–∏–º —Å–ø–æ—Å–æ–±–æ–º.

**–ù–∞–≥–∞–¥—É—î–º–æ:** –î–∏—Å–ø–µ—Ä—Å—ñ—è –≤–∏–±—ñ—Ä–∫–æ–≤–æ–≥–æ —Å–µ—Ä–µ–¥–Ω—å–æ–≥–æ –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ —Ä–æ–∑–º—ñ—Ä—É –≤–∏–±—ñ—Ä–∫–∏,
$$ \mathop{\text{Var}} \left( \overline{x} \right) = \dfrac{\sigma_x^2}{n} $$

. . .

**–ü—Ä–∏–∫–ª–∞–¥:** –ù–∞—à—ñ –¥–∞–Ω—ñ —à–∫—ñ–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è —É—Å–µ—Ä–µ–¥–Ω–µ–Ω—ñ –Ω–∞ —Ä—ñ–≤–Ω—ñ —à–∫–æ–ª–∏.

---

## –ü—Ä–∏–∫–ª–∞–¥: WLS

*–ü—Ä–∏–∫–ª–∞–¥:* –ù–∞—à—ñ –¥–∞–Ω—ñ —à–∫—ñ–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è —É—Å–µ—Ä–µ–¥–Ω–µ–Ω—ñ –Ω–∞ —Ä—ñ–≤–Ω—ñ —à–∫–æ–ª–∏.

–ù–∞–≤—ñ—Ç—å —è–∫—â–æ –æ–∫—Ä–µ–º—ñ —É—á–Ω—ñ –º–∞—é—Ç—å –≥–æ–º–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω—ñ –ø–æ—Ä—É—à–µ–Ω–Ω—è, —É —à–∫–æ–ª–∞—Ö –±—É–¥—É—Ç—å –≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω—ñ –ø–æ—Ä—É—à–µ–Ω–Ω—è, _—Ç–æ–±—Ç–æ_,

**–ú–æ–¥–µ–ª—å —ñ–Ω–¥–∏–≤—ñ–¥—É–∞–ª—å–Ω–æ–≥–æ —Ä—ñ–≤–Ω—è:** $\quad \text{Score}_i = \beta_0 + \beta_1 \text{Ratio}_i + \beta_2 \text{Income}_i + u_i$

**–ú–æ–¥–µ–ª—å —à–∫—ñ–ª—å–Ω–æ–≥–æ —Ä—ñ–≤–Ω—è:** $\quad \overline{\text{Score}}_s = \beta_0 + \beta_1 \overline{\text{Ratio}}_s + \beta_2 \overline{\text{Income}}_s + \overline{u}_s$

–¥–µ —ñ–Ω–¥–µ–∫—Å $s$ –ø–æ–∑–Ω–∞—á–∞—î –æ–∫—Ä–µ–º—É —à–∫–æ–ª—É (—Ç–∞–∫ —Å–∞–º–æ, —è–∫ $i$ —ñ–Ω–¥–µ–∫—Å—É—î –æ–∫—Ä–µ–º—É –æ—Å–æ–±—É).

$$ \mathop{\text{Var}} \left( \overline{u}_s \right) = \dfrac{\sigma^2}{n_s} $$

---

## –ü—Ä–∏–∫–ª–∞–¥: WLS

–î–ª—è WLS –º–∏ —à—É–∫–∞—î–º–æ —Ñ—É–Ω–∫—Ü—ñ—é $h(x_s)$ —Ç–∞–∫—É, —â–æ $\mathop{\text{Var}} \left( \overline{u}_s | x_s \right) = \sigma^2 h(x_s )$.

. . .

–ú–∏ —â–æ–π–Ω–æ –ø–æ–∫–∞–∑–∞–ª–∏, —â–æ $\mathop{\text{Var}} \left( \overline{u}_s |x_s \right) = \dfrac{\sigma^2}{ n_s}$.

. . .

–¢–∞–∫–∏–º —á–∏–Ω–æ–º, $h(x_s) = 1/n_s$, –¥–µ $n_s$ ‚Äì –∫—ñ–ª—å–∫—ñ—Å—Ç—å —É—á–Ω—ñ–≤ —É —à–∫–æ–ª—ñ $s$.

. . .

–©–æ–± —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ WLS, –º–∏ –¥—ñ–ª–∏–º–æ –¥–∞–Ω—ñ –∫–æ–∂–Ω–æ–≥–æ —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è –Ω–∞ $1/\sqrt{h(x_s)}$, —Ç–æ–±—Ç–æ –Ω–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–æ–º–Ω–æ–∂–∏—Ç–∏ –¥–∞–Ω—ñ –∫–æ–∂–Ω–æ—ó —à–∫–æ–ª–∏ –Ω–∞ $\sqrt{n_s}$.

. . .

–ó–º—ñ–Ω–Ω–∞ `enrollment` —É –Ω–∞–±–æ—Ä—ñ –¥–∞–Ω–∏—Ö `test_df` —î –Ω–∞—à–∏–º $n_s$.

---

## –ü—Ä–∏–∫–ª–∞–¥: WLS

–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è WLS –¥–ª—è –æ—Ü—ñ–Ω–∫–∏ $\text{Score}_i = \beta_0 + \beta_1 \text{Ratio}_i + \beta_2 \text{Income}_i + u_i$

**–ö—Ä–æ–∫ 1:** –ü–æ–º–Ω–æ–∂—Ç–µ –∫–æ–∂–Ω—É –∑–º—ñ–Ω–Ω—É –Ω–∞ $1/\sqrt{h(x_i)} = \sqrt{\text{Enrollment}_i}$

```{r, wls1}
# Create WLS transformed variables, multiplying by sqrt of 'pop'
test_df <- mutate(test_df,
  test_score_wls = test_score * sqrt(enrollment),
  ratio_wls      = ratio * sqrt(enrollment),
  income_wls     = income * sqrt(enrollment),
  intercept_wls  = 1 * sqrt(enrollment)
)
```

–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –º–∏ —Å—Ç–≤–æ—Ä—é—î–º–æ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–µ intercept

---

## –ü—Ä–∏–∫–ª–∞–¥: WLS

–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è WLS –¥–ª—è –æ—Ü—ñ–Ω–∫–∏ $\text{Score}_i = \beta_0 + \beta_1 \text{Ratio}_i + \beta_2 \text{Income}_i + u_i$

**–ö—Ä–æ–∫ 2:** –ó–∞–ø—É—Å—Ç—ñ—Ç—å –Ω–∞—à—É —Ä–µ–≥—Ä–µ—Å—ñ—é WLS (—Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–æ–≤–∞–Ω—É).

```{r, wls2}
# WLS regression
wls_reg <- lm(
  test_score_wls ~ -1 + intercept_wls + ratio_wls + income_wls,
  data = test_df
)
```

. . .

*–ü—Ä–∏–º—ñ—Ç–∫–∞: * ¬´-1¬ª —É –Ω–∞—à—ñ–π —Ä–µ–≥—Ä–µ—Å—ñ—ó –ø–æ–≤—ñ–¥–æ–º–ª—è—î `R` –Ω–µ –¥–æ–¥–∞–≤–∞—Ç–∏ intercept, –æ—Å–∫—ñ–ª—å–∫–∏ –º–∏ –¥–æ–¥–∞—î–º–æ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–µ intercept (`intercept_wls`).

---

## –ü—Ä–∏–∫–ª–∞–¥: WLS

[O—Ü—ñ–Ω–∫–∏ WLS —ñ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –ø–æ–º–∏–ª–∫–∏:]{.hi}

```{r, wls3, echo = F}
# Grab the summary
test_wls_out <- summary(wls_reg) %>% capture.output()
# Print the coefficients
test_wls_out[11:14] %>% paste0("\n") %>% cat()
```

. . .

<br>
–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –ø–æ–º–∏–ª–∫–∏ [–ú–ù–ö]{.hi} —ñ [het.-robust:]{.hi}

```{r, wls4, echo = F}
# Print the coefficients
test_het_out[4:7] %>% paste0("\n") %>% cat()
```

---

## –ü—Ä–∏–∫–ª–∞–¥: WLS

–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ –≤–ª–∞—Å–Ω–æ–º—É –∑–≤–∞–∂—É–≤–∞–Ω–Ω—é: –Ω–∞–¥–∞–π—Ç–µ `lm()` –¥–µ—è–∫—ñ `weights`.

```{r, wls5, eval = F}
lm(test_score ~ ratio + income, data = test_df, weights = enrollment)
```

---

## –ü—Ä–∏–∫–ª–∞–¥: WLS

–£ —Ü—å–æ–º—É –ø—Ä–∏–∫–ª–∞–¥—ñ

- [–ì–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–æ-—Ä–æ–±–∞—Å—Ç—ñ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –ø–æ–º–∏–ª–∫–∏]{.hi} –Ω–µ —Å–∏–ª—å–Ω–æ –∑–º—ñ–Ω–∏–ª–∏ –Ω–∞—à—ñ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –ø–æ–º–∏–ª–∫–∏ (–ø–æ—Ä—ñ–≤–Ω—è–Ω–æ –∑ –ø—Ä–æ—Å—Ç–∏–º–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–º–∏ –ø–æ–º–∏–ª–∫–∞–º–∏ OLS).

- [WLS]{.hi} –¥–µ—â–æ –∑–º—ñ–Ω–∏–≤ –Ω–∞—à—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ ‚Äî –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç–∏ —Ç–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –ø–æ–º–∏–ª–∫–∏.

. . .

–¶—ñ –ø—Ä–∏–∫–ª–∞–¥–∏ –ø—ñ–¥–∫—Ä–µ—Å–ª–∏–ª–∏ –∫—ñ–ª—å–∫–∞ —Ä–µ—á–µ–π:

1. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ—Ü—ñ–Ω—é–≤–∞—á–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏—Ö –ø–æ–º–∏–ª–æ–∫ –¥—ñ–π—Å–Ω–æ –º–∞—î –∑–Ω–∞—á–µ–Ω–Ω—è.

2. –ï–∫–æ–Ω–æ–º–µ—Ç—Ä–∏–∫–∞ –Ω–µ –∑–∞–≤–∂–¥–∏ –ø—Ä–æ–ø–æ–Ω—É—î –æ—á–µ–≤–∏–¥–Ω–æ *–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π* –º–∞—Ä—à—Ä—É—Ç.

. . .

–©–æ–± –ø–æ–±–∞—á–∏—Ç–∏ \#1, –¥–∞–≤–∞–π—Ç–µ –∑–∞–ø—É—Å—Ç–∏–º–æ —Å–∏–º—É–ª—è—Ü—ñ—é.

---

## –°–∏–º—É–ª—è—Ü—ñ—è

```{r, sim params, include = F}
b0 <- 1L
b1 <- 10L
```

–î–∞–≤–∞–π—Ç–µ —Ä–æ–∑–≥–ª—è–Ω–µ–º–æ –ø—Ä–æ—Å—Ç—É –º–æ–¥–µ–ª—å –ª—ñ–Ω—ñ–π–Ω–æ—ó —Ä–µ–≥—Ä–µ—Å—ñ—ó –∑ –≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω—ñ—Å—Ç—é.

$$ y_i = \underbrace{\beta_0}_{=`r b0`} + \underbrace{\beta_1}_{=`r b1`} x_i + u_i $$
–¥–µ $\mathop{\text{Var}} \left( u_i | x_i \right) = \sigma_i^2 = \sigma^2 x_i^2$.

. . .

```{r, sim plot y, echo = F, fig.height = 4}
set.seed(12345)
ggplot(data = tibble(
  x = runif(1e3, 0.5, 1.5),
  y = b0 + b1 * x + rnorm(1e3, 0, sd = x^2)
), aes(x = x, y = y)) +
geom_point(color = "darkslategrey", size = 2.75, alpha = 0.5) +
geom_abline(intercept = b0, slope = b1, color = "orange", size = 1.5, alpha = 0.85) +
labs(x = "x", y = "y") +
theme_axes_math
```

---

## –°–∏–º—É–ª—è—Ü—ñ—è

–î–∞–≤–∞–π—Ç–µ —Ä–æ–∑–≥–ª—è–Ω–µ–º–æ –ø—Ä–æ—Å—Ç—É –º–æ–¥–µ–ª—å –ª—ñ–Ω—ñ–π–Ω–æ—ó —Ä–µ–≥—Ä–µ—Å—ñ—ó –∑ –≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω—ñ—Å—Ç—é.

$$ y_i = \underbrace{\beta_0}_{=`r b0`} + \underbrace{\beta_1}_{=`r b1`} x_i + u_i $$
–¥–µ $\mathop{\text{Var}} \left( u_i | x_i \right) = \sigma_i^2 = \sigma^2 x_i^2$.

```{r, sim plot u, echo = F, fig.height = 4}
set.seed(12345)
ggplot(data = tibble(
  x = runif(1e3, 0.5, 1.5),
  u = rnorm(1e3, 0, sd = x^2)
), aes(x = x, y = u)) +
geom_point(color = "darkslategrey", size = 2.75, alpha = 0.5) +
labs(x = "x", y = "u") +
theme_axes_math
```

---

## –°–∏–º—É–ª—è—Ü—ñ—è

*–ü—Ä–∏–º—ñ—Ç–∫–∞ —â–æ–¥–æ WLS:*

–û—Å–∫—ñ–ª—å–∫–∏ $\mathop{\text{Var}} \left( u_i | x_i \right) = \sigma^2 x_i^2$,

$$ \mathop{\text{Var}} \left( u_i | x_i \right) = \sigma^2 h(x_i) \implies h(x_i) = x_i^2 $$

WLS –º–Ω–æ–∂–∏—Ç—å –∫–æ–∂–Ω—É –∑–º—ñ–Ω–Ω—É –Ω–∞ $1/\sqrt{h(x_i)} = 1/x_i$.

---

## –°–∏–º—É–ª—è—Ü—ñ—è

–£ —Ü—ñ–π —Å–∏–º—É–ª—è—Ü—ñ—ó –º–∏ —Ö–æ—á–µ–º–æ –ø–æ—Ä—ñ–≤–Ω—è—Ç–∏

1. **–ï—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å**
   - OLS
   - WLS –∑ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–º–∏ –≤–∞–≥–∞–º–∏: $h(x_i) = x_i$
   - WLS –∑ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–º–∏ –≤–∞–≥–∞–º–∏: $h(x_i) = \sqrt{x_i}$

2. –ù–∞—Å–∫—ñ–ª—å–∫–∏ –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ –Ω–∞—à—ñ **—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –ø–æ–º–∏–ª–∫–∏** (—á–µ—Ä–µ–∑ –¥–æ–≤—ñ—Ä—á—ñ —ñ–Ω—Ç–µ—Ä–≤–∞–ª–∏) –∑—ñ
   - –ó–≤–∏—á–∞–π–Ω—ñ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –ø–æ–º–∏–ª–∫–∏ OLS
   - Heteroskedasticity-robust standard errors
   - –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –ø–æ–º–∏–ª–∫–∏ WLS

---

## –°–∏–º—É–ª—è—Ü—ñ—è

–ê–ª–≥–æ—Ä–∏—Ç–º —Å–∏–º—É–ª—è—Ü—ñ—ó:

–í–∏–∫–æ–Ω–∞–π—Ç–µ 10 000 —Ä–∞–∑—ñ–≤:

1. –ó–≥–µ–Ω–µ—Ä—É–π—Ç–µ –≤–∏–±—ñ—Ä–∫—É —Ä–æ–∑–º—ñ—Ä–æ–º 30 —ñ–∑ —Å—É–∫—É–ø–Ω–æ—Å—Ç—ñ

2. –û–±—á–∏—Å–ª—ñ—Ç—å/–∑–±–µ—Ä–µ–∂—ñ—Ç—å –æ—Ü—ñ–Ω–∫–∏ OLS —Ç–∞ WLS (√ó2) –¥–ª—è Œ≤~1~

3. –û–±—á–∏—Å–ª—ñ—Ç—å/–∑–±–µ—Ä–µ–∂—ñ—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –ø–æ–º–∏–ª–∫–∏ –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è Œ≤~1~.
   - –ó–≤–∏—á–∞–π–Ω—ñ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –ø–æ–º–∏–ª–∫–∏ OLS
   - Heteroskedasticity-robust standard errors
   - WLS (–ø—Ä–∞–≤–∏–ª—å–Ω–æ)
   - WLS (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ)

---

## –°–∏–º—É–ª—è—Ü—ñ—è

**–î–ª—è –æ–¥–Ω—ñ—î—ó —ñ—Ç–µ—Ä–∞—Ü—ñ—ó —Å–∏–º—É–ª—è—Ü—ñ—ó:**

–ö–æ–¥ –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö...

```{r, sim one iteration 1, eval = F}
# Parameters
b0 <- 1
b1 <- 10
s2 <- 1
# Sample size
n <- 30
# Generate data
sample_df <- tibble(
  x = runif(n, 0.5, 1.5),
  y = b0 + b1 * x + rnorm(n, 0, sd = s2 * x^2)
)
```

---

## –°–∏–º—É–ª—è—Ü—ñ—è

**–î–ª—è –æ–¥–Ω—ñ—î—ó —ñ—Ç–µ—Ä–∞—Ü—ñ—ó —Å–∏–º—É–ª—è—Ü—ñ—ó:**

–ö–æ–¥ –¥–ª—è –æ—Ü—ñ–Ω–∫–∏ –Ω–∞—à–∏—Ö –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç—ñ–≤ —ñ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏—Ö –ø–æ–º–∏–ª–æ–∫...

```{r, sim one iteration 2, eval = F}
# OLS
ols <- feols(y ~ x, data = sample_df)
# WLS: Correct weights
wls_t <- lm(y ~ x, data = sample_df, weights = 1/x^2)
# WLS: Correct weights
wls_f <- lm(y ~ x, data = sample_df, weights = 1/x)
# Coefficients and standard errors
summary(ols, vcov = 'iid')
summary(ols, vcov = 'hetero')
summary(wls_t)
summary(wls_f)
```

–ü–æ—Ç—ñ–º –∑–±–µ—Ä–µ–∂—ñ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏.

---

## –°–∏–º—É–ª—è—Ü—ñ—è: –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç–∏

```{r, sim df, include = F, cache = T}
# Parameters
b0 <- 1
b1 <- 10
s2 <- 1
# Sample size
n <- 30
# Number of iterations
n_iter <- 1e3
# Set seed
set.seed(1234)
# The simulation
sim_df <- mclapply(X = 1:n_iter, FUN = function(i, size) {
  # Generate data
  sample_df <- tibble(
    x = runif(size, 0.5, 1.5),
    y = b0 + b1 * x + rnorm(size, 0, sd = s2 * x^2)
  )
  # OLS
  ols <- feols(y ~ x, data = sample_df)
  # WLS: Correct weights
  wls_t <- lm(y ~ x, data = sample_df, weights = 1/x^2)
  # WLS: Correct weights
  wls_f <- lm(y ~ x, data = sample_df, weights = 1/x)
  # Save results
  iter_df <- rbind(
    summary(ols, vcov = 'iid') %>% coeftable() %>% magrittr::extract(2, 1:2),
    summary(ols, vcov = 'hetero') %>% coeftable() %>% magrittr::extract(2, 1:2),
    summary(wls_t) %>% coef() %>% magrittr::extract(2,1:2),
    summary(wls_f) %>% coef() %>% magrittr::extract(2,1:2)
  ) %>%
  as_tibble() %>%
  mutate(
    model = c("OLS Hom.", "OLS Het.", "WLS T", "WLS F"),
    iter = i
  )
  # Return the data
  return(iter_df)
}, size = n) %>% bind_rows()
# Change names
names(sim_df) <- c("coef", "se", "model", "iter")
```

```{r, sim plot efficiency, echo = F, fig.height = 6.25}
ggplot(data = sim_df %>% filter(model != "OLS Hom."), aes(x = coef, color = model, fill = model)) +
geom_vline(xintercept = 10, linetype = "dashed") +
geom_density(alpha = 0.1) +
geom_hline(yintercept = 0) +
labs(x = "Estimated coefficient", y = "Density") +
scale_color_viridis_d("",
  labels = c("OLS", "WLS Incorrect", "WLS Correct"),
  end = 0.9, option = "C"
) +
scale_fill_viridis_d("",
  labels = c("OLS", "WLS Incorrect", "WLS Correct"),
  end = 0.9, option = "C"
) +
theme_pander(base_size = 22, base_family = "Fira Sans") +
theme(
  legend.position = c(.85,.9),
  # legend.background = element_blank(),
  legend.key.size = unit(1, "cm")
)
```

---

## –°–∏–º—É–ª—è—Ü—ñ—è: –≤–∏—Å–Ω–æ–≤–æ–∫

```{r, sim plot t stat, echo = F, fig.height = 6.25}
ggplot(data = sim_df, aes(x = (coef-10)/se, color = model, fill = model)) +
geom_vline(xintercept = qt(c(0.025, 0.975), df = 28), linetype = "dashed") +
geom_density(alpha = 0.1) +
geom_hline(yintercept = 0) +
labs(x = "t statistic testing the true value", y = "Density") +
scale_color_viridis_d("",
  labels = c("OLS + Het.-robust", "Plain OLS", "WLS Incorrect", "WLS Correct"),
  end = 0.9, option = "C"
) +
scale_fill_viridis_d("",
labels = c("OLS + Het.-robust", "Plain OLS", "WLS Incorrect", "WLS Correct"),
  end = 0.9, option = "C"
) +
theme_pander(base_size = 22, base_family = "Fira Sans") +
theme(
  legend.position = c(.85,.9),
  # legend.background = element_blank(),
  legend.key.size = unit(1, "cm")
)
```

---

## –°–∏–º—É–ª—è—Ü—ñ—è: —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–£–∑–∞–≥–∞–ª—å–Ω–µ–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ –Ω–∞—à–æ–≥–æ –º–æ–¥–µ–ª—é–≤–∞–Ω–Ω—è (10 000 —ñ—Ç–µ—Ä–∞—Ü—ñ–π)

:::: {.columns}

::: {.column width="40%"}
**–û—Ü—ñ–Ω–∫–∞**: Summary $\hat{\beta}_1$
```{r, sim table coef, eval = T, echo = F}
sim_df %>%
  filter(model != "OLS Hom.") %>%
  mutate(Estimator = recode(model,
    "OLS Het." = "OLS",
    "WLS F" = "WLS Incorrect",
    "WLS T" = "WLS Correct"
  )) %>%
  group_by(Estimator) %>%
  summarize(Mean = mean(coef) %>% round(3), "S.D." = sd(coef) %>% round(3)) %>%
  kable() %>%
  kable_styling(full_width = T)
```
:::

::: {.column width="60%"}
**–í–∏—Å–Ω–æ–≤–æ–∫: ** % –≤–∏–ø–∞–¥–∫—ñ–≤ –º–∏ –≤—ñ–¥—Ö–∏–ª—è—î–º–æ $\beta_1$
```{r, sim table se, eval = T, echo = F}
sim_df %>%
  mutate(Estimators = recode(model,
    "OLS Hom." = "OLS + Homosk.",
    "OLS Het." = "OLS + Het.-robust",
    "WLS F" = "WLS Incorrect",
    "WLS T" = "WLS Correct"
  )) %>%
  group_by(Estimators) %>%
  summarize(`% Reject` = mean(abs(coef-10)/se > qt(0.975, 28)) %>% multiply_by(100) %>% round(1)) %>%
  kable() %>%
  kable_styling(full_width = T)
```
:::

::::

---

## –ü—Ä–∏–ø—É—â–µ–Ω–Ω—è

–ó–≥–∞–¥–∞–π—Ç–µ –Ω–∞—à–µ —Å—Ç–∞—Ä–µ –ø—Ä–∏–ø—É—â–µ–Ω–Ω—è, —è–∫–µ –ø—Ä–∏–∑–≤–µ–ª–æ –¥–æ –æ–±–≥–æ–≤–æ—Ä–µ–Ω–Ω—è –≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–æ—Å—Ç—ñ:

> 5\. –ó–±—É—Ä–µ–Ω–Ω—è –º–∞—é—Ç—å [**–ø–æ—Å—Ç—ñ–π–Ω—É –¥–∏—Å–ø–µ—Ä—Å—ñ—è**]{.slate} $\sigma^2$ <br>—Ç–∞ [–Ω—É–ª—å–æ–≤—É –∫–æ–≤–∞—Ä—ñ–∞—Ü—ñ—é]{.hi}, _—Ç–æ–±—Ç–æ_,
  - $\color{#314f4f}{\mathop{\boldsymbol{E}}\left[ u_i^2 \middle| X_i \right] = \mathop{\text{Var}} \left( u_i \middle| X_i \right) = \sigma^2 \implies \mathop{\text{Var}} \left( u_i \right) = \sigma^2}$
  - $\color{#e64173}{\mathop{\text{Cov}} \left( u_i, \, u_j \middle| X_i,\,X_j \right) = \mathop{\boldsymbol{E}}\left[ u_i u_j \middle| X_i,\,X_j \right] = 0}$ for $i\neq j$

. . .

[**–ü–æ—Ä—É—à–µ–Ω–Ω—è –ø–æ—Å—Ç—ñ–π–Ω–æ—ó –¥–∏—Å–ø–µ—Ä—Å—ñ—ó**]{.slate} $=$ [**heteroskedasticity**]{.slate}

–¢–∞–∫–æ–∂ –º–æ–∂–ª–∏–≤–æ (—ñ–º–æ–≤—ñ—Ä–Ω–æ), —â–æ [–∑–±—É—Ä–µ–Ω–Ω—è –∫–æ—Ä–µ–ª—å–æ–≤–∞–Ω—ñ]{.pink}.

–Ü–≥–Ω–æ—Ä—É–≤–∞–Ω–Ω—è —Ü—ñ—î—ó –∫–æ—Ä–µ–ª—è—Ü—ñ—ó —â–µ –±—ñ–ª—å—à –ø—Ä–æ–±–ª–µ–º–∞—Ç–∏—á–Ω–æ –¥–ª—è –≤–∏—Å–Ω–æ–≤–∫—ñ–≤.

---

## –ü—Ä–æ–±–ª–µ–º–∞

–£ –±–∞–≥–∞—Ç—å–æ—Ö –≤–∏–ø–∞–¥–∫–∞—Ö [–∑–±—É—Ä–µ–Ω–Ω—è —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω—å]{.pink} $\left(u_i,\,u_j\right)$ [–º–æ–∂—É—Ç—å –±—É—Ç–∏ –∫–æ—Ä–µ–ª—é–≤–∞–Ω—ñ]{.pink}.

*–ó–∞–ø–∞–º'—è—Ç–∞–π*

- [–∑–±—É—Ä–µ–Ω–Ω—è]{.pink} –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—î –Ω–µ–≤–∫–ª—é—á–µ–Ω—ñ –∑–º—ñ–Ω–Ω—ñ, —è–∫—ñ –≤–ø–ª–∏–≤–∞—é—Ç—å –Ω–∞ $y$.
- –î–µ—è–∫—ñ [—Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è]{.pink} —É –≤–∏–±—ñ—Ä—Ü—ñ –º–æ–∂—É—Ç—å *–ø–æ–≤‚Äô—è–∑—É–≤–∞—Ç–∏—Å—è* –∑ —ñ–Ω—à–∏–º–∏ —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è–º–∏.

–Ø–∫—â–æ —Ü—ñ –≤–∑–∞—î–º–æ–∑–≤‚Äô—è–∑–∫–∏ –Ω–∞ —Ä—ñ–≤–Ω—ñ —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è –ø–æ—à–∏—Ä—é—é—Ç—å—Å—è –Ω–∞ –∑–º—ñ–Ω–Ω—ñ –≤ –∑–±—É—Ä–µ–Ω–Ω—ñ, —Ç–æ–¥—ñ –∑–±—É—Ä–µ–Ω–Ω—è –º–æ–∂—É—Ç—å –∫–æ—Ä–µ–ª—é–≤–∞—Ç–∏.

$\implies \mathop{\text{Cov}} \left( u_i, \, u_j \middle| X_i,\,X_j \right) \color{#e64173}{\neq} 0$.

. . .

–Ü–≥–Ω–æ—Ä—É–≤–∞–Ω–Ω—è —Ü—ñ—î—ó –∫–æ—Ä–µ–ª—è—Ü—ñ—ó –º–æ–∂–µ —Å–ø—Ä–∏—á–∏–Ω–∏—Ç–∏ **–≤–µ–ª–∏–∫—ñ –ø—Ä–æ–±–ª–µ–º–∏** —É –≤–∞—à–æ–º—É –≤–∏—Å–Ω–æ–≤–∫—É.

---

## –Ü–Ω—Ç—É—ó—Ü—ñ—è

–ß–æ–º—É —ñ–≥–Ω–æ—Ä—É–≤–∞–Ω–Ω—è —Ç–∞–∫–æ—ó –∫–æ—Ä–µ–ª—è—Ü—ñ—ó –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ –ø—Ä–æ–±–ª–µ–º?

**–ü–æ–º–∏–ª–∫–æ–≤–∞ —Ç–æ—á–Ω—ñ—Å—Ç—å**: –º–∏ –º–æ–∂–µ–º–æ —Å—Ç–∞—Ç–∏ ¬´–Ω–∞–¥—Ç–æ –≤–ø–µ–≤–Ω–µ–Ω–∏–º–∏¬ª —É —Å–≤–æ—ó—Ö –∑–Ω–∞–Ω–Ω—è—Ö.

**–ï–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω–∏–π –ø—Ä–∏–∫–ª–∞–¥**: —è–∫—â–æ –¥—É–±–ª—é–≤–∞—Ç–∏ —Å–≤—ñ–π –Ω–∞–±—ñ—Ä –¥–∞–Ω–∏—Ö (—Å–∫–ª–∞–¥–∞—Ç–∏ –π–æ–≥–æ –ø–æ–≤–µ—Ä—Ö —Å–∞–º–æ–≥–æ —Å–µ–±–µ), –∑–≤–∏—á–∞–π–Ω—ñ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –ø–æ–º–∏–ª–∫–∏ OLS –∑–º–µ–Ω—à—É–≤–∞—Ç–∏–º—É—Ç—å—Å—è –∫–æ–∂–Ω–æ–≥–æ —Ä–∞–∑—É, –∫–æ–ª–∏ –≤–∏ –¥—É–±–ª—é–≤–∞—Ç–∏–º–µ—Ç–µ –Ω–∞–±—ñ—Ä –¥–∞–Ω–∏—Ö.

---

```{r, dup-data, echo = F, cache = TRUE}
# And an id
test_df %<>% mutate(id = 1:nrow(test_df))
# Stack the dataset a bunch of times
dup_df = lapply(X = 1:20, FUN = function(x) mutate(test_df, dup = x)) %>% bind_rows()
# Now run a regression
dup_est = lapply(
  X = 1:20,
  FUN = function(x) feols(test_score ~ ratio + income, data = dup_df %>% filter(dup <= x))
)
# Grab standard errors
dup_se = lapply(
  X = seq_along(dup_est),
  FUN = function(x) {
    data.frame(
      dups = x - 1,
      se_iid = dup_est[[x]] %>% summary(vcov = 'iid') %>% coeftable() %>% magrittr::extract(2,2),
      se_cl = dup_est[[x]] %>% summary(cluster = 'id') %>% coeftable() %>% magrittr::extract(2,2)
    )
  }
) %>% bind_rows()
```

–í–ø–ª–∏–≤ –¥—É–±–ª—é–≤–∞–Ω–Ω—è –Ω–∞—à–∏—Ö –¥–∞–Ω–∏—Ö –Ω–∞ [—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞ –ø–æ–º–∏–ª–∫–∏ –ú–ù–ö]{.pink} –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `ratio`.

```{r, dup-plot1, echo = FALSE}
ggplot(
  data = dup_se,
  aes(x = dups, y = se_iid)
) +
geom_hline(yintercept = 0) +
geom_line(color = red_pink, size = 0.5) +
geom_point(color = red_pink, size = 3.5) +
labs(x = "Number of times dataset is duplicated", y = "Standard error") +
theme_pander(base_size = 22, base_family = "Fira Sans Condensed")
```

---

–í–∏–ø—Ä–∞–≤–ª—è—î–º–æ –Ω–∞—à—ñ [—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –ø–æ–º–∏–ª–∫–∏]{.orange} (–∫–æ—Ä–µ–ª—è—Ü—ñ—è —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω—å).

```{r, dup-plot2, echo = FALSE}
ggplot(
  data = dup_se,
  aes(x = dups)
) +
geom_hline(yintercept = 0) +
geom_line(aes(y = se_iid), color = red_pink, size = 0.5, alpha = 0.25) +
geom_point(aes(y = se_iid), color = red_pink, size = 3.5, alpha = 0.25) +
geom_line(aes(y = se_cl), color = orange, size = 0.5) +
geom_point(aes(y = se_cl), color = orange, size = 3.5) +
labs(x = "Number of times dataset is duplicated", y = "Standard error") +
theme_pander(base_size = 22, base_family = "Fira Sans Condensed")
```

---

## –ü—Ä–∏–∫–ª–∞–¥–∏

¬´–†–µ–∞–ª—å–Ω—ñ¬ª –ø—Ä–∏–∫–ª–∞–¥–∏, –∫–æ–ª–∏ –∑–±—É—Ä–µ–Ω–Ω—è –º–æ–∂—É—Ç—å –∫–æ—Ä–µ–ª—é–≤–∞—Ç–∏:

- –£—á–Ω—ñ –≤ –∫–ª–∞—Å—ñ (–¥—ñ–ª—è—Ç—å—Å—è –≤—á–∏—Ç–µ–ª–µ–º, –Ω–∞–≤—á–∞–ª—å–Ω–∏–º –ø–ª–∞–Ω–æ–º —Ç–æ—â–æ)
- –ü—ñ–¥–ø—Ä–∏—î–º—Å—Ç–≤–∞ –≤ –º—ñ—Å—Ç—ñ
- –ü–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ –¥–Ω—ñ —É –≤–∏–±—ñ—Ä—Ü—ñ (–ø–æ–¥—ñ–ª—ñ—Ç—å—Å—è –ø–æ–¥—ñ—è–º–∏, –ø–æ–≥–æ–¥–æ—é —Ç–æ—â–æ)

---

## –†—ñ—à–µ–Ω–Ω—è

–ü–æ–¥—ñ–±–Ω–æ –¥–æ —Ç–æ–≥–æ, —è–∫ –º–∏ –æ–±—á–∏—Å–ª—é—î–º–æ *heteroskedasticity*-robust standard errors,
<br>–º–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ–º–æ —Ä–æ–∑—Ä–∞—Ö—É–≤–∞—Ç–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –ø–æ–º–∏–ª–∫–∏, —Å—Ç—ñ–π–∫—ñ –¥–æ –∫–æ—Ä–µ–ª—å–æ–≤–∞–Ω–∏—Ö –∑–±—É—Ä–µ–Ω—å.

–õ—é–¥–∏ –Ω–∞–∑–∏–≤–∞—é—Ç—å —Ü–µ [*cluster-robust standard errors*]{.pink} (–∞–±–æ –ø—Ä–æ—Å—Ç–æ *clustered*).

–ó –ø–∞–∫–µ—Ç–∞ `fixest`:

`feols(y ~ x, –¥–∞–Ω—ñ = fake_data, cluster = 'cluster_var')`

–∞–±–æ –Ω–∞–≤—ñ—Ç—å

`feols(y ~ x, –¥–∞–Ω—ñ = fake_data, cluster = c('cluster1', 'cluster2'))`

---

## –ó–∞–≥–∞–ª—å–Ω—ñ –≤–∏—Å–Ω–æ–≤–∫–∏

1. –í–∏ –ø–æ–≤–∏–Ω–Ω—ñ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –≤–≤–∞–∂–∞—Ç–∏, —â–æ –≤–∞—à—ñ –¥–∞–Ω—ñ –≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω—ñ

2. –ü–æ–¥—É–º–∞–π—Ç–µ –ø—Ä–æ —Ç–µ, —è–∫ –≤–∞—à—ñ –ø–æ—è—Å–Ω—é–≤–∞–ª—å–Ω—ñ –∑–º—ñ–Ω–Ω—ñ —Ç–∞/–∞–±–æ –ø–æ—Ä—É—à–µ–Ω–Ω—è –∫–æ—Ä–µ–ª—é—é—Ç—å –º—ñ–∂ —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è–º–∏.

## –î–æ–¥–∞—Ç–æ–∫–≤—ñ –º–∞—Ç–µ—Ä—ñ–∞–ª–∏

### R

- ["`olsrr`: Tools for Building OLS Regression Models"](https://cran.r-project.org/web/packages/olsrr/)
- ["Heteroskedasticity Robust Standard Errors in R"](https://www.r-econometrics.com/methods/hcrobusterrors/)
- ["Heteroskedasticity and Homoskedasticity"](https://www.econometrics-with-r.org/5.4-hah.html"")

### Python

- ["`statsmodels`: Weighted Least Squares"](https://www.statsmodels.org/dev/examples/notebooks/generated/wls.html)
- ["`statsmodels`: `test_heteroskedasticity()`"](https://www.statsmodels.org/dev/generated/statsmodels.tsa.arima.model.ARIMAResults.test_heteroskedasticity.html)
- ["Python for Introductory Econometrics: Heteroskedasticity"](https://solomonegash.com/econometrics/wooldridge_python/iexample8_py.html)




# –î—è–∫—É—é –∑–∞ —É–≤–∞–≥—É! {.unnumbered .unlisted}

<br>
<br>

`r fa("envelope")` ihor.miroshnychenko\@kneu.ua

`r fa("telegram")` [Data Mirosh](https://t.me/araprof)

`r fa("linkedin")` [\@ihormiroshnychenko](https://www.linkedin.com/in/ihormiroshnychenko/)

`r fa("github")` [\@aranaur](https://github.com/Aranaur)

`r fa("house")` [aranaur.rbind.io](https://aranaur.rbind.io)



