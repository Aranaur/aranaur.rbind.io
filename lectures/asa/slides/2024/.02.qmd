---
title: "–°—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–∞ –ø–æ—Ç—É–∂–Ω—ñ—Å—Ç—å"
subtitle: "–ü—Ä–∏–∫–ª–∞–¥–Ω–∏–π —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–∏–π –∞–Ω–∞–ª—ñ–∑"
author: "–Ü–≥–æ—Ä –ú—ñ—Ä–æ—à–Ω–∏—á–µ–Ω–∫–æ"
institute: –ö–ù–£ —ñ–º–µ–Ω—ñ –¢–∞—Ä–∞—Å–∞ –®–µ–≤—á–µ–Ω–∫–∞, –§–Ü–¢
from: markdown+emoji
title-slide-attributes:
    data-background-iframe: .02_files/libs/colored-particles/index.html
language: _language-ua.yml
footer: <a href="https://aranaur.rbind.io/lectures/asa/">üîó–ü—Ä–∏–∫–ª–∞–¥–Ω–∏–π —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–∏–π –∞–Ω–∞–ª—ñ–∑</a>
format:
  revealjs: 
    code-line-numbers: false
    # center: true
    navigation-mode: vertical
    transition: fade
    background-transition: fade
    # controls-layout: bottom-right
    chalkboard: true
    logo: fit.png
    slide-number: true
    toc: true
    toc-depth: 1
    mouse-wheel: true
    width: 1350  
    height: 759.375
    highlight-style: github
    # fig-width: 9
    # fig-height: 5
    fig-format: svg
    theme: [default, custom.scss]
    mermaid:
      theme: forest
  # gfm:
  #   mermaid-format: png
preload-iframes: true
jupyter: python3
execute: 
  echo: true
  warning: false
editor_options: 
  chunk_output_type: console

revealjs-plugins:
  - verticator
---

```{python}
#| label: setup
#| include: false

# Import libraries
from scipy.stats import (
    binom
)
import numpy as numpy
from seaborn import distplot
from matplotlib import pyplot
import seaborn
import random
from tqdm.notebook import tqdm

from IPython.display import Markdown
from tabulate import tabulate

# Define colors
red_pink   = "#e64173"
turquoise  = "#20B2AA"
orange     = "#FFA500"
red        = "#fb6107"
blue       = "#181485"
navy       = "#150E37FF"
green      = "#8bb174"
yellow     = "#D8BD44"
purple     = "#6A5ACD"
slate      = "#314f4f"
```

# –ü–æ—Ç—É–∂–Ω—ñ—Å—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–æ–≥–æ –∫—Ä–∏—Ç–µ—Ä—ñ—é {background-iframe=".02_files/libs/colored-particles/index.html"}

## –•–∏–±–Ω–æ-–Ω–µ–≥–∞—Ç–∏–≤–Ω–∞ –ø–æ–º–∏–ª–∫–∞ {.smaller}

–†–∞–Ω—ñ—à–µ –º–∏ –∑–≤–µ—Ä—Ç–∞–ª–∏ —É–≤–∞–≥—É —Ç—ñ–ª—å–∫–∏ –Ω–∞ $\alpha$ --- **—Ä—ñ–≤–µ–Ω—å –∑–Ω–∞—á—É—â–æ—Å—Ç—ñ**. 

–¶–µ–π –ø–∞—Ä–∞–º–µ—Ç—Ä –∫–æ–Ω—Ç—Ä–æ–ª—é—î –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å –≤–∏—è–≤–ª–µ–Ω–Ω—è **–ø–æ–º–∏–ª–∫–∏ I —Ä–æ–¥—É** (*FPR, —Ö–∏–±–Ω–æ-–ø–æ–∑–∏—Ç–∏–≤–Ω–∞ –ø–æ–º–∏–ª–∫–∞*): –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è $H_0$, –∫–æ–ª–∏ –≤–æ–Ω–∞ –Ω–∞—Å–ø—Ä–∞–≤–¥—ñ –≤—ñ—Ä–Ω–∞.

**–í —Ç–µ—Ä–º—ñ–Ω–∞—Ö –±—ñ–∑–Ω–µ—Å—É:** –≤ —è–∫—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å –Ω–µ–µ—Ñ–µ–∫—Ç–∏–≤–Ω–∏—Ö –ø—Ä–æ—î–∫—Ç—ñ–≤ –º–∏ –≥–æ—Ç–æ–≤—ñ –≤–∫–ª–∞–¥–∞—Ç–∏ —Ä–µ—Å—É—Ä—Å–∏?

. . .

<center>[–ß–∏ –º–æ–∂–µ–º–æ –º–∏ –º—ñ–Ω—ñ–º—ñ–∑—É–≤–∞—Ç–∏ —Ü—é –ø–æ–º–∏–ª–∫—É?]{.hi}</center>

. . .

–¢–∞–∫! –î–ª—è —Ü—å–æ–≥–æ –¥–æ—Å—Ç–∞—Ç–Ω—å–æ –Ω—ñ–∫–æ–ª–∏ –Ω–µ –≤—ñ–¥–∫–∏–¥–∞—Ç–∏ $H_0$ 

$$
S \equiv 0, \alpha = 0
$$

. . .

–Ø–∫—â–æ —î –ø–æ–º–∏–ª–∫–∞ I —Ä–æ–¥—É, —Ç–æ —î —ñ **–ø–æ–º–∏–ª–∫–∞ II —Ä–æ–¥—É** --- **—Ö–∏–±–Ω–æ-–Ω–µ–≥–∞—Ç–∏–≤–Ω–∞ –ø–æ–º–∏–ª–∫–∞** (*FNR*): –ø—Ä–∏–π–º–∞—î–º–æ $H_0$, –∫–æ–ª–∏ –Ω–∞—Å–ø—Ä–∞–≤–¥—ñ –≤—ñ—Ä–Ω–æ—é —î $H_1$.

**–í —Ç–µ—Ä–º—ñ–Ω–∞—Ö –±—ñ–∑–Ω–µ—Å—É:** —è–∫—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å –µ—Ñ–µ–∫—Ç–∏–≤–Ω–∏—Ö –ø—Ä–æ—î–∫—Ç—ñ–≤ –º–∏ –≥–æ—Ç–æ–≤—ñ –≤–ø—É—Å—Ç–∏—Ç–∏?

$$
\beta = \text{FNR} = \mathbb{P}(S=0|H_1)
$$

## –ö—Ä–∏—Ç–µ—Ä—ñ–π –¥–ª—è –ø–æ—Ä–∏ —Ä–æ–∫—É ‚ùÑÔ∏è‚òÄÔ∏è {.tiny}

$$
H_0: \text{–Ω–∞ –≤—É–ª–∏—Ü—ñ –ª—ñ—Ç–æ}
$$

$$
H_1: \text{–Ω–∞ –≤—É–ª–∏—Ü—ñ –Ω–µ –ª—ñ—Ç–æ}
$$

. . .

$$
\begin{equation}
Q = \begin{cases}
1, & \text{—è–∫—â–æ –Ω–∞ –≤—É–ª–∏—Ü—ñ –π–¥–µ —Å–Ω—ñ–≥} \\
0, & \text{—ñ–Ω–∞–∫—à–µ}
\end{cases}
\end{equation}
$$

. . .

$$
\begin{equation}
S = Q = \begin{cases}
1, & \text{—è–∫—â–æ }Q = 1, \text{ –≤—ñ–¥—Ö–∏–ª—è—î–º–æ } H_0 \\
0, & \text{—è–∫—â–æ }Q = 0, \text{ –Ω–µ –≤—ñ–¥—Ö–∏–ª—è—î–º–æ } H_0
\end{cases}
\end{equation}
$$

. . .

$$
\alpha = \text{FPR} = \mathbb{P}(\text{–π–¥–µ —Å–Ω—ñ–≥}|\text{–∑–∞—Ä–∞–∑ –ª—ñ—Ç–æ}) < 0.001
$$

$$
\beta = \text{FNR} = \mathbb{P}(\text{–Ω–µ –π–¥–µ —Å–Ω—ñ–≥}|\text{–∑–∞—Ä–∞–∑ –Ω–µ –ª—ñ—Ç–æ}) > 0.9
$$

. . .

–Ø–∫ –±–∞—á–∏–º–æ, –∫—Ä–∏—Ç–µ—Ä—ñ–π –¥–æ–≤–æ–ª—ñ –º–∞—Ä–Ω–∏–π.

. . .

[–ü–æ—Ç—É–∂–Ω—ñ—Å—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–æ–≥–æ –∫—Ä–∏—Ç–µ—Ä—ñ—é]{.hi} (*power, True Positive Rate, —ñ—Å—Ç–∏–Ω–Ω–æ-–ø–æ–∑–∏—Ç–∏–≤–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è*) --- —Ü–µ –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤—ñ–¥—Ö–∏–ª–∏—Ç–∏ $H_0$, –∫–æ–ª–∏ –≤–æ–Ω–∞ —ñ—Å—Ç–∏–Ω–Ω–æ —î —Ö–∏–±–Ω–æ—é, —Ç–æ–±—Ç–æ –∑–¥–∞—Ç–Ω—ñ—Å—Ç—å –≤–∏—è–≤–∏—Ç–∏ –µ—Ñ–µ–∫—Ç, —è–∫—â–æ –≤—ñ–Ω –¥—ñ–π—Å–Ω–æ —ñ—Å–Ω—É—î.

$$
\text{Power} = 1 - \beta = \mathbb{P}(S=1|H_1)
$$

. . .

–£ –Ω–∞—à–æ–º—É –ø—Ä–∏–∫–ª–∞–¥—ñ: $\text{Power} = 1 - 0.9 = 0.1$

## –ü–æ—Ç—É–∂–Ω—ñ—Å—Ç—å {.tiny}

:::: {.columns}

::: {.column width="65%"}
–ó–≥–∞–¥–∞—î–º–æ –∑–∞–¥–∞—á—É –ø—Ä–æ –¥–æ—Å—Ç–∞–≤–∫—É:

$H_0: \mu = 0.5 \\H_1: \mu > 0.5 \\Q = \text{–∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–∏—Ö –∑–∞–º–æ–≤–ª–µ–Ω—å} \\\alpha = 0.05 \\ S = \{Q \geq 20\}$
:::

::: {.column width="35%" .fragment}

```{python}
#| label: power-h0
#| echo: false

binom_h0 = binom(
    n=30,
    p=0.5
)

x_grid = numpy.arange(1, 31)
probs = binom_h0.pmf(x_grid)

pyplot.figure(figsize=(16, 8))

pyplot.vlines(x_grid, 0, probs, linewidth=15.0, color=turquoise, label='PMF, $Binom(30, 0.5)$')
crit_reg = x_grid >= 20
pyplot.vlines(x_grid[crit_reg], 0, probs[crit_reg], linewidth=15.0, label='Critical region for S')
pyplot.title('–ë—ñ–Ω–æ–º—ñ–∞–ª—å–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª', fontsize=20)
pyplot.xlabel('–ö—ñ–ª—å–∫—ñ—Å—Ç—å —É—Å–ø—ñ—Ö—ñ–≤', fontsize=18)
pyplot.ylabel('', fontsize=18, rotation=0, labelpad=30)
pyplot.legend(fontsize=18)
pyplot.show()
```
:::

::::

. . .

:::: {.columns}

::: {.column width="65%"}
–ü—Ä–∏–ø—É—Å—Ç–∏–º–æ, —â–æ –≤—ñ—Ä–Ω–∞ $H_1$: $\mu = 0.6$
:::

::: {.column width="35%" .fragment}
```{python}
#| label: power-h1
#| echo: false

binom_alternative = binom(
    n=30,
    p=0.6
)

x_grid = numpy.arange(1, 31)
probs = binom_alternative.pmf(x_grid)

pyplot.figure(figsize=(16, 8))

pyplot.vlines(x_grid, 0, probs, linewidth=15.0, color=turquoise, label='PMF, $Binom(30, 0.6)$')
crit_reg = x_grid >= 20
pyplot.vlines(x_grid[crit_reg], 0, probs[crit_reg], linewidth=15.0, label='Critical region for S')
pyplot.title('–ë—ñ–Ω–æ–º—ñ–∞–ª—å–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª', fontsize=20)
pyplot.xlabel('–ö—ñ–ª—å–∫—ñ—Å—Ç—å —É—Å–ø—ñ—Ö—ñ–≤', fontsize=18)
pyplot.ylabel('', fontsize=18, rotation=0, labelpad=30)
pyplot.legend(fontsize=18)
pyplot.show()
```
:::

::::

. . .

$$\text{Power} = \mathbb{P}(Q \geq 20|\mu = 0.6)$$

---

$$\text{Power} = \mathbb{P}(Q \geq 20|\mu = 0.6)$$

```{python}
#| label: power
#| echo: false
#| fig-align: center

x_grid = numpy.arange(1, 31)
crit_reg = x_grid >= 20

pyplot.figure(figsize=(16, 8))

# –±—É–¥—É—î–º–æ —Ä–æ–∑–ø–æ–¥—ñ–ª –ø—Ä–∏ H0 —ñ –∫—Ä–∏—Ç–∏—á–Ω—É –æ–±–ª–∞—Å—Ç—å
probs_h0 = binom_h0.pmf(x_grid)
pyplot.vlines(x_grid, 0, probs_h0, linewidth=15.0, color=navy, label='PMF, $Binom(0.5, 30)$ $H_0$', alpha=0.5)

# –±—É–¥—É—î–º–æ —Ä–æ–∑–ø–æ–¥—ñ–ª –ø—Ä–∏ mu > 0.5
probs_alternative = binom_alternative.pmf(x_grid)
pyplot.vlines(x_grid, 0, probs_alternative, linewidth=15.0, color=turquoise, label='PMF, $Binom(0.6, 30)$ $H_1$')
pyplot.vlines(x_grid[crit_reg], 0, probs_alternative[crit_reg], linewidth=15.0, label='Rejection of H0', color='red')

pyplot.title('–ë—ñ–Ω–æ–º—ñ–∞–ª—å–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª', fontsize=20)
pyplot.legend(fontsize=18)
pyplot.show()
```

```{python}
#| label: power-value
#| echo: false

critical_value = 20
power = 1 - binom(n=30, p=0.6).cdf(critical_value - 1)
fpr   = 1 - binom(n=30, p=0.5).cdf(critical_value - 1)

print('False Positive Rate is {:.1%}'.format(fpr))
print('Power is {:.1%}'.format(power))
```

[–í–∏–¥–Ω–æ, —â–æ –ø–æ—Ç—É–∂–Ω—ñ—Å—Ç—å –±–ª–∏–∑—å–∫–æ $30\%$. –¶–µ –¥–æ–≤–æ–ª—ñ –º–∞–ª–µ–Ω—å–∫–µ –∑–Ω–∞—á–µ–Ω–Ω—è, –∞–¥–∂–µ —è–∫—â–æ –Ω–∞—à –ø—Ä–æ–¥—É–∫—Ç –ø—Ä–∏–±—É—Ç–∫–æ–≤–∏–π, —Ç–æ –º–∏ –ø–æ–±–∞—á–∏–º–æ —Ü–µ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –Ω–∞—à–æ–≥–æ —Ç–µ—Å—Ç—É –ª–∏—à–µ –∑ –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—é –≤ $30$ –≤—ñ–¥—Å–æ—Ç–∫—ñ–≤. **–ú–∏ –ª–µ–≥–∫–æ –º–æ–∂–µ–º–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç–∏ –µ—Ñ–µ–∫—Ç.**]{.tiny}

## Python —Ç–∞ –ø–æ—Ç—É–∂–Ω—ñ—Å—Ç—å {.smaller}

```{python}
#| label: power-def

def get_stat_power(N, mu_h0, mu_alternative, alpha):
    '''–û–±—á–∏—Å–ª—é—î —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω—É –ø–æ—Ç—É–∂–Ω—ñ—Å—Ç—å –∫—Ä–∏—Ç–µ—Ä—ñ—é –¥–ª—è –±—ñ–Ω–æ–º—ñ–∞–ª—å–Ω–æ–≥–æ —Ä–æ–∑–ø–æ–¥—ñ–ª—É
    
    –ü–∞—Ä–∞–º–µ—Ç—Ä–∏:
        N - –∫—ñ–ª—å–∫—ñ—Å—Ç—å –±–µ—Ä–Ω—É–ª–ª—ñ—î–≤—Å—å–∫–∏—Ö –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ñ–≤ (—Ä–æ–∑–º—ñ—Ä –≤–∏–±—ñ—Ä–∫–∏)
        mu_h0 - —ñ–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å —É—Å–ø—ñ—Ö—É –≤ –Ω—É–ª—å–æ–≤—ñ–π –≥—ñ–ø–æ—Ç–µ–∑—ñ
        mu_alternative - –ø–µ—Ä–µ–¥–±–∞—á—É–≤–∞–Ω–∞ –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å —É—Å–ø—ñ—Ö—É –≤ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ñ
        alpha - —Ä—ñ–≤–µ–Ω—å –∑–Ω–∞—á—É—â–æ—Å—Ç—ñ –∫—Ä–∏—Ç–µ—Ä—ñ—é
    '''
    binom_h0 = binom(n=N, p=mu_h0)
    binom_alternative = binom(n=N, p=mu_alternative)

    # –æ–±—á–∏—Å–ª—é—î–º–æ –∫—Ä–∏—Ç–∏—á–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è
    critical_value = binom_h0.ppf(1 - alpha) + 1
    # –æ–±—á–∏—Å–ª—é—î–º–æ –ø–æ—Ç—É–∂–Ω—ñ—Å—Ç—å –∑–∞ —Ñ–æ—Ä–º—É–ª–æ—é
    return 1 - binom_alternative.cdf(critical_value - 1) 
```

\

```{python}
#| label: power-example-30

get_stat_power(N=30, mu_h0=0.5,mu_alternative=0.6, alpha=0.05)
```

–ü–æ–¥–∏–≤–∏–º–æ—Å—è, —â–æ –±—É–¥–µ, —è–∫—â–æ –º–∏ –ø—Ä–æ–≤–µ–¥–µ–º–æ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç –Ω–∞ 300 –∫–ª—ñ—î–Ω—Ç–∞—Ö.

```{python}
#| label: power-example-300

get_stat_power(N=300, mu_h0=0.5,mu_alternative=0.6, alpha=0.05)
```

## Python —Ç–∞ –ø–æ—Ç—É–∂–Ω—ñ—Å—Ç—å {.smaller}

–ü—Ä–∏–π–Ω—è—Ç–æ –≤–≤–∞–∂–∞—Ç–∏, —â–æ –ø—Ä–∏–π–Ω—è—Ç–Ω–æ—é –¥–ª—è —Ä–æ–±–æ—Ç–∏ –ø–æ—Ç—É–∂–Ω—ñ—Å—Ç—é –≤–≤–∞–∂–∞—î—Ç—å—Å—è $80\%$.

–ü–æ–¥–∏–≤–∏–º–æ—Å—è, —è–∫ –∑–º—ñ–Ω—é—î—Ç—å—Å—è –ø–æ—Ç—É–∂–Ω—ñ—Å—Ç—å –ø—Ä–∏ –∑—Ä–æ—Å—Ç–∞–Ω–Ω—ñ —Ä–æ–∑–º—ñ—Ä—É –≤–∏–±—ñ—Ä–∫–∏, —ñ —Å–∫—ñ–ª—å–∫–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø—Ä–æ–≤–µ—Å—Ç–∏ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ñ–≤, —â–æ–± –¥–µ—Ç–µ–∫—Ç—É–≤–∞—Ç–∏ –µ—Ñ–µ–∫—Ç –ø—Ä–∏ $\mu=0.6$ –≤ $80\%$ –≤–∏–ø–∞–¥–∫—ñ–≤.

```{python}
#| label: power-example-80
#| fig-align: center
#| code-fold: true

n_grid = numpy.arange(10, 600, 10)
# –º–æ–∂–µ–º–æ –æ–±—á–∏—Å–ª–∏—Ç–∏ 
power = get_stat_power(n_grid, 0.5, 0.6, alpha=0.05)

pyplot.figure(figsize=(12, 7))
pyplot.title('–ü–æ—Ç—É–∂–Ω—ñ—Å—Ç—å –¥–ª—è $\mu = 0,6$', fontsize=18)
pyplot.xlabel('–ö—ñ–ª—å–∫—ñ—Å—Ç—å –ø—Ä–æ–±–Ω–∏—Ö –ø–æ—Å—Ç–∞–≤–æ–∫', fontsize=15)
pyplot.ylabel('–ü–æ—Ç—É–∂–Ω—ñ—Å—Ç—å', fontsize=15)

pyplot.plot(n_grid, power)
pyplot.axhline(0.8, ls='--', color='red', label='Power = 80%')

# —Ä–∞—Ö—É—î–º–æ –º—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π —Ä–æ–∑–º—ñ—Ä –≤–∏–±—ñ—Ä–∫–∏ –¥–ª—è –ø–æ—Ç—É–∂–Ω–æ—Å—Ç—ñ —É 80% 
min_n = n_grid[power >= 0.8].min()
pyplot.axvline(min_n, ls='--', color=turquoise, label=f'N = {min_n}')

pyplot.legend(fontsize=15)
pyplot.show()
```

## Python —Ç–∞ –ø–æ—Ç—É–∂–Ω—ñ—Å—Ç—å {.smaller}

–ê —â–æ, —è–∫—â–æ –º–∏ —Ö–æ—á–µ–º–æ –¥–µ—Ç–µ–∫—Ç—É–≤–∞—Ç–∏ —â–µ –º–µ–Ω—à–∏–π –µ—Ñ–µ–∫—Ç? –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —è–∫—â–æ —Ö–æ—á–µ–º–æ –≤—ñ–¥–∫–∏–¥–∞—Ç–∏ –≥—ñ–ø–æ—Ç–µ–∑—É –ø—Ä–∏ $\mu = 0.51$. –ß–∞—Å—Ç–æ –ø–æ–ª—ñ–ø—à–µ–Ω–Ω—è –π–º–æ–≤—ñ—Ä–Ω–æ—Å—Ç—ñ —É—Å–ø—ñ—Ö—É –Ω–∞ $1\%$ –º–æ–∂–µ –±—É—Ç–∏ –∑–Ω–∞—á—É—â–∏–º –¥–ª—è –ø—Ä–æ–¥—É–∫—Ç—É, —Ç–æ–º—É —Ü–µ –ø–∏—Ç–∞–Ω–Ω—è –Ω–µ –ø–æ–∑–±–∞–≤–ª–µ–Ω–µ —Å–µ–Ω—Å—É.

```{python}
#| label: power-example-51
#| fig-align: center
#| code-fold: true

n_grid = numpy.arange(10, 30000, 59)

power = get_stat_power(n_grid, 0.5, 0.51, alpha=0.05)

pyplot.figure(figsize=(12, 7))
pyplot.title('–ü–æ—Ç—É–∂–Ω—ñ—Å—Ç—å –¥–ª—è $\mu = 0.51$', fontsize=18)
pyplot.xlabel('–ö—ñ–ª—å–∫—ñ—Å—Ç—å –ø—Ä–æ–±–Ω–∏—Ö –ø–æ—Å—Ç–∞–≤–æ–∫', fontsize=15)
pyplot.ylabel('–ü–æ—Ç—É–∂–Ω—ñ—Å—Ç—å', fontsize=15)

pyplot.plot(n_grid, power)
pyplot.axhline(0.8, ls='--', color='red', label='Power = 80%')

# —Ä–∞—Ö—É—î–º–æ –º—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π —Ä–æ–∑–º—ñ—Ä –≤–∏–±—ñ—Ä–∫–∏ –¥–ª—è –ø–æ—Ç—É–∂–Ω–æ—Å—Ç—ñ —É 80% 
min_n = n_grid[power >= 0.8].min()
pyplot.axvline(min_n, ls='--', color=turquoise, label=f'N = {min_n}')

pyplot.legend(fontsize=15)
pyplot.show()
```

---

–ü–µ—Ä–µ–¥ –∫–æ–∂–Ω–∏–º –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–º –∞–Ω–∞–ª—ñ—Ç–∏–∫—É –≤–∞—Ä—Ç–æ –∑–∞–º–∏—Å–ª—é–≤–∞—Ç–∏—Å—è –Ω–∞–¥ –ø–∏—Ç–∞–Ω–Ω—è–º [—Ç—Ä–∏–≤–∞–ª–æ—Å—Ç—ñ —Ç–µ—Å—Ç—É]{.hi} —Ç–∞ [–∫—ñ–ª—å–∫–æ—Å—Ç—ñ —É—á–∞—Å–Ω–∏–∫—ñ–≤]{.hi-slate}. 

\

–î–ª—è —Ü—å–æ–≥–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑—Ä–æ–∑—É–º—ñ—Ç–∏:

- –Ø–∫–∏–π –µ—Ñ–µ–∫—Ç —î –¥–ª—è –∑–∞–≤–¥–∞–Ω–Ω—è –ø—Ä–∞–∫—Ç–∏—á–Ω–æ –∑–Ω–∞—á—É—â–∏–º?
- –°–∫—ñ–ª—å–∫–∏ –∑–Ω–∞–¥–æ–±–∏—Ç—å—Å—è –≤–∏–ø—Ä–æ–±–æ–≤—É–≤–∞–Ω–∏—Ö, —â–æ–± –¥–µ—Ç–µ–∫—Ç—É–≤–∞—Ç–∏ —Ü–µ–π –µ—Ñ–µ–∫—Ç —á–∞—Å—Ç—ñ—à–µ, –Ω—ñ–∂ —É $80\%$ –≤–∏–ø–∞–¥–∫—ñ–≤?

## Python —Ç–∞ –ø–æ—Ç—É–∂–Ω—ñ—Å—Ç—å {.smaller}

–ó –≥—Ä–∞—Ñ—ñ–∫—ñ–≤ –≤–∏–¥–Ω–æ, —â–æ –¥–ª—è –¥–µ—Ç–µ–∫—Ç—É–≤–∞–Ω–Ω—è –º–µ–Ω—à–æ–≥–æ –µ—Ñ–µ–∫—Ç—É –ø–æ—Ç—Ä—ñ–±–µ–Ω –±—ñ–ª—å—à–∏–π —Ä–æ–∑–º—ñ—Ä –≤–∏–±—ñ—Ä–∫–∏. 

–ü–æ–¥–∏–≤–∏–º–æ—Å—è, —è–∫ –¥–ª—è —Ñ—ñ–∫—Å–æ–≤–∞–Ω–æ–≥–æ $N = 30$ –∑–º—ñ–Ω—é—î—Ç—å—Å—è –ø–æ—Ç—É–∂–Ω—ñ—Å—Ç—å –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ $\mu$.

```{python}
#| label: power-example-mu
#| fig-align: center
#| code-fold: true

mu_grid = numpy.linspace(0.5, 1, 500)
power = get_stat_power(30, 0.5, mu_grid, alpha=0.05)

pyplot.figure(figsize=(12, 7))
pyplot.title('Power for $N = 30$', fontsize=18)
pyplot.xlabel('$\mu$', fontsize=15)
pyplot.ylabel('–ü–æ—Ç—É–∂–Ω—ñ—Å—Ç—å', fontsize=15)

pyplot.plot(mu_grid, power)
pyplot.axhline(0.8, ls='--', color='red', label='Power = 80%')
min_mu = mu_grid[power >= 0.8].min()
pyplot.axvline(min_mu, ls='--', color=turquoise, label='$\mu$ = {:.2f}'.format(min_mu))

pyplot.legend(fontsize=15)
pyplot.show()
```

–£ –Ω–∞—à–æ–º—É –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ñ –º–∏ –¥–æ–±—Ä–µ –¥–µ—Ç–µ–∫—Ç—É—î–º–æ –µ—Ñ–µ–∫—Ç, —Ç—ñ–ª—å–∫–∏ —è–∫—â–æ –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å —É—Å–ø—ñ—Ö—É –≤ –≥–µ–Ω–µ—Ä–∞–ª—å–Ω—ñ–π —Å—É–∫—É–ø–Ω–æ—Å—Ç—ñ —Ö–æ—á–∞ –± $72\%$.

# –ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π –≤–∏—è–≤–ª–µ–Ω–∏–π –µ—Ñ–µ–∫—Ç *(MDE)* {background-iframe=".02_files/libs/colored-particles/index.html"}

## –ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π –≤–∏—è–≤–ª–µ–Ω–∏–π –µ—Ñ–µ–∫—Ç {.smaller}

[–ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π –≤–∏—è–≤–ª–µ–Ω–∏–π –µ—Ñ–µ–∫—Ç]{.hi} (*MDE, Minimal Detectable Effect*) --- —Ü–µ –Ω–∞–π–º–µ–Ω—à–∏–π –µ—Ñ–µ–∫—Ç, —è–∫–∏–π –º–∏ –º–æ–∂–µ–º–æ –≤–∏—è–≤–∏—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—É (—è–∫ –ø—Ä–∞–≤–∏–ª–æ, –ø—Ä–∏ $80\%$ –ø–æ—Ç—É–∂–Ω–æ—Å—Ç—ñ).

```{python}
#| label: power-example-mu-2
#| fig-align: center
#| echo: false

mu_grid = numpy.linspace(0.5, 1, 500)
power = get_stat_power(30, 0.5, mu_grid, alpha=0.05)

pyplot.figure(figsize=(12, 7))
pyplot.title('Power for $N = 30$', fontsize=18)
pyplot.xlabel('$\mu$', fontsize=15)
pyplot.ylabel('–ü–æ—Ç—É–∂–Ω—ñ—Å—Ç—å', fontsize=15)

pyplot.plot(mu_grid, power)
pyplot.axhline(0.8, ls='--', color='red', label='Power = 80%')
min_mu = mu_grid[power >= 0.8].min()
pyplot.axvline(min_mu, ls='--', color=turquoise, label='$\mu$ = {:.2f}'.format(min_mu))

pyplot.legend(fontsize=15)
pyplot.show()
```

–£ –Ω–∞—à–æ–º—É –ø—Ä–∏–∫–ª–∞–¥—ñ $\text{MDE} = +0.22$

\

::: {.callout-warning icon="false"}
## –ë—ñ–ª—å—à —Ñ–æ—Ä–º–∞–ª—å–Ω–æ

$\text{MDE}$ –¥–ª—è –≥—ñ–ø–æ—Ç–µ–∑–∏ $\mathsf{H}_0: \mu = \mu_0$ &mdash; —Ü–µ –º—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π –µ—Ñ–µ–∫—Ç $\delta$, –∑–∞ —è–∫–æ–≥–æ –∫—Ä–∏—Ç–µ—Ä—ñ–π —Ä—ñ–≤–Ω—è –∑–Ω–∞—á—É—â–æ—Å—Ç—ñ $\alpha$ –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Ü—ñ—î—ó –≥—ñ–ø–æ—Ç–µ–∑–∏ –∑–∞ —ñ—Å—Ç–∏–Ω–Ω–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ $\mu = \mu_0 + \delta$ —Ç–∞ —Ä–æ–∑–º—ñ—Ä—É –≤–∏–±—ñ—Ä–∫–∏ $N$ –≤—ñ–¥–∫–∏–¥–∞—Ç–∏–º–µ $\mathsf{H}_0$ –∑ –ø–æ—Ç—É–∂–Ω—ñ—Å—Ç—é –±—ñ–ª—å—à–æ—é, –Ω—ñ–∂ $1 - \beta$.
:::

## Python —Ç–∞ MDE {.smaller}

```{python}
#| label: mde-def

def binom_test_mde_one_sided(N, mu0, alpha=0.05, min_power=0.8):
    '''–û–±—á–∏—Å–ª—é—î MDE –æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω—å–æ–≥–æ –∫—Ä–∏—Ç–µ—Ä—ñ—é –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –≥—ñ–ø–æ—Ç–µ–∑–∏ mu = mu0 —É –∑–∞–¥–∞—á—ñ –∑ –¥–æ—Å—Ç–∞–≤–∫–æ—é
    
    –ü–∞—Ä–∞–º–µ—Ç—Ä–∏:
        N (int) - —Ä–æ–∑–º—ñ—Ä –≤–∏–±—ñ—Ä–∫–∏
        mu0 (float) - —ñ–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å —É—Å–ø—ñ—Ö—É –≤ –Ω—É–ª—å–æ–≤—ñ–π –≥—ñ–ø–æ—Ç–µ–∑—ñ
        alpha (float) - —Ä—ñ–≤–µ–Ω—å –∑–Ω–∞—á—É—â–æ—Å—Ç—ñ –∫—Ä–∏—Ç–µ—Ä—ñ—é
        min_power (float) - –±–∞–∂–∞–Ω–∞ –ø–æ—Ç—É–∂–Ω—ñ—Å—Ç—å
        
    –ü–æ–≤–µ—Ä—Ç–∞—î:
        float - MDE'''
    delta_grid = numpy.linspace(0, 1 - mu0, 500) 
    power = get_stat_power(N, mu0, mu0 + delta_grid, alpha=alpha)
    # –≤–∏–±–µ—Ä–µ–º–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ delta —ñ –ø–æ–≤–µ—Ä–Ω–µ–º–æ –ø–µ—Ä—à—É
    fit_delta = delta_grid[power >= min_power]
    return fit_delta[0]
```

\

```{python}
#| label: mde-def-calc

binom_test_mde_one_sided(N=30, mu0=0.5, alpha=0.05, min_power=0.8)
```

---

::: {.smaller}

–ó–∞–∑–≤–∏—á–∞–π $\text{MDE}$ —Ä–∞—Ö—É—é—Ç—å –Ω–µ –ø—Ä–æ—Å—Ç–æ —Ç–∞–∫, –∞ –Ω–µ—Ä–æ–∑—Ä–∏–≤–Ω–æ –∑ –Ω–∏–º —ñ–¥–µ –ø–∏—Ç–∞–Ω–Ω—è –ø—Ä–æ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Ä–æ–∑–º—ñ—Ä—É –≤–∏–±—ñ—Ä–∫–∏.

\

**–í–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Ä–æ–∑–º—ñ—Ä—É –≤–∏–±—ñ—Ä–∫–∏**

\

–£ –Ω–∞—à–æ–º—É –∑–∞–≤–¥–∞–Ω–Ω—ñ –º–∏ –∑–Ω–∞–π—à–ª–∏ $30$ –∫–ª—ñ—î–Ω—Ç—ñ–≤, –Ω–µ –æ–±—á–∏—Å–ª—é—é—á–∏ —Å–ø–æ—á–∞—Ç–∫—É, —Å–∫—ñ–ª—å–∫–∏ —ó—Ö –∑–Ω–∞–¥–æ–±–∏—Ç—å—Å—è. –ê–ª–µ —â–æ —è–∫—â–æ –æ—Ç—Ä–∏–º–∞–Ω–∏–π $\text{MDE}$ –∑–∞–Ω–∞–¥—Ç–æ –≤–µ–ª–∏–∫–∏–π —ñ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑—Ä–æ–±–∏—Ç–∏ –π–æ–≥–æ –º–µ–Ω—à–∏–º, –æ—Å–∫—ñ–ª—å–∫–∏ –æ—á—ñ–∫—É–≤–∞–Ω—ñ –∑–º—ñ–Ω–∏ –Ω–∞–±–∞–≥–∞—Ç–æ –º–µ–Ω—à—ñ? –¢–æ–¥—ñ –≤–∏—Ä—ñ—à—É—î—Ç—å—Å—è –∑–≤–æ—Ä–æ—Ç–Ω–µ –∑–∞–≤–¥–∞–Ω–Ω—è: –∑–∞ –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏–º $\text{MDE}$ –≤–∏–∑–Ω–∞—á–∏—Ç–∏ –æ–±—Å—è–≥ –≤–∏–±—ñ—Ä–∫–∏. –Ø–∫—â–æ –º–∏ –≥–æ–≤–æ—Ä–∏–º–æ, —â–æ —Ö–æ—á–µ–º–æ –¥–µ—Ç–µ–∫—Ç—É–≤–∞—Ç–∏ $+10$ –≤.–ø., —Ç–æ–±—Ç–æ $60\%$ —É—Å–ø—ñ—à–Ω–∏—Ö –¥–æ—Å—Ç–∞–≤–æ–∫, —Ç–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–Ω–∞–π—Ç–∏ 160 –ø—Ä–æ–±–Ω–∏—Ö –∫–ª—ñ—î–Ω—Ç—ñ–≤, —Ü–µ –≤–∏–¥–Ω–æ –∑ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ—Ö –≥—Ä–∞—Ñ—ñ–∫—ñ–≤. –Ø–∫—â–æ 30 –æ—Å—ñ–± –Ω–∞–º, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —à—É–∫–∞—Ç–∏ –º—ñ—Å—è—Ü—å, —Ç–∞–∫–∏–π —Ç–µ—Å—Ç –º–æ–∂–µ –∑–∞—Ç—è–≥–Ω—É—Ç–∏—Å—è –º–∞–π–∂–µ –Ω–∞ –ø—ñ–≤—Ä–æ–∫—É. –¢–æ–º—É –≤–∞—Ä—Ç–æ –ø–æ–¥—É–º–∞—Ç–∏ –ø—Ä–æ —Ç–µ, —â–æ–± –≤–∏–¥—ñ–ª–∏—Ç–∏ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ —Ä–µ—Å—É—Ä—Å–∏ –Ω–∞ –ø–æ—à—É–∫ –∫–ª—ñ—î–Ω—Ç—ñ–≤, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –∑–∞–ª—É—á–∏—Ç–∏ –º–∞—Ä–∫–µ—Ç–æ–ª–æ–≥—ñ–≤.

:::

# –î–æ–≤—ñ—Ä—á—ñ —ñ–Ω—Ç–µ—Ä–≤–∞–ª–∏ {background-iframe=".02_files/libs/colored-particles/index.html"}

## –î–æ–≤—ñ—Ä—á–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª

[–î–æ–≤—ñ—Ä—á–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª]{.hi} (*CI, confidence interval*) --- –º–Ω–æ–∂–∏–Ω–∞ –∑–Ω–∞—á–µ–Ω—å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ $\mu_0,$ –¥–ª—è —è–∫–∏—Ö –≥—ñ–ø–æ—Ç–µ–∑–∞ $\mu = \mu_0$ –Ω–µ –≤—ñ–¥–∫–∏–¥–∞—î—Ç—å—Å—è –∫—Ä–∏—Ç–µ—Ä—ñ—î–º —Ä—ñ–≤–Ω—è –∑–Ω–∞—á—É—â–æ—Å—Ç—ñ $\alpha$ –∑ –≤—ñ–¥–æ–º–æ—é –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—é $\geq 1 - \alpha$.

–ó –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –≤–∏–ø–ª–∏–≤–∞—î, —â–æ —Ä—ñ–∑–Ω—ñ –∫—Ä–∏—Ç–µ—Ä—ñ—ó –º–æ–∂—É—Ç—å –ø–æ—Ä–æ–¥–∂—É–≤–∞—Ç–∏ —Ä—ñ–∑–Ω—ñ –¥–æ–≤—ñ—Ä—á—ñ —ñ–Ω—Ç–µ—Ä–≤–∞–ª–∏. –£ —Ü—ñ–π —á–∞—Å—Ç–∏–Ω—ñ —Ä–æ–∑–≥–ª—è–Ω–µ–º–æ, —è–∫—ñ —ñ–Ω—Ç–µ—Ä–≤–∞–ª–∏ –ø–æ—Ä–æ–¥–∂—É—é—Ç—å—Å—è –¥–≤–æ—Å—Ç–æ—Ä–æ–Ω–Ω—ñ–º –∫—Ä–∏—Ç–µ—Ä—ñ—î–º. 

–î–ª—è —Ü—å–æ–≥–æ –∑ –∫—Ä–æ–∫–æ–º $0.001$ –ø–µ—Ä–µ–±–µ—Ä–µ–º–æ –∑–Ω–∞—á–µ–Ω–Ω—è $\mu \in [0, 1]$ —ñ –ø–µ—Ä–µ–≤—ñ—Ä–∏–º–æ –≥—ñ–ø–æ—Ç–µ–∑–∏.

## Python —Ç–∞ –¥–æ–≤—ñ—Ä—á–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª {.tiny}

:::: {.columns}

::: {.column width="50%"}
```{python}
#| label: ci-def

# –§—É–Ω–∫—Ü—ñ—è –∑ –º–∏–Ω—É–ª–æ—ó –ª–µ–∫—Ü—ñ—ó
def two_sided_criterion_nonsym(n, mu, alpha):
    '''–ë—É–¥—É—î –¥–≤–æ—Å—Ç–æ—Ä–æ–Ω–Ω—ñ–π –∫—Ä–∏—Ç–µ—Ä—ñ–π –¥–ª—è –Ω–µ—Å–∏–º–µ—Ç—Ä–∏—á–Ω–æ—ó –∑–∞–¥–∞—á—ñ –∑ –¥–æ—Å—Ç–∞–≤–∫–æ—é
    
    –ü–∞—Ä–∞–º–µ—Ç—Ä–∏:
        n: –∫—ñ–ª—å–∫—ñ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–æ–∫ –≤ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ñ
        mu: —ñ–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å —É—Å–ø—ñ—Ö—É –≤ –Ω—É–ª—å–æ–≤—ñ–π –≥—ñ–ø–æ—Ç–µ–∑—ñ
        alpha: —Ä—ñ–≤–µ–Ω—å –∑–Ω–∞—á—É—â–æ—Å—Ç—ñ –∫—Ä–∏—Ç–µ—Ä—ñ—é
        
    –ü–æ–≤–µ—Ä—Ç–∞—î:
        C1, C2 –¥–ª—è –∫—Ä–∏—Ç–µ—Ä—ñ—é S = {Q <= C1 –∞–±–æ Q >= C2}
    '''
    binom_h0 = binom(n=n, p=mu)
    
    # –∞–Ω–∞–ª–æ–≥—ñ—á–Ω–æ –æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω—å–æ–º—É –∫—Ä–∏—Ç–µ—Ä—ñ—é
    c2 = binom_h0.ppf(1 - alpha/2) + 1
        
    # –∑–∞ –≤–∏–∫–ª–∞–¥–∫–∞–º–∏ –≤–∏—â–µ
    c1 = binom_h0.ppf(alpha/2) - 1
    
    return c1, c2
```
:::

::: {.column width="50%" .fragment}
```{python}
#| label: ci-calc-19

success_cnt = 19
mu_grid = numpy.arange(0, 1, 0.001)
mu_no_rejection = []

for mu_h0 in mu_grid:
    c1, c2 = two_sided_criterion_nonsym(30, mu_h0, alpha=0.05)
    if success_cnt > c1 and success_cnt < c2:
        mu_no_rejection.append(mu_h0)

print(f'95% confidence interval: {min(mu_no_rejection)} -- {max(mu_no_rejection)}')
```

–ù–µ –≤—ñ–¥—Ö–∏–ª—è—î–º–æ $H_0$!

\

```{python}
#| label: ci-calc-28

success_cnt = 28
mu_grid = numpy.arange(0, 1, 0.001)
mu_no_rejection = []

for mu_h0 in mu_grid:
    c1, c2 = two_sided_criterion_nonsym(30, mu_h0, alpha=0.05)
    if success_cnt > c1 and success_cnt < c2:
        mu_no_rejection.append(mu_h0)

print(f'95% confidence interval: {min(mu_no_rejection)} -- {max(mu_no_rejection)}')
```

–í—ñ–¥—Ö–∏–ª—è—î–º–æ $H_0$!
:::

::::

---

```{python}
#| label: ci-fig-6
#| code-fold: true
#| fig-align: center

mus_h0 = [0.2, 0.438, 0.439, 0.8, 0.81, 0.9]
success_cnt = 19

fig, axes = pyplot.subplots(3, 2, figsize=(15, 15))

for mu_h0, ax in zip(mus_h0, axes.flatten()):
    binom_h0 = binom(n=30, p=mu_h0)
    probs = binom_h0.pmf(x_grid)

    # –±—É–¥—É—î–º–æ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ñ —Å—Ç–æ–≤–ø—Ü—ñ –≤—ñ–¥ 0 –¥–æ –π–º–æ–≤—ñ—Ä–Ω–æ—Å—Ç—ñ
    ax.vlines(x_grid, 0, probs, linewidth=8.0, color=turquoise, label=f'PMF, $Binom({mu_h0}, 30)$')
    # –æ–∫—Ä–µ–º–æ –∑–æ–±—Ä–∞–∑–∏–º–æ –∫—Ä–∏—Ç–∏—á–Ω—É –æ–±–ª–∞—Å—Ç—å –∫—Ä–∏—Ç–µ—Ä—ñ—é
    c1, c2 = two_sided_criterion_nonsym(30, mu_h0, alpha=0.05)
    crit_reg = (x_grid <= c1) | (x_grid >= c2)
    ax.vlines(x_grid[crit_reg], 0, probs[crit_reg], linewidth=8.0, label='–ö—Ä–∏—Ç–∏—á–Ω–∞ –æ–±–ª–∞—Å—Ç—å –¥–ª—è S')

    is_rejection = success_cnt <= c1 or success_cnt >= c2
    ax.axvline(success_cnt, ls='--', label=f'Q = {success_cnt}' + (' –≤—ñ–¥–∫–∏–Ω—É—Ç–æ' if is_rejection else ' –Ω–µ –≤—ñ–¥–∫–∏–Ω—É—Ç–æ'), color='gray', alpha=0.4)

    rejection_prob = probs[crit_reg].sum()
    ax.set_title(f'$\mu = {mu_h0}$', fontsize=12)
    ax.legend()
```

## –û–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω—ñ –¥–æ–≤—ñ—Ä—á—ñ —ñ–Ω—Ç–µ—Ä–≤–∞–ª–∏

–£ –º–∏–Ω—É–ª—ñ–π —á–∞—Å—Ç–∏–Ω—ñ –º–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–ª–∏ **–¥–≤–æ—Å—Ç–æ—Ä–æ–Ω–Ω—ñ–π –∫—Ä–∏—Ç–µ—Ä—ñ–π**, —ñ –∑ –Ω—å–æ–≥–æ –≤–∏–π—à–æ–≤ –¥–æ–≤—ñ—Ä—á–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª. 

–ê–ª–µ –Ω–∞ –º–∏–Ω—É–ª—ñ–π –ª–µ–∫—Ü—ñ—ó –º–∏ –≥–æ–≤–æ—Ä–∏–ª–∏, —â–æ –¥–≤–æ—Å—Ç–æ—Ä–æ–Ω–Ω—ñ–π –∫—Ä–∏—Ç–µ—Ä—ñ–π –ø–æ—Ç—Ä—ñ–±–µ–Ω **–≤–∫—Ä–∞–π —Ä—ñ–¥–∫–æ**. 

–ö–æ–Ω—Ç—Ä–æ–ª—é–≤–∞—Ç–∏ –ø–æ–º–∏–ª–∫—É *False Positive* –Ω–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ —Ç—ñ–ª—å–∫–∏ –¥–ª—è –≤—ñ–¥—Ö–∏–ª–µ–Ω—å —É –±—ñ–∫, –∫–æ—Ä–∏—Å–Ω–∏–π –¥–ª—è –±—ñ–∑–Ω–µ—Å—É. 

–£ –≤–∏–ø–∞–¥–∫—É –∑–∞–≤–¥–∞–Ω–Ω—è –∑ –¥–æ—Å—Ç–∞–≤–∫–æ—é —Ü–µ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è *–±—ñ–ª—å—à–æ—ó* –∫–æ–Ω–≤–µ—Ä—Å—ñ—ó –≤ —É—Å–ø—ñ—Ö.

\

–°–ø—Ä–æ–±—É—î–º–æ —Å–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏—Å—è –æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω—ñ–º –∫—Ä–∏—Ç–µ—Ä—ñ—î–º –¥–ª—è –ø–æ–±—É–¥–æ–≤–∏ –¥–æ–≤—ñ—Ä—á–æ–≥–æ —ñ–Ω—Ç–µ—Ä–≤–∞–ª—É.

## Python —Ç–∞ –æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω—ñ–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª {.smaller}

:::: {.columns}

::: {.column width="40%"}
```{python}
#| label: ci-one-sided-—Årit

def make_binom_criterion(n, mu=0.5, alpha=0.05):
    '''–ë—É–¥—É—î –∫—Ä–∏—Ç–µ—Ä—ñ–π –¥–ª—è –∑–∞–¥–∞—á—ñ –∑ –¥–æ—Å—Ç–∞–≤–∫–æ—é
    
    –ü–∞—Ä–∞–º–µ—Ç—Ä–∏:
        n: –∫—ñ–ª—å–∫—ñ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–æ–∫ –≤ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ñ
        mu: –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å —É—Å–ø—ñ—Ö—É –≤ –Ω—É–ª—å–æ–≤—ñ–π –≥—ñ–ø–æ—Ç–µ–∑—ñ
        alpha: —Ä—ñ–≤–µ–Ω—å –∑–Ω–∞—á—É—â–æ—Å—Ç—ñ –∫—Ä–∏—Ç–µ—Ä—ñ—é
        
    –ü–æ–≤–µ—Ä—Ç–∞—î:
        C –¥–ª—è –∫—Ä–∏—Ç–µ—Ä—ñ—é S = {Q >= C}
    '''
    binom_h0 = binom(n=n, p=mu)
    q = binom_h0.ppf(1 - alpha)
    return q + 1
```
:::

::: {.column width="60%"}

```{python}
#| label: ci-one-sided-calc

success_cnt = 19
mu_grid = numpy.arange(0, 1.001, 0.001)
mu_no_rejection = []

for mu_h0 in mu_grid:
    crit_val = make_binom_criterion(n=30, mu=mu_h0, alpha=0.05)
    if success_cnt < crit_val:
        mu_no_rejection.append(mu_h0)

print(f'95% confidence interval: {min(mu_no_rejection)} -- {max(mu_no_rejection)}')
```
:::

::::

–ö–æ–ª–∏ –º–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–ª–∏ –¥–≤–æ—Å—Ç–æ—Ä–æ–Ω–Ω—ñ–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª, –º–∏ –æ—Ç—Ä–∏–º–∞–ª–∏ –ª—ñ–≤—É –º–µ–∂—É $0.439 < 0.467$. 

–í–∏—Ö–æ–¥–∏—Ç—å, —â–æ –æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω—ñ–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª –∑ —Ç–æ—á–∫–∏ –∑–æ—Ä—É –ª—ñ–≤–æ—ó –º–µ–∂—ñ –¥–∞—î –Ω–∞–º –±—ñ–ª—å—à–µ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó. –ü—Ä–∏ —Ü—å–æ–º—É –∑ —Ç–æ—á–∫–∏ –∑–æ—Ä—É –ø—Ä–∞–≤–æ—ó –º–µ–∂—ñ –º–∏ –≤—Ç—Ä–∞—á–∞—î–º–æ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –∑–æ–≤—Å—ñ–º. –í–æ–Ω–∞ –¥–æ—Ä—ñ–≤–Ω—é—î 1 –ø—Ä–æ—Å—Ç–æ —Ç–æ–º—É, —â–æ –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ –±—ñ–ª—å—à–æ—é.

–ù–∞—Å–ø—Ä–∞–≤–¥—ñ –∑–∞–∑–≤–∏—á–∞–π –Ω–∞ –ø—Ä–∞–≤—É –º–µ–∂—É –Ω–µ –¥–∏–≤–ª—è—Ç—å—Å—è –ø—ñ–¥ —á–∞—Å –∞–Ω–∞–ª—ñ–∑—É, –∫–æ–ª–∏ –º–∏ —à—É–∫–∞—î–º–æ –ø–æ–∑–∏—Ç–∏–≤–Ω–∏–π –µ—Ñ–µ–∫—Ç.

## Python —Ç–∞ –æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω—ñ–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª {.smaller}

–ü—Ä–∏–ø—É—Å—Ç–∏–º–æ, –º–∏ –æ—Ç—Ä–∏–º–∞–ª–∏ –Ω–µ $19$ —É—Å–ø—ñ—Ö—ñ–≤, –∞ $22$. –ü–æ–±—É–¥—É—î–º–æ 2 –≤–∏–¥–∏ —ñ–Ω—Ç–µ—Ä–≤–∞–ª—ñ–≤.

```{python}
#| label: ci-one-sided-calc-22

success_cnt = 22
mu_grid = numpy.arange(0, 1, 0.001)
mu_no_rejection = []

for mu_h0 in mu_grid:
    c1, c2 = two_sided_criterion_nonsym(30, mu_h0, alpha=0.05)
    if success_cnt > c1 and success_cnt < c2:
        mu_no_rejection.append(mu_h0)

print(f'Two-sided 95% confidence interval: {min(mu_no_rejection)} -- {max(mu_no_rejection)}')
```

\

```{python}
#| label: ci-one-sided-calc-22-one-sided

success_cnt = 22
mu_grid = numpy.arange(0, 1.001, 0.001)
mu_no_rejection = []

for mu_h0 in mu_grid:
    crit_val = make_binom_criterion(n=30, mu=mu_h0, alpha=0.05)
    if success_cnt < crit_val:
        mu_no_rejection.append(mu_h0)

print(f'One-sided 95% confidence interval: {min(mu_no_rejection):.2f} -- {max(mu_no_rejection)}')
```

## Python —Ç–∞ –æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω—ñ–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª {.smaller}

–ù–∞–≤—ñ—â–æ –∂ –º–∏ —Ç–æ–¥—ñ –≤–∑–∞–≥–∞–ª—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –¥–≤–æ—Å—Ç–æ—Ä–æ–Ω–Ω—ñ–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª? –©–æ–± —Ü–µ –∑—Ä–æ–∑—É–º—ñ—Ç–∏, –ø–æ–¥–∏–≤–∏–º–æ—Å—è, —è–∫–∏–π –≤–∏–≥–ª—è–¥ –º–∞—é—Ç—å –≤—ñ–∑—É–∞–ª—å–Ω–æ –º–µ–∂—ñ –¥–ª—è –æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω—å–æ–≥–æ —ñ–Ω—Ç–µ—Ä–≤–∞–ª—É.

```{python}
#| label: ci-fig-6-one-sided
#| code-fold: true
#| fig-align: center

fig, axes = pyplot.subplots(3, 2, figsize=(15, 15))

for mu_h0, ax in zip(mus_h0, axes.flatten()):
    binom_h0 = binom(n=30, p=mu_h0)
    probs = binom_h0.pmf(x_grid)

    # –±—É–¥—É—î–º–æ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ñ —Å—Ç–æ–≤–ø—Ü—ñ –≤—ñ–¥ 0 –¥–æ –π–º–æ–≤—ñ—Ä–Ω–æ—Å—Ç—ñ
    ax.vlines(x_grid, 0, probs, linewidth=8.0, color=turquoise, label=f'PMF, $Binom({mu_h0}, 30)$')
    # –æ–∫—Ä–µ–º–æ –∑–æ–±—Ä–∞–∑–∏–º–æ –∫—Ä–∏—Ç–∏—á–Ω—É –æ–±–ª–∞—Å—Ç—å –∫—Ä–∏—Ç–µ—Ä—ñ—é
    c = make_binom_criterion(30, mu_h0, alpha=0.05)
    crit_reg = (x_grid >= c)
    ax.vlines(x_grid[crit_reg], 0, probs[crit_reg], linewidth=8.0, label='–ö—Ä–∏—Ç–∏—á–Ω–∞ –æ–±–ª–∞—Å—Ç—å –¥–ª—è S')

    is_rejection = success_cnt >= c
    ax.axvline(success_cnt, ls='--', label=f'Q = {success_cnt}' + (' –≤—ñ–¥–∫–∏–Ω—É—Ç–æ' if is_rejection else ' –Ω–µ –≤—ñ–¥–∫–∏–Ω—É—Ç–æ'), color='gray', alpha=0.4)

    rejection_prob = probs[crit_reg].sum()
    ax.set_title(f'$\mu = {mu_h0}$', fontsize=12)
    ax.legend()
```

---

–ö—Ä–∏—Ç–∏—á–Ω–∞ –æ–±–ª–∞—Å—Ç—å —Å—Ç–∞–ª–∞ **–±—ñ–ª—å—à–æ—é** —á–µ—Ä–µ–∑ —Ç–µ, —â–æ —Ç–∞–º —Ç–µ–ø–µ—Ä –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –Ω–µ $2.5\%$, –∞ $5\%$ –∑–∞ –ø–æ–±—É–¥–æ–≤–æ—é. –ü—Ä–∏ —Ü—å–æ–º—É **–ª—ñ–≤–æ—ó** –∫—Ä–∏—Ç–∏—á–Ω–æ—ó –æ–±–ª–∞—Å—Ç—ñ –ø—Ä–æ—Å—Ç–æ **–Ω–µ —ñ—Å–Ω—É—î**, —Ç–æ–º—É –∑–∞ –≤–µ–ª–∏–∫–∏—Ö $\mu$ –Ω–µ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –ø–æ—Ç—Ä–∞–ø–ª—è–Ω–Ω—è $19$ –¥–æ –Ω–µ—ó, –∞ –∑–Ω–∞—á–∏—Ç—å –º–∏ –Ω–µ –≤—ñ–¥–∫–∏–¥–∞—î–º–æ –≥—ñ–ø–æ—Ç–µ–∑—É.

\

–ó–∞—É–≤–∞–∂–∏–º–æ, —â–æ —è–∫–±–∏ –º–∏ –±—É–¥—É–≤–∞–ª–∏ –¥–≤–æ—Å—Ç–æ—Ä–æ–Ω–Ω—ñ–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª, –∞–ª–µ –∑ —É–¥–≤—ñ—á—ñ –±—ñ–ª—å—à–æ—é $\alpha$, –ø–æ—Ç—Ä–∞–ø–ª—è–Ω–Ω—è –≤ –ø—Ä–∞–≤—É –∫—Ä–∏—Ç–∏—á–Ω—É –æ–±–ª–∞—Å—Ç—å —Ç—Ä–∞–ø–ª—è–ª–∏—Å—è –± –∑–∞ —Ç–∏—Ö —Å–∞–º–∏—Ö $\mu$, —â–æ –π –≤ –æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω—å–æ–º—É –∫—Ä–∏—Ç–µ—Ä—ñ—ó. –¢–æ–º—É —á–∞—Å—Ç–æ **–¥–ª—è –ø–æ—à—É–∫—É –æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω—å–æ—ó** –º–µ–∂—ñ –±—É–¥—É—é—Ç—å –¥–≤–æ—Å—Ç–æ—Ä–æ–Ω–Ω—ñ–π –¥–æ–≤—ñ—Ä—á–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª —ñ–∑ **–±—ñ–ª—å—à–æ—é** $\\alpha$, —ñ–≥–Ω–æ—Ä—É—é—á–∏ –ø—Ä–∏ —Ü—å–æ–º—É –ø—Ä–∞–≤—É –º–µ–∂—É. –¶–µ –∑—Ä—É—á–Ω–æ, –æ—Å–∫—ñ–ª—å–∫–∏ –º–æ–∂–Ω–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ç–∏—Å—è —Ç—ñ–ª—å–∫–∏ –æ–¥–Ω—ñ—î—é —Ñ—É–Ω–∫—Ü—ñ—î—é –¥–ª—è –∫—Ä–∏—Ç–µ—Ä—ñ—é.

## Python —Ç–∞ –æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω—ñ–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª {.smaller}

–ü–µ—Ä–µ–≤—ñ—Ä–∏–º–æ, —â–æ –≤–∏–π–¥–µ –ø—Ä–∏ $\alpha = 0.1$.

```{python}
#| label: ci-one-sided-calc-22-one-sided-10

success_cnt = 19
mu_grid = numpy.arange(0, 1, 0.001)
mu_no_rejection = []

for mu_h0 in mu_grid:
    c1, c2 = two_sided_criterion_nonsym(30, mu_h0, alpha=0.1)
    if success_cnt > c1 and success_cnt < c2:
        mu_no_rejection.append(mu_h0)

print(f'Two-sided 90% confidence interval: {min(mu_no_rejection):.3f} -- {max(mu_no_rejection):.3f}')
```

## –í–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å –¥–æ–≤—ñ—Ä—á–æ–≥–æ —ñ–Ω—Ç–µ—Ä–≤–∞–ª—É

–Ø–∫–∏–º –±–∏ –Ω–µ –±—É–ª–æ —ñ—Å—Ç–∏–Ω–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è $\mu = \mu_0$, –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å —Ç–æ–≥–æ, —â–æ –≤–æ–Ω–æ –ø–µ—Ä–µ–±—É–≤–∞—î –º—ñ–∂ $\mathcal{L}(Q)$ —ñ $\mathcal{R}(Q)$, –Ω–µ –Ω–∏–∂—á–∞, –Ω—ñ–∂ $1 - \alpha$. 

–ó–Ω–∞—á–µ–Ω–Ω—è $1 - \alpha$ –Ω–∞–∑–∏–≤–∞—î—Ç—å—Å—è [—Ä—ñ–≤–Ω–µ–º –¥–æ–≤—ñ—Ä–∏]{.hi} –¥–æ–≤—ñ—Ä—á–æ–≥–æ —ñ–Ω—Ç–µ—Ä–≤–∞–ª—É.

$$ P(\mathcal{L}(Q) < \mu_0 < \mathcal{R}(Q)) \geqslant 1 - \alpha $$

–í–∞–∂–ª–∏–≤–æ, —â–æ –≤–∏–ø–∞–¥–∫–æ–≤—ñ—Å—Ç—å —Ç—É—Ç –ø—Ä–∏—Ö–æ–≤–∞–Ω–∞ —Å–∞–º–µ –≤ $\mathcal{L}$ —ñ $\mathcal{R}$, –∞ –Ω–µ –≤ $\mu_0$. 

–ü–∞—Ä–∞–º–µ—Ç—Ä $\mu_0$ –Ω–µ–≤—ñ–¥–æ–º–∏–π, –∞–ª–µ –º–∏ –ø—Ä–∏–ø—É—Å–∫–∞—î–º–æ –π–æ–≥–æ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω–∏–º —ñ –Ω–µ –≤–∏–ø–∞–¥–∫–æ–≤–∏–º.

## –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ {.tiny}

:::: {.columns}

::: {.column width="40%"}
–î–ª—è —Ü—å–æ–≥–æ –∑–∞—Ñ—ñ–∫—Å—É—î–º–æ $\mu_0$ —ñ –ø—Ä–æ–≤–µ–¥–µ–º–æ –º–Ω–æ–∂–∏–Ω—É –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ñ–≤:

* –ì–µ–Ω–µ—Ä—É—î–º–æ –≤–∏–±—ñ—Ä–∫—É –∑ —Ä–æ–∑–ø–æ–¥—ñ–ª—É –∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º $\mu_0$
* –û–±—á–∏—Å–ª—é—î–º–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É $q$
* –†–∞—Ö—É—î–º–æ –¥–æ–≤—ñ—Ä—á–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è $\alpha = 0.05$

–ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —â–æ —á–∞—Å—Ç–∫–∞ –≤–∏–ø–∞–¥–∫—ñ–≤, –∫–æ–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä $\mu_0$ –æ–ø–∏–Ω–∏–≤—Å—è –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –º–µ–∂ —ñ–Ω—Ç–µ—Ä–≤–∞–ª—É, —Ö–æ—á–∞ –± $95\%$
:::

::: {.column width="60%"}
```{python}
#| label: ci-property-slow
#| eval: false

def my_binomial_confint(n, alpha, q):
    '''–û–±—á–∏—Å–ª—é—î –¥–æ–≤—ñ—Ä—á–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è –≤–∏–±—ñ—Ä–∫–∏ –∑ —Ä–æ–∑–ø–æ–¥—ñ–ª—É –ë–µ—Ä–Ω—É–ª–ª—ñ
    
        n (int) - –∫—ñ–ª—å–∫—ñ—Å—Ç—å –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ —É –≤–∏–±—ñ—Ä—Ü—ñ
        alpha (float) - —Ä—ñ–≤–µ–Ω—å –∑–Ω–∞—á—É—â–æ—Å—Ç—ñ –∫—Ä–∏—Ç–µ—Ä—ñ—é
        q (float) - —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∫—Ä–∏—Ç–µ—Ä—ñ—é
    '''
    mu_grid = numpy.arange(0, 1.001, 0.001)
    mu_no_rejection = []

    for mu_h0 in mu_grid:
        c1, c2 = two_sided_criterion_nonsym(30, mu_h0, alpha=0.05)
        if q > c1 and q < c2:
            mu_no_rejection.append(mu_h0)

    return min(mu_no_rejection), max(mu_no_rejection)

numpy.random.seed(2024)

N_EXPERIMENTS = 1000
SAMPLE_SIZE = 30
latent_mu = 0.5 # ¬´—ñ—Å—Ç–∏–Ω–Ω–µ¬ª –∑–Ω–∞—á–µ–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞
binom_true = binom(n=SAMPLE_SIZE, p=latent_mu) # ¬´—ñ—Å—Ç–∏–Ω–Ω–∏–π¬ª —Ä–æ–∑–ø–æ–¥—ñ–ª

confint_fail_cases = 0

for i in range(N_EXPERIMENTS):
    q = binom_true.rvs() # –≥–µ–Ω–µ—Ä—É—î–º–æ –æ–¥—Ä–∞–∑—É —Å—É–º—É –µ–ª–µ–º–µ–Ω—Ç—ñ–≤
    L, R = my_binomial_confint(n=SAMPLE_SIZE, alpha=0.05, q=q)
    if L < latent_mu < R:
        pass # –≤—Å–µ –¥–æ–±—Ä–µ
    else:
        confint_fail_cases += 1

print(1 - confint_fail_cases / N_EXPERIMENTS)
```

```{python}
#| label: ci-property-fast
#| echo: false

print(0.962)
```
:::

::::

–ê–ª–µ —Ü–µ –¥—É–∂–µ –¥–æ–≤–≥–æ! –¶–µ —á–µ—Ä–µ–∑ —Ç–µ, —â–æ –ø—ñ–¥ —á–∞—Å –∫–æ–∂–Ω–æ–≥–æ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—É –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–æ–±—É–¥—É–≤–∞—Ç–∏ –¥–æ–≤—ñ—Ä—á–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª, –∞ –æ—Ç–∂–µ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ 1000 –º–æ–∂–ª–∏–≤–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ $\mu_0$.

## –î–æ–≤—ñ—Ä—á–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª –í—ñ–ª—Å–æ–Ω–∞ {.tiny}

–†–æ–∑–≥–ª—è–Ω—É—Ç–∏–π –∑–∞—Ä–∞–∑ –∞–ª–≥–æ—Ä–∏—Ç–º –ø–æ–±—É–¥–æ–≤–∏ –¥–æ–≤—ñ—Ä—á–æ–≥–æ —ñ–Ω—Ç–µ—Ä–≤–∞–ª—É –ø—Ä–∞—Ü—é—î –∑–∞–Ω–∞–¥—Ç–æ –¥–æ–≤–≥–æ. –£ Python —î —Ñ—É–Ω–∫—Ü—ñ—ó, —è–∫—ñ –¥–æ–∑–≤–æ–ª—è—é—Ç—å —à–≤–∏–¥—à–µ —Ä–æ–∑—Ä–∞—Ö—É–≤–∞—Ç–∏ —ñ–Ω—Ç–µ—Ä–≤–∞–ª. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –º–æ–∂–Ω–∞ —Å–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏—Å—è –º–µ—Ç–æ–¥–æ–º –í—ñ–ª—Å–æ–Ω–∞ —ñ —Ñ—É–Ω–∫—Ü—ñ—î—é `proportion_confint`

```{python}
#| label: ci-wilson

from statsmodels.stats.proportion import proportion_confint

numpy.random.seed(20231212)

N_EXPERIMENTS = 1000
SAMPLE_SIZE = 30
latent_mu = 0.5 # ¬´—ñ—Å—Ç–∏–Ω–Ω–µ¬ª –∑–Ω–∞—á–µ–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞
binom_true = binom(n=SAMPLE_SIZE, p=latent_mu) # ¬´—ñ—Å—Ç–∏–Ω–Ω–∏–π¬ª —Ä–æ–∑–ø–æ–¥—ñ–ª

confint_fail_cases = 0

for i in range(N_EXPERIMENTS):
    q = binom_true.rvs()  
    L, R = proportion_confint(
        count=q, # –∫—ñ–ª—å–∫—ñ—Å—Ç—å —É—Å–ø—ñ—Ö—ñ–≤
        nobs=SAMPLE_SIZE, # —Ä–æ–∑–º—ñ—Ä –≤–∏–±—ñ—Ä–∫–∏
        alpha=0.05,
        method='wilson'
    )
    if L < latent_mu < R:
        pass # –≤—Å–µ –¥–æ–±—Ä–µ
    else:
        confint_fail_cases += 1

print(1 - confint_fail_cases / N_EXPERIMENTS)
```

<center>üò¢</center>

## CI –í—ñ–ª—Å–æ–Ω–∞ vs. N {.smaller}

–ó–∞–ª–µ–∂–Ω—ñ—Å—Ç—å —á–∞—Å—Ç–∫–∏ —É—Å–ø—ñ—à–Ω–∏—Ö –≤–ª—É—á–µ–Ω—å $\mu$ —É –¥–æ–≤—ñ—Ä—á–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª –≤—ñ–¥ —Ä–æ–∑–º—ñ—Ä—É –≤–∏–±—ñ—Ä–∫–∏ –∑–æ–±—Ä–∞–∑–∏–º–æ –Ω–∞ –≥—Ä–∞—Ñ—ñ–∫—É.

```{python}
#| label: ci-wilson-plot
#| fig-align: center
#| code-fold: true

n_grid = numpy.arange(1, 1000, 25).tolist()
interval_success_rate = []

for n in n_grid:
    confint_fail_cases = 0
    for i in range(N_EXPERIMENTS):
        binom_true = binom(n=n, p=latent_mu)
        q = binom_true.rvs()  
        L, R = proportion_confint(
            count=q, # –∫—ñ–ª—å–∫—ñ—Å—Ç—å —É—Å–ø—ñ—Ö—ñ–≤
            nobs=n, # —Ä–æ–∑–º—ñ—Ä –≤–∏–±—ñ—Ä–∫–∏
            alpha=0.05,
            method='wilson'
        )
        if L < latent_mu < R:
            pass # –≤—Å–µ –¥–æ–±—Ä–µ
        else:
            confint_fail_cases += 1
    interval_success_rate.append(1 - confint_fail_cases / N_EXPERIMENTS)

pyplot.figure(figsize=(12, 7))
pyplot.title('–£—Å–ø—ñ—à–Ω—ñ—Å—Ç—å –¥–æ–≤—ñ—Ä—á–æ–≥–æ —ñ–Ω—Ç–µ—Ä–≤–∞–ª—É –í—ñ–ª—Å–æ–Ω–∞ –∑–∞ —Ä—ñ–∑–Ω–æ–≥–æ —Ä–æ–∑–º—ñ—Ä—É –≤–∏–±—ñ—Ä–∫–∏', fontsize=15)
pyplot.xlabel('–†–æ–∑–º—ñ—Ä –≤–∏–±—ñ—Ä–∫–∏', fontsize=15)
pyplot.ylabel('–ß–∞—Å—Ç–∫–∞ –≤–ª—É—á–µ–Ω—å $\mu$ –≤ —ñ–Ω—Ç–µ—Ä–≤–∞–ª', fontsize=15)

pyplot.plot(n_grid, interval_success_rate, label='–£—Å–ø—ñ—à–Ω—ñ—Å—Ç—å –≤ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞—Ö')
pyplot.axhline(0.95, ls='--', label='–ë–∞–∂–∞–Ω–∞ —É—Å–ø—ñ—à–Ω—ñ—Å—Ç—å', color='red')

pyplot.legend(fontsize=15)
pyplot.show()
```

## –ü—ñ–¥—Å—É–º–∫–∏

#### –ê–ª–≥–æ—Ä–∏—Ç–º –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –≥—ñ–ø–æ—Ç–µ–∑ {.smaller}

1. –ë—ñ–∑–Ω–µ—Å-–∑–∞–¥–∞—á–∞ / –≥—ñ–ø–æ—Ç–µ–∑–∞
2. –§–æ—Ä–º—É–ª—é–≤–∞–Ω–Ω—è –Ω—É–ª—å–æ–≤–æ—ó —Ç–∞ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ—ó –≥—ñ–ø–æ—Ç–µ–∑:
    + $\mathsf{H}_0: \mu = 0.5$
    + $\mathsf{H}_1: \mu > 0.5$
3. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫—Ä–∏—Ç–µ—Ä—ñ—é $Q = \sum_{i=1}^n \text{Bernoulli}(\mu)$, $q = 19$
4. –†–æ–∑–ø–æ–¥—ñ–ª $Q$ –ø—Ä–∏ $\mathsf{H}_0$ —Ç–∞ –∫—Ä–∏—Ç–∏—á–Ω–∞ –æ–±–ª–∞—Å—Ç—å ($p$-–∑–Ω–∞—á–µ–Ω–Ω—è) –ø—Ä–∏ $\alpha = 0.05$
5. $\text{MDE} (n, \text{power}, \alpha)$
6. –î–æ–≤—ñ—Ä—á–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è $\mu$

# –î—è–∫—É—é –∑–∞ —É–≤–∞–≥—É! {.unnumbered .unlisted background-iframe=".02_files/libs/colored-particles/index.html"}

<br> <br>

{{< iconify solar book-bold >}} [–ú–∞—Ç–µ—Ä—ñ–∞–ª–∏ –∫—É—Ä—Å—É](https://aranaur.rbind.io/lectures/asa/)

{{< iconify mdi envelope >}} ihor.miroshnychenko\@knu.ua

{{< iconify ic baseline-telegram >}} [Data Mirosh](https://t.me/araprof)

{{< iconify mdi linkedin >}} [\@ihormiroshnychenko](https://www.linkedin.com/in/ihormiroshnychenko/)

{{< iconify mdi github >}} [\@aranaur](https://github.com/Aranaur)

{{< iconify ion home >}} [aranaur.rbind.io](https://aranaur.rbind.io)
