---
title: "$t$-–∫—Ä–∏—Ç–µ—Ä—ñ–π –°—Ç'—é–¥–µ–Ω—Ç–∞"
subtitle: "–ü—Ä–∏–∫–ª–∞–¥–Ω–∏–π —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–∏–π –∞–Ω–∞–ª—ñ–∑"
author: "–Ü–≥–æ—Ä –ú—ñ—Ä–æ—à–Ω–∏—á–µ–Ω–∫–æ"
institute: –ö–ù–£ —ñ–º–µ–Ω—ñ –¢–∞—Ä–∞—Å–∞ –®–µ–≤—á–µ–Ω–∫–∞, –§–Ü–¢
from: markdown+emoji
title-slide-attributes:
    data-background-iframe: .04_files/libs/colored-particles/index.html
language: _language-ua.yml
footer: <a href="https://aranaur.rbind.io/lectures/asa/">üîó–ü—Ä–∏–∫–ª–∞–¥–Ω–∏–π —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–∏–π –∞–Ω–∞–ª—ñ–∑</a>
format:
  revealjs: 
    code-line-numbers: false
    # center: true
    navigation-mode: vertical
    transition: fade
    background-transition: fade
    # controls-layout: bottom-right
    chalkboard: true
    logo: fit.png
    slide-number: true
    toc: true
    toc-depth: 1
    mouse-wheel: true
    width: 1350  
    height: 759.375
    highlight-style: github
    # fig-width: 9
    # fig-height: 5
    fig-format: svg
    theme: [default, custom.scss]
    mermaid:
      theme: forest
  # gfm:
  #   mermaid-format: png
preload-iframes: true
jupyter: python3
execute: 
  echo: true
  warning: false
editor_options: 
  chunk_output_type: console

revealjs-plugins:
  - verticator
---

```{python}
#| label: setup
#| include: false

# Import libraries
from scipy.stats import (
    norm, binom, expon, t, chi2, pareto, ttest_1samp, ttest_ind, sem
)
from statsmodels.stats.api import CompareMeans, DescrStatsW
from statsmodels.stats.proportion import proportion_confint
import numpy as numpy
from seaborn import distplot
from matplotlib import pyplot
import seaborn

from IPython.display import Markdown
from tabulate import tabulate

# Define colors
red_pink   = "#e64173"
turquoise  = "#20B2AA"
orange     = "#FFA500"
red        = "#fb6107"
blue       = "#181485"
navy       = "#150E37FF"
green      = "#8bb174"
yellow     = "#D8BD44"
purple     = "#6A5ACD"
slate      = "#314f4f"
```

# $t'$-—Ç–µ—Å—Ç {background-iframe=".04_files/libs/colored-particles/index.html"}

## üìà –ó–∞–¥–∞—á–∞ {.smaller}

> –£ –Ω–∞—à—ñ–π –∫–æ–º–ø–∞–Ω—ñ—ó —Ö–æ—á—É—Ç—å –ø–µ—Ä–µ–π—Ç–∏ –∑ –æ–¥–Ω—ñ—î—ó –°–£–ë–î –Ω–∞ —ñ–Ω—à—É. –ì–æ–ª–æ–≤–Ω–∏–º –∫—Ä–∏—Ç–µ—Ä—ñ—î–º –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥—É —î ¬´–≤–∏—Ç—Ä–∞—á–µ–Ω–∏–π —á–∞—Å —É –¥–æ–±—ñ –Ω–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö¬ª. –Ø–∫—â–æ —Ä–∞–Ω—ñ—à–µ –¥–ª—è —â–æ–¥–µ–Ω–Ω–æ–≥–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –±–∞–∑–∏ –±—É–ª–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤ —Å–µ—Ä–µ–¥–Ω—å–æ–º—É 10 –≥–æ–¥–∏–Ω, —Ç–æ —Ö–æ—á–µ—Ç—å—Å—è –∑–Ω–∞–π—Ç–∏ –Ω–æ–≤—É –°–£–ë–î, —É —è–∫—ñ–π —É—Å–µ —Ü–µ –≤—ñ–¥–±—É–≤–∞—Ç–∏–º–µ—Ç—å—Å—è —à–≤–∏–¥—à–µ, –Ω—ñ–∂ –∑–∞ 7 –≥–æ–¥–∏–Ω.
>
> –î–ª—è —Ü—å–æ–≥–æ –±—É–ª–æ –ø—Ä–∏–π–Ω—è—Ç–æ —Ä—ñ—à–µ–Ω–Ω—è –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –≤—Å—ñ –¥–∞–Ω—ñ –Ω–∞ –Ω–æ–≤—É —Ç–µ—Å—Ç–æ–≤–∞–Ω—É –°–£–ë–î. –ü—Ä–æ—Ç—è–≥–æ–º –æ–¥–Ω–æ–≥–æ —Ç–∏–∂–Ω—è —â–æ–¥–Ω—è –º–∏ –ø–æ—Ä–∞—Ö—É—î–º–æ —á–∞—Å –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö, —ñ —è–∫—â–æ –≤ —Å–µ—Ä–µ–¥–Ω—å–æ–º—É –Ω–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –≤–∏—Ç—Ä–∞—á–∞—Ç–∏–º–µ—Ç—å—Å—è –º–µ–Ω—à–µ 7 –≥–æ–¥–∏–Ω, —Ç–æ –º–∏ –ø–æ–≤–Ω—ñ—Å—Ç—é –ø–µ—Ä–µ–π–¥–µ–º–æ –Ω–∞ –Ω–æ–≤—É –°–£–ë–î. –í–∞—à–µ –∑–∞–≤–¥–∞–Ω–Ω—è –ø—Ä–∏–¥—É–º–∞—Ç–∏, —è–∫ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –≥—ñ–ø–æ—Ç–µ–∑—É –ø—Ä–æ —Ç–µ, —â–æ –Ω–æ–≤–∞ –°–£–ë–î –∫—Ä–∞—â–∞ –∑–∞ —Å—Ç–∞—Ä—É.

–í–∏–π—à–ª–∞ –≤–∏–±—ñ—Ä–∫–∞:

- `[6.9, 6.45, 6.32, 6.88, 6.19, 7.13, 6.76]` --- —á–∞—Å –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤ –Ω–æ–≤—É –ë–î –ø–æ –¥–Ω—è—Ö —É –≥–æ–¥–∏–Ω–∞—Ö.

## üìä –ì—ñ–ø–æ—Ç–µ–∑–∞

- $X_1, X_2, ..., X_7$ --- —á–∞—Å –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤ –≥–æ–¥–∏–Ω–∞—Ö –Ω–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö —É –°–£–ë–î –∑–∞ –∫–æ–∂–µ–Ω –¥–µ–Ω—å –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—É
- $X$ –∑ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–æ–∑–ø–æ–¥—ñ–ª—É.

```{python}
#| label: data-gen

X = numpy.array([6.9, 6.45, 6.32, 6.88, 6.09, 7.13, 6.76])
print(f"–°–µ—Ä–µ–¥–Ω—ñ–π —á–∞—Å –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤ –°–£–ë–î: {round(numpy.mean(X), 2)}")
```

- $H_0: \bar{X} \geq 7$ vs. $H_1: \bar{X} < 7$

## üìê $Z$-–∫—Ä–∏—Ç–µ—Ä—ñ–π

- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ $Z(X) = \sqrt{n}\dfrac{\overline X - \mu_0}{\sqrt{\sigma^2}}$

. . .

–¢–æ–¥—ñ —Ç—Ä–µ–±–∞ –ª–∏—à–µ –ø–æ—Ä–∞—Ö—É–≤–∞—Ç–∏ —Ç–∞–∫—É —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É: $$\sqrt{n}\dfrac{\overline X - 7}{\sqrt{\sigma^2}} \overset{H_0}{\sim} \mathcal{N}(0, 1)$$

. . .

::: {.callout-important}
–ê–ª–µ —î –æ–¥–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞: [–º–∏ –Ω–µ –∑–Ω–∞—î–º–æ $\sigma^2$!]{.hi}
:::

## üìê $t'$-—Ç–µ—Å—Ç {.smaller}

$\widehat{\sigma^2} =S^2 = \dfrac{1}{n - 1}\underset{i=1}{\overset{n}{\sum}}(X_i - \overline X)^2$

. . .

```{python}
#| label: sigma-hat

# ddof = 1 -- –¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –¥—ñ–ª–∏–º–æ –Ω–µ –Ω–∞ n, –∞ –Ω–∞ n-1 —É —Ñ–æ—Ä–º—É–ª—ñ –≤–∏—â–µ
print(f"–û—Ü—ñ–Ω–∫–∞ sigma^2: {numpy.var(X, ddof=1)}")
```

. . .

–î–∞–≤–∞–π—Ç–µ –≤–≤–µ–¥–µ–º–æ –Ω–æ–≤–∏–π –∫—Ä–∏—Ç–µ—Ä—ñ–π $t$-–∫—Ä–∏—Ç–µ—Ä—ñ–π, —É —è–∫–æ–º—É –º–∏ –ø—ñ–¥—Å—Ç–∞–≤–∏–º–æ:

- $T(X) := \sqrt{n}\dfrac{\overline X - \mu_0}{\sqrt{S^2}}$
- $T(X) \overset{H_0}{\sim} \mathcal{N}(0, 1)$ ü§®

. . .

> –ó–∞–ª–∏—à–∏–ª–æ—Å—è –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏: –ß–∏ –ø—Ä–∞–≤–¥–∞, —â–æ –ø—Ä–∏ $H_0$ —Ä–æ–∑–ø–æ–¥—ñ–ª —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ T --- —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–π –Ω–æ—Ä–º–∞–ª—å–Ω–∏–π?

## üìä –†–æ–∑–ø–æ–¥—ñ–ª —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

- –ú–∏ $M$ —Ä–∞–∑ –≥–µ–Ω–µ—Ä—É—î–º–æ –≤–∏–±—ñ—Ä–∫—É $X$ —ñ –ø–æ—Ä–∞—Ö—É—î–º–æ —â–æ—Ä–∞–∑—É —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É $T(X)$.
- –£ –ø—ñ–¥—Å—É–º–∫—É –º–∏ –æ—Ç—Ä–∏–º–∞—î–º–æ –≤–∏–±—ñ—Ä–∫—É —Ä–æ–∑–º—ñ—Ä—É $M$ –¥–ª—è $T(X)$ —ñ –∑–º–æ–∂–µ–º–æ –ø–æ–±—É–¥—É–≤–∞—Ç–∏ –≥—ñ—Å—Ç–æ–≥—Ä–∞–º—É —Ä–æ–∑–ø–æ–¥—ñ–ª—É. 
- –û–∫—Ä–µ–º–æ –ø–æ–±—É–¥—É—î–º–æ —Ä–æ–∑–ø–æ–¥—ñ–ª $\mathcal{N}(0, 1)$. 
- –Ø–∫—â–æ –µ–º–ø—ñ—Ä–∏—á–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª –≤—ñ–∑—É–∞–ª—å–Ω–æ –∑–±—ñ–∂–∏—Ç—å—Å—è –∑ —Ç–µ–æ—Ä–µ—Ç–∏—á–Ω–∏–º –Ω–æ—Ä–º–∞–ª—å–Ω–∏–º, –∑–Ω–∞—á–∏—Ç—å, —É—Å–µ –¥–æ–±—Ä–µ. –ê —è–∫—â–æ –Ω—ñ, —Ç–æ —Ç–∞–∫ –ø—Ä–æ—Å—Ç–æ –º–∏ –Ω–µ –º–æ–∂–µ–º–æ –∑–∞–º—ñ–Ω–∏—Ç–∏ $\sigma^2$ –Ω–∞ $S^2$.
    - –î–æ–¥–∞—Ç–∫–æ–≤–æ –ø–æ–¥–∏–≤–∏–º–æ—Å—è, —â–æ –±—É–¥–µ, —è–∫—â–æ –∑–∞–º—ñ–Ω–∏—Ç–∏ $T(X)$ –Ω–∞ $Z(X)$.

## üêç Python —Ç–∞ üìä –†–æ–∑–ø–æ–¥—ñ–ª —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ {.smaller}

```{python}
#| label: t-test-sim-def

def sample_statistics(number_of_experiments, statistic_function, sample_size, sample_distr):
    """
        –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –≤–∏–±—ñ—Ä–∫–∏ –¥–µ—è–∫–æ—ó —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ statistic_function, –ø–æ–±—É–¥–æ–≤–∞–Ω–æ—ó –∑–∞ –≤–∏–±—ñ—Ä–∫–æ—é –∑ —Ä–æ–∑–ø–æ–¥—ñ–ª—É sample_distr.
        –ü–æ–≤–µ—Ä—Ç–∞—î –≤–∏–±—ñ—Ä–∫—É —Ä–æ–∑–º—ñ—Ä—É number_of_experiments –¥–ª—è statistic_function.

        –ü–∞—Ä–∞–º–µ—Ç—Ä–∏:
            - number_of_experiments: –∫—ñ–ª—å–∫—ñ—Å—Ç—å –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ñ–≤, —É –∫–æ–∂–Ω–æ–º—É –∑ —è–∫–∏—Ö –º–∏ –ø–æ—Ä–∞—Ö—É—î–º–æ statistic_function
            - statistic_function: —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞, —è–∫–∞ –ø—Ä–∏–π–º–∞—î –Ω–∞ –≤—Ö—ñ–¥ –≤–∏–±—ñ—Ä–∫—É –∑ —Ä–æ–∑–ø–æ–¥—ñ–ª—É sample_distr
            - sample_size: —Ä–æ–∑–º—ñ—Ä –≤–∏–±—ñ—Ä–∫–∏, —è–∫–∞ –ø–æ–¥–∞—î—Ç—å—Å—è –Ω–∞ –≤—Ö—ñ–¥ statistic_function
            - sample_distr: —Ä–æ–∑–ø–æ–¥—ñ–ª –ø–æ—á–∞—Ç–∫–æ–≤–æ—ó –≤–∏–±—ñ—Ä–∫–∏, –∑–∞ —è–∫–æ—é —Ä–∞—Ö—É—î—Ç—å—Å—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    """

    statistic_sample = []
    for _ in range(number_of_experiments):
        # –≥–µ–Ω–µ—Ä—É—î–º–æ number_of_experiments —Ä–∞–∑ –≤–∏–±—ñ—Ä–∫—É
        sample = sample_distr.rvs(sample_size)

        # —Ä–∞—Ö—É—î–º–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
        statistic = statistic_function(sample)

        # –∑–±–µ—Ä—ñ–≥–∞—î–º–æ
        statistic_sample.append(statistic)
    return statistic_sample
```

## üêç Python —Ç–∞ üìä –†–æ–∑–ø–æ–¥—ñ–ª —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ {.tiny}

```{python}
#| label: t-test-sim-run
#| code-fold: true
#| fig-align: center

numpy.random.seed(8)

sample_size = 7
M = 100000
sample_distr = norm(loc=5, scale=3) # –ù–µ—Ö–∞–π –≤–∏–±—ñ—Ä–∫–∞ –∑ —Ü—å–æ–≥–æ —Ä–æ–∑–ø–æ–¥—ñ–ª—É

T_X = lambda sample: numpy.sqrt(sample_size) * (numpy.mean(sample) - sample_distr.mean()) / numpy.sqrt(numpy.var(sample, ddof=1)) # –∞–±–æ numpy.std
Z_X = lambda sample: numpy.sqrt(sample_size) * (numpy.mean(sample) - sample_distr.mean()) / sample_distr.std()
samples = {
    "T(X)": sample_statistics(
    number_of_experiments=M, statistic_function=T_X,
    sample_size=sample_size, sample_distr=sample_distr),

    "Z(X)": sample_statistics(
    number_of_experiments=M, statistic_function=Z_X,
    sample_size=sample_size, sample_distr=sample_distr)
}


pyplot.figure(figsize=(22, 5))

for i, name in enumerate(["T(X)", "Z(X)"]):
    pyplot.subplot(1, 2, i + 1)
    current_sample = samples[name]
    l_bound, r_bound = numpy.quantile(current_sample, [0.001, 0.999])

    x = numpy.linspace(l_bound, r_bound, 1000)
    pyplot.title(f'–†–æ–∑–ø–æ–¥—ñ–ª —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ {name}, sample size={sample_size}', fontsize=12)
    distplot(current_sample, label='–ï–º–ø—ñ—Ä–∏—á–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª')
    pyplot.plot(x, norm(0, 1).pdf(x), label='$\mathcal{N}(0, 1)$')
    pyplot.legend(fontsize=12)
    pyplot.xlabel(f'{name}', fontsize=12)
    pyplot.xlim((l_bound, r_bound))
    pyplot.ylabel('–©—ñ–ª—å–Ω—ñ—Å—Ç—å', fontsize=12)
    pyplot.grid(linewidth=0.2)

pyplot.show()
```

::: {.callout-important icon=false}
- $Z$-test —Ç—É—Ç –ø—Ä–∞—Ü—é—î: $\sqrt{n}\dfrac{\overline X - \mu_0}{\sqrt{\sigma^2}} \sim \mathcal{N}(0, 1)$.
- –ê–ª–µ –æ—Å—å –¥–ª—è $T(X)$ —Ü–µ –Ω–µ —Ç–∞–∫! [–í–æ–Ω–∏ –≤—ñ–¥—Ä—ñ–∑–Ω—è—é—Ç—å—Å—è! –ê –∑–Ω–∞—á–∏—Ç—å $t'$-–∫—Ä–∏—Ç–µ—Ä—ñ–π –Ω–µ –ø—ñ–¥—Ö–æ–¥–∏—Ç—å –¥–ª—è –ø–æ—á–∞—Ç–∫–æ–≤–æ—ó –∑–∞–¥–∞—á—ñ!]{.hi}
:::

## üìù –ß–æ–º—É —Ç–∞–∫ –≤–∏–π—à–ª–æ? {.smaller}

$S^2$ --- —Ü–µ –≤–∏–ø–∞–¥–∫–æ–≤–∞ –≤–µ–ª–∏—á–∏–Ω–∞!

–î–∞–≤–∞–π—Ç–µ –ø–æ–¥–∏–≤–∏–º–æ—Å—è –Ω–∞ —Ä–æ–∑–ø–æ–¥—ñ–ª $\sqrt{S^2}$ –Ω–∞ –≤—Å–µ —Ç–æ–º—É –∂ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º—É —Ä–æ–∑–ø–æ–¥—ñ–ª—ñ.

```{python}
#| label: sigma-hat-sim
#| code-fold: true
#| fig-align: center

numpy.random.seed(42)

S2 = lambda sample: numpy.std(sample, ddof=1)
S2_sample = sample_statistics(
    number_of_experiments=M, statistic_function=S2,
    sample_size=sample_size, sample_distr=sample_distr
)

pyplot.figure(figsize=(10, 5))
pyplot.title('–†–æ–∑–ø–æ–¥—ñ–ª $\sqrt{S^2}$', fontsize=12)
distplot(S2_sample, label='–ï–º–ø—ñ—Ä–∏—á–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª')
pyplot.legend(fontsize=12)
pyplot.xlabel('$\sqrt{S^2}$', fontsize=12)
pyplot.ylabel('–©—ñ–ª—å–Ω—ñ—Å—Ç—å —Ä–æ–∑–ø–æ–¥—ñ–ª—É', fontsize=12)
pyplot.grid(linewidth=0.2)
pyplot.show()
```

::: {.callout-note icon=false}
## –í–∏—Å–Ω–æ–≤–æ–∫

$T(X) \overset{H_0}{\nsim} \mathcal{N}(0, 1)$ üò≠
:::

## –Ø–∫–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª –º–∞—î $T(X)$? {.tiny40}

1. –ù–µ—Ö–∞–π $X_1 \ldots X_n \sim \mathcal{N}(\mu, \sigma^2)$

2. –ù–µ—Ö–∞–π $\xi_1 \ldots \xi_n \sim \mathcal{N}(0, 1)$. –¢–æ–¥—ñ $\eta=\xi_1^2 +\ ... +\xi_n^2 \sim \chi^2_n$, &mdash; [**$\chi^2$ —Ä–æ–∑–ø–æ–¥—ñ–ª –∑ $n$ —Å—Ç—É–ø–µ–Ω—è–º–∏ —Å–≤–æ–±–æ–¥–∏**](https://en.wikipedia.org/wiki/Chi-squared_distribution).
    - –¢–æ–¥—ñ $\underset{i=1}{\overset{n}{\sum}}\left(\xi_i - \overline \xi \right)^2 \sim \chi^2_{n-1}$. [–î–æ–≤-–Ω—è](https://en.wikipedia.org/wiki/Cochran%27s_theorem) ü´†

    - $S^2_X = \dfrac{1}{n - 1}\underset{i=1}{\overset{n}{\sum}}(X_i - \overline X)^2$

    - $\xi_i := \dfrac{X_i - \mu}{\sigma} \sim \mathcal{N}(0, 1)$. –¢–æ–¥—ñ $S^2_{\xi} = \dfrac{1}{\sigma^2}S^2_X$.

    - –ê –æ—Ç–∂–µ $\dfrac{(n - 1)\cdot S^2_X}{\sigma^2} = \underset{i=1}{\overset{n}{\sum}}\left(\xi_i - \overline \xi \right)^2 \sim \chi^2_{n-1}$

3. –ù–µ—Ö–∞–π $\xi \sim \mathcal{N}(0, 1), \eta \sim \chi^2_k$ —ñ $\xi$ –∑ $\eta$ –Ω–µ–∑–∞–ª–µ–∂–Ω—ñ. –¢–æ–¥—ñ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ $\zeta = \dfrac{\xi}{\sqrt{\eta/k}} \sim t_{k}$ &mdash; –∑ [—Ä–æ–∑–ø–æ–¥—ñ–ª—É –°—Ç'—é–¥–µ–Ω—Ç–∞](https://en.wikipedia.org/wiki/Student%27s_t-distribution) –∑ $k$ —Å—Ç—É–ø–µ–Ω—è–º–∏ —Å–≤–æ–±–æ–¥–∏.

    - $\xi := \sqrt{n}\dfrac{\overline X - \mu_0}{\sigma} \sim \mathcal{N}(0, 1)$
    - $\eta := \dfrac{(n - 1)\cdot S^2_X}{\sigma^2} \sim \chi^2_{n-1}$
    - $\xi$ —ñ $\eta$ [–Ω–µ–∑–∞–ª–µ–∂–Ω—ñ](https://math.stackexchange.com/questions/4165803/overlinex-and-s2-are-independent)
    - –¢–æ–¥—ñ
$$
\begin{align}
T = \sqrt{n}\dfrac{\overline X - \mu_0}{\sqrt{S^2}} = \frac{\sqrt{n}\dfrac{\overline X - \mu_0}{\sigma}}{\sqrt{\dfrac{(n - 1)\cdot S^2_X}{(n - 1)\sigma^2}}} = \dfrac{\xi}{\sqrt{\dfrac{\eta}{n-1}}} \sim t_{n - 1}
\end{align}
$$

## üìà –ó–∞–¥–∞—á–∞ —Ç–∞ üìê $t$-—Ç–µ—Å—Ç {.smaller}

$T = \sqrt{n}\dfrac{\overline X - \mu_0}{\sqrt{S^2}} \sim t_{n - 1}$ --- –≤–∑—è—Ç–∞ –∑ —Ä–æ–∑–ø–æ–¥—ñ–ª—É –°—Ç'—é–¥–µ–Ω—Ç–∞ –∑ $n - 1$ —Å—Ç—É–ø–µ–Ω–µ–º —Å–≤–æ–±–æ–¥–∏.

<br>

```{python}
#| label: t-test-data

X = numpy.array([6.9, 6.45, 6.32, 6.88, 6.09, 7.13, 6.76])
t_stat = numpy.sqrt(sample_size) * (numpy.mean(X) - 7) / numpy.sqrt(numpy.var(X, ddof=1))
print(f"t-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: {round(t_stat, 2)}")
```

<br>

```{python}
#| label: t-test-p-value

p_value = t.cdf(t_stat, df=sample_size - 1)
print(f"p-–∑–Ω–∞—á–µ–Ω–Ω—è: {round(p_value, 4)}")
```

<br>

```{python}
#| label: ttest_1samp

ttest_1samp(X, 7, alternative='less')
```

# –î–æ–≤—ñ—Ä—á—ñ —ñ–Ω—Ç–µ—Ä–≤–∞–ª–∏ {background-iframe=".04_files/libs/colored-particles/index.html"}

## üìä –î–æ–≤—ñ—Ä—á–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è —Å–µ—Ä–µ–¥–Ω—å–æ–≥–æ: –≤–∞—Ä—ñ–∞–Ω—Ç 1 {.tiny}

[–î–æ–≤—ñ—Ä—á–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª]{.hi} --- –º–Ω–æ–∂–∏–Ω–∞ $m$: —Ç–µ—Å—Ç –Ω–µ –≤—ñ–¥—Ö–∏–ª—è—î $H_0: \mu = m$ –Ω–∞ —Ä—ñ–≤–Ω—ñ –∑–Ω–∞—á—É—â–æ—Å—Ç—ñ $\alpha$.

- –ù–µ—Ö–∞–π $\mu$ --- —ñ—Å—Ç–∏–Ω–Ω–µ —Å–µ—Ä–µ–¥–Ω—î –≤–∏–±—ñ—Ä–∫–∏. –ú–∏ —Ç–∞–∫–æ–∂ –∑–Ω–∞—î–º–æ, —â–æ –∑–∞ $H_0: \sqrt{n}\dfrac{\overline X - m}{\sqrt{S^2}} \sim t_{n - 1}$.

- –ù–∞—Å —Ü—ñ–∫–∞–≤–ª—è—Ç—å —Ç–∞–∫—ñ $m$, —â–æ: $\left\{-t_{n-1, 1 - \frac{\alpha}{2}} < \sqrt{n}\dfrac{\overline X - m}{\sqrt{S^2}} < t_{n-1, 1 - \frac{\alpha}{2}} \right\}$, —É —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É –∫—Ä–∏—Ç–µ—Ä—ñ–π –Ω–µ –≤—ñ–¥–∫–∏–Ω–µ—Ç—å—Å—è.

- –†–æ–∑–ø–∏—à–µ–º–æ, —â–æ–± —É —Ü–µ–Ω—Ç—Ä—ñ –∑–∞–ª–∏—à–∏–ª–æ—Å—è —Ç—ñ–ª—å–∫–∏ $m$:

$$\left\{\overline X - \dfrac{t_{n - 1, 1 - \alpha/2} \sqrt{S^2}}{\sqrt{n}} < m < \overline X + \dfrac{t_{n - 1, 1 - \alpha/2} \sqrt{S^2}}{\sqrt{n}}\right\}$$

- –¢–æ–¥—ñ –¥–æ–≤—ñ—Ä—á–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª:

$$CI_{\mu} = \left(\overline X \pm \dfrac{t_{n - 1, 1 - \alpha/2} \sqrt{S^2}}{\sqrt{n}} \right),$$ 

–¥–µ $S^2 = \dfrac{1}{n - 1}\underset{i=1}{\overset{n}{\sum}}(X_i - \overline X)^2$

## üìä –î–æ–≤—ñ—Ä—á–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è —Å–µ—Ä–µ–¥–Ω—å–æ–≥–æ: –≤–∞—Ä—ñ–∞–Ω—Ç 2 {.tiny}

[–ö–ª–∞—Å–∏—á–Ω–µ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è](https://en.wikipedia.org/wiki/Confidence_interval#Definition) –¥–æ–≤—ñ—Ä—á–æ–≥–æ —ñ–Ω—Ç–µ—Ä–≤–∞–ª—É:

> –î–æ–≤—ñ—Ä—á–∏–º —ñ–Ω—Ç–µ—Ä–≤–∞–ª–æ–º –¥–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ $\theta$ —Ä—ñ–≤–Ω—è –¥–æ–≤—ñ—Ä–∏ $1 - \alpha$ —î –ø–∞—Ä–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫ $L(X), R(X)$, —Ç–∞–∫–∏—Ö, —â–æ $P(L(X) < \theta < R(X)) = 1 - \alpha$.

$$
\begin{align}
&T(X) = \sqrt{n}\dfrac{\overline X - \mu}{\sqrt{S^2}} \sim t_{n - 1} \Rightarrow \\
&P\left(-t_{n - 1, 1-\alpha/2} < \sqrt{n}\dfrac{\overline X - \mu}{\sqrt{S^2}} < t_{n - 1, 1-\alpha/2} \right) = 1 - \alpha \Leftrightarrow \\
&P\left(\overline X - \dfrac{t_{n - 1, 1 - \alpha/2} \sqrt{S^2}}{\sqrt{n}}  < \mu < \overline X + \dfrac{t_{n - 1, 1 - \alpha/2} \sqrt{S^2}}{\sqrt{n}} \right) = 1 - \alpha
\end{align}
$$

- –¢–æ–¥—ñ –¥–æ–≤—ñ—Ä—á–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª:

$$CI_{\mu} = \left(\overline X \pm \dfrac{t_{n - 1, 1 - \alpha/2} \sqrt{S^2}}{\sqrt{n}} \right)$$

## üêç Python —Ç–∞ üìä –¥–æ–≤—ñ—Ä—á–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª

```{python}
#| label: ci

sample = norm(loc=10, scale=2).rvs(100)

# sem -- —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞ –ø–æ–º–∏–ª–∫–∞ —Å–µ—Ä–µ–¥–Ω—å–æ–≥–æ, sem = sqrt(S^2)/sqrt(n)
left_bound, right_bound = t.interval(confidence=0.95, loc=numpy.mean(sample), df=len(sample)-1, scale=sem(sample))
print(f"CI = [{round(left_bound, 2)}, {round(right_bound, 2)}]")
```

<br>

üìà –ó–∞–¥–∞—á–∞
```{python}
#| label: ci-data

X = numpy.array([6.9, 6.45, 6.32, 6.88, 6.09, 7.13, 6.76])
left_bound, right_bound = t.interval(confidence=0.95, loc=numpy.mean(X), df=len(X)-1, scale=sem(X))
print(f"CI = [{round(left_bound, 2)}, {round(right_bound, 2)}]")
```

# $t$-—Ç–µ—Å—Ç —Ç–∞ –Ω–µ–≤—ñ–¥–æ–º–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª {background-iframe=".04_files/libs/colored-particles/index.html"}

## üìä –ó–∞–¥–∞—á–∞ {.tiny}

> –í–∏ –ø—Ä–∏–¥—É–º–∞–ª–∏ —ñ–¥–µ—é –¥–ª—è —Å—Ç–∞—Ä—Ç–∞–ø—É, –¥–µ –∫—É—Ä'—î—Ä–∏ –∑–±–∏—Ä–∞—é—Ç—å –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –¥–ª—è –∫–ª—ñ—î–Ω—Ç—ñ–≤ —ñ –≤—ñ–¥–≤–æ–∑—è—Ç—å —ó–º –¥–æ–¥–æ–º—É. –ú–∞—Ä–∂–∞ –≤—ñ–¥ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è —É –≤–∞—à–æ–º—É —Å—Ç–∞—Ä—Ç–∞–ø—ñ --- X ‚Ç¥, –∞ –≤–∞—Ä—Ç—ñ—Å—Ç—å —Ä–æ–±–æ—Ç–∏ –∫—É—Ä'—î—Ä–∞ --- 1k ‚Ç¥. –°–ø–µ—Ü–∏—Ñ—ñ–∫–∞ –≤–∞—à–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞–ø—É —Ç–∞–∫–∞, —â–æ —î –≤–µ–ª–∏–∫–∏–π —Ä–∏–∑–∏–∫ –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –±–µ–∑ –æ–ø–ª–∞—Ç–∏. –ó —É—Ä–∞—Ö—É–≤–∞–Ω–Ω—è–º –≤–∞—Ä—Ç–æ—Å—Ç–µ–π, —ñ–Ω–≤–µ—Å—Ç–æ—Ä–∏ –≥–æ—Ç–æ–≤—ñ –ø—Ä–æ—Å–ø–æ–Ω—Å–æ—Ä—É–≤–∞—Ç–∏ –≤–∞–º —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É —ñ –∑–∞–ª—É—á–µ–Ω–Ω—è –∫–ª—ñ—î–Ω—Ç—ñ–≤, —è–∫—â–æ –≤–∏ –ø–æ–∫–∞–∂–µ—Ç–µ, —â–æ —É –≤–∞—Å –±—É–¥–µ –ø—Ä–∏–±—É—Ç–æ–∫.

> –ó –¥–∞–Ω–∏—Ö —É –≤–∞—Å —î –ø—Ä–∏–Ω–µ—Å–µ–Ω—ñ –≥—Ä–æ—à—ñ –≤—ñ–¥ –∫–æ–∂–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞. –Ü–Ω–æ–¥—ñ –ø–æ–∑–∏—Ç–∏–≤–Ω–∞ –≤–µ–ª–∏—á–∏–Ω–∞, —ñ–Ω–æ–¥—ñ –Ω–µ–≥–∞—Ç–∏–≤–Ω–∞.

- $X_1, X_2, \dots X_N$ --- –≤–∏–±—ñ—Ä–∫–∞ –ø—Ä–∏–±—É—Ç–∫—É –≤—ñ–¥ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.
- $H_0$: $E \overline{X} \leq 0$ vs. $H_1: E \overline{X} > 0$

–î–∞–Ω—ñ:

```{python}
#| label: profit-data

profits = numpy.loadtxt('data/profit_from_user.out', delimiter=',')
print(profits[:100])
```

## üìä –ó–∞–¥–∞—á–∞ {.tiny}

```{python}
#| label: profit-avg

print(f"average profit = {profits.mean()}")
print(f"n = {profits.shape[0]}")
```

<br>

```{python}
#| label: profit-distplot

seaborn.distplot(profits)
pyplot.grid(linewidth=0.2)
```

- –ü–æ—á–∞—Ç–∫–æ–≤–∞ –≤–∏–±—ñ—Ä–∫–∞ –Ω–µ –∑ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–æ–∑–ø–æ–¥—ñ–ª—É
- –í–∏–±—ñ—Ä–∫–∞ –¥–æ—Å–∏—Ç—å –≤–µ–ª–∏–∫–∞: –Ω–µ 7 –µ–ª–µ–º–µ–Ω—Ç—ñ–≤, –∞ –≤–∂–µ 5000.

[–ß–∏ –º–æ–∂–µ–º–æ –º–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –Ω–æ—Ä–º–∞–ª—å–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª –¥–ª—è –Ω–∞–±–ª–∏–∂–µ–Ω–Ω—è?]{.hi}

## $t$-—Ç–µ—Å—Ç —Ç–∞ –Ω–∞–±–ª–∏–∂–µ–Ω–Ω—è {.tiny40}

1. –ë—É–¥–µ–º–æ —Ä–æ–∑–≥–ª—è–¥–∞—Ç–∏ —Ç—É —Å–∞–º—É —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É $T = \sqrt{n}\dfrac{\overline X - \mu_0}{\sqrt{S^2}}$
2. $\xi := \sqrt{n}\dfrac{\overline X - \mu_0}{\sqrt{\sigma^2}} \stackrel{d}{\rightarrow} \mathcal{N}(0, 1)$. –ó–∞ –¶–ì–¢ –∑–±—ñ–∂–Ω—ñ—Å—Ç—å —î —Ç—ñ–ª—å–∫–∏ –∑–∞ [—Ä–æ–∑–ø–æ–¥—ñ–ª–æ–º](https://en.wikipedia.org/wiki/Convergence_in_distribution).
3. —Ç–æ–¥—ñ $T = \sqrt{n}\dfrac{\overline X - \mu_0}{\sqrt{S^2}} = \xi \cdot \sqrt{\dfrac{\sigma^2}{S^2}}$. –ü–æ–∑–Ω–∞—á–∏–º–æ $\phi := \sqrt{\dfrac{\sigma^2}{S^2}}$
    - –ü–∞–º'—è—Ç–∞—î—Ç–µ, –Ω–∞ –ø–æ—á–∞—Ç–∫—É –ª–µ–∫—Ü—ñ—ó –±—É–ª–æ —Å–∫–∞–∑–∞–Ω–æ, —â–æ $S^2$ &mdash; –Ω–∞–π–∫—Ä–∞—â–∞ –æ—Ü—ñ–Ω–∫–∞ –¥–ª—è –¥–∏—Å–ø–µ—Ä—Å—ñ—ó? –ü–æ-—ñ–Ω—à–æ–º—É —Ü–µ –º–æ–∂–Ω–∞ –∑–∞–ø–∏—Å–∞—Ç–∏ —Ç–∞–∫: $S^2$ [–∑–±—ñ–≥–∞—î—Ç—å—Å—è –∑–∞ –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—é](https://en.wikipedia.org/wiki/Convergence_of_random_variables#Convergence_in_probability) –¥–æ $\sigma^2$. –¢–æ–±—Ç–æ $S^2 \stackrel{p}{\rightarrow} \sigma^2$
    - –ê –≤ —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É —ñ—Å–Ω—É—î [—Ç–µ–æ—Ä–µ–º–∞](https://en.wikipedia.org/wiki/Continuous_mapping_theorem), —è–∫–∞ —Å—Ç–≤–µ—Ä–¥–∂—É—î, —â–æ $\phi = \dfrac{\sigma^2}{S^2}  \stackrel{p}{\rightarrow} 1$.
4. $T = \xi \cdot \phi$.
    - $\xi \stackrel{d}{\rightarrow} \mathcal{N}(0, 1)$
    - $\phi \stackrel{p}{\rightarrow} 1$
    - –Ü —Ç—É—Ç –Ω–∞–±—É–≤–∞—î —á–∏–Ω–Ω–æ—Å—Ç—ñ —â–µ –æ–¥–Ω–∞ [—Ç–µ–æ—Ä–µ–º–∞](https://en.wikipedia.org/wiki/Slutsky%27s_theorem): $T = \xi \cdot \phi \stackrel{d}{\rightarrow} 1\cdot \mathcal{N}(0, 1)$. –¢–∞ —Å–∞–º–∞ –∑–±—ñ–∂–Ω—ñ—Å—Ç—å, —â–æ –π —É –¶–ì–¢!
    - –¢–æ–±—Ç–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ $T$ —Ç–∞–∫ —Å–∞–º–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω–∞!

[–û—Ç–∂–µ, —è–∫—â–æ –≤–∏–±—ñ—Ä–∫–∞ –≤–µ–ª–∏–∫–∞, —Ç–æ –º–∏ –º–æ–∂–µ–º–æ –≤–≤–∞–∂–∞—Ç–∏, —â–æ $T(X) \overset{H_0}{\sim} \mathcal{N}(0, 1)$.]{.hi}

## üêç Python —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ {.tiny40}

–ü–µ—Ä–µ–≤—ñ—Ä–∏–º–æ –Ω–∞—à –∫—Ä–∏—Ç–µ—Ä—ñ–π –Ω–∞ –≤–µ–ª–∏–∫–∏—Ö –≤–∏–±—ñ—Ä–∫–∞—Ö:

```{python}
#| label: sim-t-test
#| code-fold: true
#| fig-align: center

numpy.random.seed(8)

sample_size=2000
M = 10000
sample_distr = expon(loc=5, scale=300)

T_X = lambda sample: numpy.sqrt(sample_size) * (numpy.mean(sample) - sample_distr.mean()) / numpy.std(sample, ddof=1)
T_sample = sample_statistics(
    number_of_experiments=M, statistic_function=T_X,
    sample_size=sample_size, sample_distr=sample_distr)

pyplot.figure(figsize=(10, 5))
l_bound, r_bound = numpy.quantile(T_sample, [0.001, 0.999])


x = numpy.linspace(l_bound, r_bound, 1000)
pyplot.title(f'–†–æ–∑–ø–æ–¥—ñ–ª —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ T(X), sample size={sample_size}', fontsize=12)
distplot(T_sample, label='–ï–º–ø—ñ—Ä–∏—á–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª')
pyplot.plot(x, norm(0, 1).pdf(x), label='–ï–∫—Å–ø–æ–Ω–µ–Ω—Ü—ñ–∞–ª—å–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª')
pyplot.legend(fontsize=12)
pyplot.xlabel(f'{name}', fontsize=12)
pyplot.xlim((l_bound, r_bound))
pyplot.ylabel('–©—ñ–ª—å–Ω—ñ—Å—Ç—å', fontsize=12)
pyplot.grid(linewidth=0.2)
pyplot.show()
```

–ú–∏ –±–∞—á–∏–º–æ, —â–æ —Ä–æ–∑–ø–æ–¥—ñ–ª–∏ –∑–±—ñ–≥–ª–∏—Å—è!

## üêç Python —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ {.tiny40}

–ê –Ω–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º—É —Ä–æ–∑–ø–æ–¥—ñ–ª—ñ, –¥–µ –≤–ø–µ—Ä—à–µ –±—É–ª–∏ –≤—ñ–¥–º—ñ–Ω–Ω–æ—Å—Ç—ñ –Ω–∞ –º–∞–ª–µ–Ω—å–∫—ñ–π –≤–∏–±—ñ—Ä—Ü—ñ?

```{python}
#| label: sim-t-test-norm
#| code-fold: true
#| fig-align: center

numpy.random.seed(8)

sample_size=2000
M = 30000
sample_distr = norm(loc=5, scale=300)

T_X = lambda sample: numpy.sqrt(sample_size) * (numpy.mean(sample) - sample_distr.mean()) / numpy.std(sample, ddof=1)
T_sample = sample_statistics(
    number_of_experiments=M, statistic_function=T_X,
    sample_size=sample_size, sample_distr=sample_distr)

pyplot.figure(figsize=(10, 5))
l_bound, r_bound = numpy.quantile(T_sample, [0.001, 0.999])


x = numpy.linspace(l_bound, r_bound, 1000)
pyplot.title(f'–†–æ–∑–ø–æ–¥—ñ–ª —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ T(X), sample size={sample_size}', fontsize=12)
distplot(T_sample, label='–ï–º–ø—ñ—Ä–∏—á–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª')
pyplot.plot(x, norm(0, 1).pdf(x), label='$\mathcal{N}(0, 1)$')
pyplot.legend(fontsize=12)
pyplot.xlabel(f'{name}', fontsize=12)
pyplot.xlim((l_bound, r_bound))
pyplot.ylabel('–©—ñ–ª—å–Ω—ñ—Å—Ç—å', fontsize=12)
pyplot.grid(linewidth=0.2)
pyplot.show()
```

–¢–æ–±—Ç–æ –ø–µ—Ä—à–æ–≥–æ —Ä–∞–∑—É –Ω–∞–º –Ω–µ –ø–æ—â–∞—Å—Ç–∏–ª–æ, —â–æ —Ä–æ–∑–º—ñ—Ä –≤–∏–±—ñ—Ä–∫–∏ –±—É–≤ –º–∞–ª–µ–Ω—å–∫–∏–º

## –î–æ–≤—ñ—Ä—á–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª {.tiny}

$$CI_{\mu} = \left(\overline X \pm \dfrac{z_{1 - \alpha/2} \sqrt{S^2}}{\sqrt{n}} \right)$$

```{python}
#| label: ci-expon

sample = expon(scale=300).rvs(2000) # E sample = scale = 300
left_bound, right_bound = norm.interval(confidence=0.95, loc=numpy.mean(sample), scale=sem(sample))
print(f"CI = [{round(left_bound, 2)}, {round(right_bound, 2)}]")
```

<br>

- üìä –ó–∞–¥–∞—á–∞

```{python}
#| label: ci-profit

left_bound, right_bound = norm.interval(confidence=0.95, loc=numpy.mean(profits), scale=sem(profits))
print(f"CI = [{round(left_bound, 2)}, {round(right_bound, 2)}]")
```

–¢–∞–∫, –≤–∏—Ä—É—á–∫–∞ –ø–æ–∑–∏—Ç–∏–≤–Ω–∞! –ó–Ω–∞—á–∏—Ç—å –º–∏ –∑–Ω–∞–π—à–ª–∏ —ñ–Ω–≤–µ—Å—Ç–æ—Ä—ñ–≤ –¥–ª—è –Ω–∞—à–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞–ø—É ü´°

## $t'$-—Ç–µ—Å—Ç vs. $t$-—Ç–µ—Å—Ç {.tiny40}

–î–ª—è –ø–æ—á–∞—Ç–∫—É –≤–∏–∑–Ω–∞—á–∏–º–æ—Å—è, –∫–æ–ª–∏ —è–∫–∏–π –∫—Ä–∏—Ç–µ—Ä—ñ–π –∫—Ä–∞—â–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏?

1. –Ø–∫—â–æ –≤–∏–±—ñ—Ä–∫–∞ —Ä–æ–∑–º—ñ—Ä—É 60, —Ç–æ –≤–∂–µ $t_{59} \approx \mathcal{N}(0, 1)$.
    - –ü–æ–¥–∏–≤–∏–º–æ—Å—è –Ω–∞ —Ä–æ–∑–ø–æ–¥—ñ–ª–∏ –°—Ç—å—é–¥–µ–Ω—Ç–∞ —ñ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ:

```{python}
#| label: t-dist
#| output-location: column

df = 59
t_dist = t(df=df)
z_dist = norm(loc=0, scale=1)

x = numpy.linspace(-3, 3, 100)
pyplot.figure(figsize=(10, 5))
pyplot.title(f'–©—ñ–ª—å–Ω—ñ—Å—Ç—å —Ä–æ–∑–ø–æ–¥—ñ–ª—É —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ T —ñ N', fontsize=12)
pyplot.plot(x, z_dist.pdf(x), label='N(0, 1)')
pyplot.plot(x, t_dist.pdf(x), label=f't(df={df})')
pyplot.legend(fontsize=12)
pyplot.grid(linewidth=0.2)
pyplot.show()
```

- –ú–∏ –±–∞—á–∏–º–æ, —â–æ —Ü—ñ 2 —Ä–æ–∑–ø–æ–¥—ñ–ª–∏ –≤—ñ–∑—É–∞–ª—å–Ω–æ –ø–æ–≤–Ω—ñ—Å—Ç—é –∑–±—ñ–≥–∞—é—Ç—å—Å—è, —Ç–æ–º—É –Ω–µ–≤–∞–∂–ª–∏–≤–æ, —è–∫ –ø–æ—Ä–∞—Ö—É–≤–∞—Ç–∏: —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ $T\sim \mathcal{N}(0, 1)$ –∞–±–æ $T\sim t_n$.
- –ê–ª–µ —Ü–µ –Ω–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –∑ N=60 T-test/T'-test –ø—Ä–∞—Ü—é—é—Ç—å –∫–æ—Ä–µ–∫—Ç–Ω–æ! –Ø–∫—â–æ –≤–∏–±—ñ—Ä–∫–∞ –Ω–µ –∑ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–æ–∑–ø–æ–¥—ñ–ª—É, –≤–æ–Ω–∏ –æ–±–∏–¥–≤–∞ –º–æ–∂—É—Ç—å –≤—Å–µ —â–µ –ø–æ–º–∏–ª—è—Ç–∏—Å—è.

## $t'$-—Ç–µ—Å—Ç vs. $t$-—Ç–µ—Å—Ç {.tiny40}

2. –Ø–∫—â–æ –≤–∏–±—ñ—Ä–∫–∞ –º–µ–Ω—à–µ 60, —Ç–æ –±–µ–∑–ø–µ—á–Ω—ñ—à–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ t-test, –Ω—ñ–∂ t'-test.
    - **–£ T-test FPR –∑–∞–≤–∂–¥–∏ –±—É–¥–µ –º–µ–Ω—à–∏–º, –Ω—ñ–∂ —É T'-test**.
        - –ù–∞ FPR –≤–ø–ª–∏–≤–∞—î –≤—ñ–¥—Å–æ—Ç–æ–∫ –≤–∏–ø–∞–¥–∫—ñ–≤ `pvalue < alpha`. –£ t-test pvalue $\geq$ t'-test pvalue.
        - `pvalue = t_distr.cdf(x)` –∞–±–æ `pvalue = norm_dist.cdf(x)`. –¢–æ–∂ —á–∏–º –≤–∞–∂—á–∏–π —Ö–≤—ñ—Å—Ç —É —Ä–æ–∑–ø–æ–¥—ñ–ª—É, —Ç–∏–º –±—ñ–ª—å—à–µ p-value. –ê —Ç–µ–ø–µ—Ä –ø–æ–¥–∏–≤–∏–º–æ—Å—è –Ω–∞ –ø—Ä–∏–∫–ª–∞–¥—ñ:

```{python}
#| label: t-test-vs-tprime
#| output-location: column

df_array = [2, 5, 10, 20]
x = numpy.linspace(-3, 3, 100)

pyplot.figure(figsize=(10, 5))
pyplot.title(f'CDF —Ä–æ–∑–ø–æ–¥—ñ–ª—ñ–≤ T —Ç–∞ N', fontsize=12)
for df in df_array:
    t_dist = t(df=df)
    pyplot.plot(x, t_dist.cdf(x), label=f't(df={df})')

z_dist = norm(loc=0, scale=1)
pyplot.plot(x, z_dist.cdf(x), c=red_pink, label='N(0, 1)')
pyplot.legend(fontsize=12)
pyplot.xlabel('X', fontsize=12)
pyplot.grid(linewidth=0.2)
pyplot.show()
```

–†–æ–∑–ø–æ–¥—ñ–ª –°—Ç—å—é–¥–µ–Ω—Ç–∞ –∑ –Ω–µ—Å–∫—ñ–Ω—á–µ–Ω–Ω—ñ—Å—Ç—é —Å—Ç—É–ø–µ–Ω—ñ–≤ —Å–≤–æ–±–æ–¥–∏ --- —Ü–µ –Ω–æ—Ä–º–∞–ª—å–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª: $t_{\infty} = \mathcal{N}(0, 1)$. –¢–æ–º—É `norm(0, 1).cdf(x) = t_distr(df=infinity).cdf(x) < t_distr(df=N).cdf(x)`.

## –í–∏—Å–Ω–æ–≤–∫–∏

–ú–∏ –±–∞—á–∏–º–æ, —â–æ –º–∏ —Å–∫—Ä—ñ–∑—å –º–æ–∂–µ–º–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ $t$-test (–∞ $t'$-test –Ω–µ –∑–∞–≤–∂–¥–∏), —ñ –≤ —Ä–∞–∑—ñ –º–∞–ª–µ–Ω—å–∫–∏—Ö –≤–∏–±—ñ—Ä–æ–∫ –≤—ñ–Ω –±–µ–∑–ø–µ—á–Ω—ñ—à–∏–π. **–¢–æ–º—É $t$-test —ñ —Å—Ç–∞–≤ –Ω–∞–±–∞–≥–∞—Ç–æ –ø–æ–ø—É–ª—è—Ä–Ω—ñ—à–∏–º, –Ω—ñ–∂ $t'$-test**. –ê–ª–µ $t'$-test –Ω–∞ –ø—Ä–∞–∫—Ç–∏—Ü—ñ –º–æ–∂–µ –±—É—Ç–∏ —Ç–µ–∂ –∫–æ—Ä–∏—Å–Ω–∏–π:

- –ù–µ —Ç—Ä–µ–±–∞ –¥—É–º–∞—Ç–∏ –ø—ñ–¥ —á–∞—Å —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó –ø—Ä–æ —Å—Ç—É–ø–µ–Ω—ñ —Å–≤–æ–±–æ–¥–∏.
- –ù–∞–ø–∏—Å–∞—Ç–∏ —Ç–∞–∫–∏–π –∫—Ä–∏—Ç–µ—Ä—ñ–π –Ω–∞ SQL –±—É–¥–µ –Ω–∞–±–∞–≥–∞—Ç–æ –ø—Ä–æ—Å—Ç—ñ—à–µ: –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ç–∞–±–ª–∏—á–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –≤ –∫–æ–¥—ñ, —â–æ–± –∑—Ä–æ–∑—É–º—ñ—Ç–∏, —á–∏ –≤—ñ–¥—Ö–∏–ª—è—î—Ç—å—Å—è –∫—Ä–∏—Ç–µ—Ä—ñ–π.
- –†–æ–±–∏—Ç–∏ —Ä—ñ–∑–Ω—ñ —Ç–µ–æ—Ä–µ—Ç–∏—á–Ω—ñ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è –ø—Ä–æ—Å—Ç—ñ—à–µ.
- –£ –Ω—å–æ–º—É —Å–∫–ª–∞–¥–Ω—ñ—à–µ –ø–æ–º–∏–ª–∏—Ç–∏—Å—è –ø—ñ–¥ —á–∞—Å —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó.

# –î–≤–æ–≤–∏–±—ñ—Ä–∫–æ–≤–∏–π $t$-—Ç–µ—Å—Ç. –ó–∞–¥–∞—á–∞ AB-—Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è {background-iframe=".04_files/libs/colored-particles/index.html"}

## üìä –ó–∞–¥–∞—á–∞

> –£ –Ω–∞—Å –Ω–∞ —Å–∞–π—Ç—ñ —î –ø–æ—Å–ª—É–≥–∏ –ø—Ä–æ—Å—É–≤–∞–Ω–Ω—è. –ú–∏ —Ö–æ—á–µ–º–æ –ø–æ—á–∞—Ç–∏ –¥–∞–≤–∞—Ç–∏ –Ω–∞ –Ω–∏—Ö –∑–Ω–∏–∂–∫–∏, —â–æ–± –∑–∞–ª—É—á–∏—Ç–∏ –±—ñ–ª—å—à–µ –ª—é–¥–µ–π —ñ –ø–æ—á–∞—Ç–∏ –±—ñ–ª—å—à–µ –∑–∞—Ä–æ–±–ª—è—Ç–∏. –î–ª—è —Ü—å–æ–≥–æ –±—É–ª–æ –≤–∏—Ä—ñ—à–µ–Ω–æ –ø—Ä–æ–≤–µ—Å—Ç–∏ AB —Ç–µ—Å—Ç:
> –û–¥–Ω—ñ–π –ø–æ–ª–æ–≤–∏–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –º–∏ –Ω–µ –≤–∏–¥–∞–ª–∏ –∑–Ω–∏–∂–æ–∫, –∞ –≤ –¥—Ä—É–≥—ñ–π –ø–æ–ª–æ–≤–∏–Ω—ñ –º–∏ –≤–∏–¥–∞–ª–∏ –∑–Ω–∏–∂–∫–∏ –≤—Å—ñ–º –Ω–æ–≤–∏–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º. –¢—Ä–µ–±–∞ –∑—Ä–æ–∑—É–º—ñ—Ç–∏, —á–∏ —Å—Ç–∞–ª–∏ –º–∏ –±—ñ–ª—å—à–µ –∑–∞—Ä–æ–±–ª—è—Ç–∏?

–¶—å–æ–≥–æ —Ä–∞–∑—É —É –Ω–∞—Å 2 –≤–∏–±—ñ—Ä–∫–∏ $A$ --- –∫–æ–Ω—Ç—Ä–æ–ª—å, —ñ $B$ --- —Ç–µ—Å—Ç.

## üìä –ó–∞–¥–∞—á–∞ {.tiny40}

$$H_0: \mathbb{E} A = \mathbb{E} B \; \text{vs.} \; H_1: \mathbb{E}A < \mathbb{E} B$$

:::: {.columns}

::: {.column width="50%"}
1. **–û–±–∏–¥–≤—ñ –≤–∏–±—ñ—Ä–∫–∏ –Ω–æ—Ä–º–∞–ª—å–Ω—ñ**. 

–¢–æ–¥—ñ —î 2 –∫—Ä–∏—Ç–µ—Ä—ñ—ó –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ –Ω–∞—à–∏—Ö –∑–Ω–∞–Ω—å –ø—Ä–æ –¥–∏—Å–ø–µ—Ä—Å—ñ—é:

- $\sigma^2_A = \sigma^2_B$.
    
    –¢–æ–¥—ñ:

    - $S^2_{full} = \dfrac{(N - 1)S^2_A + (M - 1)S^2_B}{N + M - 2}$, –¥–µ N, M - —Ä–æ–∑–º—ñ—Ä –∫–æ–Ω—Ç—Ä–æ–ª—é —ñ —Ç–µ—Å—Ç—É –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ. –ê –∫—Ä–∏—Ç–µ—Ä—ñ–π –º–∞—î —Ç–∞–∫–∏–π –≤–∏–≥–ª—è–¥:
    - $T(A, B) = \dfrac{\overline A - \overline B}{S^2_{full}\sqrt{1/N + 1/M}} \overset{H_0}{\sim} T_{n + m - 2}$
   
- $\sigma^2_A \neq \sigma^2_B$.
    
    –¢–æ–¥—ñ:
    
    - $T(A, B) = \dfrac{\overline A - \overline B}{\sqrt{S^2_{A}/N + S^2_{B}/M}} \overset{H_0}{\sim} T_{v}$
    - –¥–µ $v = \dfrac{\left(\dfrac{S^2_{A}}{N} + \dfrac{S^2_{B}}{M} \right)^2}{\left(\dfrac{(S^2_{A})^2}{N^2(N - 1)} + \dfrac{(S^2_{B})^2}{M^2(M-1)} \right)}$
:::

::: {.column width="50%"}
2. **–•–æ—á –±–∏ 1 –≤–∏–±—ñ—Ä–∫–∞ –Ω–µ–Ω–æ—Ä–º–∞–ª—å–Ω–∞**. 

–¢–æ–¥—ñ –≤ –±—ñ–π –≤—Å—Ç—É–ø–∞—î –Ω–æ—Ä–º–∞–ª—å–Ω–∞ –∞–ø—Ä–æ–∫—Å–∏–º–∞—Ü—ñ—è –ø—Ä–∏ –≤–µ–ª–∏–∫–æ–º—É —Ä–æ–∑–º—ñ—Ä—ñ –≤–∏–±—ñ—Ä–æ–∫, –∫—Ä–∏—Ç–µ—Ä—ñ–π T'-test:

- $T(A, B) = \dfrac{\overline A - \overline B}{\sqrt{S^2_{A}/N + S^2_{B}/M}} \overset{H_0}{\sim} \mathcal{N}(0, 1)$
:::

::::

## üêç Python —Ç–∞ –î–≤–æ–≤–∏–±—ñ—Ä–∫–æ–≤–∏–π $t$-—Ç–µ—Å—Ç {.tiny}

- `scipy.stats.ttest_ind` --- 2-–≤–∏–±—ñ—Ä–∫–æ–≤–∏–π t-test [–∫—Ä–∏—Ç–µ—Ä—ñ–π](https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.ttest_ind.html#scipy.stats.ttest_ind)
- `CompareMeans` --- [–∫–ª–∞—Å](https://www.statsmodels.org/stable/generated/statsmodels.stats.weightstats.CompareMeans.html) –¥–ª—è –ø–æ–±—É–¥–æ–≤–∏ –¥–æ–≤—ñ—Ä—á–∏—Ö —ñ–Ω—Ç–µ—Ä–≤–∞–ª—ñ–≤ —É t-test.

```{python}
#| label: ttest_ind-sim
#| output-location: column

numpy.random.seed(42)
X = expon(scale=1100).rvs(1000)
Y = norm(loc=980, scale=30).rvs(1000)

ttest_ind(X, Y, equal_var=False, alternative='greater')
```

<br>

```{python}
#| label: ttest_ind-sim-norm

ttest_ind(X, Y, equal_var=False, alternative='greater').pvalue
```

<br>

```{python}
#| label: ttest_ind-ci

# –î–æ–≤—ñ—Ä—á–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª

cm = CompareMeans(DescrStatsW(X), DescrStatsW(Y))
print(cm.tconfint_diff(usevar='unequal'))
```

# MDE –¥–ª—è $t$-—Ç–µ—Å—Ç—É. {background-iframe=".04_files/libs/colored-particles/index.html"}

## –ó–≥–∞–¥—É—î–º–æ MDE {.tiny}

**MDE** --- —Ü–µ —Ç–∞–∫–µ —ñ—Å—Ç–∏–Ω–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è –µ—Ñ–µ–∫—Ç—É, —â–æ –Ω–∞—à —à–∞–Ω—Å –π–æ–≥–æ –≤–∏—è–≤–∏—Ç–∏ –¥–æ—Ä—ñ–≤–Ω—é—î $1-\beta$ –ø—Ä–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—ñ –Ω–∞—à–æ–≥–æ –∫—Ä–∏—Ç–µ—Ä—ñ—é.

–í—ñ–¥ —á–æ–≥–æ –∑–∞–ª–µ–∂–∏—Ç—å MDE?

- –ü–æ–º–∏–ª–∫–∞ 1 —Ä–æ–¥—É, –∞–±–æ $\alpha$.
    - –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –∑–∞ $\alpha = 1$ –º–∏ –∑–Ω–∞–π–¥–µ–º–æ –µ—Ñ–µ–∫—Ç —ñ –∑–∞ —Ä–æ–∑–º—ñ—Ä—É –≤–∏–±—ñ—Ä–∫–∏, —â–æ –¥–æ—Ä—ñ–≤–Ω—é—î 1 (–º–∏ –ø—Ä–æ—Å—Ç–æ –∑–∞–≤–∂–¥–∏ –≤—ñ–¥–∫–∏–¥–∞—Ç–∏–º–µ–º–æ 0 –≥—ñ–ø–æ—Ç–µ–∑—É). –ê –∑–∞ $\alpha = 0$ –º–∏ –Ω—ñ–∫–æ–ª–∏ –Ω–µ –∑–∞–¥–µ—Ç–µ–∫—Ç—É—î–º–æ –µ—Ñ–µ–∫—Ç.
- –ü–æ—Ç—É–∂–Ω—ñ—Å—Ç—å, –∞–±–æ $1 - \beta$.
    - –í–∏–ø–ª–∏–≤–∞—î —ñ–∑ —Å–∞–º–æ–≥–æ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è
- –í—ñ–¥ —à—É–º—É –≤ –¥–∞–Ω–∏—Ö, –∞–±–æ –≤—ñ–¥ –¥–∏—Å–ø–µ—Ä—Å—ñ—ó.
    - –©–æ –±—ñ–ª—å—à –≥–∞–ª–∞—Å–ª–∏–≤—ñ –¥–∞–Ω—ñ, —è–∫ –º–∏ –∑–Ω–∞—î–º–æ, —Ç–æ —à–∏—Ä—à–∏–π –¥–æ–≤—ñ—Ä—á–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª. –ê –æ—Ç–∂–µ, —Å–∫–ª–∞–¥–Ω—ñ—à–µ —Ç–æ—á–Ω–æ –ø–µ—Ä–µ–¥–±–∞—á–∏—Ç–∏ —Ä–∞–º–∫–∏ –¥–ª—è —ñ—Å—Ç–∏–Ω–Ω–æ–≥–æ –µ—Ñ–µ–∫—Ç—É, —Ç–æ–º—É —ñ MDE –±—É–¥–µ –±—ñ–ª—å—à–∏–º.
- –í—ñ–¥ —Ä–æ–∑–º—ñ—Ä—É –≤–∏–±—ñ—Ä–∫–∏.
    - –ù–∞—Å —Ü—ñ–∫–∞–≤–∏—Ç—å –Ω–µ –ø—Ä–æ—Å—Ç–æ –¥–∏—Å–ø–µ—Ä—Å—ñ—è –≤ –¥–∞–Ω–∏—Ö, –∞ –¥–∏—Å–ø–µ—Ä—Å—ñ—è —Å–µ—Ä–µ–¥–Ω—å–æ–≥–æ –∑–Ω–∞—á–µ–Ω–Ω—è: –≤–æ–Ω–∞ –∑–∞ —Ç—ñ—î—é —Å–∞–º–æ—é –ª–æ–≥—ñ–∫–æ—é –º–∞—î –±—É—Ç–∏ —è–∫–æ–º–æ–≥–∞ –º–µ–Ω—à–æ—é. –ê —â–æ —Ç–∞–∫–µ –¥–∏—Å–ø–µ—Ä—Å—ñ—è —Å–µ—Ä–µ–¥–Ω—å–æ–≥–æ? –¶–µ $\dfrac{\sigma^2}{N}$, —Ç–æ–º—É MDE —Ç–∞–∫–æ–∂ –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ —Ä–æ–∑–º—ñ—Ä—É –≤–∏–±—ñ—Ä–∫–∏.

## üìä –ó–∞–¥–∞—á–∞ {.tiny}

–î–ª—è –ø–æ—á–∞—Ç–∫—É –≤–∏–∑–Ω–∞—á–∏–º–æ—Å—è –∑ –≥—ñ–ø–æ—Ç–µ–∑–æ—é, —â–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—î—Ç—å—Å—è: 

- $H_0: \mu_0 = 0\ vs. \ H_1: \mu_0 > 0$

–ü–æ–∑–Ω–∞—á–∏–º–æ

- $S^2_{\mu} := \dfrac{S^2}{N}$ &mdash; –æ—Ü—ñ–Ω–∫–∞ –¥–∏—Å–ø–µ—Ä—Å—ñ—ó —Å–µ—Ä–µ–¥–Ω—å–æ–≥–æ –∑–Ω–∞—á–µ–Ω–Ω—è.
- $S_{\mu} = \sqrt{\dfrac{S^2}{N}}$ &mdash; –æ—Ü—ñ–Ω–∫–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è —Å–µ—Ä–µ–¥–Ω—å–æ–≥–æ –∑–Ω–∞—á–µ–Ω–Ω—è, –∞–±–æ SEM.

–¢–µ–ø–µ—Ä –º–∏ –∑–Ω–∞—î–º–æ, —â–æ

- $\overline X \sim \mathcal{N}(\mu, S^2_{\mu})$

–ù–∞–º —Ç—Ä–µ–±–∞ –∑–Ω–∞–π—Ç–∏ $MDE=m$, —Ç–∞–∫–µ, —â–æ:

- —è–∫—â–æ $\overline X \sim \mathcal{N}(m, S^2_{\mu})$, —Ç–æ –≤ $1-\beta$ –≤—ñ–¥—Å–æ—Ç–∫—É –≤–∏–ø–∞–¥–∫—ñ–≤ –¥–ª—è –Ω—å–æ–≥–æ –≤—ñ–¥–∫–∏–Ω–µ—Ç—å—Å—è –∫—Ä–∏—Ç–µ—Ä—ñ–π. –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –ø–æ—Ç—É–∂–Ω—ñ—Å—Ç—å (–∑–µ–ª–µ–Ω–∞ –ø–ª–æ—â–∞ –Ω–∞ –≥—Ä–∞—Ñ—ñ–∫—É).
- —è–∫—â–æ $\overline X \sim \mathcal{N}(0, S^2_{\mu})$, —Ç–æ –∫—Ä–∏—Ç–µ—Ä—ñ–π –≤—ñ–¥–∫–∏–Ω–µ—Ç—å—Å—è –¥–ª—è –Ω—å–æ–≥–æ –≤ $\alpha$ –≤—ñ–¥—Å–æ—Ç–∫—ñ–≤ –≤–∏–ø–∞–¥–∫—ñ–≤. –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ FPR (—á–µ—Ä–≤–æ–Ω–∞ –ø–ª–æ—â–∞ –Ω–∞ –≥—Ä–∞—Ñ—ñ–∫—É).

---

![](img/mde.png){fig-align=center}

$$\text{MDE} = (z_{1 - \alpha} + z_{1 - \beta}) \cdot \sqrt{\dfrac{S^2}{N}}$$

–¥–µ $z_{1 - \alpha}$ —Ç–∞ $z_{1 - \beta}$ --- –∫–≤–∞–Ω—Ç–∏–ª—ñ —Ä–æ–∑–ø–æ–¥—ñ–ª—É $\mathcal{N}(0, 1)$.

## üêç Python —Ç–∞ MDE {.smaller}

$N = 1000$, $\alpha=5$%, $1-\beta=80$%, –∞ —è–∫ –¥—ñ–∑–Ω–∞—Ç–∏—Å—è $S^2$?

–ù–∞ –ø—Ä–∞–∫—Ç–∏—Ü—ñ —î 3 —Å–ø–æ—Å–æ–±–∏:

- –û—Ü—ñ–Ω–∏—Ç–∏ –Ω–∞ —ñ—Å—Ç–æ—Ä–∏—á–Ω–∏—Ö –¥–∞–Ω–∏—Ö. –£ —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É —Ü–µ –Ω–µ –ø—ñ–¥—Ö–æ–¥–∏—Ç—å, —Ç–æ–º—É —â–æ —Ä–∞–Ω—ñ—à–µ —Å—Ç–∞—Ä—Ç–∞–ø—É –Ω–µ –±—É–ª–æ.
- –û—Ü—ñ–Ω–∏—Ç–∏ –∑–∞ —Å—Ö–æ–∂–∏–º–∏ –¥–∞–Ω–∏–º–∏.
- –Ø–∫–æ—Å—å —Ç–µ–æ—Ä–µ—Ç–∏—á–Ω–æ –æ—Ü—ñ–Ω–∏—Ç–∏. –ù–∞–π–≥—ñ—Ä—à–∏–π —Å–ø–æ—Å—ñ–±, —è–∫–∏–π –ø—Ä–∞—Ü—é—î, —è–∫—â–æ –ø–µ—Ä—à—ñ 2 –Ω–µ –¥–æ–ø–æ–º–∞–≥–∞—é—Ç—å.

```{python}
#| label: mde

N = 1000
S2 = numpy.var(profits)
alpha = 0.05
beta = 1 - 0.8

MDE = (norm().ppf(1-alpha) + norm().ppf(1 - beta)) * numpy.sqrt(S2/N)
print(f"MDE –ø—Ä–∏ N={N}: {MDE}")
```

## MDE —Ç–∞ —Ä–æ–∑–º—ñ—Ä –≤–∏–±—ñ—Ä–∫–∏ {.smaller}

–î–ª—è –Ω–∞—Å —Ü–µ –∑–∞–Ω–∞–¥—Ç–æ –≤–µ–ª–∏–∫–∏–π MDE: —Ö–æ—á–µ—Ç—å—Å—è, —â–æ–± –≤—ñ–Ω –±—É–≤ $\leq$ 100, –º–∏ –ø—Ä–∏–ø—É—Å–∫–∞—î–º–æ, —â–æ —Ü–µ –π–º–æ–≤—ñ—Ä–Ω—ñ—à–∏–π —ñ—Å—Ç–∏–Ω–Ω–∏–π –µ—Ñ–µ–∫—Ç, –≤–∏—Ö–æ–¥—è—á–∏ –∑ –¥–æ—Å–≤—ñ–¥—É.

–î–∞–≤–∞–π—Ç–µ —Ç–µ–ø–µ—Ä —Ä–æ–∑–≤'—è–∂–µ–º–æ –∑–≤–æ—Ä–æ—Ç–Ω—É –∑–∞–¥–∞—á—É: –ú–∏ –∑–Ω–∞—î–º–æ MDE = 100, $\alpha=5$%, $1-\beta=80$%, $S^2$, —á–æ–º—É –¥–æ—Ä—ñ–≤–Ω—é—î $N$? –í–∏–≤–µ–¥–µ–º–æ –π–æ–≥–æ –∑ —Ñ–æ—Ä–º—É–ª–∏ MDE:

$N = \left(\dfrac{z_{1 - \alpha} + z_{1 - \beta}}{\text{MDE}}\right)^2 S^2$

```{python}
#| label: n-mde

S2 = numpy.var(profits)
alpha = 0.05
beta = 1 - 0.8
mde = 100

N = ((norm().ppf(1-alpha) + norm().ppf(1 - beta)) / mde)**2 * S2
N = int(N) + 1
print(f'–ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π —Ä–æ–∑–º—ñ—Ä –≤–∏–±—ñ—Ä–∫–∏: {N}')
```

# –î—è–∫—É—é –∑–∞ —É–≤–∞–≥—É! {.unnumbered .unlisted background-iframe=".04_files/libs/colored-particles/index.html"}

<br> <br>

{{< iconify solar book-bold >}} [–ú–∞—Ç–µ—Ä—ñ–∞–ª–∏ –∫—É—Ä—Å—É](https://aranaur.rbind.io/lectures/asa/)

{{< iconify mdi envelope >}} ihor.miroshnychenko\@knu.ua

{{< iconify ic baseline-telegram >}} [Data Mirosh](https://t.me/araprof)

{{< iconify mdi linkedin >}} [\@ihormiroshnychenko](https://www.linkedin.com/in/ihormiroshnychenko/)

{{< iconify mdi github >}} [\@aranaur](https://github.com/Aranaur)

{{< iconify ion home >}} [aranaur.rbind.io](https://aranaur.rbind.io)
