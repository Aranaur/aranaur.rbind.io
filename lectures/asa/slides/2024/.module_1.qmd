---
title: "–ú–æ–¥—É–ª—å–Ω–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å"
subtitle: "–ü—Ä–∏–∫–ª–∞–¥–Ω–∏–π —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–∏–π –∞–Ω–∞–ª—ñ–∑"
author: "–Ü–≥–æ—Ä –ú—ñ—Ä–æ—à–Ω–∏—á–µ–Ω–∫–æ"
institute: –ö–ù–£ —ñ–º–µ–Ω—ñ –¢–∞—Ä–∞—Å–∞ –®–µ–≤—á–µ–Ω–∫–∞, –§–Ü–¢
from: markdown+emoji
language: _language-ua.yml
footer: <a href="https://aranaur.rbind.io/lectures/asa/">üîó–ü—Ä–∏–∫–ª–∞–¥–Ω–∏–π —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–∏–π –∞–Ω–∞–ª—ñ–∑</a>
format:
  html:
    toc: true
preload-iframes: true
jupyter: python3
execute: 
  echo: true
  warning: false
editor_options: 
  chunk_output_type: console

revealjs-plugins:
  - verticator
---

```{python}
#| label: setup
#| include: false

# Import libraries
from scipy.stats import (
    norm, binom, expon, t, chi2, pareto, ttest_ind, sem, beta, laplace
)
from statsmodels.stats.proportion import proportion_confint
import numpy as numpy
from seaborn import distplot
from matplotlib import pyplot
import seaborn

from IPython.display import Markdown
from tabulate import tabulate

# Define colors
red_pink   = "#e64173"
turquoise  = "#20B2AA"
orange     = "#FFA500"
red        = "#fb6107"
blue       = "#181485"
navy       = "#150E37FF"
green      = "#8bb174"
yellow     = "#D8BD44"
purple     = "#6A5ACD"
slate      = "#314f4f"
```

# –ü–∞–∫–µ—Ç–∏

–í —Ü—å–æ–º—É –º–æ–¥—É–ª—ñ –º–∏ –±—É–¥–µ–º–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω—ñ –ø–∞–∫–µ—Ç–∏:

```{python}
#| label: packages

from collections import namedtuple
from scipy.stats import binom
import math
import numpy as np
```

[–í–æ—Å—å–º–∏–Ω—ñ–≥ –ü–∞—É–ª—å](https://uk.wikipedia.org/wiki/–í–æ—Å—å–º–∏–Ω—ñ–≥_–ü–∞—É–ª—å) 13 —Ä–∞–∑—ñ–≤ –Ω–∞–º–∞–≥–∞–≤—Å—è –≤–≥–∞–¥–∞—Ç–∏ –ø–µ—Ä–µ–º–æ–∂—Ü—è —Ñ—É—Ç–±–æ–ª—å–Ω–æ–≥–æ –º–∞—Ç—á—É.

11 —Ä–∞–∑—ñ–≤ –≤—ñ–Ω —É–≥–∞–¥–∞–≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ, 2 —Ä–∞–∑–∏ --- –ø–æ–º–∏–ª–∏–≤—Å—è. –ú–∏ —Ö–æ—á–µ–º–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –≥—ñ–ø–æ—Ç–µ–∑—É:

 - $H_0$: –≤–æ—Å—å–º–∏–Ω—ñ–≥ –≤–≥–∞–¥—É—î –ø–µ—Ä–µ–º–æ–∂—Ü—è –º–∞—Ç—á—É –∑ –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—é 0.5
 - $H_1$: –≤–æ—Å—å–º–∏–Ω—ñ–≥ –≤–∏–±–∏—Ä–∞—î –ø–µ—Ä–µ–º–æ–∂—Ü—è –º–∞—Ç—á—É –∑ –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—é $\neq$ 0.5

–í–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ —Ä–æ–∑—Ä–æ–±–∏—Ç–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–∏–π –∫—Ä–∏—Ç–µ—Ä—ñ–π –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Ü—ñ—î—ó –≥—ñ–ø–æ—Ç–µ–∑–∏, –∞ —Ç–∞–∫–æ–∂ –ø–æ—Ä–∞—Ö—É–≤–∞—Ç–∏ $p$-–∑–Ω–∞—á–µ–Ω–Ω—è.

- $H_0: p = 0.5$
- $H_1: p \neq 0.5$  
- $S(X) = \sum\limits_{i=1}^n X_i \sim Binom(n, 0.5)$ –∑–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—ñ –≥—ñ–ø–æ—Ç–µ–∑–∏ $H_0$  
- –ö—Ä–∏—Ç–µ—Ä—ñ–π: $\bigl\{ S(X) \gt u_{1-\frac{\alpha}{2}} \bigr\} \cup \bigl\{ S(X) \lt u_{\frac{\alpha}{2}} \bigr\}$,
    + –¥–µ $u_{\beta}$ - –∫—Ä–∏—Ç–∏—á–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è, —â–æ –¥–æ—Ä—ñ–≤–Ω—é—î $\beta$-–∫–≤–∞–Ω—Ç–∏–ª—é $Binom(n, 0.5)$,  
- $p$-–∑–Ω–∞—á–µ–Ω–Ω—è = $2 \cdot \text{min}\bigl[P\bigl( S(X) \geqslant S_0 \, | \, H_0\bigr), \, P\bigl( S(X) \leqslant S_0 \, | \, H_0\bigr) \bigr]$, 
    + –¥–µ $S_0$ - –∑–Ω–∞—á–µ–Ω–Ω—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≤—ñ–¥ –∑–∞–¥–∞–Ω–æ—ó –≤–∏–±—ñ—Ä–∫–∏

## –ó–∞–≤–¥–∞–Ω–Ω—è 1

–†–µ–∞–ª—ñ–∑—É–π—Ç–µ –∫—Ä–∏—Ç–µ—Ä—ñ–π `check_paul_criterion(n, k, alpha)`, –¥–µ:

- `n` &mdash; –∫—ñ–ª—å–∫—ñ—Å—Ç—å –º–∞—Ç—á—ñ–≤;
- `k` &mdash; –∫—ñ–ª—å–∫—ñ—Å—Ç—å –≤—ñ—Ä–Ω–∏—Ö –ø–µ—Ä–µ–¥–±–∞—á–µ–Ω—å –≤—ñ–¥ –≤–æ—Å—å–º–∏–Ω–æ–≥–∞;
- `alpha` &mdash; —Ä—ñ–≤–µ–Ω—å –∑–Ω–∞—á—É—â–æ—Å—Ç—ñ –∫—Ä–∏—Ç–µ—Ä—ñ—é.

–§—É–Ω–∫—Ü—ñ—è –º–∞—î –ø–æ–≤–µ—Ä–Ω—É—Ç–∏ `PaulCheckResults` –∑ –ø–æ–ª—è–º–∏:

- `is_rejected`: –≤—ñ–¥–∫–∏–Ω—É–ª–∞—Å—è —á–∏ –Ω—ñ –≥—ñ–ø–æ—Ç–µ–∑–∞ $H_0$ –Ω–∞ —Ä—ñ–≤–Ω—ñ –∑–Ω–∞—á—É—â–æ—Å—Ç—ñ $\alpha$
- `pvalue`: $p$-–∑–Ω–∞—á–µ–Ω–Ω—è


```{python}
#| label: task_1
#| eval: false

PaulCheckResults = namedtuple('PaulCheckResults', ['is_rejected', 'pvalue'])

def check_paul_criterion(n: int, k: int, alpha: float = 0.05):
    """
    –í–∞—à –æ–ø–∏c —Ç—É—Ç
    ‚ãÖÀö‚Çä‚Äß ‡¨≥ ‚Äß‚ÇäÀö ‚ãÖ
    """

    # –í–∞—à –∫–æ–¥ —Ç—É—Ç
    # ìáº ‚ãÜÔΩ°Àö ìÜù‚ãÜÔΩ°Àö ìáº

    return PaulCheckResults(is_rejected, pvalue)
```

## –ó–∞–≤–¥–∞–Ω–Ω—è 2

1. –Ø–∫—ñ –≤–∏—Å–Ω–æ–≤–∫–∏ –º–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏ –∑ –æ—Ç—Ä–∏–º–∞–Ω–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É?
2. –í–∏–∑–Ω–∞—á—ñ—Ç—å –∫—Ä–∏—Ç–∏—á–Ω—É –æ–±–ª–∞—Å—Ç—å –∫—Ä–∏—Ç–µ—Ä—ñ—é –¥–ª—è –∑–∞–¥–∞–Ω–æ–≥–æ `n`.

## –ó–∞–≤–¥–∞–Ω–Ω—è 3

1. –ü–æ–±—É–¥—É–π—Ç–µ –¥–æ–≤—ñ—Ä—á–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è –π–º–æ–≤—ñ—Ä–Ω–æ—Å—Ç—ñ –≤–≥–∞–¥—É–≤–∞–Ω–Ω—è –≤–æ—Å—å–º–∏–Ω–æ–≥–∞.
2. –Ø–∫ –º–æ–∂–Ω–∞ —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç—É–≤–∞—Ç–∏ —Ü–µ–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª?