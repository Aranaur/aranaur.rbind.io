---
title: "–ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ"
subtitle: "–ü—Ä–∏–∫–ª–∞–¥–Ω–∏–π —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–∏–π –∞–Ω–∞–ª—ñ–∑"
author: "–Ü–≥–æ—Ä –ú—ñ—Ä–æ—à–Ω–∏—á–µ–Ω–∫–æ"
institute: –ö–ù–£ —ñ–º–µ–Ω—ñ –¢–∞—Ä–∞—Å–∞ –®–µ–≤—á–µ–Ω–∫–∞, –§–Ü–¢
from: markdown+emoji
title-slide-attributes:
    data-background-iframe: .05_files/libs/colored-particles/index.html
language: _language-ua.yml
footer: <a href="https://aranaur.rbind.io/lectures/asa/">üîó–ü—Ä–∏–∫–ª–∞–¥–Ω–∏–π —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–∏–π –∞–Ω–∞–ª—ñ–∑</a>
format:
  revealjs: 
    code-line-numbers: false
    # center: true
    navigation-mode: vertical
    transition: fade
    background-transition: fade
    # controls-layout: bottom-right
    chalkboard: true
    logo: fit.png
    slide-number: true
    toc: true
    toc-depth: 1
    mouse-wheel: true
    width: 1350  
    height: 759.375
    highlight-style: github
    # fig-width: 9
    # fig-height: 5
    fig-format: svg
    theme: [default, custom.scss]
    mermaid:
      theme: forest
  # gfm:
  #   mermaid-format: png
preload-iframes: true
jupyter: python3
execute: 
  echo: true
  warning: false
editor_options: 
  chunk_output_type: console

revealjs-plugins:
  - verticator
---

```{python}
#| label: setup
#| include: false

# Import libraries
from scipy.stats import (
    norm, binom, expon, t, chi2, pareto, ttest_ind, sem, beta, laplace
)
from statsmodels.stats.proportion import proportion_confint
import numpy as numpy
from seaborn import distplot
from matplotlib import pyplot
import seaborn

from IPython.display import Markdown
from tabulate import tabulate

# Define colors
red_pink   = "#e64173"
turquoise  = "#20B2AA"
orange     = "#FFA500"
red        = "#fb6107"
blue       = "#181485"
navy       = "#150E37FF"
green      = "#8bb174"
yellow     = "#D8BD44"
purple     = "#6A5ACD"
slate      = "#314f4f"
```

# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∫—Ä–∏—Ç–µ—Ä—ñ—ó–≤ {background-iframe=".05_files/libs/colored-particles/index.html"}

## –ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞

–ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ --- —â–æ —î –¥—É–∂–µ –ø–æ—Ç—É–∂–Ω–∏–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º —É —Å—Ç–∞—Ç–∏—Å—Ç–∏—Ü—ñ. 

–ó –π–æ–≥–æ –¥–æ–ø–æ–º–æ–≥–æ—é –º–∏ –≤—ñ–¥–ø–æ–≤—ñ–º–æ –∑ –≤–∞–º–∏ –Ω–∞ –∑–∞–ø–∏—Ç–∞–Ω–Ω—è:

- –Ø–∫ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –≤–∞—à –∫—Ä–∏—Ç–µ—Ä—ñ–π? –í–∞–ª—ñ–¥–Ω–∏–π –≤—ñ–Ω –Ω–∞ –ø—Ä–∞–∫—Ç–∏—Ü—ñ —á–∏ –Ω—ñ?
    - –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —á–∏ –ø—Ä–∞—Ü—é—î $t$-test –Ω–∞ –º–∞–ª–∏—Ö —Ä–æ–∑–º—ñ—Ä–∞—Ö –≤–∏–±—ñ—Ä–æ–∫?
- –£ –≤–∞—Å —î 2 —Ä—ñ–∑–Ω—ñ –∫—Ä–∏—Ç–µ—Ä—ñ—ó. –Ø–∫ –∑—Ä–æ–∑—É–º—ñ—Ç–∏, —è–∫–∏–π –∫—Ä–∏—Ç–µ—Ä—ñ–π –∫—Ä–∞—â–µ –ø—ñ–¥—Ö–æ–¥–∏—Ç—å –¥–ª—è –≤–∞—à–æ—ó –∑–∞–¥–∞—á—ñ?

## –ó–≥–∞–¥–∞—î–º–æ $t$-–∫—Ä–∏—Ç–µ—Ä—ñ–π

| | –º–∞–ª–µ–Ω—å–∫–∞ –≤–∏–±—ñ—Ä–∫–∞ | –≤–µ–ª–∏–∫–∞ –≤–∏–±—ñ—Ä–∫–∞ |
|--------------------------|-------------------|-----------------|
| –Ω–æ—Ä–º–∞–ª—å–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª | t-test | t-test |
| –±—É–¥—å-—è–∫–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª | | t-test |

–©–æ –æ–∑–Ω–∞—á–∞—î, —â–æ –∫—Ä–∏—Ç–µ—Ä—ñ–π –∫–æ—Ä–µ–∫—Ç–Ω–∏–π? 

- –ö—Ä–∏—Ç–µ—Ä—ñ–π —Ä—ñ–≤–Ω—è –∑–Ω–∞—á—É—â–æ—Å—Ç—ñ $\alpha$ –æ–∑–Ω–∞—á–∞—î, —â–æ –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å –Ω–µ–≤—ñ—Ä–Ω–æ –≤—ñ–¥–∫–∏–Ω—É—Ç–∏ –Ω—É–ª—å–æ–≤—É –≥—ñ–ø–æ—Ç–µ–∑—É $\le \alpha$. 
- –ê —Ü–µ –∑—ñ —Å–≤–æ–≥–æ –±–æ–∫—É –æ–∑–Ω–∞—á–∞—î, —â–æ —è–∫—â–æ **–Ω–µ—Å–∫—ñ–Ω—á–µ–Ω–Ω–æ –±–∞–≥–∞—Ç–æ —Ä–∞–∑—ñ–≤ –ø–æ–≤—Ç–æ—Ä–∏—Ç–∏ –æ–¥–∏–Ω —ñ —Ç–æ–π —Å–∞–º–∏–π –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç**, —É —è–∫–æ–º—É –ø—Ä–∞–≤–∏–ª—å–Ω–∞ –Ω—É–ª—å–æ–≤–∞ –≥—ñ–ø–æ—Ç–µ–∑–∞, –≥–µ–Ω–µ—Ä—É—é—á–∏ –Ω–∞–Ω–æ–≤–æ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç, —Ç–æ –∫—ñ–ª—å–∫—ñ—Å—Ç—å **—Ö–∏–±–Ω–æ–ø–æ–∑–∏—Ç–∏–≤–Ω–∏—Ö** —Å–ø—Ä–∞—Ü—å–æ–≤—É–≤–∞–Ω—å –±—É–¥–µ –º–µ–Ω—à–æ—é –∑–∞ $\le \alpha$ –≤—ñ–¥—Å–æ—Ç–∫—ñ–≤.

## –ü—Ä–æ—Ü–µ–¥—É—Ä–∞ {.tiny40}

:::: {.columns}

::: {.column width="40%"}
–ö–æ—Ä–æ—Ç–∫–æ:

1. –°—Ç–≤–æ—Ä—é—î–º–æ –∫–æ–¥ –∫—Ä–∏—Ç–µ—Ä—ñ—é, —è–∫–∏–π –º–∏ –±—É–¥–µ–º–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏.
2. –ì–µ–Ω–µ—Ä—É—î–º–æ —è–∫–æ–º–æ–≥–∞ –±—ñ–ª—å—à–µ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ñ–≤, –¥–µ –≤—ñ—Ä–Ω–∞ $H_0$. 
3. –ü—Ä–æ–≥–∞–Ω—è—î–º–æ –Ω–∞ –Ω–∏—Ö –ø—Ä–∏–¥—É–º–∞–Ω–∏–π –∫—Ä–∏—Ç–µ—Ä—ñ–π.
4. –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ –ø—Ä–∞–≤–¥–∞, —â–æ —Ç—ñ–ª—å–∫–∏ –≤ $\alpha$ –≤—ñ–¥—Å–æ—Ç–∫—ñ–≤ –≤–∏–ø–∞–¥–∫—ñ–≤ –∫—Ä–∏—Ç–µ—Ä—ñ–π –≤—ñ–¥–∫–∏–¥–∞—î—Ç—å—Å—è?
:::

::: {.column width="60%"}
–†–æ–∑–≥–æ—Ä–Ω—É—Ç–æ:

1. –ù–∞—Å–∞–º–ø–µ—Ä–µ–¥ —Ç—Ä–µ–±–∞ –≤–∏–±—Ä–∞—Ç–∏ —Ä–æ–∑–ø–æ–¥—ñ–ª, —è–∫–∏–π –±—É–¥–µ –æ–ø–∏—Å—É–≤–∞—Ç–∏ –Ω–∞—à—ñ –¥–∞–Ω—ñ. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —è–∫—â–æ —É –Ω–∞—Å –º–µ—Ç—Ä–∏–∫–∞ –∫–æ–Ω–≤–µ—Ä—Å—ñ—ó, —Ç–æ —Ü–µ –±–µ—Ä–Ω—É–ª–ª—ñ–≤—Å—å–∫–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª, –∞ —è–∫—â–æ –º–µ—Ç—Ä–∏–∫–∞ --- –≤–∏—Ç–æ—Ä–≥, —Ç–æ –∫—Ä–∞—â–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –µ–∫—Å–ø–æ–Ω–µ–Ω—Ü—ñ–∞–ª—å–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª —è–∫ –Ω–∞–π–ø—Ä–æ—Å—Ç—ñ—à–µ –Ω–∞–±–ª–∏–∂–µ–Ω–Ω—è.
2. –ó–∞–≤–µ—Å—Ç–∏ –ª—ñ—á–∏–ª—å–Ω–∏–∫ `bad_cnt = 0`.
3. –î–∞–ª—ñ –≤ —Ü–∏–∫–ª—ñ —Ä–æ–∑–º—ñ—Ä—É $N$, –¥–µ $N$ --- –Ω–∞—Ç—É—Ä–∞–ª—å–Ω–µ —á–∏—Å–ª–æ –≤—ñ–¥ 1000 –¥–æ –Ω–µ—Å–∫—ñ–Ω—á–µ–Ω–Ω–æ—Å—Ç—ñ (—á–∏–º –≤–æ–Ω–æ –±—ñ–ª—å—à–µ, —Ç–∏–º –∫—Ä–∞—â–µ):
    - –°–∏–º—É–ª—é–≤–∞—Ç–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤–∏–±—ñ—Ä–∫–∏ –∑ —Ä–æ–∑–ø–æ–¥—ñ–ª—É, –æ–±—Ä–∞–Ω–æ–≥–æ –Ω–∞ –ø–µ—Ä—à–æ–º—É –∫—Ä–æ—Ü—ñ. –¢–∞–∫, —â–æ–± –≤—ñ—Ä–Ω–æ—é –±—É–ª–∞ $H_0$.
        - –ê –≤ —Ä–∞–∑—ñ AB-—Ç–µ—Å—Ç—É —Å–∏–º—É–ª—é–≤–∞—Ç–∏ —Ç—Ä–µ–±–∞ –Ω–µ 1 –≤–∏–±—ñ—Ä–∫—É, –∞ 2: –¥–ª—è —Ç–µ—Å—Ç—É —ñ –∫–æ–Ω—Ç—Ä–æ–ª—é.
    - –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –Ω–∞ –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏—Ö –¥–∞–Ω–∏—Ö –∫—Ä–∏—Ç–µ—Ä—ñ–π, —â–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—î—Ç—å—Å—è.
    - –î–∞–ª—ñ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, `pvalue < alpha`. –Ø–∫—â–æ —Ç–∞–∫, —Ç–æ –∑–±—ñ–ª—å—à–∏—Ç–∏ –ª—ñ—á–∏–ª—å–Ω–∏–∫ `bad_cnt` –Ω–∞ 1. –¢—É—Ç –º–∏ –ø–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ –ø–æ–º–∏–ª–∏–≤—Å—è –∫—Ä–∏—Ç–µ—Ä—ñ–π –Ω–∞ –ø–æ—Ç–æ—á–Ω—ñ–π —Å–∏–º—É–ª—è—Ü—ñ—ó, —á–∏ –Ω—ñ. 
4. –ü–æ—Ä–∞—Ö—É–≤–∞—Ç–∏ –∫–æ–Ω–≤–µ—Ä—Å—ñ—é `bad_cnt / N`.
    - –Ø–∫—â–æ –≤–æ–Ω–∞ –ø—Ä–∏–±–ª–∏–∑–Ω–æ –∑–±—ñ–≥–∞—î—Ç—å—Å—è –∑ $\alpha$, —Ç–æ –≤—Å–µ –¥–æ–±—Ä–µ.
    - –Ø–∫—â–æ –≤–æ–Ω–∞ –º–µ–Ω—à–∞ –∑–∞ $\alpha$, —Ç–æ –≤ –ø—Ä–∏–Ω—Ü–∏–ø—ñ —Ü–µ –∞–¥–µ–∫–≤–∞—Ç–Ω–∏–π –∫—Ä–∏—Ç–µ—Ä—ñ–π –Ω–∞ –ø—Ä–∞–∫—Ç–∏—Ü—ñ, –ø—Ä–æ—Å—Ç–æ –≤—ñ–Ω –±—É–¥–µ –º–µ–Ω—à –ø–æ—Ç—É–∂–Ω–∏–π, –Ω—ñ–∂ –∫—Ä–∏—Ç–µ—Ä—ñ–π, —â–æ –ø–æ–º–∏–ª—è—î—Ç—å—Å—è —Ä—ñ–≤–Ω–æ –≤ $\alpha$ –≤—ñ–¥—Å–æ—Ç–∫—É –≤–∏–ø–∞–¥–∫—ñ–≤.
        - –ê–ª–µ –Ω–∞ –ø—Ä–∞–∫—Ç–∏—Ü—ñ –≤–∞—Ä—Ç–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏: –∞ —Ç–µ–æ—Ä–µ—Ç–∏—á–Ω–æ —Ç–∞–∫–∞ —Å–∏—Ç—É–∞—Ü—ñ—è –º–æ–∂–ª–∏–≤–∞? –ß–∏ —Ü–µ –ø–æ–º–∏–ª–∫–∞ –≤ –∫–æ–¥—ñ –∫—Ä–∏—Ç–µ—Ä—ñ—é?
    - –Ø–∫—â–æ –∫—Ä–∏—Ç–µ—Ä—ñ–π –ø–æ–º–∏–ª—è—î—Ç—å—Å—è –±—ñ–ª—å—à–µ, –Ω—ñ–∂ —É $\alpha$, —Ç–æ –∑–Ω–∞—á–∏—Ç—å –≤—ñ–Ω –Ω–µ–∫–æ—Ä–µ–∫—Ç–Ω–∏–π —ñ –Ω–∏–º –Ω–µ –º–æ–∂–Ω–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ç–∏—Å—è. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Ç–∞–∫–∏–π –∫—Ä–∏—Ç–µ—Ä—ñ–π, –≤–∏ –±—É–¥–µ—Ç–µ –ø–æ–º–∏–ª—è—Ç–∏—Å—è —á–∞—Å—Ç—ñ—à–µ, –Ω—ñ–∂ —Ç—Ä–µ–±–∞, –∞ –æ—Ç–∂–µ, –≤–∞—à–∞ –∫–æ–º–ø–∞–Ω—ñ—è –≤—Ç—Ä–∞—á–∞—Ç–∏–º–µ –±—ñ–ª—å—à–µ –≥—Ä–æ—à–µ–π.
:::

::::

## $t$-test: –º–∞–ª–∞ –≤–∏–±—ñ—Ä–∫–∞, –Ω–æ—Ä–º–∞–ª—å–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª {.smaller}

:::: {.columns}

::: {.column width="50%"}
```{python}
#| label: t-test-small-norm

numpy.random.seed(42)

bad_cnt = 0
N = 10000
alpha = 0.05

sample_dist = norm(loc=2, scale=3)
mu0=sample_dist.expect()
for i in range(N):
    # –ì–µ–Ω–µ—Ä—É—é –≤–∏–±—ñ—Ä–∫—É —Ç–µ—Å—Ç—É —ñ –∫–æ–Ω—Ç—Ä–æ–ª—é
    test    = sample_dist.rvs(5)
    control = sample_dist.rvs(5)

    # –ó–∞–ø—É—Å–∫–∞—é –∫—Ä–∏—Ç–µ—Ä—ñ–π —ñ —Ä–∞—Ö—É—é p-value
    pvalue = ttest_ind(test, control, alternative='two-sided').pvalue
    
    # –ü–µ—Ä–µ–≤—ñ—Ä—è—é, —â–æ pvalue < alpha
    bad_cnt += (pvalue < alpha)

print(f"FPR: {round(bad_cnt / N, 4)}")
```

<center>üò©</center>
:::

::: {.column width="50%" .fragment}
<center>üòÉ[–î–æ–≤—ñ—Ä—á–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è FPR!]{.hi}</center>

4. –ü–æ—Ä–∞—Ö—É–≤–∞—Ç–∏ –æ—Ç—Ä–∏–º–∞–Ω–∏–π FPR —ñ –ø–æ–±—É–¥—É–≤–∞—Ç–∏ –¥–æ–≤—ñ—Ä—á–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è –Ω—å–æ–≥–æ. –Ø–∫—â–æ $\alpha$ –ª–µ–∂–∏—Ç—å —É –Ω—å–æ–º—É, –∑–Ω–∞—á–∏—Ç—å —É—Å–µ –¥–æ–±—Ä–µ, –∞ —ñ–Ω–∞–∫—à–µ —Ä–æ–∑–±–∏—Ä–∞—î–º–æ—Å—è, —â–æ –ø—ñ—à–ª–æ –Ω–µ —Ç–∞–∫.
    - –î–æ–≤—ñ—Ä—á–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª –º–æ–∂–Ω–∞ –ø–æ–±—É–¥—É–≤–∞—Ç–∏ —Ä—ñ–∑–Ω–∏–º–∏ —Å–ø–æ—Å–æ–±–∞–º–∏: –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —ñ–¥–µ—ó –ø–æ–±—É–¥–æ–≤–∏ –¥–æ–≤—ñ—Ä—á–∏—Ö —ñ–Ω—Ç–µ—Ä–≤–∞–ª—ñ–≤ —ñ–∑ –¥—Ä—É–≥–æ—ó –ª–µ–∫—Ü—ñ—ó.
    - –ê–ª–µ –º–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏ –ø—Ä–æ—Å—Ç—ñ—à–µ: [–¥–æ–≤—ñ—Ä—á–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª –í—ñ–ª—Å–æ–Ω–∞](https://en.wikipedia.org/wiki/Binomial_proportion_confidence_interval#Wilson_score_interval): –≤—ñ–Ω –Ω–µ —Ç–∞–∫–∏–π —Ç–æ—á–Ω–∏–π, —è–∫ –º–∏ –≤–∏–≤–æ–¥–∏–ª–∏ —Ä–∞–Ω—ñ—à–µ, –∑–∞—Ç–µ –≤—ñ–Ω —à–≤–∏–¥—à–∏–π —ñ –ø—Ä–∞—Ü—é—î –∑ ¬´–∫–æ—Ä–æ–±–∫–∏¬ª. –ô–æ–≥–æ –Ω–µ —Ç—Ä–µ–±–∞ —Ä–µ–∞–ª—ñ–∑–æ–≤—É–≤–∞—Ç–∏ —Å–∞–º–æ–º—É.
:::

::::

. . .

```{python}
#| label: t-test-small-norm-ci
#| output-location: column

proportion_confint(
    count = bad_cnt, nobs = N, alpha=0.05, method='wilson'
    )
```

## $t$-test: –º–∞–ª–∞ –≤–∏–±—ñ—Ä–∫–∞, –µ–∫—Å–ø. —Ä–æ–∑–ø–æ–¥—ñ–ª {.smaller}

```{python}
#| label: t-test-small-exp
#| output-location: column

numpy.random.seed(42)

bad_cnt = 0
N = 10000
alpha = 0.05

sample_dist = expon(scale=10)
mu0=sample_dist.expect()

for i in range(N):
    # –ì–µ–Ω–µ—Ä—É—é –≤–∏–±—ñ—Ä–∫—É —Ç–µ—Å—Ç—É —ñ –∫–æ–Ω—Ç—Ä–æ–ª—é
    test    = sample_dist.rvs(5)
    control = sample_dist.rvs(5)

    # –ó–∞–ø—É—Å–∫–∞—é –∫—Ä–∏—Ç–µ—Ä—ñ–π —ñ —Ä–∞—Ö—É—é p-value
    pvalue = ttest_ind(test, control, alternative='two-sided').pvalue
    
    # –ü–µ—Ä–µ–≤—ñ—Ä—è—é, —â–æ pvalue < alpha
    bad_cnt += (pvalue < alpha)

print(f"FPR: {round(bad_cnt / N, 4)}")
```

```{python}
#| label: t-test-small-exp-ci
#| output-location: column

proportion_confint(
    count = bad_cnt, nobs = N, alpha=0.05, method='wilson'
    )
```

<center>ü§®</center>

## $t$-test: –º–∞–ª–∞ –≤–∏–±—ñ—Ä–∫–∞, —Ä—ñ–∑–Ω—ñ —Ä–æ–∑–ø–æ–¥—ñ–ª–∏ {.smaller}

```{python}
#| label: t-test-small-exp-exp
#| output-location: column
#| fig-align: center

numpy.random.seed(42)

test_dist = expon(scale = 10)
control_dist = expon(loc=5, scale = 5)

x = numpy.linspace(0, 100, 1000)

pyplot.figure(figsize=(10, 5))
pyplot.title('–ü—Ä–∏–∫–ª–∞–¥ —Ä–æ–∑–ø–æ–¥—ñ–ª—ñ–≤', fontsize=12)
pyplot.plot(x, test_dist.pdf(x), label='test', color=red)
pyplot.plot(x, control_dist.pdf(x), label='control', color=blue)
pyplot.xlabel('–í–∏—Ä—É—á–∫–∞')
pyplot.ylabel('–©—ñ–ª—å–Ω—ñ—Å—Ç—å')
pyplot.legend(fontsize=12)
pyplot.grid(linewidth=0.2)
pyplot.show()

print(f"mean_t: {test_dist.mean()}, mean_c: {control_dist.mean()}")
```

## $t$-test: –º–∞–ª–∞ –≤–∏–±—ñ—Ä–∫–∞, —Ä—ñ–∑–Ω—ñ —Ä–æ–∑–ø–æ–¥—ñ–ª–∏ {.tiny}

```{python}
#| label: t-test-small-exp-exp-test-def
#| output-location: column

def check_criterion(test_dist, control_dist, sample_size, N_exps=10000, to_print=True):
    """
        –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ t-test –∫—Ä–∏—Ç–µ—Ä—ñ—é –¥–ª—è AB-—Ç–µ—Å—Ç—É
        –ü–æ–≤–µ—Ä—Ç–∞—î –¥–æ–≤—ñ—Ä—á–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è FPR, —è–∫—â–æ –ø—Ä–∞–ø–æ—Ä to_print = False. –Ü–Ω–∞–∫—à–µ –¥—Ä—É–∫—É—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç.
    
        –ü–∞—Ä–∞–º–µ—Ç—Ä–∏:
            - test_dist: –†–æ–∑–ø–æ–¥—ñ–ª —Ç–µ—Å—Ç–æ–≤–æ—ó –≤–∏–±—ñ—Ä–∫–∏ –≤ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ñ
            - control_dist: –†–æ–∑–ø–æ–¥—ñ–ª –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ—ó –≤–∏–±—ñ—Ä–∫–∏ –≤ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ñ
            - sample_size: —Ä–æ–∑–º—ñ—Ä –≤–∏–±—ñ—Ä–∫–∏ —Ç–µ—Å—Ç—É —ñ –∫–æ–Ω—Ç—Ä–æ–ª—é
            - N_exps: –∫—ñ–ª—å–∫—ñ—Å—Ç—å –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ñ–≤, –∑–∞ —è–∫–∏–º–∏ –ø–æ—Ç—ñ–º —Ä–∞—Ö—É—î—Ç—å—Å—è FPR
            - to_print: –¥—Ä—É–∫—É–≤–∞—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —á–∏ –Ω—ñ. –Ø–∫—â–æ –Ω—ñ, —Ç–æ —Ñ—É–Ω–∫—Ü—ñ—è –ø–æ–≤–µ—Ä—Ç–∞—î –¥–æ–≤—ñ—Ä—á–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è FPR.
    """
    
    numpy.random.seed(35)
    bad_cnt = 0
    alpha = 0.05

    for i in range(N_exps):
        # –ì–µ–Ω–µ—Ä—É—é –≤–∏–±—ñ—Ä–∫—É
        test = test_dist.rvs(sample_size)
        control = control_dist.rvs(sample_size)

        # –ó–∞–ø—É—Å–∫–∞—é –∫—Ä–∏—Ç–µ—Ä—ñ–π —ñ —Ä–∞—Ö—É—é p-value
        pvalue = ttest_ind(test, control, equal_var=False, alternative='two-sided').pvalue

        # –ü–µ—Ä–µ–≤—ñ—Ä—è—é, —â–æ pvalue < alpha
        bad_cnt += (pvalue < alpha)

    if to_print:
        print(f"FPR: {round(bad_cnt / N_exps, 4)}")
        print(f"CI={proportion_confint(count = bad_cnt, nobs = N_exps, alpha=0.05, method='wilson')}")
    else:
        return proportion_confint(count = bad_cnt, nobs = N_exps, alpha=0.05, method='wilson')
```

<br>

```{python}
#| label: t-test-small-exp-exp-test-calc

check_criterion(test_dist=test_dist, control_dist=control_dist, sample_size=10)
```

## –ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π —Ä–æ–∑–º—ñ—Ä –≤–∏–±—ñ—Ä–∫–∏ –¥–ª—è $t$-test

```{python}
#| label: t-test-min-n

scale = numpy.arange(20, 110, 20)
for N in scale:
    left, right = check_criterion(test_dist=test_dist, control_dist=control_dist, sample_size=N, N_exps=10000, to_print=False)
    if left < alpha < right:
        print(f"Min sample size: {N}")
        break
```

<br>

```{python}
#| label: t-test-min-n-print

check_criterion(test_dist=test_dist, control_dist=control_dist, sample_size=60)
```

–Ø–∫—â–æ —Ç—Ä–µ–±–∞ –±—ñ–ª—å—à–∞ —Ç–æ—á–Ω—ñ—Å—Ç—å, —Ç–æ –º–æ–∂–Ω–∞ –∑–±—ñ–ª—å—à–∏—Ç–∏ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ñ–≤ `N_exps`.

## –í–∏—Å–Ω–æ–≤–æ–∫ {.smaller}

–©–æ–± –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –∫—Ä–∏—Ç–µ—Ä—ñ–π, —Ç—Ä–µ–±–∞ –≤–º—ñ—Ç–∏ –±–∞–≥–∞—Ç–æ —Ä–∞–∑—ñ–≤ –ø—Ä–æ–≤–æ–¥–∏—Ç–∏ –æ–¥–∏–Ω —ñ —Ç–æ–π —Å–∞–º–∏–π –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç.

- –ß–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ –∫—Ä–∏—Ç–µ—Ä—ñ–π?
    - –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –π–æ–≥–æ! –ú–æ–∂–Ω–∞ –Ω–∞ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–æ –∑–º–æ–¥–µ–ª—å–æ–≤–∞–Ω–∏—Ö –¥–∞–Ω–∏—Ö.
- –ß–∏ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ü–µ–π –∫—Ä–∏—Ç–µ—Ä—ñ–π –¥–ª—è –Ω–∞—à–æ—ó –∑–∞–¥–∞—á—ñ?
    - –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –π–æ–≥–æ! –ê–ª–µ —Ç—ñ–ª—å–∫–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ **–ø—Ä–∞–≤–∏–ª—å–Ω–æ** –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç.
- –Ø–∫ –∑–Ω–∞–π—Ç–∏ –º—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π —Ä–æ–∑–º—ñ—Ä –≤–∏–±—ñ—Ä–∫–∏ —É $t$-test?
    - –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ $t$-test –Ω–∞ —Ä—ñ–∑–Ω–∏—Ö —Ä–æ–∑–º—ñ—Ä–∞—Ö –≤–∏–±—ñ—Ä–∫–∏. –ó —Ç–æ–≥–æ –º–æ–º–µ–Ω—Ç—É, —è–∫ $\alpha$ –ª–µ–∂–∏—Ç—å —É –¥–æ–≤—ñ—Ä—á–æ–º—É —ñ–Ω—Ç–µ—Ä–≤–∞–ª—ñ --- –º–æ–∂–µ–º–æ –≤–≤–∞–∂–∞—Ç–∏, —â–æ $t$-test –±—É–¥–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏.

| | –º–∞–ª–µ–Ω—å–∫–∞ –≤–∏–±—ñ—Ä–∫–∞ | –≤–µ–ª–∏–∫–∞ –≤–∏–±—ñ—Ä–∫–∞ |
|--------------------------|-------------------|-----------------|
| –Ω–æ—Ä–º–∞–ª—å–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª | t-test | t-test |
| –±—É–¥—å-—è–∫–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª | [–ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ]{.hi} | t-test |

## –Ø–∫ —ñ–º—ñ—Ç—É–≤–∞—Ç–∏ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç? {.smaller}

–Ñ 2 –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –Ω–∞ —Ü–µ –∑–∞–ø–∏—Ç–∞–Ω–Ω—è:

1. –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è —Ç–µ—Å—Ç—É —ñ –∫–æ–Ω—Ç—Ä–æ–ª—é —á–µ—Ä–µ–∑ —à—Ç—É—á–Ω–µ –º–æ–¥–µ–ª—é–≤–∞–Ω–Ω—è. –ó–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ä—ñ–∑–Ω–∏—Ö —Ä–æ–∑–ø–æ–¥—ñ–ª—ñ–≤ –º–æ–∂–Ω–∞ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –Ω–∞–±–ª–∏–∑–∏—Ç–∏ —Ä–µ–∞–ª—å–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª –Ω–∞ –¥–∞–Ω–∏—Ö. –ù–∞–ø—Ä–∏–∫–ª–∞–¥:
    - –î–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –≤–∏—Ä—É—á–∫–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –µ–∫—Å–ø–æ–Ω–µ–Ω—Ü—ñ–∞–ª—å–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª. –ß–∏–º –±—ñ–ª—å—à–∞ –≤–∏—Ä—É—á–∫–∞ –≤—ñ–¥ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ --- —Ç–∏–º –º–µ–Ω—à–µ —Ç–∞–∫–∏—Ö –ª—é–¥–µ–π.
    - –î–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –∫–æ–Ω–≤–µ—Ä—Å—ñ–π–Ω–∏—Ö –≤–∏–±—ñ—Ä–æ–∫ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –∫–ª—ñ–∫–Ω–µ/–Ω–µ –∫–ª—ñ–∫–Ω–µ) –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –±–µ—Ä–Ω—É–ª–ª—ñ—ó–≤—Å—å–∫—É –≤–∏–±—ñ—Ä–∫—É.
    - –Ü–Ω–æ–¥—ñ –º–æ–∂–Ω–∞ –±—Ä–∞—Ç–∏ —Å—É–º—ñ—à —Ä–æ–∑–ø–æ–¥—ñ–ª—ñ–≤: –Ω–µ—Ö–∞–π 90% –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –Ω–∞—à–æ–≥–æ —Å–∞–π—Ç—É –ø—Ä–∏–Ω–æ—Å—è—Ç—å –Ω—É–ª—å–æ–≤—É –≤–∏—Ä—É—á–∫—É. –¢–æ–¥—ñ –º–æ–∂–Ω–∞ –ø–µ—Ä–µ–º–Ω–æ–∂–∏—Ç–∏ –±–µ—Ä–Ω—É–ª–ª—ñ–≤—Å—å–∫–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª –Ω–∞ –µ–∫—Å–ø–æ–Ω–µ–Ω—Ü—ñ–∞–ª—å–Ω–∏–π –¥–ª—è –º–æ–¥–µ–ª—é–≤–∞–Ω–Ω—è –≤–∏—Ä—É—á–∫–∏ –≤—ñ–¥ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.
    - –¢–∞–∫–æ–∂ –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –∫—Ä–∏—Ç–µ—Ä—ñ—é –Ω–µ –æ–±–æ–≤'—è–∑–∫–æ–≤–æ —Ä–æ–∑–ø–æ–¥—ñ–ª–∏ –≤ —Ç–µ—Å—Ç—ñ —Ç–∞ –≤ –∫–æ–Ω—Ç—Ä–æ–ª—ñ –º–∞—é—Ç—å –∑–±—ñ–≥–∞—Ç–∏—Å—è. –í–æ–Ω–∏ –º–æ–∂—É—Ç—å –±—É—Ç–∏ —Ä—ñ–∑–Ω–∏–º–∏, –∞–ª–µ –º–∞—Ç. –æ—á—ñ–∫—É–≤–∞–Ω–Ω—è —Å–ø—ñ–≤–ø–∞–¥–µ, —è–∫ –±—É–ª–æ –≤ –ø—Ä–∏–∫–ª–∞–¥—ñ —Ä–∞–Ω—ñ—à–µ.

## –Ø–∫ —ñ–º—ñ—Ç—É–≤–∞—Ç–∏ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç? {.smaller}

2. –î–∞—Ç–∞—Å–µ—Ç–∏ –Ω–∞ —ñ—Å—Ç–æ—Ä–∏—á–Ω–∏—Ö –¥–∞–Ω–∏—Ö –∫–æ–º–ø–∞–Ω—ñ—ó. –£ –±–∞–≥–∞—Ç—å–æ—Ö –∫–æ–º–ø–∞–Ω—ñ–π —î –ª–æ–≥—É–≤–∞–Ω–Ω—è –ø–æ–¥—ñ–π. –¢–æ–¥—ñ –º–∏ –∑–º–æ–∂–µ–º–æ –ø—Ä—è–º–æ –Ω–∞ —Ä–µ–∞–ª—å–Ω–∏—Ö –¥–∞–Ω–∏—Ö –æ—Ü—ñ–Ω–∏—Ç–∏ –¥—ñ—î–∑–¥–∞—Ç–Ω—ñ—Å—Ç—å –∫—Ä–∏—Ç–µ—Ä—ñ—é! –Ü –Ω–µ –ø–æ—Ç—Ä–∞–ø–∏—Ç–∏ –≤ –ø–∞—Å—Ç–∫—É —Ç–æ–≥–æ, —â–æ –Ω–∞ —à—Ç—É—á–Ω–∏—Ö –≤–∏–±—ñ—Ä–∫–∞—Ö –∫—Ä–∏—Ç–µ—Ä—ñ–π –≤–∞–ª—ñ–¥–Ω–∏–π, –∞ –Ω–∞ —Ä–µ–∞–ª—å–Ω–∏—Ö –¥–∞–Ω–∏—Ö –Ω—ñ. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —É –Ω–∞—Å —î –¥–∞–Ω—ñ –ø—Ä–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –∑–∞ –∫—ñ–ª—å–∫–∞ —Ä–æ–∫—ñ–≤. –¶–µ –≤–∂–µ –æ–¥–∏–Ω –≥–æ—Ç–æ–≤–∏–π –¥–∞—Ç–∞—Å–µ—Ç: –≤–∏ –¥—ñ–ª–∏—Ç–µ –≤—Å—ñ—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –Ω–∞ —Ç–µ—Å—Ç —Ç–∞ –∫–æ–Ω—Ç—Ä–æ–ª—å —ñ –æ—Ç—Ä–∏–º—É—î—Ç–µ –æ–¥–∏–Ω ¬´–µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç¬ª –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –≤–∞—à–æ–≥–æ –∫—Ä–∏—Ç–µ—Ä—ñ—é. 

## –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ –Ω–∞ —ñ—Å—Ç–æ—Ä–∏—á–Ω–∏—Ö –¥–∞–Ω–∏—Ö {.smaller}

> –ù–∞—à—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ —Ä–æ–∑–º—ñ—â—É—é—Ç—å –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è. –ö–æ–∂–Ω–µ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è –≤—ñ–¥–Ω–æ—Å–∏—Ç—å—Å—è —Ç—ñ–ª—å–∫–∏ –¥–æ –æ–¥–Ω—ñ—î—ó –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó —Ç–æ–≤–∞—Ä—ñ–≤ —ñ —Ä–æ–∑–º—ñ—â–µ–Ω–æ —Ç—ñ–ª—å–∫–∏ –≤ –æ–¥–Ω–æ–º—É —Ä–µ–≥—ñ–æ–Ω—ñ. –ó–≤—ñ–¥—Å–∏ –≤–∏–Ω–∏–∫–∞—î –Ω–µ—Ö–∏—Ç—Ä–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º:

- –†–æ–∑—ñ–±'—î–º–æ –≤—Å—ñ —Ä–æ–∑–º—ñ—â–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –Ω–∞ —á–æ—Ç–∏—Ä–∏ (–∞–±–æ N —É –∑–∞–≥–∞–ª—å–Ω–æ–º—É –≤–∏–ø–∞–¥–∫—É) –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó: –∞–≤—Ç–æ–º–æ–±—ñ–ª—ñ, —Å–ø–µ—Ü—Ç–µ—Ö–Ω—ñ–∫–∞, –ø–æ—Å–ª—É–≥–∏ —Ç–∞ –Ω–µ—Ä—É—Ö–æ–º—ñ—Å—Ç—å. –¢–µ–ø–µ—Ä –Ω–∞—à –¥–∞—Ç–∞—Å–µ—Ç –º–æ–∂–Ω–∞ —Ä–æ–∑–±–∏—Ç–∏ –Ω–∞ —Ü—ñ –ø—ñ–¥–∫–∞—Ç–µ–≥–æ—Ä—ñ—ó: –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –≤ –æ–¥–Ω–æ–º—É –¥–∞—Ç–∞—Å–µ—Ç—ñ –¥–∏–≤–∏—Ç–∏—Å—è –≤–∏—Ä—É—á–∫—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —Ç—ñ–ª—å–∫–∏ –≤ —Ü—ñ–π –ø—ñ–¥–∫–∞—Ç–µ–≥–æ—Ä—ñ—ó.
- –ü–æ–¥—ñ–ª–∏–º–æ –¥–∞—Ç–∞—Å–µ—Ç–∏ –∑–∞ –º—ñ—Å—è—Ü—è–º–∏: –¥–∞—Ç–∞—Å–µ—Ç –≤–∏—Ç—Ä–∞—Ç –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑–∞ –ª–∏—Å—Ç–æ–ø–∞–¥, –∑–∞ –≥—Ä—É–¥–µ–Ω—å —ñ —Ç–∞–∫ –¥–∞–ª—ñ.
- –©–µ –≤—Å—ñ –º–µ—Ç—Ä–∏–∫–∏ –º–æ–∂–Ω–∞ –ø–æ–¥—ñ–ª–∏—Ç–∏ –∑–∞ —Å—É–±'—î–∫—Ç–∞–º–∏ –∫—Ä–∞—ó–Ω–∏ –∞–±–æ –∑–∞ –≥—Ä—É–ø–æ—é —Å—É–±'—î–∫—Ç—ñ–≤.
- –û–±'—î–¥–Ω–∞—î–º–æ –≤—Å—ñ 3 –ø—Ä–∞–≤–∏–ª–∞ –≤ –æ–¥–Ω–µ. –ù–∞–ø—Ä–∏–∫–ª–∞–¥: –¥–∞—Ç–∞—Å–µ—Ç –≤–∏—Ç—Ä–∞—Ç –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑–∞ –ª–∏—Å—Ç–æ–ø–∞–¥ —É –ö–∏—î–≤—ñ.
- –¢–µ–ø–µ—Ä —É –Ω–∞—Å —î –≤–µ–ª–∏–∫–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –¥–∞—Ç–∞—Å–µ—Ç—ñ–≤ —ñ –≤ –∫–æ–∂–Ω–æ–º—É –∑ –Ω–∏—Ö —î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ. –ü–æ–¥—ñ–ª–∏–º–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –≤–∏–ø–∞–¥–∫–æ–≤–æ –Ω–∞ —Ç–µ—Å—Ç —Ç–∞ –∫–æ–Ω—Ç—Ä–æ–ª—å —ñ –æ—Ç—Ä–∏–º–∞—î–º–æ —Ñ—ñ–Ω–∞–ª—å–Ω—ñ –¥–∞—Ç–∞—Å–µ—Ç–∏ –¥–ª—è –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó –ø—Ä–∏–¥—É–º–∞–Ω–∏—Ö —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–∏—Ö –∫—Ä–∏—Ç–µ—Ä—ñ—ó–≤.

---

![](img/hist-mk.png){width=70%}

# –Ø–∫–∏–π –∫—Ä–∏—Ç–µ—Ä—ñ–π –∫—Ä–∞—â–µ? {background-iframe=".05_files/libs/colored-particles/index.html"}

## –ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞

–£ –Ω–∞—Å —î 2 –∫—Ä–∏—Ç–µ—Ä—ñ—ó, —è–∫—ñ –º–∏ —Ö–æ—á–µ–º–æ –ø–æ—Ä—ñ–≤–Ω—è—Ç–∏. –Ø–∫ –≤–∏–±—Ä–∞—Ç–∏ –∫—Ä–∞—â–∏–π?

. . .

<center>**–ü–æ—Ä—ñ–≤–Ω—è—Ç–∏ –ø–æ—Ç—É–∂–Ω—ñ—Å—Ç—å –∫—Ä–∏—Ç–µ—Ä—ñ—ó–≤!**</center>

- –≥–µ–Ω–µ—Ä—É—î–º–æ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏, –¥–µ –≤—ñ—Ä–Ω–∞ $H_1$;
- —Ä–∞—Ö—É—î–º–æ TPR –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –∫—Ä–∏—Ç–µ—Ä—ñ—é;

## –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –∫—Ä–∏—Ç–µ—Ä—ñ—ó–≤ –∑–∞ –ø–æ—Ç—É–∂–Ω—ñ—Å—Ç—é {.smaller}

```{python}
#| label: t-test-power-1

numpy.random.seed(42)

rej_cnt = 0
N = 10000
alpha = 0.05

sample_dist = norm(loc=2, scale=3)
mu = sample_dist.expect()

for i in range(N):
    # –ì–µ–Ω–µ—Ä—É—é –≤–∏–±—ñ—Ä–∫—É —Ç–µ—Å—Ç—É —ñ –∫–æ–Ω—Ç—Ä–æ–ª—é
    test = sample_dist.rvs(15)
    control = sample_dist.rvs(15) * 2

    # –ó–∞–ø—É—Å–∫–∞—é –∫—Ä–∏—Ç–µ—Ä—ñ–π —ñ —Ä–∞—Ö—É—é p-value
    pvalue = ttest_ind(test, control, equal_var=False, alternative='two-sided').pvalue
    
    # –ü–µ—Ä–µ–≤—ñ—Ä—è—é, —â–æ pvalue < alpha
    rej_cnt += (pvalue < alpha)

print(f"TPR –∞–±–æ –ø–æ—Ç—É–∂–Ω—ñ—Å—Ç—å: {round(rej_cnt / N, 4)}")
```

## –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –∫—Ä–∏—Ç–µ—Ä—ñ—ó–≤ –∑–∞ –ø–æ—Ç—É–∂–Ω—ñ—Å—Ç—é {.smaller}

```{python}
#| label: t-test-power-2

numpy.random.seed(42)

rej_cnt = 0
N = 10000
alpha = 0.05

sample_dist = norm(loc=2, scale=3)
mu = sample_dist.expect()

for i in range(N):
    # –ì–µ–Ω–µ—Ä—É—é –≤–∏–±—ñ—Ä–∫—É —Ç–µ—Å—Ç—É —ñ –∫–æ–Ω—Ç—Ä–æ–ª—é
    test = sample_dist.rvs(15)
    control = sample_dist.rvs(15) * 3

    # –ó–∞–ø—É—Å–∫–∞—é –∫—Ä–∏—Ç–µ—Ä—ñ–π —ñ —Ä–∞—Ö—É—é p-value
    pvalue = ttest_ind(test, control, equal_var=False, alternative='two-sided').pvalue
    
    # –ü–µ—Ä–µ–≤—ñ—Ä—è—é, —â–æ pvalue < alpha
    rej_cnt += (pvalue < alpha)

print(f"TPR –∞–±–æ –ø–æ—Ç—É–∂–Ω—ñ—Å—Ç—å: {round(rej_cnt / N, 4)}")
```

## –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –∫—Ä–∏—Ç–µ—Ä—ñ—ó–≤ –∑–∞ –ø–æ—Ç—É–∂–Ω—ñ—Å—Ç—é {.smaller}

```{python}
#| label: t-test-power-3

numpy.random.seed(42)

rej_cnt = 0
N = 10000
alpha = 0.05

sample_dist = norm(loc=2, scale=3)
mu = sample_dist.expect()

for i in range(N):
    # –ì–µ–Ω–µ—Ä—É—é –≤–∏–±—ñ—Ä–∫—É —Ç–µ—Å—Ç—É —ñ –∫–æ–Ω—Ç—Ä–æ–ª—é
    test = sample_dist.rvs(50)
    control = sample_dist.rvs(50) * 3

    # –ó–∞–ø—É—Å–∫–∞—é –∫—Ä–∏—Ç–µ—Ä—ñ–π —ñ —Ä–∞—Ö—É—é p-value
    pvalue = ttest_ind(test, control, equal_var=False, alternative='two-sided').pvalue
    
    # –ü–µ—Ä–µ–≤—ñ—Ä—è—é, —â–æ pvalue < alpha
    rej_cnt += (pvalue < alpha)

print(f"TPR –∞–±–æ –ø–æ—Ç—É–∂–Ω—ñ—Å—Ç—å: {round(rej_cnt / N, 4)}")
```

# –î—è–∫—É—é –∑–∞ —É–≤–∞–≥—É! {.unnumbered .unlisted background-iframe=".05_files/libs/colored-particles/index.html"}

<br> <br>

{{< iconify solar book-bold >}} [–ú–∞—Ç–µ—Ä—ñ–∞–ª–∏ –∫—É—Ä—Å—É](https://aranaur.rbind.io/lectures/asa/)

{{< iconify mdi envelope >}} ihor.miroshnychenko\@knu.ua

{{< iconify ic baseline-telegram >}} [Data Mirosh](https://t.me/araprof)

{{< iconify mdi linkedin >}} [\@ihormiroshnychenko](https://www.linkedin.com/in/ihormiroshnychenko/)

{{< iconify mdi github >}} [\@aranaur](https://github.com/Aranaur)

{{< iconify ion home >}} [aranaur.rbind.io](https://aranaur.rbind.io)
