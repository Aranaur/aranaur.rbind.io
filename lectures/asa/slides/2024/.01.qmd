---
title: "–°—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–∏–π –∫—Ä–∏—Ç–µ—Ä—ñ–π"
subtitle: "–ü—Ä–∏–∫–ª–∞–¥–Ω–∏–π —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–∏–π –∞–Ω–∞–ª—ñ–∑"
author: "–Ü–≥–æ—Ä –ú—ñ—Ä–æ—à–Ω–∏—á–µ–Ω–∫–æ"
institute: –ö–ù–£ —ñ–º–µ–Ω—ñ –¢–∞—Ä–∞—Å–∞ –®–µ–≤—á–µ–Ω–∫–∞, –§–Ü–¢
from: markdown+emoji
title-slide-attributes:
    data-background-iframe: .01_files/libs/colored-particles/index.html
language: _language-ua.yml
footer: <a href="https://aranaur.rbind.io/lectures/asa/">üîó–ü—Ä–∏–∫–ª–∞–¥–Ω–∏–π —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–∏–π –∞–Ω–∞–ª—ñ–∑</a>
format:
  revealjs: 
    code-line-numbers: false
    # center: true
    navigation-mode: vertical
    transition: fade
    background-transition: fade
    # controls-layout: bottom-right
    chalkboard: true
    logo: fit.png
    slide-number: true
    toc: true
    toc-depth: 1
    mouse-wheel: true
    width: 1350  
    height: 759.375
    highlight-style: github
    # fig-width: 9
    # fig-height: 5
    fig-format: svg
    theme: [default, custom.scss]
    mermaid:
      theme: forest
  # gfm:
  #   mermaid-format: png
preload-iframes: true
jupyter: python3
execute: 
  echo: true
  warning: false
editor_options: 
  chunk_output_type: console

revealjs-plugins:
  - verticator
---

```{python}
#| label: setup
#| include: false

# Import libraries
from scipy.stats import (
    binom
)
import numpy as numpy
from seaborn import distplot
from matplotlib import pyplot
import seaborn
import random

import sys

# Import libraries
# import numpy as numpy
import pandas as pd
# import matplotlib.pyplot as plt
# import seaborn as sns

from IPython.display import Markdown
from tabulate import tabulate

# Define colors
red_pink   = "#e64173"
turquoise  = "#20B2AA"
orange     = "#FFA500"
red        = "#fb6107"
blue       = "#181485"
navy       = "#150E37FF"
green      = "#8bb174"
yellow     = "#D8BD44"
purple     = "#6A5ACD"
slate      = "#314f4f"
```

# –ü—Ä–æ –º–µ–Ω–µ {.unnumbered .unlisted .tiny}

::: columns
::: {.column width="40%"}
![](img/miv.png){width="60%"}
:::

::: {.column width="40%"}
-   –ú—ñ—Ä–æ—à–Ω–∏—á–µ–Ω–∫–æ –Ü–≥–æ—Ä –í—ñ–∫—Ç–æ—Ä–æ–≤–∏—á
-   –∫–∞–Ω–¥–∏–¥–∞—Ç –µ–∫–æ–Ω–æ–º—ñ—á–Ω–∏—Ö –Ω–∞—É–∫, –¥–æ—Ü–µ–Ω—Ç
-   –¥–æ—Ü–µ–Ω—Ç –∫–∞—Ñ–µ–¥—Ä–∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ–π —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è, –§–Ü–¢, –ö–ù–£ —ñ–º–µ–Ω—ñ –¢–∞—Ä–∞—Å–∞ –®–µ–≤—á–µ–Ω–∫–∞
-   –¥–æ—Ü–µ–Ω—Ç –∫–∞—Ñ–µ–¥—Ä–∏ –º–∞—Ç–µ–º–∞—Ç–∏—á–Ω–æ–≥–æ –º–æ–¥–µ–ª—é–≤–∞–Ω–Ω—è —Ç–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏, –Ü–Ü–¢–ï, –ö–ù–ï–£
-   –≤–∏–∫–ª–∞–¥–∞—á –ö–∏—ó–≤—Å—å–∫–æ—ó —à–∫–æ–ª–∏ –µ–∫–æ–Ω–æ–º—ñ–∫–∏
-   –≤–∏–∫–ª–∞–¥–∞—á –ú—ñ–∂–Ω–∞—Ä–æ–¥–Ω–æ–≥–æ —ñ–Ω—Å—Ç–∏—Ç—É—Ç—É –±—ñ–∑–Ω–µ—Å—É (MBA)
:::
:::

{{< iconify mdi envelope >}} ihor.miroshnychenko\@knu.ua

{{< iconify ic baseline-telegram >}} [Data Mirosh](https://t.me/araprof)

{{< iconify mdi linkedin >}} [\@ihormiroshnychenko](https://www.linkedin.com/in/ihormiroshnychenko/)

{{< iconify mdi github >}} [\@aranaur](https://github.com/Aranaur)

{{< iconify ion home >}} [aranaur.rbind.io](https://aranaur.rbind.io)

# DataCamp Group {.unnumbered .unlisted}

![](img/datacamp-logo.png)

## DataCamp Group {.unlisted}

::: columns
::: column
![](img/datacamp-1.png)
:::

::: column
![](img/datacamp-2.png)
:::
:::

---

## DataCamp Group {.unlisted .smaller}

::: columns
::: {.column width="60%"}
![](img/datacamp-cert.png)
:::

::: {.column width="40%"}
**–Ø–∫ –¥–æ–ª—É—á–∏—Ç–∏—Å—è?**

1.  –ó–∞—Ä–µ—î—Å—Ç—Ä—É–π—Ç–µ—Å—å –Ω–∞ [DataCamp](http://datacamp.com)
2.  –ü—Ä–∏—î–¥–Ω–∞—Ç–∏—Å—è –¥–æ —Ç–µ–ª–µ–≥—Ä–∞–º-–∫–∞–Ω–∞–ª—É {{< iconify ic baseline-telegram >}} [Data Mirosh](https://t.me/araprof/53)
3.  –ü—Ä–∏—î–¥–Ω–∞–π—Ç–µ—Å—å –¥–æ –∫–ª–∞—Å—É –∑–∞ [–ø–æ—Å–∏–ª–∞–Ω–Ω—è–º](https://www.datacamp.com/groups/shared_links/bf4d3ee6fd2b417c0501831087a6f1a3f149532beb4dae7d8cf5f228cc78da8e)
:::
:::

. . .

::: callout-note
–ö–ª–∞—Å –±—É–¥–µ –∞–∫—Ç–∏–≤–Ω–∏–π **–¥–æ 11 –∂–æ–≤—Ç–Ω—è 2024 —Ä–æ–∫—É**, –ø—ñ—Å–ª—è —á–æ–≥–æ –±—É–¥–µ –±—É–¥–µ –≤—ñ–¥–∫—Ä–∏—Ç–æ –Ω–∞—Å—Ç—É–ø–Ω–∏–π –ø–æ—Ç—ñ–∫. –°–ª—ñ–¥–∫—É–π—Ç–µ –∑–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è–º–∏.
:::

# –°—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–∏–π –∫—Ä–∏—Ç–µ—Ä—ñ–π {background-iframe=".01_files/libs/colored-particles/index.html"}

## Startup —ñ–¥–µ—è

{{< iconify emojione department-store >}} –î–æ—Å—Ç–∞–≤–ª—è—î–º–æ —Ç–æ–≤–∞—Ä –∑ –º–∞–≥–∞–∑–∏–Ω—ñ–≤ –¥–æ –¥–æ–º—É

{{< iconify mdi courier-check >}} –í–∞—Ä—Ç—ñ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏ --- 100‚Ç¥

{{< iconify mdi courier-fast >}} –í–∞—Ä—Ç—ñ—Å—Ç—å —Ä–æ–±–æ—Ç–∏ –∫—É—Ä'—î—Ä–∞ --- 50‚Ç¥

. . .

\

–ê–ª–µ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –º–æ–∂—É—Ç—å –≤—ñ–¥–º–æ–≤–∏—Ç–∏—Å—è –≤—ñ–¥ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è.

. . .

\

–Ü–Ω–≤–µ—Å—Ç–æ—Ä–∏ –≥–æ—Ç–æ–≤—ñ –¥–æ–ø–æ–º–æ–≥—Ç–∏, —è–∫—â–æ —à–∞–Ω—Å –≤—ñ–¥–º–æ–≤–∏ **< 50%**.

–©–æ —Ä–æ–±–∏—Ç–∏?

. . .

<center>[–ü—Ä–æ–≤–µ—Å—Ç–∏ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç!]{.hi}</center>

## –ü—Ä–æ–≤–æ–¥–∏–º–æ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç

- –ó–Ω–∞–π—à–ª–∏ 30 –∫–ª—ñ—î–Ω—Ç—ñ–≤
- 19 –æ–ø–ª–∞—Ç–∏–ª–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è

. . .

\

<center>**–ê–ª–µ —á–∏ –¥–æ—Å—Ç–∞—Ç–Ω—å–æ —Ü—å–æ–≥–æ, —â–æ–± –¥–æ–≤–µ—Å—Ç–∏ —É—Å–ø—ñ—à–Ω—ñ—Å—Ç—å –Ω–∞—à–æ–≥–æ –±—ñ–∑–Ω–µ—Å—É?**</center>

## –ú–æ–¥–µ–ª—å —Ç–∞ —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è

–ú–∏ –Ω–µ –º–æ–∂–µ–º–æ –ø—Ä–æ—Ç–µ—Å—Ç—É–≤–∞—Ç–∏ –ø—Ä–æ–¥—É–∫—Ç –Ω–∞ –≤—Å—ñ—Ö, –∞–ª–µ –º–æ–∂–µ–º–æ –∑—ñ–±—Ä–∞—Ç–∏ –≤–∏–±—ñ—Ä–∫—É –∑ –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ—ó —Å—É–∫—É–ø–Ω–æ—Å—Ç—ñ —Ç–∞ –ø–æ—Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—Ç–∏ —á–∞—Å—Ç–∫—É —É—Å–ø—ñ—Ö—ñ–≤.

. . .

1. –ê—É–¥–∏—Ç–æ—Ä—ñ—è, —è–∫–∞ —Å–∫–æ—Ä–∏—Å—Ç–∞—î—Ç—å—Å—è –Ω–∞—à–∏–º —Å–µ—Ä–≤—ñ—Å–æ–º --- **–≥–µ–Ω–µ—Ä–∞–ª—å–Ω–∞ —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å**, $\xi \sim \text{Bernoulli}(\mu)$.
2. –ß–∞—Å—Ç–∫–∞ —É—Å–ø—ñ—à–Ω–∏—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π --- $\mu$.
3. –í–∏–±—ñ—Ä–∫–∞ –∑ –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ—ó —Å—É–∫—É–ø–Ω–æ—Å—Ç—ñ --- $\xi_1, \xi_2, \ldots, \xi_{30}$.

## –ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á—ñ {.tiny}

:::: {.columns}

::: {.column width="50%"}

1. –í–∏–∑–Ω–∞—á–∞—î–º–æ –≥—ñ–ø–æ—Ç–µ–∑–∏:
    - $H_0: \mu = 50%$
    - $H_1: \mu > 50%$

2. –í–∏–∑–Ω–∞—á–∞—î–º–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∫—Ä–∏—Ç–µ—Ä—ñ—é:

$Q = \xi_1 + \xi_2 + \ldots + \xi_{30} \underset{H_0}{\sim} \text{Binomial}(30, 0.5)$

3. –í–∏–∑–Ω–∞—á–∞—î–º–æ –∫—Ä–∏—Ç–µ—Ä—ñ–π:

:::{.border}
  - —è–∫—â–æ $Q \geq 21$: [–≤—ñ–¥—Ö–∏–ª—è—î–º–æ $H_0$]{.green}
  - —ñ–Ω–∞–∫—à–µ: [–Ω–µ –≤—ñ–¥—Ö–∏–ª—è—î–º–æ $H_0$]{.red}
:::

:::

::: {.column width="50%" .fragment fragment-index=2}
–ê–ª–µ —á–æ–º—É —Å–∞–º–µ 21?

```{python}
#| label: pmf-q-plot
#| echo: false

binom_h0 = binom(
    n=30, # –∫—ñ–ª—å–∫—ñ—Å—Ç—å –≤–∏–ø—Ä–æ–±—É–≤–∞–Ω—å
    p=0.5 # –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å —É—Å–ø—ñ—Ö—É
)

# –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞
x_grid = numpy.arange(1, 31)
# –≤–∏—Å–æ—Ç–∞ —Å—Ç–æ–≤–ø—Ü—ñ–≤ –Ω–∞ –≥—Ä–∞—Ñ—ñ–∫—É
probs = binom_h0.pmf(x_grid)

pyplot.figure(figsize=(16, 8))

# –±—É–¥—É—î–º–æ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ñ —Å—Ç–æ–≤–ø—Ü—ñ –≤—ñ–¥ 0 –¥–æ –π–º–æ–≤—ñ—Ä–Ω–æ—Å—Ç—ñ
pyplot.vlines(x_grid, 0, probs, linewidth=15.0, color=turquoise, label='PMF, $Binom(30, 0.5)$')
# –æ–∫—Ä–µ–º–æ –∑–æ–±—Ä–∞–∑–∏–º–æ –∫—Ä–∏—Ç–∏—á–Ω—É –æ–±–ª–∞—Å—Ç—å –∫—Ä–∏—Ç–µ—Ä—ñ—é
crit_reg = x_grid >= 21
pyplot.vlines(x_grid[crit_reg], 0, probs[crit_reg], linewidth=15.0, label='Critical region for S')
# –¥–æ–¥–∞–º–æ –≤—ñ–¥—Å–æ—Ç–æ–∫ –¥–æ –∫–æ–∂–Ω–æ–≥–æ —Å—Ç–æ–≤–ø—Ü—è
for i in range(19, 24, 1):
    pyplot.text(x_grid[i], probs[i], f'{probs[i] * 100:.1f}%', fontsize=12, ha='center', va='bottom')
pyplot.title('–ë—ñ–Ω–æ–º—ñ–∞–ª—å–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª', fontsize=20)
pyplot.xlabel('–ö—ñ–ª—å–∫—ñ—Å—Ç—å —É—Å–ø—ñ—Ö—ñ–≤', fontsize=18)
pyplot.ylabel('PMF Q \n $H_0$', fontsize=18, rotation=0, labelpad=30)
pyplot.legend(fontsize=18)
pyplot.show()
```

4. –í–∏–∑–Ω–∞—á–∞—î–º–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω—É –∑–Ω–∞—á—É—â—ñ—Å—Ç—å:
- $\alpha$ --- —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–∞ –∑–Ω–∞—á—É—â—ñ—Å—Ç—å –∫—Ä–∏—Ç–µ—Ä—ñ—é, 5%.
- **FPR** (False Positive Rate, —á–∞—Å—Ç–æ—Ç–∞ —Ö–∏–±–Ω–æ–ø–æ–∑–∏—Ç–∏–≤–Ω–∏—Ö —Å–ø—Ä–∞—Ü—å–æ–≤—É–≤–∞–Ω—å) --- –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è $H_0$ –ø—Ä–∏ —ó—ó –¥—ñ–π—Å–Ω–æ—Å—Ç—ñ.

$FPR \leq \alpha$
:::

::::

. . .

$$FPR = 1.3\% + 0.5\% + 0.2\% + 0.1\% \approx 2.1\% < 5\%$$

## 21 vs. 20 {.smaller}

:::: {.columns}

::: {.column width="50%"}

```{python}
#| label: pmf-q-plot-21
#| echo: false

pyplot.figure(figsize=(16, 8))
pyplot.vlines(x_grid, 0, probs, linewidth=15.0, color=turquoise, label='PMF, $Binom(30, 0.5)$')
crit_reg = x_grid >= 21
pyplot.vlines(x_grid[crit_reg], 0, probs[crit_reg], linewidth=15.0, label='Critical region for S')
for i in range(19, 24, 1):
    pyplot.text(x_grid[i], probs[i], f'{probs[i] * 100:.1f}%', fontsize=12, ha='center', va='bottom')
pyplot.title('–ë—ñ–Ω–æ–º—ñ–∞–ª—å–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª, $Q \geq 21$', fontsize=20)
pyplot.xlabel('–ö—ñ–ª—å–∫—ñ—Å—Ç—å —É—Å–ø—ñ—Ö—ñ–≤', fontsize=18)
pyplot.ylabel('PMF Q \n $H_0$', fontsize=18, rotation=0, labelpad=30)
pyplot.legend(fontsize=18)
pyplot.show()
```


:::

::: {.column width="50%"}
```{python}
#| label: pmf-q-plot-20
#| echo: false

pyplot.figure(figsize=(16, 8))
pyplot.vlines(x_grid, 0, probs, linewidth=15.0, color=turquoise, label='PMF, $Binom(30, 0.5)$')
crit_reg = x_grid >= 20
pyplot.vlines(x_grid[crit_reg], 0, probs[crit_reg], linewidth=15.0, label='Critical region for S')
for i in range(19, 24, 1):
    pyplot.text(x_grid[i], probs[i], f'{probs[i] * 100:.1f}%', fontsize=12, ha='center', va='bottom')
pyplot.title('–ë—ñ–Ω–æ–º—ñ–∞–ª—å–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª, $Q \geq 20$', fontsize=20)
pyplot.xlabel('–ö—ñ–ª—å–∫—ñ—Å—Ç—å —É—Å–ø—ñ—Ö—ñ–≤', fontsize=18)
pyplot.ylabel('PMF Q \n $H_0$', fontsize=18, rotation=0, labelpad=30)
pyplot.legend(fontsize=18)
pyplot.show()
```

:::

::::

$FPR_{21} = 1.3\% + 0.5\% + 0.2\% + 0.1\% \approx 2.1\% < 5\%$

$FPR_{20} = 2.8\% + 1.3\% + 0.5\% + 0.2\% + 0.1\% \approx 4.9\% < 5\%$

. . .

::: {.callout-tip icon="false"}
## –†—ñ—à–µ–Ω–Ω—è

  - —è–∫—â–æ $Q \geq 20$: [–≤—ñ–¥—Ö–∏–ª—è—î–º–æ $H_0$]{.green}
  - —ñ–Ω–∞–∫—à–µ: [–Ω–µ –≤—ñ–¥—Ö–∏–ª—è—î–º–æ $H_0$]{.red}
:::

## –¢–æ —è–∫–µ —Ä—ñ—à–µ–Ω–Ω—è?

{{< iconify emojione department-store >}} –î–æ—Å—Ç–∞–≤–ª—è—î–º–æ —Ç–æ–≤–∞—Ä –∑ –º–∞–≥–∞–∑–∏–Ω—ñ–≤ –¥–æ –¥–æ–º—É

{{< iconify mdi courier-check >}} –í–∞—Ä—Ç—ñ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏ --- 100‚Ç¥

{{< iconify mdi courier-fast >}} –í–∞—Ä—Ç—ñ—Å—Ç—å —Ä–æ–±–æ—Ç–∏ –∫—É—Ä'—î—Ä–∞ --- 50‚Ç¥

. . .

- –ó–Ω–∞–π—à–ª–∏ 30 –∫–ª—ñ—î–Ω—Ç—ñ–≤
- 19 –æ–ø–ª–∞—Ç–∏–ª–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è

. . .

\

<center>[–í –Ω–∞—Å –Ω–µ –º–∞—î –¥–æ—Å—Ç–∞—Ç–Ω—å–æ –¥–æ–∫–∞–∑—ñ–≤, —â–æ–± –≤—ñ–¥—Ö–∏–ª—è—î–º–æ $H_0$.]{.hi}</center>

# –°—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–∏–π –∫—Ä–∏—Ç–µ—Ä—ñ–π —Ç–∞ Python {background-iframe=".01_files/libs/colored-particles/index.html"}

## –ë—ñ–Ω–æ–º—ñ–∞–ª—å–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª

1. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ $Q$ –º–∞—î –±—ñ–Ω–æ–º—ñ–∞–ª—å–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª: $Q \sim \text{Binomial}(30, 0.5)$.

```{python}
#| label: binom-pmf

from scipy.stats import binom

binom_h0 = binom(
    n=30, # –∫—ñ–ª—å–∫—ñ—Å—Ç—å –≤–∏–ø—Ä–æ–±—É–≤–∞–Ω—å
    p=0.5 # –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å —É—Å–ø—ñ—Ö—É
)
```

2. –§—É–Ω–∫—Ü—ñ—è –π–º–æ–≤—ñ—Ä–Ω–æ—Å—Ç—ñ –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ä–æ–∑–ø–æ–¥—ñ–ª—É $p_{\xi}(x)$ --- –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å —Ç–æ–≥–æ, —â–æ –≤–∏–ø–∞–¥–∫–æ–≤–∞ –≤–µ–ª–∏—á–∏–Ω–∞ $\xi$ –ø—Ä–∏–π–º–µ –∑–Ω–∞—á–µ–Ω–Ω—è $x$.

:::: {.columns}

::: {.column width="25%"}
```{python}
#| label: pmf-q-10

binom_h0.pmf(10)
```
:::

::: {.column width="25%"}
```{python}
#| label: pmf-q-15

binom_h0.pmf(15)
```
:::

::: {.column width="25%"}
```{python}
#| label: pmf-q-14

binom_h0.pmf(14)
```
:::

::: {.column width="25%"}
```{python}
#| label: pmf-q-16

binom_h0.pmf(16)
```
:::

::::

---

```{python}
#| label: pmf-q-plot-python
#| output-location: slide

import numpy as numpy

# –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞
x_grid = numpy.arange(1, 31)
# –≤–∏—Å–æ—Ç–∞ —Å—Ç–æ–≤–ø—Ü—ñ–≤ –Ω–∞ –≥—Ä–∞—Ñ—ñ–∫—É
probs = binom_h0.pmf(x_grid)

pyplot.figure(figsize=(16, 8))

# –±—É–¥—É—î–º–æ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ñ —Å—Ç–æ–≤–ø—Ü—ñ –≤—ñ–¥ 0 –¥–æ –π–º–æ–≤—ñ—Ä–Ω–æ—Å—Ç—ñ
pyplot.vlines(x_grid, 0, probs, linewidth=15.0, color='lightblue', label='PMF, $Binom(0.5, 30)$')
# –æ–∫—Ä–µ–º–æ –∑–æ–±—Ä–∞–∑–∏–º–æ –∫—Ä–∏—Ç–∏—á–Ω—É –æ–±–ª–∞—Å—Ç—å –∫—Ä–∏—Ç–µ—Ä—ñ—é
crit_reg = x_grid >= 20
pyplot.vlines(x_grid[crit_reg], 0, probs[crit_reg], linewidth=15.0, label='Critical region for S')

pyplot.title('–ë—ñ–Ω–æ–º—ñ–∞–ª—å–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª', fontsize=20)
pyplot.legend(fontsize=18)
pyplot.show()
```

## –ô–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å –∫—Ä–∏—Ç–∏—á–Ω–æ—ó –æ–±–ª–∞—Å—Ç—ñ

–†–∞—Ö—É—î–º–æ —Å—É–º—É –π–º–æ–≤—ñ—Ä–Ω–æ—Å—Ç–µ–π —É—Å–ø—ñ—Ö—ñ–≤ –≤ –∫—Ä–∏—Ç–∏—á–Ω—ñ–π –æ–±–ª–∞—Å—Ç—ñ.

```{python}
#| label: pmf-q-20

numpy.sum(probs[crit_reg])
```

\

–ê —è–∫—â–æ $Q \geq 19$?

```{python}
#| label: pmf-q-19

crit_reg = x_grid >= 19
numpy.sum(probs[crit_reg])
```

\

–¢–æ–¥—ñ –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å –ø–æ–º–∏–ª–∫–∏ –≤–∂–µ –Ω–∞–≤—ñ—Ç—å –±—ñ–ª—å—à–∞ 10%, —â–æ –∑–æ–≤—Å—ñ–º –Ω–∞–º –Ω–µ –ø—ñ–¥—Ö–æ–¥–∏—Ç—å.

## –ö—É–º—É–ª—è—Ç–∏–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è —Ä–æ–∑–ø–æ–¥—ñ–ª—É

–ö—É–º—É–ª—è—Ç–∏–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è —Ä–æ–∑–ø–æ–¥—ñ–ª—É $F_{\xi}(x) = P(\xi \leq x)$ --- –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å —Ç–æ–≥–æ, —â–æ –≤–∏–ø–∞–¥–∫–æ–≤–∞ –≤–µ–ª–∏—á–∏–Ω–∞ $\xi$ –ø—Ä–∏–π–º–µ –∑–Ω–∞—á–µ–Ω–Ω—è –Ω–µ –±—ñ–ª—å—à–µ $x$.

–£ Python —Ü–µ —Ñ—É–Ω–∫—Ü—ñ—è `cdf` (cumulative distribution function)

```{python}
#| label: cdf-q-19

binom_h0.cdf(19)
```

\

–ô–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å –æ—Ç—Ä–∏–º–∞—Ç–∏ 19 –∞–±–æ –º–µ–Ω—à–µ —É—Å–ø—ñ—Ö—ñ–≤ —É –Ω–∞—à–æ–º—É –∑–∞–≤–¥–∞–Ω–Ω—ñ $\geq 95$. –ê –æ—Å–∫—ñ–ª—å–∫–∏ $P(\xi \leq 19) + P(\xi \geq 21) = 1$, –º–æ–∂–µ–º–æ –æ–±—á–∏—Å–ª–∏—Ç–∏ —Ä—ñ–≤–µ–Ω—å –∑–Ω–∞—á—É—â–æ—Å—Ç—ñ –Ω–∞—à–æ–≥–æ –∫—Ä–∏—Ç–µ—Ä—ñ—é.

```{python}
#| label: cdf-q-one

1 - binom_h0.cdf(19)
```

## –ö–≤–∞–Ω—Ç–∏–ª—å {.smaller}

–©–æ–± –≤–∏–±—Ä–∞—Ç–∏ –∫—Ä–∏—Ç–∏—á–Ω—É –æ–±–ª–∞—Å—Ç—å –¥–ª—è –∫—Ä–∏—Ç–µ—Ä—ñ—é, –º–∏ —Ö–æ—Ç—ñ–ª–∏ –± –∑–Ω–∞–π—Ç–∏ —Ç–æ—á–∫—É, –ø–ª–æ—â–∞ —Å—Ç–æ–≤–ø—Ü—ñ–≤ –ø—Ä–∞–≤–æ—Ä—É—á –≤—ñ–¥ —è–∫–æ—ó –±—É–ª–∞ –± $5\%$. –¢–æ–±—Ç–æ –ø–ª–æ—â–∞ —Å—Ç–æ–≤–ø—Ü—ñ–≤ –ª—ñ–≤–æ—Ä—É—á --- $95\%$. –¢–∞–∫–∞ —Ç–æ—á–∫–∞ –Ω–∞–∑–∏–≤–∞—î—Ç—å—Å—è *–∫–≤–∞–Ω—Ç–∏–ª–µ–º*.
$$u_p(\xi) = \{x | F_{\xi}(x) = p\}$$

–ê–ª–µ –ø—Ä–∏ $p = 0.95$ —ñ –Ω–∞—à–æ–º—É –±—ñ–Ω–æ–º—ñ–∞–ª—å–Ω–æ–º—É —Ä–æ–∑–ø–æ–¥—ñ–ª—ñ, —Ç–∞–∫–æ—ó —Ç–æ—á–∫–∏ –Ω–µ–º–∞—î. –ú–∏ –∑'—è—Å—É–≤–∞–ª–∏, —â–æ —î —Ç–æ—á–∫–∞, –ø—Ä–∞–≤–æ—Ä—É—á –≤—ñ–¥ —è–∫–æ—ó –ø–ª–æ—â–∞ $0.494$, –∞ –≤ –Ω–∞—Å—Ç—É–ø–Ω–æ—ó –≤–∂–µ $0.1$. –©–æ–± –≤–∏–∑–Ω–∞—á–∏—Ç–∏ –∫–≤–∞–Ω—Ç–∏–ª—å —É —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É, –º–æ–¥–∏—Ñ—ñ–∫—É—î–º–æ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è:

\

–ö–≤–∞–Ω—Ç–∏–ª—å $u_p(\xi) = \{x | F_{\xi}(x) \geq p\}$ --- –≤–µ–ª–∏—á–∏–Ω–∞, —è–∫—É $\xi$ –Ω–µ –ø–µ—Ä–µ–≤–∏—â—É—î –∑ —ñ–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—é —Ö–æ—á–∞ –± $p$.

## –ö–≤–∞–Ω—Ç–∏–ª—å: –ø—Ä–∏–∫–ª–∞–¥ {.smaller}

–î–ª—è –≤–µ–ª–∏—á–∏–Ω–∏ $\xi \sim Bin(30, 0.5)$ –ø–æ—Ä–∞—Ö—É—î–º–æ $0.95$-–∫–≤–∞–Ω—Ç–∏–ª—å. –†–æ–∑–≤'—è–∂–µ–º–æ –∑–∞–≤–¥–∞–Ω–Ω—è –ø—Ä–æ—Å—Ç–æ –ø—ñ–¥–±–æ—Ä–æ–º.

:::: {.columns}

::: {.column width="50%"}
$$P(\xi \leq 18) \approx 0.9$$

$$P(\xi \leq 19) \approx 0.951$$

$$P(\xi \leq 20) \approx 0.97$$
:::

::: {.column width="50%"}

```{python}
#| label: quantile-q-95-18

binom_h0.cdf(18)
```

\

```{python}
#| label: quantile-q-95-19

binom_h0.cdf(19)
```

\

```{python}
#| label: quantile-q-95-20

binom_h0.cdf(20)
```
:::

::::

\

–£ Python –∫–≤–∞–Ω—Ç–∏–ª—å –º–æ–∂–Ω–∞ –ø–æ—Ä–∞—Ö—É–≤–∞—Ç–∏ —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü—ñ—é `ppf` (*percent point function*)

```{python}
#| label: quantile-q-95

binom_h0.ppf(0.95)
```

## –í–ª–∞—Å–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è –∫—Ä–∏—Ç–µ—Ä—ñ—é {.smaller}

:::: {.columns}

::: {.column width="50%"}
–Ø–∫ —Ç–µ–ø–µ—Ä –ø—ñ–¥—ñ–±—Ä–∞—Ç–∏ $C$ –¥–ª—è –±—É–¥—å-—è–∫–∏—Ö $n, \mu$ —Ç–∞ –±—É–¥—å-—è–∫–æ–≥–æ —Ä—ñ–≤–Ω—è –∑–Ω–∞—á—É—â–æ—Å—Ç—ñ $\alpha$?

1. –ü–æ—Ç—Ä—ñ–±–Ω–æ –∑–Ω–∞–π—Ç–∏ $C$, —Ç–∞–∫–µ —â–æ $P(Q \geq C) \leq \alpha$.
2. –¢–æ–±—Ç–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ $P(Q < C) \geq 1 - \alpha$
3. $Q$ –ø—Ä–∏–π–º–∞—î —Ç—ñ–ª—å–∫–∏ —Ü—ñ–ª—ñ –∑–Ω–∞—á–µ–Ω–Ω—è: $P(Q \leq C - 1) \geq 1 - \alpha$, –∞–±–æ $P(Q \leq C) \geq 1 - \alpha$. 
4. –û—Ç–∂–µ, –∑ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –∫–≤–∞–Ω—Ç–∏–ª—ñ, $C - 1 = u_{1 - \alpha}$
5. –ó–Ω–∞—á–∏—Ç—å $C = u_{1 - \alpha} + 1$ 
:::

::: {.column width="50%" .fragment}

```{python}
#| label: custom-crit

def make_binom_criterion(n, mu=0.5, alpha=0.05):
    '''–ë—É–¥—É—î –∫—Ä–∏—Ç–µ—Ä—ñ–π –¥–ª—è –∑–∞–¥–∞—á—ñ –∑ –¥–æ—Å—Ç–∞–≤–∫–æ—é
    
    –ü–∞—Ä–∞–º–µ—Ç—Ä–∏:
        n: –∫—ñ–ª—å–∫—ñ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–æ–∫ –≤ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ñ
        mu: –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å —É—Å–ø—ñ—Ö—É –≤ –Ω—É–ª—å–æ–≤—ñ–π –≥—ñ–ø–æ—Ç–µ–∑—ñ
        alpha: —Ä—ñ–≤–µ–Ω—å –∑–Ω–∞—á—É—â–æ—Å—Ç—ñ –∫—Ä–∏—Ç–µ—Ä—ñ—é
        
    –ü–æ–≤–µ—Ä—Ç–∞—î:
        C –¥–ª—è –∫—Ä–∏—Ç–µ—Ä—ñ—é S = {Q >= C}
    '''
    binom_h0 = binom(n=n, p=mu)
    q = binom_h0.ppf(1 - alpha)
    return q + 1
```
:::

::::

## –í–ª–∞—Å–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è –∫—Ä–∏—Ç–µ—Ä—ñ—é: –ø—Ä–∏–∫–ª–∞–¥

:::: {.columns}

::: {.column width="50%"}
```{python}
#| label: custom-crit-eval
#| eval: false

def make_binom_criterion(n, mu=0.5, alpha=0.05):
    '''–ë—É–¥—É—î –∫—Ä–∏—Ç–µ—Ä—ñ–π –¥–ª—è –∑–∞–¥–∞—á—ñ –∑ –¥–æ—Å—Ç–∞–≤–∫–æ—é
    
    –ü–∞—Ä–∞–º–µ—Ç—Ä–∏:
        n: –∫—ñ–ª—å–∫—ñ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–æ–∫ –≤ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ñ
        mu: –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å —É—Å–ø—ñ—Ö—É –≤ –Ω—É–ª—å–æ–≤—ñ–π –≥—ñ–ø–æ—Ç–µ–∑—ñ
        alpha: —Ä—ñ–≤–µ–Ω—å –∑–Ω–∞—á—É—â–æ—Å—Ç—ñ –∫—Ä–∏—Ç–µ—Ä—ñ—é
        
    –ü–æ–≤–µ—Ä—Ç–∞—î:
        C –¥–ª—è –∫—Ä–∏—Ç–µ—Ä—ñ—é S = {Q >= C}
    '''
    binom_h0 = binom(n=n, p=mu)
    q = binom_h0.ppf(1 - alpha)
    return q + 1
```
:::

::: {.column width="50%"}

```{python}
#| label: custom-crit-func

print(r'–Ø–∫—â–æ Q >=', make_binom_criterion(
    n=30,
    mu=0.5,
    alpha=0.05
), '—Ç–æ–¥—ñ –≤—ñ–¥—Ö–∏–ª—è—î–º–æ H0')
```
:::

::::

\

–ö—Ä–∏—Ç–∏—á–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è $C = 20$, —Ç–æ–¥—ñ –∫—Ä–∏—Ç–µ—Ä—ñ–π –≤–∏–≥–ª—è–¥–∞—î —Ç–∞–∫:

$$S = \{Q \geq 20\}$$

## –î–æ–¥–∞—Ç–∫–æ–≤–∏–π –ø—Ä–∏–∫–ª–∞–¥

- –ö—ñ–ª—å–∫—ñ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–æ–∫ --- 50
- –î–æ—Å—Ç–∞—Ç–Ω—è –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å —É—Å–ø—ñ—Ö—É --- 0.1, —Ç–æ–±—Ç–æ —è–∫—â–æ —Ä–æ–±–æ—Ç–∞ –∫—É—Ä'—î—Ä–∞ –∫–æ—à—Ç—É—î 100‚Ç¥, —Ç–æ –≤–∞—Ä—Ç—ñ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏ --- 1000‚Ç¥

```{python}
#| label: binom-50

binom_h0 = binom(
    n=50, # –∫—ñ–ª—å–∫—ñ—Å—Ç—å –≤–∏–ø—Ä–æ–±—É–≤–∞–Ω—å
    p=0.1 # –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å —É—Å–ø—ñ—Ö—É
)

numpy.random.seed(2024)

for _ in range(3):
    print(binom_h0.rvs(1))
```

---



```{python}
#| label: binom-50-plot
#| echo: false

# –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞
x_grid = numpy.arange(1, 31)
probs = binom_h0.pmf(x_grid)
pyplot.figure(figsize=(16, 8))
pyplot.vlines(x_grid, 0, probs, linewidth=15.0, color='lightblue', label='PMF, $Binom(0.1, 50)$')
pyplot.title('–ë—ñ–Ω–æ–º—ñ–∞–ª—å–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª', fontsize=20)
pyplot.legend(fontsize=18)
pyplot.show()
```

---

::: {.tiny}

```{python}
#| label: custom-crit-func-50

print(r'–Ø–∫—â–æ Q >=', make_binom_criterion(
    n=50,
    mu=0.1,
    alpha=0.05
), '—Ç–æ–¥—ñ –≤—ñ–¥—Ö–∏–ª—è—î–º–æ H0')
```


```{python}
#| label: custom-crit-func-50-plot
#| echo: false
#| fig-align: center

# –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞
x_grid = numpy.arange(1, 31)
# –≤–∏—Å–æ—Ç–∞ —Å—Ç–æ–≤–ø—Ü—ñ–≤ –Ω–∞ –≥—Ä–∞—Ñ—ñ–∫—É
probs = binom_h0.pmf(x_grid)

pyplot.figure(figsize=(10, 6))

# –±—É–¥—É—î–º–æ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ñ —Å—Ç–æ–≤–ø—Ü—ñ –≤—ñ–¥ 0 –¥–æ –π–º–æ–≤—ñ—Ä–Ω–æ—Å—Ç—ñ
pyplot.vlines(x_grid, 0, probs, linewidth=15.0, color=turquoise, label='PMF, $Binom(50, 0.1)$')
# –æ–∫—Ä–µ–º–æ –∑–æ–±—Ä–∞–∑–∏–º–æ –∫—Ä–∏—Ç–∏—á–Ω—É –æ–±–ª–∞—Å—Ç—å –∫—Ä–∏—Ç–µ—Ä—ñ—é
crit_reg = x_grid >= 10
pyplot.vlines(x_grid[crit_reg], 0, probs[crit_reg], linewidth=15.0, label='Critical region for S')
# –¥–æ–¥–∞–º–æ –≤—ñ–¥—Å–æ—Ç–æ–∫ –¥–æ –∫–æ–∂–Ω–æ–≥–æ —Å—Ç–æ–≤–ø—Ü—è
for i in range(8, 13, 1):
    pyplot.text(x_grid[i], probs[i], f'{probs[i] * 100:.1f}%', fontsize=12, ha='center', va='bottom')
pyplot.title('–ë—ñ–Ω–æ–º—ñ–∞–ª—å–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª', fontsize=20)
pyplot.xlabel('–ö—ñ–ª—å–∫—ñ—Å—Ç—å —É—Å–ø—ñ—Ö—ñ–≤', fontsize=18)
pyplot.ylabel('PMF Q \n $H_0$', fontsize=18, rotation=0, labelpad=30)
pyplot.legend(fontsize=18)
pyplot.show()
```


```{python}
#| label: custom-crit-func-50-FPR

numpy.sum(probs[crit_reg])
```

:::

# $p$-–∑–Ω–∞—á–µ–Ω–Ω—è {background-iframe=".01_files/libs/colored-particles/index.html"}

## $p$-–∑–Ω–∞—á–µ–Ω–Ω—è {.smaller}

$p$-–∑–Ω–∞—á–µ–Ω–Ω—è (*$p$-value*) --- –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å –æ—Ç—Ä–∏–º–∞—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç, —è–∫–∏–π –±—ñ–ª—å—à –µ–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω–∏–π, –Ω—ñ–∂ –Ω–∞—à—ñ —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è, –ø—Ä–∏ —É–º–æ–≤—ñ, —â–æ –Ω—É–ª—å–æ–≤–∞ –≥—ñ–ø–æ—Ç–µ–∑–∞ $H_0$ —Å–ø—Ä–∞–≤–¥–∂—É—î—Ç—å—Å—è.


:::: {.columns}

::: {.column width="40%"}
```{mermaid}
%%| echo: false
%%| label: mermaid-binom

graph TD
    A["n = 30 \n H0: Œº = 0.5 \n H1: Œº > 0.5 \n Œ± = 0.05"] --> B["–Ø–∫—â–æ Q >= 20: \n –≤—ñ–¥—Ö–∏–ª—è—î–º–æ H0"]

```
:::

::: {.column width="60%" .fragment}

```{python}
#| label: p-value-new
#| echo: false

binom_h0 = binom(
    n=30, # –∫—ñ–ª—å–∫—ñ—Å—Ç—å –≤–∏–ø—Ä–æ–±—É–≤–∞–Ω—å
    p=0.5 # –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å —É—Å–ø—ñ—Ö—É
)

# –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞
x_grid = numpy.arange(1, 31)
# –≤–∏—Å–æ—Ç–∞ —Å—Ç–æ–≤–ø—Ü—ñ–≤ –Ω–∞ –≥—Ä–∞—Ñ—ñ–∫—É
probs = binom_h0.pmf(x_grid)

pyplot.figure(figsize=(16, 8))

# –±—É–¥—É—î–º–æ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ñ —Å—Ç–æ–≤–ø—Ü—ñ –≤—ñ–¥ 0 –¥–æ –π–º–æ–≤—ñ—Ä–Ω–æ—Å—Ç—ñ
pyplot.vlines(x_grid, 0, probs, linewidth=15.0, color=turquoise, label='PMF, $Binom(30, 0.5)$')
# –æ–∫—Ä–µ–º–æ –∑–æ–±—Ä–∞–∑–∏–º–æ –∫—Ä–∏—Ç–∏—á–Ω—É –æ–±–ª–∞—Å—Ç—å –∫—Ä–∏—Ç–µ—Ä—ñ—é
crit_reg = x_grid >= 20
pyplot.vlines(x_grid[17], 0, probs[17], linewidth=15.0, label='–ù–æ–≤–µ –∑–Ω–∞—á–µ–Ω–Ω—è $Q = 17$')
pyplot.vlines(x_grid[crit_reg], 0, probs[crit_reg], linewidth=15.0, label='Critical region for S', colors=red)
pyplot.title('–ë—ñ–Ω–æ–º—ñ–∞–ª—å–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª', fontsize=20)
pyplot.xlabel('–ö—ñ–ª—å–∫—ñ—Å—Ç—å —É—Å–ø—ñ—Ö—ñ–≤', fontsize=18)
pyplot.ylabel('PMF Q \n $H_0$', fontsize=18, rotation=0, labelpad=30)
pyplot.legend(fontsize=18)
pyplot.show()
```

:::

::::

. . .


- $p > \alpha \equiv$ $q$ –ø–æ–∑–∞ –∫—Ä–∏—Ç–∏—á–Ω–æ—é –æ–±–ª–∞—Å—Ç—é $\equiv$ –Ω–µ –≤—ñ–¥—Ö–∏–ª—è—î–º–æ $H_0$.
- $p \leq \alpha \equiv$ $q$ –≤ –∫—Ä–∏—Ç–∏—á–Ω—ñ–π –æ–±–ª–∞—Å—Ç—ñ $\equiv$ –≤—ñ–¥—Ö–∏–ª—è—î–º–æ $H_0$.

---



::: {.callout-important icon="false"}
## –°—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–∏–π –∫—Ä–∏—Ç–µ—Ä—ñ–π –¥–ª—è –≤—Å—ñ—Ö!
<center>–Ø–∫—â–æ $p$-–∑–Ω–∞—á–µ–Ω–Ω—è $\leq \alpha$: –≤—ñ–¥—Ö–∏–ª—è—î–º–æ $H_0$.<br><br> –Ü–Ω–∞–∫—à–µ: –Ω–µ –≤—ñ–¥—Ö–∏–ª—è—î–º–æ $H_0$.</center>
:::

---

```{python}
#| label: p-value-calc
#| echo: false

C = 20 # –∫—Ä–∏—Ç–∏—á–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è
qs = [10, 19, 20, 23] # —Ä—ñ–∑–Ω—ñ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

fig, axes = pyplot.subplots(2, 2, figsize=(16, 8))

for q, ax in zip(qs, axes.flatten()):
    ax.set_title(f'$q = {q}$' + ('[–Ω–∞—à –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç]' if q == 19 else ''))
    # –±—É–¥—É—î–º–æ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ñ —Å—Ç–æ–≤–ø—Ü—ñ –≤—ñ–¥ 0 –¥–æ –π–º–æ–≤—ñ—Ä–Ω–æ—Å—Ç—ñ
    ax.vlines(x_grid, 0, probs, linewidth=8.0, color=turquoise, label='PMF, $Binom(0.5, 30)$')
    # –æ–∫—Ä–µ–º–æ –∑–æ–±—Ä–∞–∑–∏–º–æ –∫—Ä–∏—Ç–∏—á–Ω—É –æ–±–ª–∞—Å—Ç—å –∫—Ä–∏—Ç–µ—Ä—ñ—é
    crit_reg = x_grid >= 20
    ax.vlines(x_grid[crit_reg], 0, probs[crit_reg], linewidth=8.0, label='Critical region for S')

    # –ø–æ—Ä–∞—Ö—É—î–º–æ –ø–ª–æ—â—É –±—ñ–ª—å—à –µ–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å
    pvalue = 1 - binom_h0.cdf(q - 1)
    # –∑–æ–±—Ä–∞–∑–∏–º–æ —Ç–∞–∫—ñ –∂ —ñ –±—ñ–ª—å—à –µ–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –Ω–∞ –≥—Ä–∞—Ñ—ñ–∫—É
    more_extremal = x_grid >= q
    ax.vlines(
        x_grid[more_extremal], 0, probs[more_extremal], linewidth=3.0, color='red',
        label='q –∞–±–æ –±—ñ–ª—å—à –µ–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è pvalue: {:.3f}'.format(pvalue)
    )
    ax.text(x_grid[q-1], probs[q-1], f'{q}', fontsize=12, ha='center', va='bottom')
    ax.legend()

pyplot.suptitle('P-–∑–Ω–∞—á–µ–Ω–Ω—è –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö q', fontsize=20)
pyplot.show()
```

## $p$-–∑–Ω–∞—á–µ–Ω–Ω—è –≤ Python {.smaller}

```{python}
#| label: deff-p-value

def pvalue_binom(n, mu, q):
    '''–û–±—á–∏—Å–ª—é—î p-–∑–Ω–∞—á–µ–Ω–Ω—è –¥–ª—è –±—ñ–Ω–æ–º—ñ–∞–ª—å–Ω–æ–≥–æ —Ä–æ–∑–ø–æ–¥—ñ–ª—É (–¥–æ—Å—Ç–∞–≤–∫–∞)
    
    –ü–∞—Ä–∞–º–µ—Ç—Ä–∏:
        n: –∫—ñ–ª—å–∫—ñ—Å—Ç—å –≤–∏–ø—Ä–æ–±—É–≤–∞–Ω—å
        mu: –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å —É—Å–ø—ñ—Ö—É –≤ –Ω—É–ª—å–æ–≤—ñ–π –≥—ñ–ø–æ—Ç–µ–∑—ñ
        q: –∫—ñ–ª—å–∫—ñ—Å—Ç—å —É—Å–ø—ñ—Ö—ñ–≤
            
    –ü–æ–≤–µ—Ä—Ç–∞—î:
        p-–∑–Ω–∞—á–µ–Ω–Ω—è
    '''
    binom_h0 = binom(n=n, p=mu)
    return 1 - binom_h0.cdf(q - 1)
```

\

```{python}
#| label: p-value-calc-2

print(f'p-–∑–Ω–∞—á–µ–Ω–Ω—è = {pvalue_binom(30, 0.5, 19):.3f} {"<= 0.05" if pvalue_binom(30, 0.5, 19) <= 0.05 else ">= 0.05"}')
```

\

```{python}
#| label: p-value-calc-3

print(f'p-–∑–Ω–∞—á–µ–Ω–Ω—è = {pvalue_binom(50, 0.1, 11):.3f} {"<= 0.05" if pvalue_binom(50, 0.1, 11) <= 0.05 else ">= 0.05"}')
```

# –î–≤–æ—Å—Ç–æ—Ä–æ–Ω–Ω—ñ–π –∫—Ä–∏—Ç–µ—Ä—ñ–π {background-iframe=".01_files/libs/colored-particles/index.html"}

## –î–≤–æ—Å—Ç–æ—Ä–æ–Ω–Ω—ñ–π –∫—Ä–∏—Ç–µ—Ä—ñ–π

:::: {.columns}

::: {.column width="60%"}
–ß–∏ –≤–ø–ª–∏–≤–∞—î –∫–æ–ª—ñ—Ä –∞–≤—Ç–æ –Ω–∞ –¥–æ—Ç—Ä–∏–º–∞–Ω–Ω—è –ü–î–†?
:::

::: {.column width="40%"}
- $Q = \xi_1 + \xi_2 + \ldots + \xi_{n}$
- $H_0: \mu = 0.5$
- [$H_1: \mu \neq 0.5$]{.hi}
- $\alpha = 0.05$
:::

::::

:::: {.columns}

::: {.column width="50%"}
```{python}
#| label: binom-two-sided
#| echo: false
#| fig-align: center

C = 6

pyplot.figure(figsize=(16, 8))

# —Å—Ç—Ä–æ–∏–º –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ —Å—Ç–æ–ª–±—Ü—ã –æ—Ç 0 –¥–æ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏
pyplot.vlines(x_grid, 0, probs, linewidth=15.0, color='turquoise', label='PMF, $Binom(0.5, 30)$')
# –æ—Ç–¥–µ–ª—å–Ω–æ –∏–∑–æ–±—Ä–∞–∑–∏–º –∫—Ä–∏—Ç–∏—á–µ—Å–∫—É—é –æ–±–ª–∞—Å—Ç–∏ –∫—Ä–∏—Ç–µ—Ä–∏—è
crit_reg = numpy.abs(x_grid - 15) >= C
pyplot.vlines(x_grid[crit_reg], 0, probs[crit_reg], linewidth=15.0, label='Critical region for S')

rejection_prob = probs[crit_reg].sum()
pyplot.text(x_grid[20], probs[20], f'21', fontsize=12, ha='center', va='bottom')
pyplot.text(x_grid[8], probs[8], f'9', fontsize=12, ha='center', va='bottom')
# pyplot.title('Two-sided criteria, C = {}, critical region proba = {:.3f}'.format(C, rejection_prob), fontsize=20)
pyplot.legend(fontsize=18)
pyplot.show()
```
:::

::: {.column width="50%"}
–Ø–∫—â–æ $q \geq 21$ –∞–±–æ $q \leq 9$, —Ç–æ –≤—ñ–¥—Ö–∏–ª—è—î–º–æ $H_0$.
:::

::::

<!-- ## –ö—Ä–∏—Ç–∏—á–Ω–∞ –æ–±–ª–∞—Å—Ç—å {.smaller}

```{python}
#| label: binom-two-sided-2
#| echo: false
#| fig-align: center

C = 6

pyplot.figure(figsize=(16, 8))

# —Å—Ç—Ä–æ–∏–º –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ —Å—Ç–æ–ª–±—Ü—ã –æ—Ç 0 –¥–æ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏
pyplot.vlines(x_grid, 0, probs, linewidth=15.0, color='turquoise', label='PMF, $Binom(0.5, 30)$')
# –æ—Ç–¥–µ–ª—å–Ω–æ –∏–∑–æ–±—Ä–∞–∑–∏–º –∫—Ä–∏—Ç–∏—á–µ—Å–∫—É—é –æ–±–ª–∞—Å—Ç–∏ –∫—Ä–∏—Ç–µ—Ä–∏—è
crit_reg = numpy.abs(x_grid - 15) >= C
pyplot.vlines(x_grid[crit_reg], 0, probs[crit_reg], linewidth=15.0, label='Critical region for S')

rejection_prob = probs[crit_reg].sum()
pyplot.text(x_grid[20], probs[20], f'21', fontsize=12, ha='center', va='bottom')
pyplot.text(x_grid[8], probs[8], f'9', fontsize=12, ha='center', va='bottom')
# pyplot.title('Two-sided criteria, C = {}, critical region proba = {:.3f}'.format(C, rejection_prob), fontsize=20)
pyplot.legend(fontsize=18)
pyplot.show()
```

–ó –∫–∞—Ä—Ç–∏–Ω–∫–∏ –≤–∏–¥–Ω–æ, —â–æ —è–∫—â–æ —Ç–µ–ø–µ—Ä –≤—ñ–¥–∫–∏–¥–∞—Ç–∏ –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è –ø—Ä–∏ $q \geq 21$, —Ç–æ–¥—ñ —Ç—Ä–µ–±–∞ –≤—ñ–¥—Ö–∏–ª—è—Ç–∏ —ñ –ø—Ä–∏ $q \leq 9$, –∞ –æ—Ç–∂–µ –∑–∞–≥–∞–ª—å–Ω–∞ –ø–ª–æ—â–∞ —Å—Ç–æ–≤–ø—Ü—ñ–≤ –±—É–¥–µ –≤–∂–µ –ø—Ä–∏–±–ª–∏–∑–Ω–æ $0.1$. -->

## $p$-–∑–Ω–∞—á–µ–Ω–Ω—è –¥–ª—è –¥–≤–æ—Å—Ç–æ—Ä–æ–Ω–Ω—å–æ–≥–æ –∫—Ä–∏—Ç–µ—Ä—ñ—é {.smaller}

–ö—Ä–∏—Ç–µ—Ä—ñ–π –º–∞—î –≤–∏–≥–ª—è–¥ $$S = \{|Q(\xi) - 15|\ \geq C\}$$

```{python}
#| label: p-value-two-sided-def

def pvalue_two_sided_sum(n, q):
    '''–û–±—á–∏—Å–ª—é—î pvalue –¥–ª—è –∑–∞–¥–∞—á—ñ –∑ –¥–æ—Å—Ç–∞–≤–∫–æ—é –¥–ª—è mu = 0.5 —ñ –¥–≤–æ—Å—Ç–æ—Ä–æ–Ω–Ω—å–æ—ó –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∏
    
    –ü–∞—Ä–∞–º–µ—Ç—Ä–∏:
        n: –∫—ñ–ª—å–∫—ñ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–æ–∫ –≤ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ñ
        q: –∫—ñ–ª—å–∫—ñ—Å—Ç—å —É—Å–ø—ñ—à–Ω–∏—Ö –¥–æ—Å—Ç–∞–≤–æ–∫
        
    –ü–æ–≤–µ—Ä—Ç–∞—î:
        pvalue –¥–ª—è –∫—Ä–∏—Ç–µ—Ä—ñ—é S = {|Q - 15| >= C}
    '''
    binom_h0 = binom(n=n, p=0.5)
    diff = numpy.abs(q - 15)
    # –¥–∏–≤–∏–º–æ—Å—è –±—ñ–ª—å—à –µ–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ñ –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è –∑ –ø—Ä–∞–≤–æ–≥–æ –±–æ–∫—É
    right_sq = 1 - binom_h0.cdf(15 + diff - 1)
    # –¥–∏–≤–∏–º–æ—Å—è –±—ñ–ª—å—à –µ–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ñ –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è –∑ –ª—ñ–≤–æ–≥–æ –±–æ–∫—É
    left_sq = binom_h0.cdf(15 - diff)
    return left_sq + right_sq # –∞–±–æ –ø—Ä–æ—Å—Ç–æ 2 * right_sq –¥–ª—è —Å–∏–º–µ—Ç—Ä–∏—á–Ω–æ–≥–æ —Ä–æ–∑–ø–æ–¥—ñ–ª—É
```

\

```{python}
#| label: p-value-two-sided-calc

pvalue_two_sided_sum(30, 21)
```

## –ù–µ—Å–∏–º–µ—Ç—Ä–∏—á–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª {.smaller}

```{python}
#| label: binom-asym

binom_h0_nonsym = binom(
    n=30, # –∫—ñ–ª—å–∫—ñ—Å—Ç—å –≤–∏–ø—Ä–æ–±—É–≤–∞–Ω—å
    p=0.8 # –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å —É—Å–ø—ñ—Ö—É
)
```

```{python}
#| label: binom-asym-plot
#| echo: false
#| fig-align: center

pyplot.figure(figsize=(16, 8))

# —Ä–∞—Ö—É—î–º–æ –π–º–æ–≤—ñ—Ä–Ω–æ—Å—Ç—ñ –∑–Ω–∞—á–µ–Ω—å —Å—É–º–∏
probs = binom_h0_nonsym.pmf(x_grid)
# –±—É–¥—É—î–º–æ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ñ —Å—Ç–æ–≤–ø—Ü—ñ –≤—ñ–¥ 0 –¥–æ –π–º–æ–≤—ñ—Ä–Ω–æ—Å—Ç—ñ
pyplot.vlines(x_grid, 0, probs, linewidth=15.0, color=turquoise, label='PMF, $Binom(0.8, 30)$')

pyplot.title('–ë—ñ–Ω–æ–º—ñ–∞–ª—å–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª', fontsize=20)
pyplot.legend(fontsize=18)
pyplot.show()
```

–î–ª—è —Ç–æ–≥–æ, —â–æ–± –ø–æ–±—É–¥—É–≤–∞—Ç–∏ –¥–≤–æ—Å—Ç–æ—Ä–æ–Ω–Ω—ñ–π –∫—Ä–∏—Ç–µ—Ä—ñ–π, –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–Ω–∞–π—Ç–∏ –ª—ñ–≤–æ—Ä—É—á —Ç–∞ –ø—Ä–∞–≤–æ—Ä—É—á –æ–±–ª–∞—Å—Ç—ñ, –ø–ª–æ—â–∞ —è–∫–∏—Ö —Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–µ –±—ñ–ª—å—à–µ, –Ω—ñ–∂ $\frac{\alpha}{2}$.

<!-- $$P(Q(\xi) \leq C) \leq \frac{\alpha}{2}$$ -->

## –ù–µ—Å–∏–º–µ—Ç—Ä–∏—á–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª: –∫—Ä–∏—Ç–∏—á–Ω–∞ –æ–±–ª–∞—Å—Ç—å

```{python}
#| label: binom-asym-crit

def two_sided_criterion_nonsym(n, mu, alpha):
    '''–ë—É–¥—É—î –¥–≤–æ—Å—Ç–æ—Ä–æ–Ω–Ω—ñ–π –∫—Ä–∏—Ç–µ—Ä—ñ–π –¥–ª—è –Ω–µ—Å–∏–º–µ—Ç—Ä–∏—á–Ω–æ—ó –∑–∞–¥–∞—á—ñ –∑ –¥–æ—Å—Ç–∞–≤–∫–æ—é
    
    –ü–∞—Ä–∞–º–µ—Ç—Ä–∏:
        n: –∫—ñ–ª—å–∫—ñ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–æ–∫ –≤ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ñ
        mu: —ñ–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å —É—Å–ø—ñ—Ö—É –≤ –Ω—É–ª—å–æ–≤—ñ–π –≥—ñ–ø–æ—Ç–µ–∑—ñ
        alpha: —Ä—ñ–≤–µ–Ω—å –∑–Ω–∞—á—É—â–æ—Å—Ç—ñ –∫—Ä–∏—Ç–µ—Ä—ñ—é
        
    –ü–æ–≤–µ—Ä—Ç–∞—î:
        C1, C2 –¥–ª—è –∫—Ä–∏—Ç–µ—Ä—ñ—é S = {Q <= C1 –∞–±–æ Q >= C2}
    '''
    binom_h0 = binom(n=n, p=mu)
    
    # –∞–Ω–∞–ª–æ–≥—ñ—á–Ω–æ –æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω—å–æ–º—É –∫—Ä–∏—Ç–µ—Ä—ñ—é
    c2 = binom_h0.ppf(1 - alpha/2) + 1
        
    # –∑–∞ –≤–∏–∫–ª–∞–¥–∫–∞–º–∏ –≤–∏—â–µ
    c1 = binom_h0.ppf(alpha/2) - 1
    
    return c1, c2
```

\

```{python}
#| label: binom-asym-crit-calc

c1, c2 = two_sided_criterion_nonsym(30, 0.8, 0.05)
c1, c2
```

## –ù–µ—Å–∏–º–µ—Ç—Ä–∏—á–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª: –∫—Ä–∏—Ç–µ—Ä—ñ–π {.smaller}

–û—Ç–∂–µ, –Ω–∞—à –∫—Ä–∏—Ç–µ—Ä—ñ–π –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –≥—ñ–ø–æ—Ç–µ–∑–∏

$$H_0: \mu = 0.8$$
$$H_1: \mu \neq 0.8$$

–≤–∏–≥–ª—è–¥–∞—î —Ç–∞–∫:

$$S = \{Q(\xi) \leq 18\} \cup \{Q(\xi) \geq 29\}$$

```{python}
#| label: binom-asym-crit-plot
#| echo: false
#| fig-align: center

pyplot.figure(figsize=(16, 8))

# —Ä–∞—Ö—É—î–º–æ –π–º–æ–≤—ñ—Ä–Ω–æ—Å—Ç—ñ –∑–Ω–∞—á–µ–Ω—å —Å—É–º–∏
probs = binom_h0_nonsym.pmf(x_grid)
# –±—É–¥—É—î–º–æ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ñ —Å—Ç–æ–≤–ø—Ü—ñ –≤—ñ–¥ 0 –¥–æ –π–º–æ–≤—ñ—Ä–Ω–æ—Å—Ç—ñ
pyplot.vlines(x_grid, 0, probs, linewidth=15.0, color=turquoise, label='PMF, $Binom(0.5, 30)$')
# –æ–∫—Ä–µ–º–æ –∑–æ–±—Ä–∞–∑–∏–º–æ –∫—Ä–∏—Ç–∏—á–Ω—É –æ–±–ª–∞—Å—Ç—å –∫—Ä–∏—Ç–µ—Ä—ñ—é
crit_reg = (x_grid >= 29) | (x_grid <= 18)
pyplot.vlines(x_grid[crit_reg], 0, probs[crit_reg], linewidth=15.0, label='Critical region for S')

pyplot.title('–ë—ñ–Ω–æ–º—ñ–∞–ª—å–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª', fontsize=20)
pyplot.legend(fontsize=18, loc='upper left')
pyplot.show()
```

## –ù–µ—Å–∏–º–µ—Ç—Ä–∏—á–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª: $p$-–∑–Ω–∞—á–µ–Ω–Ω—è {.smaller}

–¶–µ–π –∫—Ä–∏—Ç–µ—Ä—ñ–π --- –æ–±'—î–¥–Ω–∞–Ω–Ω—è –¥–≤–æ—Ö –∫—Ä–∏—Ç–µ—Ä—ñ—ó–≤ —Ä—ñ–≤–Ω—è –∑–Ω–∞—á—É—â–æ—Å—Ç—ñ $\frac{\alpha}{2}$, –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –∑ —è–∫–∏—Ö –º–æ–∂–Ω–∞ –ø–æ—Ä–∞—Ö—É–≤–∞—Ç–∏ $p$-–∑–Ω–∞—á–µ–Ω–Ω—è. 

–ü–æ–∑–Ω–∞—á–∏–º–æ —ó—Ö —è–∫ $p_1, p_2$. 

–ü–µ—Ä—à–∏–π –∫—Ä–∏—Ç–µ—Ä—ñ–π –≤—ñ–¥–∫–∏–¥–∞—î—Ç—å—Å—è –ø—Ä–∏ $p_1 \leqslant \frac{\alpha}{2}$, –¥—Ä—É–≥–∏–π –ø—Ä–∏ $p_2 \leqslant \frac{\alpha}{2}$.

–ê –Ω–∞—à –æ–±'—î–¥–Ω–∞–Ω–∏–π, –∫–æ–ª–∏ –≤–∏–∫–æ–Ω–∞–Ω–æ –æ–¥–Ω—É –∑ —Ü–∏—Ö —É–º–æ–≤, —Ç–æ–±—Ç–æ

$$ 2p_1 \leqslant \alpha \vee 2p_2 \leqslant \alpha \Leftrightarrow 2 \cdot \min(p_1, p_2) \leqslant \alpha $$

## –ù–µ—Å–∏–º–µ—Ç—Ä–∏—á–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª: $p$-–∑–Ω–∞—á–µ–Ω–Ω—è Python {.smaller}

```{python}
#| label: p-value-asym-def

def pvalue_two_sided(n, q, mu=0.5):
    '''–û–±—á–∏—Å–ª—é—î pvalue –¥–ª—è –¥–≤–æ—Å—Ç–æ—Ä–æ–Ω–Ω—å–æ—ó –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∏ –≤ –∑–∞–¥–∞—á—ñ –∑ –¥–æ—Å—Ç–∞–≤–∫–æ—é
    
    –ü–∞—Ä–∞–º–µ—Ç—Ä–∏:
        n: –∫—ñ–ª—å–∫—ñ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–æ–∫ –≤ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ñ
        q: –∫—ñ–ª—å–∫—ñ—Å—Ç—å —É—Å–ø—ñ—à–Ω–∏—Ö –¥–æ—Å—Ç–∞–≤–æ–∫
        mu: –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å —É—Å–ø—ñ—Ö—É –ø—Ä–∏ H0
        
    –ü–æ–≤–µ—Ä—Ç–∞—î:
        pvalue –¥–ª—è –¥–≤–æ—Å—Ç–æ—Ä–æ–Ω–Ω—å–æ–≥–æ –∫—Ä–∏—Ç–µ—Ä—ñ—é
    '''
    binom_h0 = binom(n=n, p=mu)
    # —Ä–∞—Ö—É—î–º–æ –¥–ª—è –ª—ñ–≤–æ—ó —á–∞—Å—Ç–∏–Ω–∏
    pvalue_left = binom_h0.cdf(q)
    # —Ä–∞—Ö—É—î–º–æ –¥–ª—è –ø—Ä–∞–≤–æ—ó —á–∞—Å—Ç–∏–Ω–∏
    pvalue_right = 1 - binom_h0.cdf(q - 1)
    # –æ–±—á–∏—Å–ª—é—î–º–æ —Ñ–æ—Ä–º—É–ª—É
    return 2 * min(pvalue_left, pvalue_right)
```

\

```{python}
#| label: p-value-asym-calc

pvalue_two_sided(n=30, q=28, mu=0.8)
```

–í–∏–¥–Ω–æ, —â–æ $p$-–∑–Ω–∞—á–µ–Ω–Ω—è $> 0.05$, –æ—Ç–∂–µ, –Ω–∞ —Ä—ñ–≤–Ω—ñ –∑–Ω–∞—á—É—â–æ—Å—Ç—ñ $0.05$ –Ω–∞–≤—ñ—Ç—å $28$ —É—Å–ø—ñ—Ö—ñ–≤ –Ω–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ, —â–æ–± –≤—ñ–¥–∫–∏–Ω—É—Ç–∏ –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å —É—Å–ø—ñ—Ö—É –≤ $80\%$.

# –î—è–∫—É—é –∑–∞ —É–≤–∞–≥—É! {.unnumbered .unlisted background-iframe=".01_files/libs/colored-particles/index.html"}

<br> <br>

{{< iconify solar book-bold >}} [–ú–∞—Ç–µ—Ä—ñ–∞–ª–∏ –∫—É—Ä—Å—É](https://aranaur.rbind.io/lectures/asa/)

{{< iconify mdi envelope >}} ihor.miroshnychenko\@knu.ua

{{< iconify ic baseline-telegram >}} [Data Mirosh](https://t.me/araprof)

{{< iconify mdi linkedin >}} [\@ihormiroshnychenko](https://www.linkedin.com/in/ihormiroshnychenko/)

{{< iconify mdi github >}} [\@aranaur](https://github.com/Aranaur)

{{< iconify ion home >}} [aranaur.rbind.io](https://aranaur.rbind.io)
