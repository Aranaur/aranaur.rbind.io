---
title: "–†–µ–≥—Ä–µ—Å—ñ–π–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ —É –ø—Ä–∏–∫–ª–∞–¥–Ω—ñ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏—Ü—ñ"
subtitle: "–ü—Ä–∏–∫–ª–∞–¥–Ω–∏–π —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–∏–π –∞–Ω–∞–ª—ñ–∑"
author: "–Ü–≥–æ—Ä –ú—ñ—Ä–æ—à–Ω–∏—á–µ–Ω–∫–æ"
institute: –ö–ù–£ —ñ–º–µ–Ω—ñ –¢–∞—Ä–∞—Å–∞ –®–µ–≤—á–µ–Ω–∫–∞ | –§–Ü–¢
from: markdown+emoji
title-slide-attributes:
    data-background-iframe: .00_files/libs/colored-particles/index.html
language: _language-ua.yml
footer: <a href="https://aranaur.rbind.io/lectures/asa/">üîó–ü—Ä–∏–∫–ª–∞–¥–Ω–∏–π —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–∏–π –∞–Ω–∞–ª—ñ–∑</a>
format:
  revealjs: 
    code-line-numbers: false
    # center: true
    navigation-mode: vertical
    transition: fade
    background-transition: fade
    # controls-layout: bottom-right
    chalkboard: true
    logo: fit.png
    slide-number: true
    toc: true
    toc-depth: 1
    mouse-wheel: true
    width: 1350  
    height: 759.375
    highlight-style: github
    # fig-width: 9
    # fig-height: 5
    fig-format: svg
    theme: [default, custom.scss]
    mermaid:
      theme: forest
  # gfm:
  #   mermaid-format: png
preload-iframes: true
jupyter: python3
execute: 
  echo: true
  warning: false
editor_options: 
  chunk_output_type: console

revealjs-plugins:
  - verticator
---

```{python}
#| label: setup
#| include: false

# Import libraries
import numpy as np
import pandas as pd
import statsmodels.api as sm
import statsmodels.formula.api as smf
import matplotlib.pyplot as plt
import seaborn as sns
from scipy.stats import norm, uniform, t

from IPython.display import Markdown
from tabulate import tabulate

# Set seaborn default style
sns.set_style('whitegrid')
sns.set_palette('colorblind')

# Define colors
red_pink   = "#e64173"
turquoise  = "#20B2AA"
orange     = "#FFA500"
red        = "#fb6107"
blue       = "#181485"
navy       = "#150E37FF"
green      = "#8bb174"
yellow     = "#D8BD44"
# grey_light = "grey70"
# grey_mid   = "grey50"
# grey_dark  = "grey20"
purple     = "#6A5ACD"
slate      = "#314f4f"
```

# üö®–ü—Ä–∞–≤–∏–ª–∞ –ø–æ–≤–µ–¥—ñ–Ω–∫–∏ –ø—Ä–∏ —Å–∏–≥–Ω–∞–ª—ñ "–ø–æ–≤—ñ—Ç—Ä—è–Ω–∞ —Ç—Ä–∏–≤–æ–≥–∞" {background-color="#eef3f8" .unnumbered .unlisted .smaller}

1. –ü—Ä–∏ –æ—Ç—Ä–∏–º–∞–Ω–Ω—ñ —Å–∏–≥–Ω–∞–ª—É "–ø–æ–≤—ñ—Ç—Ä—è–Ω–∞ —Ç—Ä–∏–≤–æ–≥–∞" –≤ –º—ñ—Å—Ç—ñ –ö–∏—î–≤—ñ –ª–µ–∫—Ü—ñ—è –±—É–¥–µ –ø—Ä–∏–∑—É–ø–∏–Ω–µ–Ω–∞, –∞ —Å—Ç—É–¥–µ–Ω—Ç–∏ –º–∞—é—Ç—å –ø–µ—Ä–µ–π—Ç–∏ –¥–æ —É–∫—Ä–∏—Ç—Ç—è. –ü—ñ—Å–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —Å–∏–≥–Ω–∞–ª—É "–≤—ñ–¥–±—ñ–π –ø–æ–≤—ñ—Ç—Ä—è–Ω–æ—ó —Ç—Ä–∏–≤–æ–≥–∏" –ª–µ–∫—Ü—ñ—è –ø—Ä–æ–¥–æ–≤–∂–∏—Ç—å—Å—è üì¢
2. –ü—Ä–∏ –æ—Ç—Ä–∏–º–∞–Ω–Ω—ñ —Å–∏–≥–Ω–∞–ª–∏ "–ø–æ–≤—ñ—Ç—Ä—è–Ω–∞ —Ç—Ä–∏–≤–æ–≥–∞" –≤ —ñ–Ω—à–∏—Ö —Ä–µ–≥—ñ–æ–Ω–∞—Ö –£–∫—Ä–∞—ó–Ω–∏ —Å—Ç—É–¥–µ–Ω—Ç–∏ –º–∞—é—Ç—å –≤—ñ–¥'—î–¥–Ω–∞—Ç–∏—Å—è –≤—ñ–¥ –ª–µ–∫—Ü—ñ–π–Ω–æ–≥–æ –∑–∞–Ω—è—Ç—Ç—è —Ç–∞ –ø–µ—Ä–µ–π—Ç–∏ –¥–æ —É–∫—Ä–∏—Ç—Ç—è –∑–∞ –º—ñ—Å—Ü–µ–º –ø–µ—Ä–µ–±—É–≤–∞–Ω–Ω—è. –ü—ñ—Å–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —Å–∏–≥–Ω–∞–ª—É "–≤—ñ–¥–±—ñ–π –ø–æ–≤—ñ—Ç—Ä—è–Ω–æ—ó —Ç—Ä–∏–≤–æ–≥–∏" —Å—Ç—É–¥–µ–Ω—Ç–∏ –º–∞—é—Ç—å –ø–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—è –¥–æ –Ω–∞–≤—á–∞–Ω–Ω—è‚ö†Ô∏è

# –ö–æ—Ä–µ–ª—è—Ü—ñ—è {background-color="#eef3f8"}

## –ü–æ–Ω—è—Ç—Ç—è –∫–æ—Ä–µ–ª—è—Ü—ñ—ó

[–ö–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –∫–æ—Ä–µ–ª—è—Ü—ñ—ó]{.hi} —É —Å–≤–æ—î–º—É —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–æ–º—É —Å–µ–Ω—Å—ñ –ø–æ–∑–Ω–∞—á–∞—î —Å–∏–ª—É —ñ —Ö–∞—Ä–∞–∫—Ç–µ—Ä [–≤–∑–∞—î–º–æ–∑–≤'—è–∑–∫—É]{.hi-purple} –º—ñ–∂ –¥–≤–æ–º–∞ –∫—ñ–ª—å–∫—ñ—Å–Ω–∏–º–∏ –∑–º—ñ–Ω–Ω–∏–º–∏.

```{python}
#| label: corr-1
#| code-fold: true
#| fig-align: center

# Set a random seed for reproducibility
np.random.seed(42)

# Function to generate datasets with specified correlation
def generate_dataset(correlation):
    mean = [0, 0]
    cov_matrix = [[1, correlation], [correlation, 1]]
    
    # Generate random data with the specified correlation
    data = np.random.multivariate_normal(mean, cov_matrix, 100)
    
    # Create a DataFrame
    df = pd.DataFrame(data, columns=['x', 'y'])
    
    return df

# Generate datasets with positive, negative, and no correlation
positive_corr_data = generate_dataset(0.8)
negative_corr_data = generate_dataset(-0.8)
no_corr_data = generate_dataset(0)

# Plot the datasets with regression lines
plt.figure(figsize=(15, 4))

# Positive Correlation
plt.subplot(131)
sns.regplot(x='x', y='y', data=positive_corr_data, color='blue', ci=None)
plt.title('–ü–æ–∑–∏—Ç–∏–≤–Ω–∞ –∫–æ—Ä–µ–ª—è—Ü—ñ—è')

# Negative Correlation
plt.subplot(132)
sns.regplot(x='x', y='y', data=negative_corr_data, color='red', ci=None)
plt.title('–ù–µ–≥–∞—Ç–∏–≤–Ω–∞ –∫–æ—Ä–µ–ª—è—Ü—ñ—è')

# No Correlation
plt.subplot(133)
sns.regplot(x='x', y='y', data=no_corr_data, color='green', ci=None)
plt.title('–í—ñ–¥—Å—É—Ç–Ω—è –∫–æ—Ä–µ–ª—è—Ü—ñ—è')

plt.tight_layout()
plt.show()
```

## –ö–æ–≤–∞—Ä—ñ–∞—Ü—ñ—è {.smaller}

[–ö–æ–≤–∞—Ä—ñ–∞—Ü—ñ—è]{.hi} - —Ü–µ –º—ñ—Ä–∞ –≤–∑–∞—î–º–æ–∑–≤'—è–∑–∫—É –º—ñ–∂ –¥–≤–æ–º–∞ –∑–º—ñ–Ω–Ω–∏–º–∏, —è–∫–∞ –≤–∏–∑–Ω–∞—á–∞—î—Ç—å—Å—è —è–∫ –æ—á—ñ–∫—É–≤–∞–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è –¥–æ–±—É—Ç–∫—É –≤—ñ–¥—Ö–∏–ª–µ–Ω—å –≤—ñ–¥ —Å–µ—Ä–µ–¥–Ω—ñ—Ö –∑–Ω–∞—á–µ–Ω—å.

–ü—Ä–∏–ø—É—Å—Ç–∏–º–æ, –Ω–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ —Ä–æ–∑—Ä–∞—Ö—É–≤–∞—Ç–∏ –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –∫–æ—Ä–µ–ª—è—Ü—ñ—ó –¥–ª—è –¥–≤–æ—Ö –∫—ñ–ª—å–∫—ñ—Å–Ω–∏—Ö –≤–µ–ª–∏—á–∏–Ω $X$ —ñ $Y$. –í—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ, —Å–µ—Ä–µ–¥–Ω—î –∑–∞ –≤–∏–±—ñ—Ä–∫–æ—é –¥–ª—è –∫–æ–∂–Ω–æ—ó –∑ —Ü–∏—Ö –≤–µ–ª–∏—á–∏–Ω –±—É–¥–µ $\bar{X}$ —ñ $\bar{Y}$. –¢–æ–¥—ñ –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –∫–æ–≤–∞—Ä—ñ–∞—Ü—ñ—ó:

$$ \text{cov}(X, Y) = \frac{\sum_{i=1}^{n} (X_i - \bar{X})(Y_i - \bar{Y})}{N-1}  $$

–¥–µ  $N$ --- –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω—å —É –≤–∏–±—ñ—Ä—Ü—ñ;<br>
    $X_i$ --- –∑–Ω–∞—á–µ–Ω–Ω—è $X$ –¥–ª—è $i$-–≥–æ —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è;<br>
    $Y_i$ --- –∑–Ω–∞—á–µ–Ω–Ω—è $Y$ –¥–ª—è $i$-–≥–æ —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è;

::: {.callout-important appearance="simple"}
–ö–æ–≤–∞—Ä—ñ–∞—Ü—ñ—è –∑–º—ñ–Ω—é—î—Ç—å—Å—è –≤ –¥–æ–≤—ñ–ª—å–Ω–æ–º—É —Ä–æ–∑–∫–∏–¥—ñ –∑–Ω–∞—á–µ–Ω—å $\rightarrow$ —Å–∫–ª–∞–¥–Ω–æ —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç—É–≤–∞—Ç–∏ —Å–∏–ª—É –≤–∑–∞—î–º–æ–∑–≤'—è–∑–∫—É.
:::

## –ö–æ—Ä–µ–ª—è—Ü—ñ—è {.smaller}

[–ö–æ—Ä–µ–ª—è—Ü—ñ—è]{.hi} - —Ü–µ –Ω–æ—Ä–º–∞–ª—ñ–∑–æ–≤–∞–Ω–∞ –º—ñ—Ä–∞ –≤–∑–∞—î–º–æ–∑–≤'—è–∑–∫—É –º—ñ–∂ –¥–≤–æ–º–∞ –∑–º—ñ–Ω–Ω–∏–º–∏.

$$ \text{corr}(X, Y) = \frac{\text{cov}(X, Y)}{\sigma_X \sigma_Y} $$

–¥–µ $\sigma_X$ - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–µ –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è $X$;<br>
    $\sigma_Y$ - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–µ –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è $Y$.

::: {.callout-important appearance="simple"}
–ö–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –∫–æ—Ä–µ–ª—è—Ü—ñ—ó –∑–∞–≤–∂–¥–∏ –ª–µ–∂–∏—Ç—å –≤ –¥—ñ–∞–ø–∞–∑–æ–Ω—ñ $[-1, 1]$.
:::

## –ö–æ—Ä–µ–ª—è—Ü—ñ—è

–Ü–Ω–æ–¥—ñ –º–æ–∂–Ω–∞ –∑—É—Å—Ç—Ä—ñ—Ç–∏ —Ç–∞–∫—É —Ñ–æ—Ä–º—É–ª—É –¥–ª—è –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç–∞ –∫–æ—Ä–µ–ª—è—Ü—ñ—ó:

$$
r_{xy} = \frac{\sum{(x_i - \bar{x})(y_i - \bar{y})}}{\sqrt{\sum{(x_i - \bar{x})^2} \sum{(y_i - \bar{y})^2}}}
$$

–£ –ø—ñ–¥—Ä—É—á–Ω–∏–∫–∞—Ö –∑—ñ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —á–∞—Å—Ç–æ –∑—É—Å—Ç—Ä—ñ—á–∞—î—Ç—å—Å—è —Ç–µ—Ä–º—ñ–Ω [–∫–æ—Ä–µ–ª—è—Ü—ñ–π–Ω–∏–π –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –ü—ñ—Ä—Å–æ–Ω–∞]{.hi}, —è–∫–∏–π —î —á–∞—Å—Ç–∫–æ–≤–∏–º –≤–∏–ø–∞–¥–∫–æ–º –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç–∞ –∫–æ—Ä–µ–ª—è—Ü—ñ—ó.

::: footer
–î–æ–¥–∞—Ç–æ–∫, –¥–µ –º–æ–∂–Ω–∞ –ø–æ–≥—Ä–∞—Ç–∏—Å—è –∑ –∫–æ—Ä–µ–ª—è—Ü—ñ—î—é: üîó[Interpreting Correlations](https://rpsychologist.com/correlation/)
:::

## –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≥—ñ–ø–æ—Ç–µ–∑–∏ –ø—Ä–æ –∫–æ—Ä–µ–ª—è—Ü—ñ—é {.smaller}

$$
H_0: r = 0
$$


$$
H_1: r \neq 0
$$

–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫—Ä–∏—Ç–µ—Ä—ñ—é:

$$
t = \frac{r \sqrt{n-2}}{\sqrt{1 - r^2}} \sim t_{n-2}
$$

–¥–µ $r$ --- –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –∫–æ—Ä–µ–ª—è—Ü—ñ—ó –ü—ñ—Ä—Å–æ–Ω–∞;<br>
    $n$ --- –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω—å —É –≤–∏–±—ñ—Ä—Ü—ñ.

::: {.callout-important appearance="simple"}
–ö—Ä–∏—Ç–∏—á–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è –∫—Ä–∏—Ç–µ—Ä—ñ—é –°—Ç—å—é–¥–µ–Ω—Ç–∞ –¥–ª—è —Ä—ñ–≤–Ω—è –∑–Ω–∞—á—É—â–æ—Å—Ç—ñ $\alpha = 0.05$ —ñ $n-2$ —Å—Ç—É–ø–µ–Ω—ñ–≤ —Å–≤–æ–±–æ–¥–∏: $t_{\alpha/2, n-2} = 2.045$

–Ø–∫—â–æ $|t| > t_{\alpha/2, n-2}$, —Ç–æ –Ω—É–ª—å–æ–≤—É –≥—ñ–ø–æ—Ç–µ–∑—É –≤—ñ–¥—Ö–∏–ª—è—é—Ç—å.
:::

## –£–º–æ–≤–∏ –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è –∫—Ä–∏—Ç–µ—Ä—ñ—é –°—Ç—å—é–¥–µ–Ω—Ç–∞ {.smaller}

1.  –í–∑–∞—î–º–æ–∑–≤'—è–∑–æ–∫ –º—ñ–∂ –∑–º—ñ–Ω–Ω–∏–º–∏ –º–∞—î –±—É—Ç–∏ **–ª—ñ–Ω—ñ–π–Ω–∏–º** —ñ **–º–æ–Ω–æ—Ç–æ–Ω–Ω–∏–º**.
2.  –í—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å **–≤–∏–∫–∏–¥—ñ–≤**
3.  **–ù–æ—Ä–º–∞–ª—å–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª** –∑–º—ñ–Ω–Ω–∏—Ö

–£ —Ä–∞–∑—ñ –ø–æ—Ä—É—à–µ–Ω–Ω—è —Ü–∏—Ö –ø—Ä–∏–ø—É—â–µ–Ω—å –º–æ–∂—É—Ç—å –±—É—Ç–∏ –∫–æ—Ä–∏—Å–Ω–∏–º–∏ –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç–∏ –∫–æ—Ä–µ–ª—è—Ü—ñ—ó –°–ø—ñ—Ä–º–µ–Ω–∞ –π –ö–µ–Ω–¥–∞–ª–ª–∞, —è–∫—ñ –∑–∞–º—ñ—Å—Ç—å —Ä–µ–∞–ª—å–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å –∞–Ω–∞–ª—ñ–∑—É—é—Ç—å —ó—Ö–Ω—ñ —Ä–∞–Ω–≥–∏.

::: {.callout-note appearance="simple"}
–ù—ñ —Ç–µ, –Ω—ñ —ñ–Ω—à–µ –Ω–µ —î –ø–∞–Ω–∞—Ü–µ—î—é, —ñ –∑–∞ –æ—Å–æ–±–ª–∏–≤–æ —Å–∏–ª—å–Ω–∏—Ö –ø–æ—Ä—É—à–µ–Ω—å –ø—Ä–∏–ø—É—â–µ–Ω—å (–æ—Å–æ–±–ª–∏–≤–æ –ø–µ—Ä—à–æ–≥–æ) –≤–æ–Ω–∏ —Ç–∞–∫–æ–∂ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –Ω–µ–∞–¥–µ–∫–≤–∞—Ç–Ω–∏–º–∏. –£–≤–∞–∂–Ω–æ –≤–∏–≤—á–∞–π—Ç–µ —Å–≤–æ—ó –¥–∞–Ω—ñ —Ç–∞ —ó—Ö–Ω—ñ–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä!
:::

## –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç—ñ–≤ –∫–æ—Ä–µ–ª—è—Ü—ñ—ó {.smaller}

```{python}
#| label: corr-compare
#| code-fold: true

import numpy as np
import matplotlib.pyplot as plt
from scipy.stats import pearsonr, spearmanr

def show_correlation(ax, x, y, title):
    pearson_corr, _ = pearsonr(x, y)
    spearman_corr, _ = spearmanr(x, y)
    
    ax.scatter(x, y, color="teal", edgecolor="k", alpha=0.7)
    ax.set_title(
        f"{title}\n–ü—ñ—Ä—Å–æ–Ω: {pearson_corr:.2f}, –°–ø—ñ—Ä–º–µ–Ω: {spearman_corr:.2f}", fontsize=10)
    ax.set_xlabel("X")
    ax.set_ylabel("Y")
    ax.grid(True)

# –°—Ç–≤–æ—Ä–∏–º–æ –≥—Ä–∞—Ñ—ñ–∫–∏
fig, axes = plt.subplots(1, 3, figsize=(18, 5))

# 1. –õ—ñ–Ω—ñ–π–Ω–∞ –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å
x1 = np.linspace(0, 10, 100)
y1 = 2 * x1 + np.random.normal(0, 1, 100)
show_correlation(axes[0], x1, y1, "–õ—ñ–Ω—ñ–π–Ω–∞ –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å")

# 2. –ù–µ–ª—ñ–Ω—ñ–π–Ω–∞, –∞–ª–µ –º–æ–Ω–æ—Ç–æ–Ω–Ω–∞ (–ª–æ–≥–∞—Ä–∏—Ñ–º—ñ—á–Ω–∞)
x2 = np.linspace(1, 100, 100)
y2 = np.log(x2) + np.random.normal(0, 0.2, 100)
show_correlation(axes[1], x2, y2, "–ú–æ–Ω–æ—Ç–æ–Ω–Ω–∞ –Ω–µ–ª—ñ–Ω—ñ–π–Ω–∞ –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å")

# 3. –ù–µ–ª—ñ–Ω—ñ–π–Ω–∞ —ñ –Ω–µ–º–æ–Ω–æ—Ç–æ–Ω–Ω–∞ (—Å–∏–Ω—É—Å)
x3 = np.linspace(0, 4 * np.pi, 100)
y3 = np.sin(x3)
show_correlation(axes[2], x3, y3, "–ù–µ–º–æ–Ω–æ—Ç–æ–Ω–Ω–∞ –Ω–µ–ª—ñ–Ω—ñ–π–Ω–∞ –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å")

plt.tight_layout(rect=[0, 0, 1, 0.95])
plt.show()

```

## –ö–≤–∞—Ä—Ç–µ—Ä –ï–Ω—Å–∫–æ–º–±–∞ {.tiny}

–û–¥–∏–Ω —ñ–∑ –∫–ª–∞—Å–∏—á–Ω–∏—Ö –ø—Ä–∏–∫–ª–∞–¥—ñ–≤ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ—Å—Ç—ñ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –ø—Ä–∏–ø—É—â–µ–Ω—å (—ñ –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—ó –¥–∞–Ω–∏—Ö –ø–µ—Ä–µ–¥ –∞–Ω–∞–ª—ñ–∑–æ–º) - [–∫–≤–∞—Ä—Ç–µ—Ç –ï–Ω—Å–∫–æ–º–±–∞]{.hi}. 

–£ –≤—Å—ñ—Ö —á–æ—Ç–∏—Ä—å–æ—Ö –Ω–∞–±–æ—Ä—ñ–≤ –¥–∞–Ω–∏—Ö –æ–¥–Ω–∞–∫–æ–≤–∏–π –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –∫–æ—Ä–µ–ª—è—Ü—ñ—ó –ü—ñ—Ä—Å–æ–Ω–∞, —Ö–æ—á–∞ —ó—Ö–Ω—ñ–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä –æ—á–µ–≤–∏–¥–Ω–æ —Ä—ñ–∑–Ω–∏–π.

```{python}
#| label: anscombe
#| code-fold: true
#| fig-align: center

# Load the data
anscombe = sns.load_dataset('anscombe')

plt.figure(figsize=(15, 4))

# First dataset
plt.subplot(141)
sns.regplot(x='x', y='y', data=anscombe.loc[anscombe['dataset'] == 'I'], color='#447099', ci=None)
plt.title('–ù–∞–±—ñ—Ä –¥–∞–Ω–∏—Ö I')

# Second dataset

plt.subplot(142)
sns.regplot(x='x', y='y', data=anscombe.loc[anscombe['dataset'] == 'II'], color='#C10000', ci=None)
plt.title('–ù–∞–±—ñ—Ä –¥–∞–Ω–∏—Ö II')

# Third dataset
plt.subplot(143)
sns.regplot(x='x', y='y', data=anscombe.loc[anscombe['dataset'] == 'III'], color='#00891A', ci=None)
plt.title('–ù–∞–±—ñ—Ä –¥–∞–Ω–∏—Ö III')

# Fourth dataset
plt.subplot(144)
sns.regplot(x='x', y='y', data=anscombe.loc[anscombe['dataset'] == 'IV'], color='#f45100', ci=None)
plt.title('–ù–∞–±—ñ—Ä –¥–∞–Ω–∏—Ö IV')

plt.tight_layout()
plt.show()
```

## Datasaurus Dozen {.smaller}

–©–µ –æ–¥–∏–Ω –∫–ª–∞—Å–∏—á–Ω–∏–π –ø—Ä–∏–∫–ª–∞–¥ - [Datasaurus Dozen]{.hi}.

–£ –≤—Å—ñ—Ö –¥–∞–Ω–∏—Ö –æ–¥–Ω–∞–∫–æ–≤–∏–π –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –∫–æ—Ä–µ–ª—è—Ü—ñ—ó –ü—ñ—Ä—Å–æ–Ω–∞, —Ö–æ—á–∞ —ó—Ö–Ω—ñ–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä –æ—á–µ–≤–∏–¥–Ω–æ —Ä—ñ–∑–Ω–∏–π.

```{python}
#| label: datasaurus
#| echo: false
#| fig-align: center

# Load the data
datasaurus = pd.read_csv('https://raw.githubusercontent.com/Aranaur/aranaur.rbind.io/main/datasets/datasaurus/datasaurus.csv')

# Plot the data
plt.figure(figsize=(15, 4))

# First dataset
plt.subplot(131)
sns.regplot(x='x', y='y', data=datasaurus.loc[datasaurus['dataset'] == 'dino'], color='#447099', ci=None)
plt.title('–î–∏–Ω–æ–∑–∞–≤—Ä')

# Second dataset
plt.subplot(132)
sns.regplot(x='x', y='y', data=datasaurus.loc[datasaurus['dataset'] == 'star'], color='#C10000', ci=None)
plt.title('–ó—ñ—Ä–∫–∞')

# Third dataset
plt.subplot(133)
sns.regplot(x='x', y='y', data=datasaurus.loc[datasaurus['dataset'] == 'h_lines'], color='#00891A', ci=None)
plt.title('–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ñ –ª—ñ–Ω—ñ—ó')

plt.tight_layout()
plt.show()
```

## –ö–æ—Ä–µ–ª—è—Ü—ñ—è –≤ Python {.tiny}

```{python}
#| label: tbl-vgsales

vgsales = pd.read_csv("https://raw.githubusercontent.com/Aranaur/aranaur.rbind.io/main/datasets/video_games_sales/vgsales.csv")
vgsales.head()
```

::: {.panel-tabset}

### NumPy

```{python}
#| label: corr-np

import numpy as np

np_corr_p = np.corrcoef(vgsales['NA_Sales'], vgsales['Global_Sales'])[0, 1]
print(f'–ö–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –∫–æ—Ä–µ–ª—è—Ü—ñ—ó: {np_corr_p:.3f}')
```

### SciPy

```{python}
#| label: corr-scipy

import scipy.stats as st

st_corr_p = st.pearsonr(vgsales['NA_Sales'], vgsales['Global_Sales'])
st_corr_s = st.spearmanr(vgsales['NA_Sales'], vgsales['Global_Sales'])
st_corr_k = st.kendalltau(vgsales['NA_Sales'], vgsales['Global_Sales'])

print(f'–ö–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –∫–æ—Ä–µ–ª—è—Ü—ñ—ó –ü—ñ—Ä—Å–æ–Ω–∞: {st_corr_p[0]:.3f} (p-value: {st_corr_p[1]:.3f})')
print(f'–ö–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –∫–æ—Ä–µ–ª—è—Ü—ñ—ó –°–ø—ñ—Ä–º–µ–Ω–∞: {st_corr_s[0]:.3f} (p-value: {st_corr_s[1]:.3f})')
print(f'–ö–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –∫–æ—Ä–µ–ª—è—Ü—ñ—ó –ö–µ–Ω–¥–∞–ª–ª–∞: {st_corr_k[0]:.3f} (p-value: {st_corr_k[1]:.3f})')
```

### Pandas

```{python}
#| label: corr-pandas

import pandas as pd

pd_corr_p = vgsales[['NA_Sales', 'Global_Sales']].corr(method='pearson').iloc[0, 1]
pd_corr_s = vgsales[['NA_Sales', 'Global_Sales']].corr(method='spearman').iloc[0, 1]
pd_corr_k = vgsales[['NA_Sales', 'Global_Sales']].corr(method='kendall').iloc[0, 1]

print(f'–ö–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –∫–æ—Ä–µ–ª—è—Ü—ñ—ó –ü—ñ—Ä—Å–æ–Ω–∞: {pd_corr_p:.3f}')
print(f'–ö–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –∫–æ—Ä–µ–ª—è—Ü—ñ—ó –°–ø—ñ—Ä–º–µ–Ω–∞: {pd_corr_s:.3f}')
print(f'–ö–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –∫–æ—Ä–µ–ª—è—Ü—ñ—ó –ö–µ–Ω–¥–∞–ª–ª–∞: {pd_corr_k:.3f}')
```

:::

## Maximal Information-based Nonparametric Exploration {.tiny}

[MINE]{.hi} --- —Ü–µ –∞–ª–≥–æ—Ä–∏—Ç–º, —è–∫–∏–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è –Ω–µ–ª—ñ–Ω—ñ–π–Ω–∏—Ö –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π –º—ñ–∂ –∑–º—ñ–Ω–Ω–∏–º–∏.

![](img/mic.jpg){fig-align="center"}

::: footer

üîó[minepy - Maximal Information-based Nonparametric Exploration](https://minepy.readthedocs.io/en/latest/)

:::

## –•–∏–±–Ω—ñ –∫–æ—Ä–µ–ª—è—Ü—ñ—ó

[Spurious Correlations](https://www.tylervigen.com/spurious-correlations)

![](img/spurious.png){fig-align="center"}

# –ì–µ–Ω–µ—Ä–∞–ª—å–Ω–∞ —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å —Ç–∞ –≤–∏–±—ñ—Ä–∫–∞ —É –∑–∞–¥–∞—á—ñ —Ä–µ–≥—Ä–µ—Å—ñ—ó {background-color="#eef3f8"}

## –ì–µ–Ω–µ—Ä–∞–ª—å–Ω–∞ —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å —ñ –≤–∏–±—ñ—Ä–∫–∞ {.smaller}

[–ì–µ–Ω–µ—Ä–∞–ª—å–Ω–∞ —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å]{.hi} - —Ü–µ —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å –≤—Å—ñ—Ö –æ–±'—î–∫—Ç—ñ–≤, —è–∫—ñ –º–∏ –≤–∏–≤—á–∞—î–º–æ.

[–í–∏–±—ñ—Ä–∫–∞]{.purple} - —Ü–µ –ø—ñ–¥–º–Ω–æ–∂–∏–Ω–∞ –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ—ó —Å—É–∫—É–ø–Ω–æ—Å—Ç—ñ, —è–∫–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ –≥–µ–Ω–µ—Ä–∞–ª—å–Ω—É —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å.

–ú–∏ –∑–∞–ø–∏—à–µ–º–æ [–ø—Ä–æ—Å—Ç—É]{.hi} –º–æ–¥–µ–ª—å –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ—ó —Å—É–∫—É–ø–Ω–æ—Å—Ç—ñ

$$ y_i = \beta_0 + \beta_1 x_i + u_i $$

–¥–µ $y_i$ - –∑–∞–ª–µ–∂–Ω–∞ –∑–º—ñ–Ω–Ω–∞;<br>
    $x_i$ - –Ω–µ–∑–∞–ª–µ–∂–Ω–∞ –∑–º—ñ–Ω–Ω–∞;<br>
    $\beta_0, \beta_1$ --- –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –º–æ–¥–µ–ª—ñ;<br>
    $u_i$ --- –≤–∏–ø–∞–¥–∫–æ–≤—ñ –∑–±—É—Ä–µ–Ω–Ω—è.

–¢–æ–¥—ñ –Ω–∞—à–∞ [–º–æ–¥–µ–ª—å —Ä–µ–≥—Ä–µ—Å—ñ—ó]{.purple} –Ω–∞ –æ—Å–Ω–æ–≤—ñ –≤–∏–±—ñ—Ä–∫–∏:

$$
y_i = \hat{\beta}_0 + \hat{\beta}_1 x_i + e_i
$$

–¥–µ $e_i$ --- –∑–∞–ª–∏—à–∫–∏ –º–æ–¥–µ–ª—ñ.

## –ì–µ–Ω–µ—Ä–∞–ª—å–Ω–∞ —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å —ñ –≤–∏–±—ñ—Ä–∫–∞ {.smaller}

–†–æ–∑—Ä–∞—Ö—É–Ω–∫–æ–≤–∞ —Ä–µ–≥—Ä–µ—Å—ñ–π–Ω–∞ –º–æ–¥–µ–ª—å –¥–∞—î [–æ—Ü—ñ–Ω–∫–∏]{.purple} –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è:

$$ \hat{y}_i = \hat{\beta}_0 + \hat{\beta}_1 x_i $$

–¥–µ $\hat{y}_i$ --- –ø—Ä–æ–≥–Ω–æ–∑–æ–≤–∞–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—ó –∑–º—ñ–Ω–Ω–æ—ó.

—â–æ –¥–∞—î –Ω–∞–º _–Ω–∞–π–∫—Ä–∞—â—É_ –ª—ñ–Ω—ñ—é –≤ –Ω–∞—à–æ–º—É –Ω–∞–±–æ—Ä—ñ –¥–∞–Ω–∏—Ö.

## –ì–µ–Ω–µ—Ä–∞–ª—å–Ω–∞ —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å —ñ –≤–∏–±—ñ—Ä–∫–∞ {.tiny}

```{python}
#| label: ols-gen
#| include: false

# Set population and sample sizes
n_p = 100
n_s = 30

np.random.seed(42)

# Function to generate datasets with specified correlation
def generate_dataset(correlation):
    mean = [0, 0]
    cov_matrix = [[1, correlation], [correlation, 1]]
    
    # Generate random data with the specified correlation
    data = np.random.multivariate_normal(mean, cov_matrix, 100)
    
    # Create a DataFrame
    df = pd.DataFrame(data, columns=['x', 'y'])
    
    return df

# Generate datasets with positive, negative, and no correlation
pop_df = generate_dataset(0.8)

pop_df['row'] = np.repeat(np.arange(1, np.sqrt(n_p) + 1), np.sqrt(n_p))
pop_df['col'] = np.tile(np.arange(1, int(np.sqrt(n_p)) + 1), int(np.sqrt(n_p)))
pop_df['s1'] = np.random.choice([True, False], size=n_p, p=[n_s / n_p, (n_p - n_s) / n_p])
pop_df['s2'] = np.random.choice([True, False], size=n_p, p=[n_s / n_p, (n_p - n_s) / n_p])
pop_df['s3'] = np.random.choice([True, False], size=n_p, p=[n_s / n_p, (n_p - n_s) / n_p])

# Regressions
lm0 = sm.OLS(pop_df['y'], sm.add_constant(pop_df['x'])).fit()
lm1 = sm.OLS(pop_df.loc[pop_df['s1'], 'y'], sm.add_constant(pop_df.loc[pop_df['s1'], 'x'])).fit()
lm2 = sm.OLS(pop_df.loc[pop_df['s2'], 'y'], sm.add_constant(pop_df.loc[pop_df['s2'], 'x'])).fit()
lm3 = sm.OLS(pop_df.loc[pop_df['s3'], 'y'], sm.add_constant(pop_df.loc[pop_df['s3'], 'x'])).fit()
```

**–ü–∏—Ç–∞–Ω–Ω—è:** –ß–æ–º—É –º–∏ —Å–ø—ñ–≤—Å—Ç–∞–≤–ª—è—î–º–æ *–≥–µ–Ω–µ—Ä–∞–ª—å–Ω—É —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å —ñ –≤–∏–±—ñ—Ä–∫—É*?

. . .

:::: {.columns}

::: {.column}

```{python}
#| label: pop1
#| echo: false

# plt.figure(figsize=(5, 3))
plt.scatter(pop_df['row'], pop_df['col'], color='darkslategray', s=100)

plt.tick_params(axis='both', labelsize=0, length = 0)

plt.box(False)
plt.grid(None)

# Display the plot
plt.show()
```

**–ì–µ–Ω–µ—Ä–∞–ª—å–Ω–∞ —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å**

:::

::: {.column}
```{python}
#| label: scatter1
#| echo: false
#| fig-align: center

# plt.figure(figsize=(5, 3))
plt.scatter(pop_df['x'], pop_df['y'], color='darkslategray', s=60)
plt.axline((0, lm0.params[0]), slope=lm0.params[1], color=red_pink, linewidth=2)
plt.tick_params(axis='both', labelsize=0, length = 0)
plt.box(False)
plt.grid(None)

plt.show()
```

**–ó–≤'—è–∑–æ–∫ —É –≥–µ–Ω–µ—Ä–∞–ª—å–Ω—ñ–π —Å—É–∫—É–ø–Ω–æ—Å—Ç—ñ**

```{python}
#| label: formula1
#| echo: false

Markdown(f"""
$$ y_i = {round(lm0.params[0], 2)} + {round(lm0.params[1], 2)} x_i + u_i $$
$$ y_i = \\beta_0 + \\beta_1 x_i + u_i $$
""")
```

:::

::::

## –ì–µ–Ω–µ—Ä–∞–ª—å–Ω–∞ —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å —ñ –≤–∏–±—ñ—Ä–∫–∞ {.tiny}

**–ü–∏—Ç–∞–Ω–Ω—è:** –ß–æ–º—É –º–∏ —Å–ø—ñ–≤—Å—Ç–∞–≤–ª—è—î–º–æ *–≥–µ–Ω–µ—Ä–∞–ª—å–Ω—É —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å —ñ –≤–∏–±—ñ—Ä–∫—É*?

:::: {.columns}

::: {.column}

```{python}
#| label: sample1
#| echo: false

# plt.figure(figsize=(5, 3))
plt.scatter(pop_df.loc[pop_df['s1'], 'row'], pop_df.loc[pop_df['s1'], 'col'], color='darkslategray', s=100, marker='o')
plt.scatter(pop_df.loc[~pop_df['s1'], 'row'], pop_df.loc[~pop_df['s1'], 'col'], facecolors='none', s=100, edgecolors='darkslategray', alpha=0.3)


plt.tick_params(axis='both', labelsize=0, length = 0)
plt.box(False)
plt.grid(None)

# Display the plot
plt.show()
```

**–ì–µ–Ω–µ—Ä–∞–ª—å–Ω–∞ —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å**

:::

::: {.column}
```{python}
#| label: sample1-scatter
#| echo: false

# plt.figure(figsize=(5, 3))
plt.scatter(pop_df.loc[pop_df['s1'], 'x'], pop_df.loc[pop_df['s1'], 'y'], color='darkslategray', s=60)
plt.scatter(pop_df.loc[~pop_df['s1'], 'x'], pop_df.loc[~pop_df['s1'], 'y'], facecolors='none', s=60, edgecolors='darkslategray', alpha=0.3)
plt.axline((0, lm0.params[0]), slope=lm0.params[1], color=red_pink, linewidth=2, alpha=0.3)
plt.axline((0, lm1.params[0]), slope=lm1.params[1], linestyle='dashed', color='black', linewidth=2)
plt.tick_params(axis='both', labelsize=0, length = 0)
plt.box(False)
plt.grid(None)

plt.show()
```

**–ó–≤'—è–∑–æ–∫ —É –≥–µ–Ω–µ—Ä–∞–ª—å–Ω—ñ–π —Å—É–∫—É–ø–Ω–æ—Å—Ç—ñ**

```{python}
#| label: formula2
#| echo: false

Markdown(f"""
$$ y_i = {round(lm0.params[0], 2)} + {round(lm0.params[1], 2)} x_i + u_i $$
""")
```

**–ó–≤'—è–∑–æ–∫ —É –≤–∏–±—ñ—Ä—Ü—ñ**

```{python}
#| label: formula3
#| echo: false

Markdown(f"""
$$ \\hat{{y_i}} = {round(lm1.params[0], 2)} + {round(lm1.params[1], 2)} x_i $$
""")
```

:::

::::

## –ì–µ–Ω–µ—Ä–∞–ª—å–Ω–∞ —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å —ñ –≤–∏–±—ñ—Ä–∫–∞ {.tiny}

**–ü–∏—Ç–∞–Ω–Ω—è:** –ß–æ–º—É –º–∏ —Å–ø—ñ–≤—Å—Ç–∞–≤–ª—è—î–º–æ *–≥–µ–Ω–µ—Ä–∞–ª—å–Ω—É —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å —ñ –≤–∏–±—ñ—Ä–∫—É*?

:::: {.columns}

::: {.column}

```{python}
#| label: sample2
#| echo: false

# plt.figure(figsize=(5, 3))
plt.scatter(pop_df.loc[pop_df['s2'], 'row'], pop_df.loc[pop_df['s2'], 'col'], color='darkslategray', s=100, marker='o')
plt.scatter(pop_df.loc[~pop_df['s2'], 'row'], pop_df.loc[~pop_df['s2'], 'col'], facecolors='none', s=100, edgecolors='darkslategray', alpha=0.3)
plt.tick_params(axis='both', labelsize=0, length = 0)
plt.box(False)
plt.grid(None)

# Display the plot
plt.show()
```

**–ì–µ–Ω–µ—Ä–∞–ª—å–Ω–∞ —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å**

:::

::: {.column}
```{python}
#| label: sample2-scatter
#| echo: false

# plt.figure(figsize=(5, 3))
plt.scatter(pop_df.loc[pop_df['s2'], 'x'], pop_df.loc[pop_df['s2'], 'y'], color='darkslategray', s=60)
plt.scatter(pop_df.loc[~pop_df['s2'], 'x'], pop_df.loc[~pop_df['s2'], 'y'], facecolors='none', s=60, edgecolors='darkslategray', alpha=0.3)
plt.axline((0, lm0.params[0]), slope=lm0.params[1], color=red_pink, linewidth=2, alpha=0.3)
plt.axline((0, lm1.params[0]), slope=lm1.params[1], linestyle='dashed', color='black', linewidth=2, alpha=0.3)
plt.axline((0, lm2.params[0]), slope=lm2.params[1], linestyle='dashed', color='black', linewidth=2)
plt.tick_params(axis='both', labelsize=0, length = 0)
plt.box(False)
plt.grid(None)

plt.show()
```

**–ó–≤'—è–∑–æ–∫ —É –≥–µ–Ω–µ—Ä–∞–ª—å–Ω—ñ–π —Å—É–∫—É–ø–Ω–æ—Å—Ç—ñ**

```{python}
#| label: formula4
#| echo: false

Markdown(f"""
$$ y_i = {round(lm0.params[0], 2)} + {round(lm0.params[1], 2)} x_i + u_i $$
""")
```

**–ó–≤'—è–∑–æ–∫ —É –≤–∏–±—ñ—Ä—Ü—ñ**

```{python}
#| label: formula5
#| echo: false

Markdown(f"""
$$ \\hat{{y_i}} = {round(lm2.params[0], 2)} + {round(lm2.params[1], 2)} x_i $$
""")
```

:::

::::

## –ì–µ–Ω–µ—Ä–∞–ª—å–Ω–∞ —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å —ñ –≤–∏–±—ñ—Ä–∫–∞ {.tiny}

**–ü–∏—Ç–∞–Ω–Ω—è:** –ß–æ–º—É –º–∏ —Å–ø—ñ–≤—Å—Ç–∞–≤–ª—è—î–º–æ *–≥–µ–Ω–µ—Ä–∞–ª—å–Ω—É —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å —ñ –≤–∏–±—ñ—Ä–∫—É*?

:::: {.columns}

::: {.column}

```{python}
#| label: sample3
#| echo: false

# plt.figure(figsize=(5, 3))
plt.scatter(pop_df.loc[pop_df['s3'], 'row'], pop_df.loc[pop_df['s3'], 'col'], color='darkslategray', s=100, marker='o')
plt.scatter(pop_df.loc[~pop_df['s3'], 'row'], pop_df.loc[~pop_df['s3'], 'col'], facecolors='none', s=100, edgecolors='darkslategray', alpha=0.3)


plt.tick_params(axis='both', labelsize=0, length = 0)
plt.box(False)
plt.grid(None)

# Display the plot
plt.show()
```

**–ì–µ–Ω–µ—Ä–∞–ª—å–Ω–∞ —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å**

:::

::: {.column}
```{python}
#| label: sample3-scatter
#| echo: false

# plt.figure(figsize=(5, 3))
plt.scatter(pop_df.loc[pop_df['s3'], 'x'], pop_df.loc[pop_df['s3'], 'y'], color='darkslategray', s=60)
plt.scatter(pop_df.loc[~pop_df['s3'], 'x'], pop_df.loc[~pop_df['s3'], 'y'], facecolors='none', s=60, edgecolors='darkslategray', alpha=0.3)
plt.axline((0, lm0.params[0]), slope=lm0.params[1], color=red_pink, linewidth=2, alpha=0.3)
plt.axline((0, lm1.params[0]), slope=lm1.params[1], linestyle='dashed', color='black', linewidth=2, alpha=0.3)
plt.axline((0, lm2.params[0]), slope=lm2.params[1], linestyle='dashed', color='black', linewidth=2, alpha=0.3)
plt.axline((0, lm3.params[0]), slope=lm3.params[1], linestyle='dashed', color='black', linewidth=2)
plt.tick_params(axis='both', labelsize=0, length = 0)
plt.box(False)
plt.grid(None)

plt.show()
```

**–ó–≤'—è–∑–æ–∫ —É –≥–µ–Ω–µ—Ä–∞–ª—å–Ω—ñ–π —Å—É–∫—É–ø–Ω–æ—Å—Ç—ñ**

```{python}
#| label: formula6
#| echo: false

Markdown(f"""
$$ y_i = {round(lm0.params[0], 2)} + {round(lm0.params[1], 2)} x_i + u_i $$
""")
```

**–ó–≤'—è–∑–æ–∫ —É –≤–∏–±—ñ—Ä—Ü—ñ**

```{python}
#| label: formula7
#| echo: false

Markdown(f"""
$$ \\hat{{y_i}} = {round(lm3.params[0], 2)} + {round(lm3.params[1], 2)} x_i $$
""")
```

:::

::::

---

<br><br><br>
–î–∞–≤–∞–π—Ç–µ –ø–æ–≤—Ç–æ—Ä–∏–º–æ —Ü–µ **10 000 —Ä–∞–∑—ñ–≤** (–ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ).

```{python}
#| label: gen-dataset-2
#| code-fold: true
#| code-summary: –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –¥–∞—Ç–∞—Å–µ—Ç—É

np.random.seed(12468)

def fit_linear_regression(size):
    sampled_data = pop_df.sample(n=size)
    model = sm.OLS(sampled_data['y'], sm.add_constant(sampled_data['x'])).fit()
    return model.params

sim_results = [fit_linear_regression(size=n_s) for _ in range(int(1e4))]
sim_df = pd.concat([pd.DataFrame(result) for result in sim_results], ignore_index=True, axis=1).T
```

## –ì–µ–Ω–µ—Ä–∞–ª—å–Ω–∞ —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å —ñ –≤–∏–±—ñ—Ä–∫–∞

```{python}
#| label: gen-dataset-2-plot
#| code-fold: true
#| fig-dpi: 300

plt.figure(figsize=(15, 4))

for intercept, slope in zip(sim_df['const'], sim_df['x']):
    plt.axline((0, intercept), slope=slope, color='black', linewidth=0.1, alpha=0.1)

plt.scatter(pop_df['x'], pop_df['y'], color='darkslategray', s=60)
plt.axline((0, lm0.params[0]), slope=lm0.params[1], color=red_pink, linewidth=2)
plt.tick_params(axis='both', labelsize=0, length = 0)
plt.box(False)
plt.grid(None)

plt.show()
```

## –ì–µ–Ω–µ—Ä–∞–ª—å–Ω–∞ —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å —ñ –≤–∏–±—ñ—Ä–∫–∞ {.smaller}

**–ü–∏—Ç–∞–Ω–Ω—è:** –ß–æ–º—É –º–∏ —Å–ø—ñ–≤—Å—Ç–∞–≤–ª—è—î–º–æ *–≥–µ–Ω–µ—Ä–∞–ª—å–Ω—É —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å —ñ –≤–∏–±—ñ—Ä–∫—É*?

:::: {.columns}

::: {.column}
```{python}
#| label: gen-dataset-2-plot-2
#| echo: false
#| fig-dpi: 300

for intercept, slope in zip(sim_df['const'], sim_df['x']):
    plt.axline((0, intercept), slope=slope, color='black', linewidth=0.1, alpha=0.1)

plt.scatter(pop_df['x'], pop_df['y'], color='darkslategray', s=60)
plt.axline((0, lm0.params[0]), slope=lm0.params[1], color=red_pink, linewidth=2)
plt.tick_params(axis='both', labelsize=0, length = 0)
plt.box(False)
plt.grid(None)

plt.show()
```
:::

::: {.column}
- –£ **—Å–µ—Ä–µ–¥–Ω—å–æ–º—É** –Ω–∞—à—ñ –ª—ñ–Ω—ñ—ó —Ä–µ–≥—Ä–µ—Å—ñ—ó –¥—É–∂–µ –¥–æ–±—Ä–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å –ª—ñ–Ω—ñ—ó –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ—ó —Å—É–∫—É–ø–Ω–æ—Å—Ç—ñ

- –û–¥–Ω–∞–∫ **–æ–∫—Ä–µ–º—ñ –ª—ñ–Ω—ñ—ó** (–∑—Ä–∞–∑–∫–∏) –º–æ–∂—É—Ç—å –ø—Ä–æ–º–∞—Ö–Ω—É—Ç–∏—Å—è.

- –í—ñ–¥–º—ñ–Ω–Ω–æ—Å—Ç—ñ –º—ñ–∂ –æ–∫—Ä–µ–º–∏–º–∏ –≤–∏–±—ñ—Ä–∫–∞–º–∏ —Ç–∞ –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ—é —Å—É–∫—É–ø–Ω—ñ—Å—Ç—é –ø—Ä–∏–∑–≤–æ–¥—è—Ç—å –¥–æ **–Ω–µ–≤–∏–∑–Ω–∞—á–µ–Ω–æ—Å—Ç—ñ**.
:::

::::

## –ì–µ–Ω–µ—Ä–∞–ª—å–Ω–∞ —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å —ñ –≤–∏–±—ñ—Ä–∫–∞ {.smaller}

**–ü–∏—Ç–∞–Ω–Ω—è:** –ß–æ–º—É –º–∏ —Å–ø—ñ–≤—Å—Ç–∞–≤–ª—è—î–º–æ *–≥–µ–Ω–µ—Ä–∞–ª—å–Ω—É —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å —ñ –≤–∏–±—ñ—Ä–∫—É*?

**–í—ñ–¥–ø–æ–≤—ñ–¥—å:** –ù–µ–≤–∏–∑–Ω–∞—á–µ–Ω—ñ—Å—Ç—å –º–∞—î –∑–Ω–∞—á–µ–Ω–Ω—è.

- $\hat{\beta}$  —Å–∞–º–∞ –ø–æ —Å–æ–±—ñ —î –≤–∏–ø–∞–¥–∫–æ–≤–æ—é –∑–º—ñ–Ω–Ω–æ—é, —è–∫–∞ –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ –≤–∏–ø–∞–¥–∫–æ–≤–æ—ó –≤–∏–±—ñ—Ä–∫–∏. 
- –ö–æ–ª–∏ –º–∏ –±–µ—Ä–µ–º–æ –∑—Ä–∞–∑–æ–∫ —ñ –∑–∞–ø—É—Å–∫–∞—î–º–æ —Ä–µ–≥—Ä–µ—Å—ñ—é, –º–∏ –Ω–µ –∑–Ω–∞—î–º–æ, —á–∏ —Ü–µ ¬´—Ö–æ—Ä–æ—à–∏–π¬ª –∑—Ä–∞–∑–æ–∫ ($\hat{\beta}$ –±–ª–∏–∑—å–∫–∏–π –¥–æ $\beta$) —á–∏ ¬´–ø–æ–≥–∞–Ω–∏–π –∑—Ä–∞–∑–æ–∫¬ª (–Ω–∞—à –∑—Ä–∞–∑–æ–∫ —Å–∏–ª—å–Ω–æ –≤—ñ–¥—Ä—ñ–∑–Ω—è—î—Ç—å—Å—è –≤—ñ–¥ –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ—ó —Å—É–∫—É–ø–Ω–æ—Å—Ç—ñ).

# –û—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ —Ä–µ–≥—Ä–µ—Å—ñ—ó {background-color="#eef3f8"}

## –û—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ —Ä–µ–≥—Ä–µ—Å—ñ—ó {.smaller}

–ú–∏ –º–æ–∂–µ–º–æ –æ—Ü—ñ–Ω–∏—Ç–∏ –ª—ñ–Ω—ñ—é —Ä–µ–≥—Ä–µ—Å—ñ—ó –≤ Python:

`lm = sm.OLS(y, sm.add_constant(x)).fit()`

–ê–ª–µ –∑–≤—ñ–¥–∫–∏ —Ç–∞–∫—ñ –æ—Ü—ñ–Ω–∫–∏?

–ö—ñ–ª—å–∫–∞ —Å–ª–∞–π–¥—ñ–≤ –Ω–∞–∑–∞–¥:

> $$ \hat{y}_i = \hat{\beta}_0 + \hat{\beta}_1 x_i $$
> —â–æ –¥–∞—î –Ω–∞–º *–Ω–∞–π–∫—Ä–∞—â–∏–π* —Ä—è–¥–æ–∫ —á–µ—Ä–µ–∑ –Ω–∞—à –Ω–∞–±—ñ—Ä –¥–∞–Ω–∏—Ö.

–ê–ª–µ —â–æ –º–∏ –º–∞—î–º–æ –Ω–∞ —É–≤–∞–∑—ñ –ø—ñ–¥ ¬´–Ω–∞–π–∫—Ä–∞—â–æ—é –ª—ñ–Ω—ñ—î—é¬ª?

## –ë—É—Ç–∏ ¬´–Ω–∞–π–∫—Ä–∞—â–∏–º¬ª{.smaller}

**–ü–∏—Ç–∞–Ω–Ω—è:** –©–æ –º–∏ –º–∞—î–º–æ –Ω–∞ —É–≤–∞–∑—ñ –ø—ñ–¥ *–Ω–∞–π–∫—Ä–∞—â–æ—é –ª—ñ–Ω—ñ—î—é*?

**–í—ñ–¥–ø–æ–≤—ñ–¥—ñ:**

- –ó–∞–≥–∞–ª–æ–º, *–Ω–∞–π–∫—Ä–∞—â–∞ –ª—ñ–Ω—ñ—è* –æ–∑–Ω–∞—á–∞—î –ª—ñ–Ω—ñ—é, —è–∫–∞ –º—ñ–Ω—ñ–º—ñ–∑—É—î —Å—É–º—É –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–∏—Ö –ø–æ–º–∏–ª–æ–∫ (ESS):

$$ \text{ESS} = \sum_{i = 1}^{n} e_i^2\quad $$

–¥–µ $\quad e_i = y_i - \hat{y}_i$

- –ó–≤–∏—á–∞–π–Ω–∏–π –º–µ—Ç–æ–¥ **–Ω–∞–π–º–µ–Ω—à–∏—Ö –∫–≤–∞–¥—Ä–∞—Ç—ñ–≤** (**OLS**) –º—ñ–Ω—ñ–º—ñ–∑—É—î —Å—É–º—É –∫–≤–∞–¥—Ä–∞—Ç—ñ–≤ –ø–æ–º–∏–ª–æ–∫.
- –ù–∞ –æ—Å–Ω–æ–≤—ñ –Ω–∏–∑–∫–∏ (–∑–¥–µ–±—ñ–ª—å—à–æ–≥–æ –ø—Ä–∏–π–Ω—è—Ç–Ω–∏—Ö) –ø—Ä–∏–ø—É—â–µ–Ω—å, OLS
   - –Ñ –Ω–µ–∑–º—ñ—â–µ–Ω–Ω–∏–º
   - –¶–µ *–Ω–∞–π–∫—Ä–∞—â–∏–π* (–º—ñ–Ω—ñ–º–∞–ª—å–Ω–∞ –¥–∏—Å–ø–µ—Ä—Å—ñ—è) –ª—ñ–Ω—ñ–π–Ω–∏–π –Ω–µ–∑–º—ñ—â–µ–Ω–∏–π –æ—Ü—ñ–Ω—é–≤–∞—á

## –ú–ù–ö {.smaller}

–î–∞–≤–∞–π—Ç–µ —Ä–æ–∑–≥–ª—è–Ω–µ–º–æ –Ω–∞–±—ñ—Ä –¥–∞–Ω–∏—Ö, —è–∫–∏–π –º–∏ –∑–≥–µ–Ω–µ—Ä—É–≤–∞–ª–∏ —Ä–∞–Ω—ñ—à–µ.

```{python}
#| label: ols-plot-1
#| echo: false

plt.figure(figsize=(15, 4))

plt.scatter(pop_df['x'], pop_df['y'], color='darkslategray', s=60)
plt.tick_params(axis='both', labelsize=0, length = 0)
plt.box(False)
plt.grid(None)
plt.show()
```

## –ú–ù–ö {.smaller}

–î–ª—è –±—É–¥—å-—è–∫–æ—ó –ª—ñ–Ω—ñ—ó $\hat{y} = \hat{\beta}_0 + \hat{\beta}_1 x$

```{python}
#| label: ols-plot-2
#| echo: false
#| fig-align: center

# Define line's parameters
b0 = 0.5
b1 = 0.2

plt.figure(figsize=(15, 4))

# Create a scatter plot
plt.scatter(pop_df['x'], pop_df['y'], color='darkslategray', s=50, alpha=0.9)
plt.axline((0, b0), slope=b1, color=orange, linewidth=2)
plt.tick_params(axis='both', labelsize=0, length = 0)
plt.box(False)
plt.grid(None)
plt.show()
```

## –ú–ù–ö {.smaller}

–î–ª—è –±—É–¥—å-—è–∫–æ—ó –ª—ñ–Ω—ñ—ó $\hat{y} = \hat{\beta}_0 + \hat{\beta}_1 x$ –º–∏ –º–æ–∂–µ–º–æ –æ–±—á–∏—Å–ª–∏—Ç–∏ –ø–æ–º–∏–ª–∫–∏: $e_i = y_i - \hat{y}_i$

```{python}
#| label: ols-plot-3
#| echo: false

# Define line's parameters
b0 = 0.5
b1 = 0.2

pop_df['bestfit'] = b0 + b1 * pop_df['x']

plt.figure(figsize=(15, 4))

# Create a scatter plot
plt.scatter(pop_df['x'], pop_df['y'], color='darkslategray', s=50, alpha=0.9)
plt.axline((0, b0), slope=b1, color=orange, linewidth=2)

for x_val, y_val, y_hat_val in zip(pop_df['x'], pop_df['y'], pop_df['bestfit']):
    plt.plot([x_val, x_val], [y_val, y_hat_val], color='darkslategray', linewidth=0.5)

plt.tick_params(axis='both', labelsize=0, length = 0)
plt.box(False)
plt.grid(None)
plt.show()
```

## –ú–ù–ö {.smaller}
–î–ª—è –±—É–¥—å-—è–∫–æ—ó –ª—ñ–Ω—ñ—ó $\hat{y} = \hat{\beta}_0 + \hat{\beta}_1 x$ –º–∏ –º–æ–∂–µ–º–æ –æ–±—á–∏—Å–ª–∏—Ç–∏ –ø–æ–º–∏–ª–∫–∏: $e_i = y_i - \hat{y}_i$

```{python}
#| label: ols-plot-4
#| echo: false

# Define line's parameters
b0 = 0.1
b1 = 0.2

pop_df['bestfit'] = b0 + b1 * pop_df['x']

plt.figure(figsize=(15, 4))

# Create a scatter plot
plt.scatter(pop_df['x'], pop_df['y'], color='darkslategray', s=50, alpha=0.9)
plt.axline((0, b0), slope=b1, color=orange, linewidth=2)

for x_val, y_val, y_hat_val in zip(pop_df['x'], pop_df['y'], pop_df['bestfit']):
    plt.plot([x_val, x_val], [y_val, y_hat_val], color='darkslategray', linewidth=0.5)

plt.tick_params(axis='both', labelsize=0, length = 0)
plt.box(False)
plt.grid(None)
plt.show()
```

## –ú–ù–ö {.smaller}
–î–ª—è –±—É–¥—å-—è–∫–æ—ó –ª—ñ–Ω—ñ—ó $\hat{y} = \hat{\beta}_0 + \hat{\beta}_1 x$ –º–∏ –º–æ–∂–µ–º–æ –æ–±—á–∏—Å–ª–∏—Ç–∏ –ø–æ–º–∏–ª–∫–∏: $e_i = y_i - \hat{y}_i$

```{python}
#| label: ols-plot-5
#| echo: false

# Define line's parameters
b0 = 2
b1 = -0.8

pop_df['bestfit'] = b0 + b1 * pop_df['x']

plt.figure(figsize=(15, 4))

# Create a scatter plot
plt.scatter(pop_df['x'], pop_df['y'], color='darkslategray', s=50, alpha=0.9)
plt.axline((0, b0), slope=b1, color=orange, linewidth=2)

for x_val, y_val, y_hat_val in zip(pop_df['x'], pop_df['y'], pop_df['bestfit']):
    plt.plot([x_val, x_val], [y_val, y_hat_val], color='darkslategray', linewidth=0.5)

plt.tick_params(axis='both', labelsize=0, length = 0)
plt.box(False)
plt.grid(None)
plt.show()
```

## –ú–ù–ö {.smaller}

ESS –∑–≤–æ–¥–∏—Ç—å –ø–æ–º–∏–ª–∫–∏ –≤ –∫–≤–∞–¥—Ä–∞—Ç $\sum e_i^2$: –±—ñ–ª—å—à—ñ –ø–æ–º–∏–ª–∫–∏ –æ—Ç—Ä–∏–º—É—é—Ç—å –±—ñ–ª—å—à—ñ —à—Ç—Ä–∞—Ñ–∏.

```{python}
#| label: ols-plot-6
#| echo: false

# Define line's parameters
b0 = 1
b1 = -0.8

pop_df['bestfit'] = b0 + b1 * pop_df['x']

plt.figure(figsize=(15, 4))

# Create a scatter plot
plt.scatter(pop_df['x'], pop_df['y'], color='darkslategray', s=50, alpha=0.9)
plt.axline((0, b0), slope=b1, color=orange, linewidth=2)

for x_val, y_val, y_hat_val in zip(pop_df['x'], pop_df['y'], pop_df['bestfit']):
    plt.plot([x_val, x_val], [y_val, y_hat_val], color='darkslategray', linewidth=0.5)

plt.tick_params(axis='both', labelsize=0, length = 0)
plt.box(False)
plt.grid(None)
plt.show()
```

## –ú–ù–ö {.smaller}

–û—Ü—ñ–Ω–∫–∞ –ú–ù–ö ‚Äî —Ü–µ –∫–æ–º–±—ñ–Ω–∞—Ü—ñ—è $\hat{\beta}_0$ —ñ $\hat{\beta}_1$, —è–∫—ñ –º—ñ–Ω—ñ–º—ñ–∑—É—é—Ç—å ESS.

```{python}
#| label: ols-plot-7
#| echo: false

pop_df['bestfit'] = lm0.fittedvalues

plt.figure(figsize=(15, 4))

# Create a scatter plot
plt.scatter(pop_df['x'], pop_df['y'], color='darkslategray', s=50, alpha=0.9)
plt.axline((0, lm0.params[0]), slope=lm0.params[1], color=orange, linewidth=2)

for x_val, y_val, y_hat_val in zip(pop_df['x'], pop_df['y'], pop_df['bestfit']):
    plt.plot([x_val, x_val], [y_val, y_hat_val], color='darkslategray', linewidth=0.5)

plt.tick_params(axis='both', labelsize=0, length = 0)
plt.box(False)
plt.grid(None)
plt.show()
```

## –ú–ù–ö {.smaller}



–£ –ø—Ä–æ—Å—Ç—ñ–π –ª—ñ–Ω—ñ–π–Ω—ñ–π —Ä–µ–≥—Ä–µ—Å—ñ—ó –æ—Ü—ñ–Ω—é–≤–∞—á –ú–ù–ö –≤–∏—Ö–æ–¥–∏—Ç—å —ñ–∑ –≤–∏–±–æ—Ä—É $\hat{\beta}_0$ —ñ $\hat{\beta}_1$, —è–∫—ñ –º—ñ–Ω—ñ–º—ñ–∑—É—é—Ç—å —Å—É–º—É –∫–≤–∞–¥—Ä–∞—Ç—ñ–≤ –ø–æ–º–∏–ª–æ–∫ (ESS), _—Ç–æ–±—Ç–æ_,

$$ \min_{\hat{\beta}_0,\, \hat{\beta}_1} \text{ESS} $$

. . .

–∞–ª–µ –º–∏ –≤–∂–µ –∑–Ω–∞—î–º–æ $\text{ESS} = \sum_i e_i^2$. –¢–µ–ø–µ—Ä —Å–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ—Å—è –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è–º–∏ $e_i$ —ñ $\hat{y}$.

$$
\begin{aligned}
   e_i^2 &= \left( y_i - \hat{y}_i \right)^2 = \left( y_i - \hat{\beta}_0 - \hat{\beta}_1 x_i \right)^2 \\
   &= y_i^2 - 2 y_i \hat{\beta}_0 - 2 y_i \hat{\beta}_1 x_i + \hat{\beta}_0^2 + 2 \hat{\beta}_0 \hat{\beta }_1 x_i + \hat{\beta}_1^2 x_i^2
\end{aligned}
$$

## –ú–ù–ö {.smaller}



–ú–∏ –Ω–∞–±–ª–∏–∂–∞—î–º–æ—Å—å. –ù–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ **–º—ñ–Ω—ñ–º—ñ–∑—É–≤–∞—Ç–∏ ESS**. –ú–∏ –ø–æ–∫–∞–∑–∞–ª–∏, —è–∫ ESS –ø–æ–≤'—è–∑–∞–Ω–æ –∑ –Ω–∞—à–æ—é –≤–∏–±—ñ—Ä–∫–æ—é (–Ω–∞—à—ñ –¥–∞–Ω—ñ: $x$ —ñ $y$) —ñ –Ω–∞—à–∏–º–∏ –æ—Ü—ñ–Ω–∫–∞–º–∏ (_—Ç–æ–±—Ç–æ_, $\hat{\beta}_0$ —ñ $\hat{\beta}_1$).

$$ \text{ESS} = \sum_i e_i^2 = \sum_i \left( y_i^2 - 2 y_i \hat{\beta}_0 - 2 y_i \hat{\beta}_1 x_i + \hat{\beta} _0^2 + 2 \hat{\beta}_0 \hat{\beta}_1 x_i + \hat{\beta}_1^2 x_i^2 \right) $$

–î–ª—è —É–º–æ–≤ –º—ñ–Ω—ñ–º—ñ–∑–∞—Ü—ñ—ó —Ç–µ–ø–µ—Ä –±–µ—Ä–µ–º–æ –ø–µ—Ä—à—ñ –ø–æ—Ö—ñ–¥–Ω—ñ ESS –≤—ñ–¥–Ω–æ—Å–Ω–æ $\hat{\beta}_0$ —ñ $\hat{\beta}_1$.

$$
\begin{aligned}
   \dfrac{\partial \text{ESS}}{\partial \hat{\beta}_0} &= \sum_i \left( 2 \hat{\beta}_0 + 2 \hat{\beta}_1 x_i - 2 y_i \right) = 2n \hat{\beta}_0 + 2 \hat{\beta}_1 \sum_i x_i - 2 \sum_i y_i \\
   &= 2n \hat{\beta}_0 + 2n \hat{\beta}_1 \overline{x} - 2n \overline{y}
\end{aligned}
$$

–¥–µ $\overline{x} = \frac{\sum x_i}{n}$ —ñ $\overline{y} = \frac{\sum y_i}{n}$ —î –≤–∏–±—ñ—Ä–∫–æ–≤–∏–º–∏ —Å–µ—Ä–µ–¥–Ω—ñ–º–∏ $x$ —ñ $y$ ( —Ä–æ–∑–º—ñ—Ä $n$).

## –ú–ù–ö {.smaller}



–ü—Ä–∏—Ä—ñ–≤–Ω—é—î–º–æ –ø–æ—Ö—ñ–¥–Ω—É –¥–æ –Ω—É–ª—è:

$$ \dfrac{\partial \text{ESS}}{\partial \hat{\beta}_0} = 2n \hat{\beta}_0 + 2n \hat{\beta}_1 \overline{x} - 2n \overline{y} = 0 $$

—â–æ –æ–∑–Ω–∞—á–∞—î

::: recap
$$ \hat{\beta}_0 = \overline{y} - \hat{\beta}_1 \overline{x} $$
:::

–¢–µ–ø–µ—Ä –ø—Ä–æ $\hat{\beta}_1$...

## –ú–ù–ö {.smaller}



–í—ñ–∑—å–º—ñ—Ç—å –ø–æ—Ö—ñ–¥–Ω—É ESS –≤—ñ–¥–Ω–æ—Å–Ω–æ $\hat{\beta}_1$

$$
\begin{aligned}
   \dfrac{\partial \text{ESS}}{\partial \hat{\beta}_1} &= \sum_i \left( 2 \hat{\beta}_0 x_i + 2 \hat{\beta}_1 x_i^2 - 2 y_i x_i \right) = 2 \hat{\beta}_0 \sum_i x_i + 2 \hat{\beta}_1 \sum_i x_i^2 - 2 \sum_i y_i x_i \\
   &= 2n \hat{\beta}_0 \overline{x} + 2 \hat{\beta}_1 \sum_i x_i^2 - 2 \sum_i y_i x_i
\end{aligned}
$$

–≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –π–æ–≥–æ —Ä—ñ–≤–Ω–∏–º –Ω—É–ª—é

$$ \dfrac{\partial \text{ESS}}{\partial \hat{\beta}_1} = 2n \hat{\beta}_0 \overline{x} + 2 \hat{\beta}_1 \sum_i x_i ^2 - 2 \sum_i y_i x_i = 0 $$

–∑–∞–º—ñ–Ω—é—î–º–æ $\hat{\beta}_0$, _—Ç–æ–±—Ç–æ_, $\hat{\beta}_0 = \overline{y} - \hat{\beta}_1 \overline{x}$ . –¢–∞–∫–∏–º —á–∏–Ω–æ–º,

$$
  2n \left(\overline{y} - \hat{\beta}_1 \overline{x}\right) \overline{x} + 2 \hat{\beta}_1 \sum_i x_i^2 - 2 \sum_i y_i x_i = 0
$$

## –ú–ù–ö {.smaller}



–ü—Ä–æ–¥–æ–≤–∂—É—é—á–∏ –∑ –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ —Å–ª–∞–π–¥–∞

$$ 2n \left(\overline{y} - \hat{\beta}_1 \overline{x}\right) \overline{x} + 2 \hat{\beta}_1 \sum_i x_i^2 - 2 \sum_i y_i x_i = 0 $$

—Ä–æ–∑–∫—Ä–∏–≤–∞—î–º–æ –¥—É–∂–∫–∏

$$ 2n \overline{y}\,\overline{x} - 2n \hat{\beta}_1 \overline{x}^2 + 2 \hat{\beta}_1 \sum_i x_i^2 - 2 \sum_i y_i x_i = 0 $$

$$ \implies 2 \hat{\beta}_1 \left( \sum_i x_i^2 - n \overline{x}^2 \right) = 2 \sum_i y_i x_i - 2n \overline{y}\,\overline{ x} $$

::: recap
$$ \implies \hat{\beta}_1 = \dfrac{\sum_i y_i x_i - 2n \overline{y}\,\overline{x}}{\sum_i x_i^2 - n \overline{x}^2} = \dfrac{\sum_i (x_i - \overline{x})(y_i - \overline{y})}{\sum_i (x_i - \overline{x})^2} $$
:::

## –ú–ù–ö {.smaller}



–ì–æ—Ç–æ–≤–æ!

–¢–µ–ø–µ—Ä —É –Ω–∞—Å —î –æ—Ü—ñ–Ω—é–≤–∞—á—ñ –ú–ù–ö –¥–ª—è –Ω–∞—Ö–∏–ª—É

$$ \hat{\beta}_1 = \dfrac{\sum_i (x_i - \overline{x})(y_i - \overline{y})}{\sum_i (x_i - \overline{x})^2}$$

—ñ –ø–µ—Ä–µ—Ç–∏–Ω—É

$$ \hat{\beta}_0 = \overline{y} - \hat{\beta}_1 \overline{x} $$

–¢–µ–ø–µ—Ä –º–∏ –ø–æ–≤–µ—Ä–Ω–µ–º–æ—Å—è –¥–æ –ø—Ä–∏–ø—É—â–µ–Ω—å —ñ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç–µ–π –ú–ù–ö.

# –ú–ù–ö: –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ —Ç–∞ –ø—Ä–∏–ø—É—â–µ–Ω–Ω—è {background-color="#eef3f8"}

## –í–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ

–£—è–≤—ñ—Ç—å, —â–æ –º–∏ –Ω–∞–º–∞–≥–∞—î–º–æ—Å—è –æ—Ü—ñ–Ω–∏—Ç–∏ –Ω–µ–≤—ñ–¥–æ–º–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä $\beta$, —ñ –Ω–∞–º –≤—ñ–¥–æ–º—ñ —Ä–æ–∑–ø–æ–¥—ñ–ª–∏ —Ç—Ä—å–æ—Ö –∫–æ–Ω–∫—É—Ä—É—é—á–∏—Ö –æ—Ü—ñ–Ω—é–≤–∞—á—ñ–≤.

–Ø–∫–∏–π –±–∏ –º–∏ –æ–±—Ä–∞–ª–∏?

```{python}
#| label: three-estimators
#| echo: false
#| fig-align: center

# Generate data for density's polygon
x = np.arange(-4, 4.01, 0.01)
y = norm.pdf(x)
y_unif = uniform.pdf(x, loc=-0.5, scale=1.5)
y_norm_2 = norm.pdf(x, loc=1, scale=0.5)
# Plot it
plt.fill_between(x, y, 0, color='darkslategray', alpha=0.6)
plt.fill_between(x, y_unif, 0, color=red_pink, alpha=0.65)
plt.fill_between(x, y_norm_2, 0, color='orange', alpha=0.8)
# add vetical dashed lines at 0
plt.axvline(0, color='black', linewidth=1, linestyle='dashed')
plt.tick_params(left = False, right = False , labelleft = False , 
                labelbottom = False, bottom = False) 
plt.xlabel(r'$\beta$', fontsize=20)
plt.box(False)
plt.grid(None)

plt.show()
```

## –í–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ

**–ü–∏—Ç–∞–Ω–Ω—è:** –Ø–∫—ñ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∞–∂–ª–∏–≤—ñ –¥–ª—è –æ—Ü—ñ–Ω—é–≤–∞—á–∞?

. . .

**–í—ñ–¥–ø–æ–≤—ñ–¥—å –ø–µ—Ä—à–∞: –∑–º—ñ—â–µ–Ω–Ω—è (Bias)**

–ß–∏ –≤ —Å–µ—Ä–µ–¥–Ω—å–æ–º—É (–ø—ñ—Å–ª—è *–±–∞–≥–∞—Ç—å–æ—Ö* –≤–∏–±—ñ—Ä–æ–∫) –æ—Ü—ñ–Ω—é–≤–∞—á –Ω–∞–±–ª–∏–∂–∞—î—Ç—å—Å—è –¥–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–Ω—è?

**–ë—ñ–ª—å—à —Ñ–æ—Ä–º–∞–ª—å–Ω–æ:** –ß–∏ –¥–æ—Ä—ñ–≤–Ω—é—î —Å–µ—Ä–µ–¥–Ω—î –∑–Ω–∞—á–µ–Ω–Ω—è —Ä–æ–∑–ø–æ–¥—ñ–ª—É –æ—Ü—ñ–Ω—é–≤–∞—á–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä—É, —è–∫–∏–π –≤—ñ–Ω –æ—Ü—ñ–Ω—é—î?

$$ \mathop{\text{Bias}}_\beta \left( \hat{\beta} \right) = \mathop{\boldsymbol{E}}\left[ \hat{\beta} \right] - \beta $$

## –í–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ

**–í—ñ–¥–ø–æ–≤—ñ–¥—å –ø–µ—Ä—à–∞: –∑–º—ñ—â–µ–Ω–Ω—è (Bias)**

:::: {.columns}

::: {.column}
**–ù–µ–∑–º—ñ—â–µ–Ω–Ω–∞ –æ—Ü—ñ–Ω–∫–∞:** $\mathop{\boldsymbol{E}}\left[ \hat{\beta} \right] = \beta$

```{python}
#| label: unbiased-pdf
#| echo: false

plt.fill_between(x, y, 0, color=red_pink, alpha=0.9)
# add vetical dashed lines at 0
plt.axvline(0, color='black', linewidth=1, linestyle='dashed')
plt.tick_params(left = False, right = False , labelleft = False , 
                labelbottom = False, bottom = False) 
plt.xlabel(r'$\beta$', fontsize=20)

plt.box(False)
plt.grid(None)

plt.show()
```
:::

::: {.column}
**–ó–º—ñ—â–µ–Ω–Ω–∞ –æ—Ü—ñ–Ω–∫–∞:** $\mathop{\boldsymbol{E}}\left[ \hat{\beta} \right] \neq \beta$

```{python}
#| label: biased-pdf
#| echo: false
fig, ax = plt.subplots()
plt.fill_between(x, y, 0, color='darkslategray', alpha=0.9)
# add vetical dashed lines at 0
plt.axvline(-2, color='black', linewidth=1, linestyle='dashed')
plt.tick_params(left = False, right = False , labelleft = False , 
                labelbottom = False, bottom = False) 
ax.set_xlabel(r'$\beta$', fontsize=20)
ax.xaxis.set_label_coords(.27, 0)
plt.box(False)
plt.grid(None)

plt.show()
```
:::

::::

## –í–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ

**–í—ñ–¥–ø–æ–≤—ñ–¥—å –¥—Ä—É–≥–∞: –¥–∏—Å–ø–µ—Ä—Å—ñ—è (Variance).**

. . .

–í–∞–∂–ª–∏–≤—ñ –Ω–µ –ª–∏—à–µ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ñ —Ç–µ–Ω–¥–µ–Ω—Ü—ñ—ó –∫–æ–Ω–∫—É—Ä—É—é—á–∏—Ö —Ä–æ–∑–ø–æ–¥—ñ–ª—ñ–≤. 

–ú–∏ —Ç–∞–∫–æ–∂ –¥–±–∞—î–º–æ –ø—Ä–æ **–¥–∏—Å–ø–µ—Ä—Å—ñ—é** –æ—Ü—ñ–Ω—é–≤–∞—á–∞.

$$ \mathop{\text{Var}} \left( \hat{\beta} \right) = \mathop{\boldsymbol{E}}\left[ \left( \hat{\beta} - \mathop{\boldsymbol{E}}\left[ \hat{\beta} \right] \right)^2 \right] $$

–ú–µ–Ω—à—ñ –æ—Ü—ñ–Ω–∫–∏ –¥–∏—Å–ø–µ—Ä—Å—ñ—ó –æ–∑–Ω–∞—á–∞—é—Ç—å, —â–æ –º–∏ –æ—Ç—Ä–∏–º—É—î–º–æ –æ—Ü—ñ–Ω–∫–∏ –±–ª–∏–∂—á–µ –¥–æ —Å–µ—Ä–µ–¥–Ω—å–æ–≥–æ –≤ –∫–æ–∂–Ω—ñ–π –≤–∏–±—ñ—Ä—Ü—ñ.

## –í–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ

**–í—ñ–¥–ø–æ–≤—ñ–¥—å –¥—Ä—É–≥–∞: –¥–∏—Å–ø–µ—Ä—Å—ñ—è (Variance).**

```{python}
#| label: variance-pdf
#| echo: false

# Generate data for density's polygon
x = np.arange(-4, 4.01, 0.01)
y = norm.pdf(x)
y_norm_2 = norm.pdf(x, loc=0, scale=0.5)
# Plot it
plt.fill_between(x, y_norm_2, 0, color=red_pink, alpha=0.8)
plt.fill_between(x, y, 0, color='darkslategray', alpha=0.6)
# add vetical dashed lines at 0
plt.axvline(0, color='black', linewidth=1, linestyle='dashed')
plt.tick_params(left = False, right = False , labelleft = False , 
                labelbottom = False, bottom = False) 
plt.xlabel(r'$\beta$', fontsize=20)
plt.box(False)
plt.grid(None)

plt.show()
```

## –í–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ

**–í—ñ–¥–ø–æ–≤—ñ–¥—å –ø–µ—Ä—à–∞: –∑–º—ñ—â–µ–Ω–Ω—è**

**–í—ñ–¥–ø–æ–≤—ñ–¥—å –¥—Ä—É–≥–∞: –¥–∏—Å–ø–µ—Ä—Å—ñ—è**

**–¢–æ–Ω–∫–æ—â—ñ:** –ö–æ–º–ø—Ä–æ–º—ñ—Å –∑–º—ñ—â–µ–Ω–Ω—è-–¥–∏—Å–ø–µ—Ä—Å—ñ—ó (*bias-variance tradeoff*).

–ß–∏ –≥–æ—Ç–æ–≤—ñ –º–∏ –ø—Ä–∏–π–Ω—è—Ç–∏ –∑–º—ñ—â–µ–Ω–Ω—è, —â–æ–± –∑–º–µ–Ω—à–∏—Ç–∏ –¥–∏—Å–ø–µ—Ä—Å—ñ—é?

–í —Å—Ç–∞—Ç–∏—Å—Ç–∏—Ü—ñ –º–∏ –∑–∞–∑–≤–∏—á–∞–π –¥–æ—Ç—Ä–∏–º—É—î–º–æ—Å—è –Ω–µ–∑–º—ñ—â–µ–Ω–∏—Ö –æ—Ü—ñ–Ω–æ–∫. –ê–ª–µ —ñ–Ω—à—ñ –¥–∏—Å—Ü–∏–ø–ª—ñ–Ω–∏ (–æ—Å–æ–±–ª–∏–≤–æ —É —Å—Ñ–µ—Ä—ñ ML) –±—ñ–ª—å—à–µ –¥—É–º–∞—é—Ç—å –ø—Ä–æ —Ü–µ–π –∫–æ–º–ø—Ä–æ–º—ñ—Å.

## The bias-variance tradeoff.

```{python}
#| label: variance-bias
#| echo: false

# Generate data for density's polygon
x = np.arange(-4, 4.01, 0.01)
y = norm.pdf(x)
y_norm_2 = norm.pdf(x, loc=0.5, scale=0.5)
# Plot it
plt.fill_between(x, y_norm_2, 0, color=red_pink, alpha=0.8)
plt.fill_between(x, y, 0, color='darkslategray', alpha=0.6)
# add vetical dashed lines at 0
plt.axvline(0, color='black', linewidth=1, linestyle='dashed')
plt.tick_params(left = False, right = False , labelleft = False , 
                labelbottom = False, bottom = False) 
plt.xlabel(r'$\beta$', fontsize=20)
plt.box(False)
plt.grid(None)

plt.show()
```

## –í–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ

–Ø–∫ –≤–∏ –≤–∂–µ –º–æ–≥–ª–∏ –∑–¥–æ–≥–∞–¥–∞—Ç–∏—Å—è,

- –ú–ù–ö —î **–Ω–µ–∑–º—ñ—â–µ–Ω–æ—é –æ—Ü—ñ–Ω–∫–æ—é**.
- –ú–ù–ö –º–∞—î **–º—ñ–Ω—ñ–º–∞–ª—å–Ω–µ –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è** —Å–µ—Ä–µ–¥ —É—Å—ñ—Ö –Ω–µ–∑–º—ñ—â–µ–Ω–∏—Ö –ª—ñ–Ω—ñ–π–Ω–∏—Ö –æ—Ü—ñ–Ω—é–≤–∞—á—ñ–≤.

## –í–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ

–ê–ª–µ... —Ü—ñ (–¥—É–∂–µ –≥–∞—Ä–Ω—ñ) –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ –∑–∞–ª–µ–∂–∞—Ç—å –≤—ñ–¥ —Ä—è–¥—É –ø—Ä–∏–ø—É—â–µ–Ω—å:

1. –ó–≤'—è–∑–æ–∫ –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ—ó —Å—É–∫—É–ø–Ω–æ—Å—Ç—ñ —î –ª—ñ–Ω—ñ–π–Ω–∏–º.

2. –ù–∞—à–∞ –∑–º—ñ–Ω–Ω–∞ $X$ —î **–µ–∫–∑–æ–≥–µ–Ω–Ω–æ—é**, _—Ç–æ–±—Ç–æ_, $\mathop{\boldsymbol{E}}\left[ u \mid X \right] = 0$.

3. –ó–º—ñ–Ω–Ω–∞ $X$ –º–∞—î –≤–∞—Ä—ñ–∞—Ü—ñ—é. –Ü —è–∫—â–æ —ñ—Å–Ω—É—î –∫—ñ–ª—å–∫–∞ –ø–æ—è—Å–Ω—é–≤–∞–ª—å–Ω–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö, –≤–æ–Ω–∏ –Ω–µ —î –∞–±—Å–æ–ª—é—Ç–Ω–æ –∫–æ–ª—ñ–Ω–µ–∞—Ä–Ω–∏–º–∏.

4. –ó–±—É—Ä–µ–Ω–Ω—è –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ—ó —Å—É–∫—É–ø–Ω–æ—Å—Ç—ñ $u_i$ –Ω–µ–∑–∞–ª–µ–∂–Ω–æ —Ç–∞ –æ–¥–Ω–∞–∫–æ–≤–æ —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω—ñ –∑–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–∏–º –∑–∞–∫–æ–Ω–æ–º —Ä–æ–∑–ø–æ–¥—ñ–ª—É —ñ–∑ —Å–µ—Ä–µ–¥–Ω—ñ–º –≤ –Ω—É–ª—ñ $\left( \mathop{\boldsymbol{E}}\left[ u \right] = 0 \right)$ —Ç–∞ –¥–∏—Å–ø–µ—Ä—Å—ñ—î—é $\sigma^2$ (_—Ç–æ–±—Ç–æ_, $\mathop{\boldsymbol{E}}\left[ u^2 \right] = \sigma^2$).

::: footer
üîó[Diagnostics for simple linear regression](https://gallery.shinyapps.io/slr_diag/)
:::

## –ü—Ä–∏–ø—É—â–µ–Ω–Ω—è

–†—ñ–∑–Ω—ñ –ø—Ä–∏–ø—É—â–µ–Ω–Ω—è –≥–∞—Ä–∞–Ω—Ç—É—é—Ç—å —Ä—ñ–∑–Ω—ñ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ:

- –ü—Ä–∏–ø—É—â–µ–Ω–Ω—è (1), (2) —ñ (3) —Ä–æ–±–ª—è—Ç—å OLS –Ω–µ–∑–º—ñ—â–µ–Ω–∏–º.

- –ü—Ä–∏–ø—É—â–µ–Ω–Ω—è (4) –¥–∞—î –Ω–∞–º –Ω–µ–∑–º—ñ—â–µ–Ω—É –æ—Ü—ñ–Ω–∫—É –¥–ª—è –¥–∏—Å–ø–µ—Ä—Å—ñ—ó –Ω–∞—à–∏—Ö –æ—Ü—ñ–Ω–æ–∫ –ú–ù–ö.

## –£–º–æ–≤–Ω–µ —Å–ø–æ–¥—ñ–≤–∞–Ω–Ω—è {.smaller}

–î–ª—è –±–∞–≥–∞—Ç—å–æ—Ö –≤–∏–ø–∞–¥–∫—ñ–≤, –Ω–∞—à–∏–º –Ω–∞–π–≤–∞–∂–ª–∏–≤—ñ—à–∏–º –ø—Ä–∏–ø—É—â–µ–Ω–Ω—è–º —î **–µ–∫–∑–æ–≥–µ–Ω–Ω—ñ—Å—Ç—å**, _—Ç–æ–±—Ç–æ_,
$$
\begin{align}
   \mathop{E}\left[ u \mid X \right] = 0
\end{align}
$$
–∞–ª–µ —â–æ —Ü–µ –Ω–∞—Å–ø—Ä–∞–≤–¥—ñ –æ–∑–Ω–∞—á–∞—î?

. . .

–û–¥–∏–Ω —ñ–∑ —Å–ø–æ—Å–æ–±—ñ–≤ –ø–æ–¥—É–º–∞—Ç–∏ –ø—Ä–æ —Ü–µ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è:

> –î–ª—è *–±—É–¥—å-—è–∫–æ–≥–æ* –∑–Ω–∞—á–µ–Ω–Ω—è $X$ —Å–µ—Ä–µ–¥–Ω—î –∑–Ω–∞—á–µ–Ω–Ω—è –∑–∞–ª–∏—à–∫—ñ–≤ –º–∞—î –¥–æ—Ä—ñ–≤–Ω—é–≤–∞—Ç–∏ –Ω—É–ª—é.

- _–ù–∞–ø—Ä–∏–∫–ª–∞–¥_, $\mathop{E}\left[ u \mid X=1 \right]=0$ *—ñ* $\mathop{E}\left[ u \mid X=100 \right]= 0$

- _–ù–∞–ø—Ä–∏–∫–ª–∞–¥_, $\mathop{E}\left[ u \mid X_2=\text{–ñ—ñ–Ω–∫–∞} \right]=0$ *—ñ* $\mathop{E}\left[ u \mid X_2=\text{–ß–æ–ª–æ–≤—ñ–∫} \right]=0$

---

–ì—Ä–∞—Ñ—ñ—á–Ω–æ...

---

–î—ñ–π—Å–Ω–∞ –µ–∫–∑–æ–≥–µ–Ω–Ω—ñ—Å—Ç—å, _—Ç–æ–±—Ç–æ_, $\mathop{E}\left[ u \mid X \right] = 0$

```{python}
#| label: ex-good-exog
#| echo: false

import joypy

np.random.seed(123)

n = 1000

# Sample data
df = pd.DataFrame({'var1': np.random.normal(0, 0.5, n),
                   'group': [i for i in np.random.choice(list(range(4, -5, -1)), n)]})



fig, ax = joypy.joyplot(df, by = "group", column = "var1")
plt.xlabel('u')
plt.ylabel('X')
plt.show() 
```

---

–ù–µ–¥—ñ–π—Å–Ω–∞ –µ–∫–∑–æ–≥–µ–Ω–Ω—ñ—Å—Ç—å, _i.e._, $\mathop{E}\left[ u \mid X \right] \neq 0$

```{python}
#| label: ex-bad-exog
#| echo: false

# Add Bais to the data
df['var2'] = df['var1'] + 0.5 * df['group']

fig, ax = joypy.joyplot(df, by = "group", column = "var2")
plt.xlabel('u')
plt.ylabel('X')
plt.show() 
```

# –ù–µ–≤–∏–∑–Ω–∞—á–µ–Ω—ñ—Å—Ç—å —Ç–∞ –ø–æ–º–∏–ª–∫–∏ {background-color="#eef3f8"}

## –©–æ—Å—å —â–µ?

–î–æ —Ü—å–æ–≥–æ –º–æ–º–µ–Ω—Ç—É –º–∏ –∑–Ω–∞—î–º–æ, —â–æ –ú–ù–ö –º–∞—î –¥–µ—è–∫—ñ —Ö–æ—Ä–æ—à—ñ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ, —ñ –º–∏ –∑–Ω–∞—î–º–æ, —è–∫ –æ—Ü—ñ–Ω–∏—Ç–∏ –ø–µ—Ä–µ—Ç–∏–Ω —ñ –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –Ω–∞—Ö–∏–ª—É –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –ú–ù–ö.

–ù–∞—à –ø–æ—Ç–æ—á–Ω–∏–π —Ä–æ–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å:

- –û—Ç—Ä–∏–º–∞—Ç–∏ –¥–∞–Ω—ñ (—Ç–æ—á–∫–∏ –∑—ñ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏ $x$ —ñ $y$)
- –ü–æ–±—É–¥—É–≤–∞—Ç–∏ –º–æ–¥–µ–ª—å $y$ –Ω–∞ $x$
- –ü–æ–±—É–¥—É–π—Ç–µ –ª—ñ–Ω—ñ—é –ú–ù–ö (_—Ç–æ–±—Ç–æ_, $\hat{y} = \hat{\beta}_0 + \hat{\beta}_1$)
- –ì–æ—Ç–æ–≤–æ?

–ê–ª–µ —á–æ–≥–æ –º–∏ **–Ω–∞–≤—á–∏–º–æ—Å—è** –∑ —Ü—ñ—î—ó –≤–ø—Ä–∞–≤–∏?

## –©–æ—Å—å —â–µ? –¢–∞–∫!

–ê–ª–µ —á–æ–≥–æ –º–∏ **–Ω–∞–≤—á–∏–º–æ—Å—è** –∑ —Ü—ñ—î—ó –≤–ø—Ä–∞–≤–∏?

- –ù–∞—Å–∫—ñ–ª—å–∫–∏ –º–∏ –ø–æ–≤–∏–Ω–Ω—ñ –±—É—Ç–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ –≤ —Ç–æ—á–Ω–æ—Å—Ç—ñ –Ω–∞—à–∏—Ö –æ—Ü—ñ–Ω–æ–∫?
- –ù–∞—Å–∫—ñ–ª—å–∫–∏ –¥–æ–±—Ä–µ –Ω–∞—à–∞ –º–æ–¥–µ–ª—å –ø–æ—è—Å–Ω—é—î –∑–º—ñ–Ω—É $y$?

–ú–∏ –ø–æ–≤–∏–Ω–Ω—ñ –≤–º—ñ—Ç–∏ —Å–ø—Ä–∞–≤–ª—è—Ç–∏—Å—è –∑ –Ω–µ–≤–∏–∑–Ω–∞—á–µ–Ω—ñ—Å—Ç—é. 

## –í—á–∏–º–æ—Å—è –Ω–∞ –ø–æ–º–∏–ª–∫–∞—Ö

–Ø–∫ –ø–æ–∫–∞–∑–∞–ª–æ –Ω–∞—à–µ –ø–æ–ø–µ—Ä–µ–¥–Ω—î –º–æ–¥–µ–ª—é–≤–∞–Ω–Ω—è, –Ω–∞—à–∞ –ø—Ä–æ–±–ª–µ–º–∞ –∑ **–Ω–µ–≤–∏–∑–Ω–∞—á–µ–Ω—ñ—Å—Ç—é** –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, —â–æ –º–∏ –Ω–µ –∑–Ω–∞—î–º–æ, —á–∏ –Ω–∞—à–∞ –≤–∏–±—ñ—Ä–∫–æ–≤–∞ –æ—Ü—ñ–Ω–∫–∞ *–±–ª–∏–∑—å–∫–∞* —á–∏ *–¥–∞–ª–µ–∫–∞* –≤—ñ–¥ –Ω–µ–≤—ñ–¥–æ–º–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ—ó —Å—É–∫—É–ø–Ω–æ—Å—Ç—ñ.

–ü—Ä–æ—Ç–µ —â–µ –Ω–µ –≤—Å–µ –≤—Ç—Ä–∞—á–µ–Ω–æ. –ú–∏ –º–æ–∂–µ–º–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –ø–æ–º–∏–ª–∫–∏ $\left(e_i = y_i - \hat{y}_i\right)$, —â–æ–± –∑—Ä–æ–∑—É–º—ñ—Ç–∏, –Ω–∞—Å–∫—ñ–ª—å–∫–∏ –¥–æ–±—Ä–µ –Ω–∞—à–∞ –º–æ–¥–µ–ª—å –ø–æ—è—Å–Ω—é—î –≤–∞—Ä—ñ–∞—Ü—ñ—é $y$.

–ö–æ–ª–∏ –∑–¥–∞—î—Ç—å—Å—è, —â–æ –Ω–∞—à–∞ –º–æ–¥–µ–ª—å –≤–∏–∫–æ–Ω—É—î ¬´–≥–∞—Ä–Ω—É¬ª —Ä–æ–±–æ—Ç—É, –º–∏ –º–æ–∂–µ–º–æ –∑ –±—ñ–ª—å—à–æ—é –≤–ø–µ–≤–Ω–µ–Ω—ñ—Å—Ç—é –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —ó—ó, —â–æ–± –¥—ñ–∑–Ω–∞—Ç–∏—Å—è –ø—Ä–æ –∑–≤'—è–∑–æ–∫ –º—ñ–∂ $y$ —ñ $x$.

–¢–µ–ø–µ—Ä –Ω–∞–º –ø—Ä–æ—Å—Ç–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ —Ñ–æ—Ä–º–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –≤–∏—â–µ–∑–∞–∑–Ω–∞—á–µ–Ω–µ.

## –í—á–∏–º–æ—Å—è –Ω–∞ –ø–æ–º–∏–ª–∫–∞—Ö

–°–ø–æ—á–∞—Ç–∫—É –º–∏ –æ—Ü—ñ–Ω–∏–º–æ –¥–∏—Å–ø–µ—Ä—Å—ñ—é $u_i$ (–Ω–∞–≥–∞–¥–∞—î–º–æ: $\mathop{\text{Var}} \left( u_i \right) = \sigma^2$), –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –Ω–∞—à—ñ –∫–≤–∞–¥—Ä–∞—Ç–∏ –ø–æ–º–∏–ª–æ–∫, _—Ç–æ–±—Ç–æ_,

$$ s^2 = \dfrac{\sum_i e_i^2}{n - k} $$

–¥–µ $k$ –¥–∞—î –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –º–æ–¥–µ–ª—ñ, —è–∫—É –º–∏ –æ—Ü—ñ–Ω—é—î–º–æ (_–Ω–∞–ø—Ä–∏–∫–ª–∞–¥_, $\beta_0$ —ñ $\beta_1$ –¥–∞–¥—É—Ç—å $k=2$).

$s^2$ —î –Ω–µ–∑–º—ñ—â–µ–Ω–æ—é –æ—Ü—ñ–Ω–∫–æ—é $\sigma^2$.

## –í—á–∏–º–æ—Å—è –Ω–∞ –ø–æ–º–∏–ª–∫–∞—Ö

–î–∏—Å–ø–µ—Ä—Å—ñ—è $\hat{\beta}_1$ (–¥–ª—è –ø—Ä–æ—Å—Ç–æ—ó –ª—ñ–Ω—ñ–π–Ω–æ—ó —Ä–µ–≥—Ä–µ—Å—ñ—ó) –¥–æ—Ä—ñ–≤–Ω—é—î

$$ \mathop{\text{Var}} \left( \hat{\beta}_1 \right) = \dfrac{s^2}{\sum_i \left( x_i - \overline{x} \right)^2 } $$

—è–∫–∏–π –ø–æ–∫–∞–∑—É—î, —â–æ –¥–∏—Å–ø–µ—Ä—Å—ñ—è –Ω–∞—à–æ–≥–æ –æ—Ü—ñ–Ω—é–≤–∞—á–∞ –Ω–∞—Ö–∏–ª—É

1. –∑–±—ñ–ª—å—à—É—î—Ç—å—Å—è, –æ—Å–∫—ñ–ª—å–∫–∏ –Ω–∞—à—ñ –∑–±—É—Ä–µ–Ω–Ω—è —Å—Ç–∞—é—Ç—å —à—É–º–Ω—ñ—à–∏–º–∏

2. –∑–º–µ–Ω—à—É—î—Ç—å—Å—è –∑—ñ –∑–±—ñ–ª—å—à–µ–Ω–Ω—è–º –¥–∏—Å–ø–µ—Ä—Å—ñ—ó $x$

## –í—á–∏–º–æ—Å—è –Ω–∞ –ø–æ–º–∏–ª–∫–∞—Ö

*–ù–∞–π—á–∞—Å—Ç—ñ—à–µ:* **—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞ –ø–æ–º–∏–ª–∫–∞** $\hat{\beta}_1$

$$ \mathop{\hat{\text{SE}}} \left( \hat{\beta}_1 \right) = \sqrt{\dfrac{s^2}{\sum_i \left( x_i - \overline{ x} \right)^2}} $$

*–ù–∞–≥–∞–¥—É—î–º–æ:* –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞ –ø–æ–º–∏–ª–∫–∞ –æ—Ü—ñ–Ω—é–≤–∞—á–∞ ‚Äî —Ü–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–µ –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è —Ä–æ–∑–ø–æ–¥—ñ–ª—É –æ—Ü—ñ–Ω—é–≤–∞—á–∞.

## –ú–ù–ö –≤ Python {.smaller}

::: {.panel-tabset}

### Statsmodels v1

```{python}
#| label: lm-statsmodels-2

import statsmodels.formula.api as smf

results = smf.ols('Global_Sales ~ NA_Sales', vgsales).fit()
print(results.summary())
```

### Statsmodels v2

```{python}
#| label: lm-statsmodels-1

import statsmodels.api as sm

X = sm.add_constant(vgsales.NA_Sales)
model = sm.OLS(vgsales.Global_Sales, X)
result = model.fit()
print(result.summary())
```

### SciPy

[–¢—ñ–ª—å–∫–∏ –ø–∞—Ä–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è]{.red}

```{python}
#| label: lm-scipy

from scipy import stats

stats.linregress(x=vgsales.NA_Sales, y=vgsales.Global_Sales)
```

### Sklearn

```{python}
#| label: lm-sklearn

from sklearn.linear_model import LinearRegression

X = vgsales[['NA_Sales']]
y = vgsales['Global_Sales']

model = LinearRegression()
model.fit(X, y)
print(model.intercept_, model.coef_, model.score(X, y))
```
:::

## –í—á–∏–º–æ—Å—è –Ω–∞ –ø–æ–º–∏–ª–∫–∞—Ö

–ú–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É –ø–æ–º–∏–ª–∫—É $\hat{SE_{\hat{\beta}_1}}$ —Ä–∞–∑–æ–º —ñ–∑ —Å–∞–º–∏–º $\hat{\beta}_1$, —â–æ–± –¥—ñ–∑–Ω–∞—Ç–∏—Å—è –ø—Ä–æ –ø–∞—Ä–∞–º–µ—Ç—Ä $\beta_1$.

–ü—ñ—Å–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —Ä–æ–∑–ø–æ–¥—ñ–ª—É $\hat{\beta}_1$, —É –Ω–∞—Å —î –¥–≤–∞ (–ø–æ–≤'—è–∑–∞–Ω–∏—Ö) –≤–∞—Ä—ñ–∞–Ω—Ç–∏ —Ñ–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–æ–≥–æ –≤–∏—Å–Ω–æ–≤–∫—É —â–æ–¥–æ –Ω–∞—à–æ–≥–æ –Ω–µ–≤—ñ–¥–æ–º–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ $\beta_1$:

- **–î–æ–≤—ñ—Ä—á—ñ —ñ–Ω—Ç–µ—Ä–≤–∞–ª–∏:** –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –æ—Ü—ñ–Ω–∫—É —Ç–∞ —ó—ó —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É –ø–æ–º–∏–ª–∫—É, —â–æ–± —Å—Ç–≤–æ—Ä–∏—Ç–∏ —ñ–Ω—Ç–µ—Ä–≤–∞–ª, —è–∫–∏–π –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–µ–Ω–Ω—ñ –∑–∞–∑–≤–∏—á–∞–π –º—ñ—Å—Ç–∏—Ç–∏–º–µ —Å–ø—Ä–∞–≤–∂–Ω—ñ–π –ø–∞—Ä–∞–º–µ—Ç—Ä.

- **–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≥—ñ–ø–æ—Ç–µ–∑–∏:** –í–∏–∑–Ω–∞—á—Ç–µ, —á–∏ —î —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–æ –∑–Ω–∞—á—É—â—ñ –¥–æ–∫–∞–∑–∏ –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è –≥—ñ–ø–æ—Ç–µ—Ç–∏—á–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–Ω—è –∞–±–æ –¥—ñ–∞–ø–∞–∑–æ–Ω—É –∑–Ω–∞—á–µ–Ω—å.

# –î–æ–≤—ñ—Ä—á—ñ —ñ–Ω—Ç–µ—Ä–≤–∞–ª–∏ {background-color="#eef3f8"}

## –î–æ–≤—ñ—Ä—á—ñ —ñ–Ω—Ç–µ—Ä–≤–∞–ª–∏

–ë—É–¥—É—î–º–æ –¥–æ–≤—ñ—Ä—á—ñ —ñ–Ω—Ç–µ—Ä–≤–∞–ª–∏ —Ä—ñ–≤–Ω—è $(1-\alpha)$ –¥–ª—è $\beta_1$
$$ \hat{\beta_1}\ \pm t_{\alpha/2,\text{df}} \, \mathop{\hat{\text{SE}}} \left( \hat{\beta_1} \right) $$

$t_{\alpha/2,\text{df}}$ –ø–æ–∑–Ω–∞—á–∞—î $\alpha/2$ –∫–≤–∞–Ω—Ç–∏–ª—å $t$ —Ä–æ–∑–ø–æ–¥—ñ–ª—É –∑ $n-k$ —Å—Ç—É–ø–µ–Ω—è–º–∏ —Å–≤–æ–±–æ–¥–∏.

## –î–æ–≤—ñ—Ä—á—ñ —ñ–Ω—Ç–µ—Ä–≤–∞–ª–∏ {.smaller}

–ë—É–¥—É—î–º–æ –¥–æ–≤—ñ—Ä—á—ñ —ñ–Ω—Ç–µ—Ä–≤–∞–ª–∏ —Ä—ñ–≤–Ω—è $(1-\alpha)$ –¥–ª—è $\beta_1$
$$ \hat{\beta_1}\ \pm t_{\alpha/2,\text{df}} \, \mathop{\hat{\text{SE}}} \left( \hat{\beta_1} \right) $$

–ù–∞–ø—Ä–∏–∫–ª–∞–¥, 100 —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω—å, –¥–≤–∞ –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç–∏ (_—Ç–æ–±—Ç–æ_, $\hat{\beta}_0$ —ñ $\hat{\beta}_1 \implies k = 2$), —ñ $\alpha = 0,05$ ( –¥–ª—è 95% –¥–æ–≤—ñ—Ä—á–æ–≥–æ —ñ–Ω—Ç–µ—Ä–≤–∞–ª—É) –¥–∞—î –Ω–∞–º $t_{0,025,\,98} = `{python} round(t.ppf(0.025, df=98), 2)`$

```{python}
#| label: t-dist
#| echo: false
#| fig-align: center

x = np.arange(-4, 4.01, 0.01)
y = stats.t.pdf(x, df=98)

plt.fill_between(x[(x > -4) & (x < -1.98)], stats.t.pdf(x[(x > -4) & (x < -1.98)], df=98), 0, color=red_pink)
plt.fill_between(x[(x > -1.98) & (x < 4)], stats.t.pdf(x[(x > -1.98) & (x < 4)], df=98), 0, color='gray', alpha=0.6)
plt.axvline(-1.98, color='black', linewidth=1)
plt.tick_params(left = False, right = False , labelleft = False , 
                labelbottom = True, bottom = False)
plt.box(False)
plt.grid(None)
plt.show()
```

## –î–æ–≤—ñ—Ä—á—ñ —ñ–Ω—Ç–µ—Ä–≤–∞–ª–∏ {.smaller}

–ë—É–¥—É—î–º–æ –¥–æ–≤—ñ—Ä—á—ñ —ñ–Ω—Ç–µ—Ä–≤–∞–ª–∏ —Ä—ñ–≤–Ω—è $(1-\alpha)$ –¥–ª—è $\beta_1$

:::: {.columns}

::: {.column width="70%"}
```{python}
#| label: ci-py-output
#| echo: true

results = smf.ols('y ~ x', pop_df).fit()
print(results.summary())
```
:::

::: {.column width="30%"}

$$ \hat{\beta_1}\ \pm t_{\alpha/2,\text{df}} \, \mathop{\hat{\text{SE}}} \left( \hat{\beta_1} \right) $$

–û—Ç–∂–µ, –Ω–∞—à 95% –¥–æ–≤—ñ—Ä—á–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª —Å—Ç–∞–Ω–æ–≤–∏—Ç—å $0.7216 \pm 1.98 \times 0.067 = \left[ 0.589,\, 0.854 \right]$
:::

::::

## –î–æ–≤—ñ—Ä—á—ñ —ñ–Ω—Ç–µ—Ä–≤–∞–ª–∏

–û—Ç–∂–µ, –º–∏ –º–∞—î–º–æ –¥–æ–≤—ñ—Ä—á–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è $\beta_1$, _—Ç–æ–±—Ç–æ_, $\left[ 0.589,\, 0.854 \right]$.

–©–æ —Ü–µ –æ–∑–Ω–∞—á–∞—î?

. . .

**–ù–µ–æ—Ñ—ñ—Ü—ñ–π–Ω–æ:** –î–æ–≤—ñ—Ä—á–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª –¥–∞—î –Ω–∞–º –æ–±–ª–∞—Å—Ç—å (—ñ–Ω—Ç–µ—Ä–≤–∞–ª), –≤ —è–∫—ñ–π –º–∏ –º–æ–∂–µ–º–æ –ø–µ–≤–Ω–æ—é –º—ñ—Ä–æ—é –¥–æ–≤—ñ—Ä—è—Ç–∏ —â–æ–¥–æ –≤–º—ñ—Å—Ç—É –ø–∞—Ä–∞–º–µ—Ç—Ä–∞.

. . .

**–ë—ñ–ª—å—à —Ñ–æ—Ä–º–∞–ª—å–Ω–æ:** –Ø–∫—â–æ –Ω–µ–æ–¥–Ω–æ—Ä–∞–∑–æ–≤–æ —Ä–æ–±–∏—Ç–∏ –≤–∏–±—ñ—Ä–∫—É –∑ –Ω–∞—à–æ—ó —Å—É–∫—É–ø–Ω–æ—Å—Ç—ñ —Ç–∞ –±—É–¥—É–≤–∞—Ç–∏ –¥–æ–≤—ñ—Ä—á—ñ —ñ–Ω—Ç–µ—Ä–≤–∞–ª–∏ –¥–ª—è –∫–æ–∂–Ω–æ—ó –∑ —Ü–∏—Ö –≤–∏–±—ñ—Ä–æ–∫, $(1-\alpha)$ –≤—ñ–¥—Å–æ—Ç–∫—ñ–≤ –Ω–∞—à–∏—Ö —ñ–Ω—Ç–µ—Ä–≤–∞–ª—ñ–≤ (*–Ω–∞–ø—Ä–∏–∫–ª–∞–¥*, 95%) –º—ñ—Å—Ç–∏—Ç–∏–º–µ –ø–∞—Ä–∞–º–µ—Ç—Ä –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ—ó —Å—É–∫—É–ø–Ω–æ—Å—Ç—ñ *–¥–µ—Å—å –≤ —ñ–Ω—Ç–µ—Ä–≤–∞–ª—ñ*.

. . .

–¢–µ–ø–µ—Ä –ø–æ–≤–µ—Ä–Ω–µ–º–æ—Å—è –¥–æ –Ω–∞—à–æ—ó —Å–∏–º—É–ª—è—Ü—ñ—ó...

## –î–æ–≤—ñ—Ä—á—ñ —ñ–Ω—Ç–µ—Ä–≤–∞–ª–∏

–ú–∏ –≤—ñ–¥—ñ–±—Ä–∞–ª–∏ 10 000 –≤–∏–±—ñ—Ä–æ–∫ (–∫–æ–∂–Ω–∞ —Ä–æ–∑–º—ñ—Ä–æ–º $n = 30$) —ñ–∑ –Ω–∞—à–æ—ó —Å—É–∫—É–ø–Ω–æ—Å—Ç—ñ —Ç–∞ –æ—Ü—ñ–Ω–∏–ª–∏ –Ω–∞—à—É —Ä–µ–≥—Ä–µ—Å—ñ–π–Ω—É –º–æ–¥–µ–ª—å –¥–ª—è –∫–æ–∂–Ω–æ—ó –∑ —Ü–∏—Ö —Å–∏–º—É–ª—è—Ü—ñ–π:

$$ y_i = \hat{\beta}_0 + \hat{\beta}_1 x_i + e_i $$
<center>(–ø–æ–≤—Ç–æ—Ä—é—î—Ç—å—Å—è 10 000 —Ä–∞–∑—ñ–≤)</center>

–¢–µ–ø–µ—Ä –¥–∞–≤–∞–π—Ç–µ –æ—Ü—ñ–Ω–∏–º–æ 95% –¥–æ–≤—ñ—Ä—á—ñ —ñ–Ω—Ç–µ—Ä–≤–∞–ª–∏ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –∑ —Ü–∏—Ö —ñ–Ω—Ç–µ—Ä–≤–∞–ª—ñ–≤...

## –î–æ–≤—ñ—Ä—á—ñ —ñ–Ω—Ç–µ—Ä–≤–∞–ª–∏

**–ó –Ω–∞—à–æ–≥–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ –º–æ–¥–µ–ª—é–≤–∞–Ω–Ω—è:** 97.5% 95% –¥–æ–≤—ñ—Ä—á–∏—Ö —ñ–Ω—Ç–µ—Ä–≤–∞–ª—ñ–≤ –º—ñ—Å—Ç—è—Ç—å —Å–ø—Ä–∞–≤–∂–Ω—î –∑–Ω–∞—á–µ–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ $\beta_1$.

![](img/simulation-ci-1.png){fig-align="center"}

# –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –≥—ñ–ø–æ—Ç–µ–∑ {background-color="#eef3f8"}

## –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –≥—ñ–ø–æ—Ç–µ–∑ {.smaller}

–£ –±–∞–≥–∞—Ç—å–æ—Ö –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è—Ö –º–∏ —Ö–æ—á–µ–º–æ –∑–Ω–∞—Ç–∏ –±—ñ–ª—å—à–µ, –Ω—ñ–∂ —Ç–æ—á–∫–æ–≤—É –æ—Ü—ñ–Ω–∫—É –∞–±–æ –¥—ñ–∞–ø–∞–∑–æ–Ω –∑–Ω–∞—á–µ–Ω—å. –ú–∏ —Ö–æ—á–µ–º–æ –∑–Ω–∞—Ç–∏, —â–æ –Ω–∞—à—ñ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω—ñ –¥–∞–Ω—ñ –≥–æ–≤–æ—Ä—è—Ç—å –ø—Ä–æ —ñ—Å–Ω—É—é—á—ñ —Ç–µ–æ—Ä—ñ—ó.

–ú–∏ —Ö–æ—á–µ–º–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –≥—ñ–ø–æ—Ç–µ–∑–∏, –≤–∏—Å—É–Ω—É—Ç—ñ —á–∏–Ω–æ–≤–Ω–∏–∫–∞–º–∏, –ø–æ–ª—ñ—Ç–∏–∫–∞–º–∏, –µ–∫–æ–Ω–æ–º—ñ—Å—Ç–∞–º–∏, –Ω–∞—É–∫–æ–≤—Ü—è–º–∏, –¥—Ä—É–∑—è–º–∏, –¥–∏–≤–Ω–∏–º–∏ —Å—É—Å—ñ–¥–∞–º–∏ —Ç–æ—â–æ.

**–ü—Ä–∏–∫–ª–∞–¥–∏**

- –ó–±—ñ–ª—å—à–µ–Ω–Ω—è –ø—Ä–∏—Å—É—Ç–Ω–æ—Å—Ç—ñ –ø–æ–ª—ñ—Ü—ñ—ó **–∑–º–µ–Ω—à—É—î –∑–ª–æ—á–∏–Ω–Ω—ñ—Å—Ç—å**?

- –ë—É–¥—ñ–≤–Ω–∏—Ü—Ç–≤–æ –≥—ñ–≥–∞–Ω—Ç—Å—å–∫–æ—ó —Å—Ç—ñ–Ω–∏ **–∑–º–µ–Ω—à—É—î –∑–ª–æ—á–∏–Ω–Ω—ñ—Å—Ç—å**?

- –†–æ–∑–ø—É—Å–∫ —É—Ä—è–¥—É **–∑–≥—É–±–Ω–æ –≤–ø–ª–∏–≤–∞—î –Ω–∞ –µ–∫–æ–Ω–æ–º—ñ–∫—É**?

- –ß–∏ –ª–µ–≥–∞–ª—å–Ω–∏–π –∫–∞–Ω–∞–±—ñ—Å **–∑–º–µ–Ω—à—É—î –≤–æ–¥—ñ–Ω–Ω—è –≤ –Ω–µ—Ç–≤–µ—Ä–µ–∑–æ–º—É —Å—Ç–∞–Ω—ñ** –∞–±–æ **–∑–º–µ–Ω—à—É—î –≤–∂–∏–≤–∞–Ω–Ω—è –æ–ø—ñ–æ—ó–¥—ñ–≤**?

- –ß–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏ —è–∫–æ—Å—Ç—ñ –ø–æ–≤—ñ—Ç—Ä—è **–ø–æ–∫—Ä–∞—â—É—é—Ç—å –∑–¥–æ—Ä–æ–≤'—è** —Ç–∞/–∞–±–æ **–∑–º–µ–Ω—à—É—é—Ç—å –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ä–æ–±–æ—á—ñ—Ö –º—ñ—Å—Ü—å**?

## –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –≥—ñ–ø–æ—Ç–µ–∑ {.smaller}

–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≥—ñ–ø–æ—Ç–µ–∑ —Å–ø–∏—Ä–∞—î—Ç—å—Å—è –Ω–∞ –¥—É–∂–µ —Å—Ö–æ–∂—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ —Ç–∞ —ñ–Ω—Ç—É—ó—Ü—ñ—é.

–•–æ—á–∞ –Ω–µ–≤–∏–∑–Ω–∞—á–µ–Ω—ñ—Å—Ç—å, –∑–≤–∏—á–∞–π–Ω–æ, —ñ—Å–Ω—É—î, –º–∏ –≤—Å–µ —â–µ –º–æ–∂–µ–º–æ –ø–æ–±—É–¥—É–≤–∞—Ç–∏ *–Ω–∞–¥—ñ–π–Ω—ñ* —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω—ñ —Ç–µ—Å—Ç–∏ (–≤—ñ–¥–∫–∏–¥–∞—é—á–∏ –∞–±–æ –Ω–µ –≤—ñ–¥—Ö–∏–ª—è—é—á–∏ –≤–∏—Å—É–Ω—É—Ç—É –≥—ñ–ø–æ—Ç–µ–∑—É).

. . .

**–ú–ù–ö *t* —Ç–µ—Å—Ç**: –ù–∞—à–∞ (–Ω—É–ª—å–æ–≤–∞) –≥—ñ–ø–æ—Ç–µ–∑–∞ —Å—Ç–≤–µ—Ä–¥–∂—É—î, —â–æ $\beta_1$ –¥–æ—Ä—ñ–≤–Ω—é—î –∑–Ω–∞—á–µ–Ω–Ω—é $c$, _—Ç–æ–±—Ç–æ_, $H_o:\: \beta_1 = c$

–ó –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç–µ–π –ú–ù–ö –º–∏ –º–æ–∂–µ–º–æ –ø–æ–∫–∞–∑–∞—Ç–∏, —â–æ —Ç–µ—Å—Ç–æ–≤–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

$$ t_\text{stat} = \dfrac{\hat{\beta}_1 - c}{\mathop{\hat{\text{SE}}} \left( \hat{\beta}_1 \right)} $$

—Å–ª—ñ–¥—É—î —Ä–æ–∑–ø–æ–¥—ñ–ª—É $t$ –∑ $n-k$ —Å—Ç—É–ø–µ–Ω—è–º–∏ —Å–≤–æ–±–æ–¥–∏.

## –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –≥—ñ–ø–æ—Ç–µ–∑ {.smaller}

–î–ª—è **–¥–≤–æ—Å—Ç–æ—Ä–æ–Ω–Ω—å–æ–≥–æ** —Ç–µ—Å—Ç—É —Ä—ñ–≤–Ω—è $\alpha$ –º–∏ –≤—ñ–¥—Ö–∏–ª—è—î–º–æ –Ω—É–ª—å–æ–≤—É –≥—ñ–ø–æ—Ç–µ–∑—É (—ñ –∑–∞–≤–µ—Ä—à—É—î–º–æ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—É –≥—ñ–ø–æ—Ç–µ–∑—É), –∫–æ–ª–∏

$$ \left|t_\text{stat}\right| > \left|t_{1-\alpha/2,\,df}\right| $$

—Ü–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –Ω–∞—à–∞ **—Ç–µ—Å—Ç–æ–≤–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —î –±—ñ–ª—å—à –µ–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω–æ—é, –Ω—ñ–∂ –∫—Ä–∏—Ç–∏—á–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è**.

–ö—Ä—ñ–º —Ç–æ–≥–æ, –º–∏ –º–æ–∂–µ–º–æ –æ–±—á–∏—Å–ª–∏—Ç–∏ **p-–∑–Ω–∞—á–µ–Ω–Ω—è**, —è–∫–µ —Å—É–ø—Ä–æ–≤–æ–¥–∂—É—î –Ω–∞—à—É —Ç–µ—Å—Ç–æ–≤—É —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É, —â–æ —Ñ–∞–∫—Ç–∏—á–Ω–æ –¥–∞—î –Ω–∞–º —ñ–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å –ø–æ–±–∞—á–∏—Ç–∏ –Ω–∞—à—É —Ç–µ—Å—Ç–æ–≤—É —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É *–∞–±–æ –±—ñ–ª—å—à –µ–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—É —Ç–µ—Å—Ç–æ–≤—É —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É*, —è–∫—â–æ –Ω—É–ª—å–æ–≤–∞ –≥—ñ–ø–æ—Ç–µ–∑–∞ –≤—ñ—Ä–Ω–∞.

–î—É–∂–µ –º–∞–ª—ñ p-–∑–Ω–∞—á–µ–Ω–Ω—è (–∑–∞–∑–≤–∏—á–∞–π < 0,05) –æ–∑–Ω–∞—á–∞—é—Ç—å, —â–æ –º–∏ –Ω–∞–≤—Ä—è–¥ —á–∏ –ø–æ–±–∞—á–∏–º–æ –Ω–∞—à—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏, —è–∫–±–∏ –Ω—É–ª—å–æ–≤–∞ –≥—ñ–ø–æ—Ç–µ–∑–∞ –¥—ñ–π—Å–Ω–æ –±—É–ª–∞ –≤—ñ—Ä–Ω–æ—é ‚Äî –º–∏ —Å—Ö–∏–ª—å–Ω—ñ –≤—ñ–¥—Ö–∏–ª—è—Ç–∏ –Ω—É—å–ª–æ–≤—É –≥—ñ–ø–æ—Ç–µ–∑—É –¥–ª—è p-–∑–Ω–∞—á–µ–Ω—å –Ω–∏–∂—á–µ 0,05.

## –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –≥—ñ–ø–æ—Ç–µ–∑ {.smaller}

:::: {.columns}

::: {.column width="70%"}
```{python}
#| label: hypothesis-test
#| echo: true

import statsmodels.formula.api as smf

results = smf.ols('y ~ x', pop_df).fit()
print(results.summary())
```

:::

::: {.column width="30%"}
$H_0$: $\beta_1 = 0$ *vs.* $H_a$: $\beta_1 \neq 0$

$t_\text{stat} = 10.811$ —Ç–∞ $t_\text{0.975, 98} = `{python} round(t.ppf(0.025, df=98), 2)`$

*p*-–∑–Ω–∞—á–µ–Ω–Ω—è $< 0,05$

**–¢–æ–º—É –º–∏ –≤—ñ–¥–∫–∏–¥–∞—î–º–æ $H_0$!**

:::

::::

## –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –≥—ñ–ø–æ—Ç–µ–∑

–ü–æ–≤–µ—Ä—Ç–∞—î–º–æ—Å—è –¥–æ –Ω–∞—à–æ—ó —Å–∏–º—É–ª—è—Ü—ñ—ó! –î–∞–≤–∞–π—Ç–µ –ø–æ–¥–∏–≤–∏–º–æ—Å—è, —â–æ –Ω–∞—Å–ø—Ä–∞–≤–¥—ñ —Ä–æ–±–∏—Ç—å –Ω–∞—à–∞ $t$ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞.

–£ —Ü—ñ–π —Å–∏—Ç—É–∞—Ü—ñ—ó –º–∏ —Ñ–∞–∫—Ç–∏—á–Ω–æ –º–æ–∂–µ–º–æ –∑–Ω–∞—Ç–∏ (—ñ –∑–∞–±–µ–∑–ø–µ—á–∏—Ç–∏) –Ω—É–ª—å–æ–≤—É –≥—ñ–ø–æ—Ç–µ–∑—É, –æ—Å–∫—ñ–ª—å–∫–∏ –º–∏ –∑–≥–µ–Ω–µ—Ä—É–≤–∞–ª–∏ –¥–∞–Ω—ñ.

–î–ª—è –∫–æ–∂–Ω–æ–≥–æ –∑ 10 000 –∑—Ä–∞–∑–∫—ñ–≤ –º–∏ –æ–±—á–∏—Å–ª–∏–º–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É $t$, –∞ –ø–æ—Ç—ñ–º –ø–æ–±–∞—á–∏–º–æ, —Å–∫—ñ–ª—å–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–∏—Ö –¥–∞–Ω–∏—Ö $t$ –ø–µ—Ä–µ–≤–∏—â—É—î –Ω–∞—à–µ –∫—Ä–∏—Ç–∏—á–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è (`{python} round(t.ppf(0.025, df=98), 2)`, —è–∫ –≤–∏—â–µ).

–í—ñ–¥–ø–æ–≤—ñ–¥—å –º–∞—î –±—É—Ç–∏ –ø—Ä–∏–±–ª–∏–∑–Ω–æ 5 –≤—ñ–¥—Å–æ—Ç–∫—ñ–≤ ‚Äî –Ω–∞—à —Ä—ñ–≤–µ–Ω—å $\alpha$.

## –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –≥—ñ–ø–æ—Ç–µ–∑

–£ –Ω–∞—à–æ–º—É –º–æ–¥–µ–ª—é–≤–∞–Ω–Ω—ñ 2.1% –Ω–∞—à–æ—ó —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ $t$ –≤—ñ–¥—Ö–∏–ª—è—î –Ω—É–ª—å–æ–≤—É –≥—ñ–ø–æ—Ç–µ–∑—É.

–†–æ–∑–ø–æ–¥—ñ–ª –Ω–∞—à–æ—ó —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ $t$ (–∑–∞—à—Ç—Ä–∏—Ö—É–≤–∞–Ω–Ω—è –æ–±–ª–∞—Å—Ç–µ–π –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è).

![](img/simulation-t-plot-1.png){fig-align="center"}

---

–í—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ, 2.1% –Ω–∞—à–∏—Ö –∑–Ω–∞—á–µ–Ω—å $p$ –≤—ñ–¥—Ö–∏–ª—è—î –Ω—É–ª—å–æ–≤—É –≥—ñ–ø–æ—Ç–µ–∑—É.

–†–æ–∑–ø–æ–¥—ñ–ª –Ω–∞—à–∏—Ö –∑–Ω–∞—á–µ–Ω—å $p$ (–∑–∞—à—Ç—Ä–∏—Ö—É–≤–∞–Ω–Ω—è –∑–Ω–∞—á–µ–Ω—å $p$ –Ω–∏–∂—á–µ 0,05).

![](img/simulation-p-plot-1.png){fig-align="center"}

## F-—Ç–µ—Å—Ç

–Ü–Ω–æ–¥—ñ –º–æ–∂–Ω–∞ –∑—É—Å—Ç—Ä—ñ—Ç–∏ $F$-—Ç–µ—Å—Ç–∏.

–ú–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ $F$-—Ç–µ—Å—Ç–∏ –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –≥—ñ–ø–æ—Ç–µ–∑, —è–∫—ñ –≤–∫–ª—é—á–∞—é—Ç—å –∫—ñ–ª—å–∫–∞ –≤–∏–ø–∞–¥–∫—ñ–≤
<br>‚ÄÉ(_–Ω–∞–ø—Ä–∏–∫–ª–∞–¥_, $\beta_1 = \beta_2$ –∞–±–æ $\beta_3 + \beta_4 = 1$),

–∞ –Ω–µ –æ–¥–Ω–∞ –ø—Ä–æ—Å—Ç–∞ –≥—ñ–ø–æ—Ç–µ–∑–∞
<br>(_–Ω–∞–ø—Ä–∏–∫–ª–∞–¥_, $\beta_1 = 0$, –¥–ª—è —è–∫–æ–≥–æ –º–∏ –ø—Ä–æ—Å—Ç–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—î–º–æ —Ç–µ—Å—Ç $t$).

## F-—Ç–µ—Å—Ç

**–ü—Ä–∏–∫–ª–∞–¥**

–ï–∫–æ–Ω–æ–º—ñ—Å—Ç–∏ –ª—é–±–ª—è—Ç—å –∫–∞–∑–∞—Ç–∏: ¬´–ì—Ä–æ—à—ñ –≤–∑–∞—î–º–æ–∑–∞–º—ñ–Ω–Ω—ñ¬ª.

–£—è–≤—ñ—Ç—å —Å–æ–±—ñ, —â–æ –º–∏ –º–æ–∂–µ–º–æ –∑–∞—Ö–æ—Ç—ñ—Ç–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –¥—ñ–π—Å–Ω–æ –≥—Ä–æ—à—ñ, –æ—Ç—Ä–∏–º–∞–Ω—ñ —è–∫ –¥–æ—Ö—ñ–¥, –º–∞—é—Ç—å —Ç–∞–∫–∏–π –∂–µ –≤–ø–ª–∏–≤ –Ω–∞ —Å–ø–æ–∂–∏–≤–∞–Ω–Ω—è, —è–∫ –≥—Ä–æ—à—ñ, –æ—Ç—Ä–∏–º–∞–Ω—ñ –≤—ñ–¥ –ø–æ–¥–∞—Ç–∫–æ–≤–∏—Ö –∑–Ω–∏–∂–æ–∫.

$$ \text{–°–ø–æ–∂–∏–≤–∞–Ω–Ω—è}_i = \beta_0 + \beta_1 \text{–î–æ—Ö—ñ–¥}_{i} + \beta_2 \text{–ó–Ω–∏–∂–∫–∞}_i + u_i $$

## F-—Ç–µ—Å—Ç

**–ü—Ä–∏–∫–ª–∞–¥, –ø—Ä–æ–¥–æ–≤–∂–µ–Ω–Ω—è**

–ú–∏ –º–æ–∂–µ–º–æ –∑–∞–ø–∏—Å–∞—Ç–∏ –Ω–∞—à—É –Ω—É–ª—å–æ–≤—É –≥—ñ–ø–æ—Ç–µ–∑—É —è–∫

$$ H_o:\: \beta_1 = \beta_2 \iff H_o :\: \beta_1 - \beta_2 = 0 $$

–ù–∞–∫–ª–∞–¥–µ–Ω–Ω—è —Ü—ñ—î—ó –Ω—É–ª—å–æ–≤–æ—ó –≥—ñ–ø–æ—Ç–µ–∑–∏ –¥–∞—î –Ω–∞–º **–æ–±–º–µ–∂–µ–Ω—É –º–æ–¥–µ–ª—å**

$$ \text{–°–ø–æ–∂–∏–≤–∞–Ω–Ω—è}_i = \beta_0 + \beta_1 \text{–î–æ—Ö—ñ–¥}_{i} + \beta_1 \text{–ó–Ω–∏–∂–∫–∞}_i + u_i $$
$$ \text{–°–ø–æ–∂–∏–≤–∞–Ω–Ω—è}_i = \beta_0 + \beta_1 \left( \text{–î–æ—Ö—ñ–¥}_{i} + \text{–ó–Ω–∏–∂–∫–∞}_i \right) + u_i $$

## F-—Ç–µ—Å—Ç

**–ü—Ä–∏–∫–ª–∞–¥, –ø—Ä–æ–¥–æ–≤–∂–µ–Ω–Ω—è**

–©–æ–± –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –Ω—É–ª—å–æ–≤—É –≥—ñ–ø–æ—Ç–µ–∑—É $H_o :\: \beta_1 = \beta_2$ –ø—Ä–æ—Ç–∏ $H_a :\: \beta_1 \neq \beta_2$,
<br>–º–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É $F$
$$
\begin{align}
   F_{q,\,n-k-1} = \dfrac{\left(\text{ESS}_r - \text{ESS}_u\right)/q}{\text{ESS}_u/(n-k-1)}
\end{align}
$$
—è–∫–∏–π (—è–∫ –≤–∏–ø–ª–∏–≤–∞—î –∑ –Ω–∞–∑–≤–∏) –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î —Ä–æ–∑–ø–æ–¥—ñ–ª—É $F$ —ñ–∑ —Å—Ç—É–ø–µ–Ω—è–º–∏ —Å–≤–æ–±–æ–¥–∏ –≤ —á–∏—Å–µ–ª—å–Ω–∏–∫—É $q$ —ñ —Å—Ç—É–ø–µ–Ω—è–º–∏ —Å–≤–æ–±–æ–¥–∏ –≤ –∑–Ω–∞–º–µ–Ω–Ω–∏–∫—É $n-k-1$.

–¢—É—Ç $q$ ‚Äî —Ü–µ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –æ–±–º–µ–∂–µ–Ω—å, —è–∫—ñ –º–∏ –Ω–∞–∫–ª–∞–¥–∞—î–º–æ —á–µ—Ä–µ–∑ $H_o$.

## F-—Ç–µ—Å—Ç {.smaller}

**–ü—Ä–∏–∫–ª–∞–¥, –ø—Ä–æ–¥–æ–≤–∂–µ–Ω–Ω—è**

$\text{ESS}_r$ ‚Äì —Ü–µ —Å—É–º–∞ –∫–≤–∞–¥—Ä–∞—Ç—ñ–≤ –ø–æ–º–∏–ª–æ–∫ (ESS) –∑ –Ω–∞—à–æ—ó **–æ–±–º–µ–∂–µ–Ω–æ—ó –º–æ–¥–µ–ª—ñ**
$$ \text{–°–ø–æ–∂–∏–≤–∞–Ω–Ω—è}_i = \beta_0 + \beta_1 \left( \text{–î–æ—Ö—ñ–¥}_{i} + \text{–ó–Ω–∏–∂–∫–∞}_i \right) + u_i $$

–∞ $\text{ESS}_u$ ‚Äì —Ü–µ —Å—É–º–∞ –∫–≤–∞–¥—Ä–∞—Ç—ñ–≤ –ø–æ–º–∏–ª–æ–∫ (ESS) –∑ –Ω–∞—à–æ—ó **–Ω–µ–æ–±–º–µ–∂–µ–Ω–æ—ó –º–æ–¥–µ–ª—ñ**
$$ \text{–°–ø–æ–∂–∏–≤–∞–Ω–Ω—è}_i = \beta_0 + \beta_1 \text{–î–æ—Ö—ñ–¥}_{i} + \beta_2 \text{–ó–Ω–∏–∂–∫–∞}_i + u_i $$

. . .

–¢–µ—Å—Ç $F$ –ø–æ—Ä—ñ–≤–Ω—é—î –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –Ω–µ–æ–±–º–µ–∂–µ–Ω–æ—ó –º–æ–¥–µ–ª—ñ –∑ –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –æ–±–º–µ–∂–µ–Ω–æ—ó –º–æ–¥–µ–ª—ñ, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —ó—Ö–Ω—ñ $\text{ESS}$.

. . .

$$
\begin{align}
   F_\text{stat} = \dfrac{\left(\text{ESS}_r - \text{ESS}_u\right)/q}{\text{ESS}_u/(n-k-1)} \sim F_{ q,\,n-k-1}
\end{align}
$$

# –û—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è –º–æ–¥–µ–ª—ñ {background-color="#eef3f8"}

## –û—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è –º–æ–¥–µ–ª—ñ

–ü–æ–∫–∞–∑–Ω–∏–∫–∏ *—Ö–æ—Ä–æ—à–æ—ó –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ* (–∞–Ω–≥. *goodness of fit*) –Ω–∞–º–∞–≥–∞—é—Ç—å—Å—è –ø—Ä–æ–∞–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏, –Ω–∞—Å–∫—ñ–ª—å–∫–∏ –¥–æ–±—Ä–µ –Ω–∞—à–∞ –º–æ–¥–µ–ª—å –æ–ø–∏—Å—É—î (*–≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î*) –¥–∞–Ω–∏–º.

**–ü–æ–ø—É–ª—è—Ä–Ω–∏–π –ø–æ–∫–∞–∑–Ω–∏–∫:** $R^2$ [R-–∫–≤–∞–¥—Ä–∞—Ç] (*–≤—ñ–Ω –∂–µ* –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –¥–µ—Ç–µ—Ä–º—ñ–Ω–∞—Ü—ñ—ó)

$$ R^2 = \dfrac{\sum_i (\hat{y}_i - \overline{y})^2}{\sum_i \left( y_i - \overline{y} \right)^2} = 1 - \dfrac{\sum_i \left( y_i - \hat{y}_i \right)^2}{\sum_i \left( y_i - \overline{y} \right)^2} $$

–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É –Ω–∞ –Ω–∞—à–æ–≥–æ —Å—Ç–∞—Ä–æ–≥–æ –¥—Ä—É–≥–∞ ESS: $\sum_i \left( y_i - \hat{y}_i \right)^2 = \sum_i e_i^2$.

. . .

$R^2$ –±—É–∫–≤–∞–ª—å–Ω–æ –≤–∫–∞–∑—É—î –Ω–∞–º —á–∞—Å—Ç–∫—É –¥–∏—Å–ø–µ—Ä—Å—ñ—ó –≤ $y$, —è–∫—É –≤—Ä–∞—Ö–æ–≤—É—î –Ω–∞—à–∞ –º–æ–¥–µ–ª—å. –¢–∞–∫–∏–º —á–∏–Ω–æ–º $0 \leq R^2 \leq 1$.

## $R^2$ {.smaller}

**–ü—Ä–æ–±–ª–µ–º–∞:** –∫–æ–ª–∏ –º–∏ –¥–æ–¥–∞—î–º–æ –∑–º—ñ–Ω–Ω—ñ –¥–æ –Ω–∞—à–æ—ó –º–æ–¥–µ–ª—ñ, $R^2$ *–ø–æ—Å—Ç—ñ–π–Ω–æ* –∑–±—ñ–ª—å—à—É—î—Ç—å—Å—è.

. . .

–©–æ–± –ø–æ–±–∞—á–∏—Ç–∏ —Ü—é –ø—Ä–æ–±–ª–µ–º—É, –º–∏ –º–æ–∂–µ–º–æ –∑–º–æ–¥–µ–ª—é–≤–∞—Ç–∏ –Ω–∞–±—ñ—Ä –¥–∞–Ω–∏—Ö —ñ–∑ 10 000 —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω—å –∑–∞ $y$ —ñ 1000 –≤–∏–ø–∞–¥–∫–æ–≤–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö $x_k$. **–ù–µ–º–∞—î –∑–≤‚Äô—è–∑–∫—É –º—ñ–∂ $y$ —ñ $x_k$!**

–ü—Å–µ–≤–¥–æ–∫–æ–¥ —Å–∏–º—É–ª—è—Ü—ñ—ó:

. . .

- –ó–≥–µ–Ω–µ—Ä—É–π—Ç–µ 10 000 —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω—å $y$
- –ó–≥–µ–Ω–µ—Ä—É–π—Ç–µ 10 000 —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω—å –∑–∞ –∑–º—ñ–Ω–Ω–∏–º–∏ –≤—ñ–¥ $x_1$ –¥–æ $x_{1000}$
- –†–µ–≥—Ä–µ—Å—ñ—è:
    - LM~1~: —Ä–µ–≥—Ä–µ—Å—ñ—è $y$ –Ω–∞ $x_1$; –∑–∞–ø–∏—Å R^2^
    - LM~2~: —Ä–µ–≥—Ä–µ—Å—ñ—è $y$ –Ω–∞ $x_1$ —ñ $x_2$; –∑–∞–ø–∏—Å R^2^
    - LM~1000~: —Ä–µ–≥—Ä–µ—Å—ñ—è $y$ –Ω–∞ $x_1$, $x_2$ —ñ $x_3$; –∑–∞–ø–∏—Å R^2^
    - ...
    - LM<sub>1000</sub>: —Ä–µ–≥—Ä–µ—Å—ñ—è $y$ –Ω–∞ $x_1$, $x_2$, ..., $x_{1000}$; –∑–∞–ø–∏—Å R^2^

## $R^2$ {.smaller}

**–ü—Ä–æ–±–ª–µ–º–∞:** –∫–æ–ª–∏ –º–∏ –¥–æ–¥–∞—î–º–æ –∑–º—ñ–Ω–Ω—ñ –¥–æ –Ω–∞—à–æ—ó –º–æ–¥–µ–ª—ñ, $R^2$ *–ø–æ—Å—Ç—ñ–π–Ω–æ* –∑–±—ñ–ª—å—à—É—î—Ç—å—Å—è.

`Python` –∫–æ–¥ –¥–ª—è —Å–∏–º—É–ª—è—Ü—ñ—ó:

```{python}
#| label: r2-sim
#| eval: false
#| echo: true

import numpy as np
import pandas as pd
from sklearn.linear_model import LinearRegression
from joblib import Parallel, delayed

np.random.seed(1234)

n = 10000
k = 1000

y = np.random.normal(size=n)
x = np.random.normal(size=(n, k))

def calculate_r2(i):
    model = LinearRegression()
    model.fit(x[:, :i+2], y)
    r2 = model.score(x[:, :i+2], y)
    adj_r2 = 1 - (1 - r2) * (len(y) - 1) / (len(y) - (i+2))
    return pd.DataFrame({'k': [i+2], 'r2': [r2], 'r2_adj': [adj_r2]})

result = Parallel(n_jobs=-1)(delayed(calculate_r2)(i) for i in range(k))

r_df = pd.concat(result, ignore_index=True)
```

## $R^2$ {.smaller}

**–ü—Ä–æ–±–ª–µ–º–∞:** –∫–æ–ª–∏ –º–∏ –¥–æ–¥–∞—î–º–æ –∑–º—ñ–Ω–Ω—ñ –¥–æ –Ω–∞—à–æ—ó –º–æ–¥–µ–ª—ñ, $R^2$ *–ø–æ—Å—Ç—ñ–π–Ω–æ* –∑–±—ñ–ª—å—à—É—î—Ç—å—Å—è.

```{python}
#| label: r2-sim-import
#| include: false

r_df = pd.read_csv('data/r2-sim.csv')
```

```{python}
#| label: r2-plot
#| echo: false
#| fig-align: center

plt.plot(r_df['k'], r_df['r2'], linewidth=4, alpha=0.75, color='darkslategrey')

plt.axhline(y=0, color='black')
plt.axvline(x=0, color='black')

plt.xlabel('–ö—ñ–ª—å–∫—ñ—Å—Ç—å –Ω–µ–∑–∞–ª–µ–∂–Ω–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö (k)')
plt.ylabel(r'$R^2$')
plt.title(r'$R^2$ vs. –ö—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ—è—Å–Ω—é–≤–∞–ª—å–Ω–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö')

plt.show()
```

## $R_{adj}^2$ {.smaller}

–©–æ —Ä–æ–±–∏—Ç–∏?
**–†—ñ—à–µ–Ω–Ω—è –ø–µ—Ä—à–µ:** [–°–∫–æ—Ä–∏–≥–æ–≤–∞–Ω–∏–π]{.pink} $\color{#e64173}{R^2}$

```{python}
#| label: r2-adj-plot
#| echo: false
#| fig-align: center

plt.plot(r_df['k'], r_df['r2'], linewidth=4, alpha=0.15, color='darkslategrey')
plt.plot(r_df['k'], r_df['r2_adj'], linewidth=4, alpha=0.85, color=red_pink)

plt.axhline(y=0, color='black')
plt.axvline(x=0, color='black')

plt.xlabel('–ö—ñ–ª—å–∫—ñ—Å—Ç—å –Ω–µ–∑–∞–ª–µ–∂–Ω–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö (k)')
plt.ylabel(r'$R^2$')
plt.title(r'$R^2$ vs. $R^2_{adj}$ vs. –ö—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ—è—Å–Ω—é–≤–∞–ª—å–Ω–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö')

plt.show()
```

## $R_{adj}^2$ {.smaller}

**–ü—Ä–æ–±–ª–µ–º–∞:** –∫–æ–ª–∏ –º–∏ –¥–æ–¥–∞—î–º–æ –∑–º—ñ–Ω–Ω—ñ –¥–æ –Ω–∞—à–æ—ó –º–æ–¥–µ–ª—ñ, $R^2$ *–ø–æ—Å—Ç—ñ–π–Ω–æ* –∑–±—ñ–ª—å—à—É—î—Ç—å—Å—è.

**–†—ñ—à–µ–Ω–Ω—è –ø–µ—Ä—à–µ:** –®—Ç—Ä–∞—Ñ—É–≤–∞—Ç–∏ –∑–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∑–º—ñ–Ω–Ω–∏—Ö, _–Ω–∞–ø—Ä–∏–∫–ª–∞–¥_, —Å–∫–æ—Ä–µ–≥–æ–≤–∞–Ω–∏–π $R^2$:

$$ \overline{R}^2 = 1 - \dfrac{\sum_i \left( y_i - \hat{y}_i \right)^2/(n-k-1)}{\sum_i \left( y_i - \overline{y} \right)^2/(n-1)} $$

::: {.callout-note}
–°–∫–æ—Ä–∏–≥–æ–≤–∞–Ω–∏–π $R^2$ –Ω–µ –æ–±–æ–≤'—è–∑–∫–æ–≤–æ –ø–æ–≤–∏–Ω–µ–Ω –±—É—Ç–∏ –≤—ñ–¥ 0 –¥–æ 1.
:::

# –Ü–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—è –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç—ñ–≤ {background-color="#eef3f8"}

## –ù–µ–ø–µ—Ä–µ—Ä–≤–Ω—ñ –∑–º—ñ–Ω–Ω—ñ {.smaller}

–†–æ–∑–≥–ª—è–Ω–µ–º–æ –≤–∑–∞—î–º–æ–∑–≤'—è–∑–æ–∫

$$ \text{Pay}_i = \beta_0 + \beta_1 \, \text{School}_i + u_i $$

–¥–µ

- $\text{Pay}_i$ ‚Äî —Ü–µ –Ω–µ–ø–µ—Ä–µ—Ä–≤–Ω–∞ –∑–º—ñ–Ω–Ω–∞, —è–∫–∞ –≤–∏–º—ñ—Ä—é—î –æ–ø–ª–∞—Ç—É –ø—Ä–∞—Ü—ñ
- $\text{School}_i$ ‚Äî —Ü–µ –Ω–µ–ø–µ—Ä–µ—Ä–≤–Ω–∞ –∑–º—ñ–Ω–Ω–∞, —è–∫–∞ –≤–∏–º—ñ—Ä—é—î —Ä–æ–∫–∏ –Ω–∞–≤—á–∞–Ω–Ω—è

. . .

**–Ü–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—è**

- $\beta_0$: $y$-intercept, _—Ç–æ–±—Ç–æ_, $\text{Pay}$, –∫–æ–ª–∏ $\text{School} = 0$
- $\beta_1$: –æ—á—ñ–∫—É–≤–∞–Ω–∞ –∑–º—ñ–Ω–∞ $\text{Pay}$ –ø—Ä–∏ –∑–±—ñ–ª—å—à–µ–Ω–Ω—ñ –Ω–∞ –æ–¥–Ω—É –æ–¥–∏–Ω–∏—Ü—é $\text{School}$

## –ù–µ–ø–µ—Ä–µ—Ä–≤–Ω—ñ –∑–º—ñ–Ω–Ω—ñ

–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥

–†–æ–∑–≥–ª—è–Ω—å—Ç–µ –º–æ–¥–µ–ª—å

$$ y = \beta_0 + \beta_1 \, x + u $$

–ü–æ—Ö—ñ–¥–Ω–∞:

$$ \dfrac{dy}{dx} = \beta_1 $$

## –ö–∞—Ç–µ–≥–æ—Ä—ñ–∞–ª—å–Ω—ñ –∑–º—ñ–Ω–Ω—ñ {.smaller}

$$ \text{Pay}_i = \beta_0 + \beta_1 \, \text{Female}_i + u_i $$

–¥–µ

- $\text{Pay}_i$ ‚Äî —Ü–µ –Ω–µ–ø–µ—Ä–µ—Ä–≤–Ω–∞ –∑–º—ñ–Ω–Ω–∞, —è–∫–∞ –≤–∏–º—ñ—Ä—é—î –æ–ø–ª–∞—Ç—É –ø—Ä–∞—Ü—ñ
- $\text{Female}_i$ - –¥–≤—ñ–π–∫–æ–≤–∞/—ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä–Ω–∞ –∑–º—ñ–Ω–Ω–∞, —è–∫–∞ –ø—Ä–∏–π–º–∞—î $1$, –∫–æ–ª–∏ $i$ —î –∂—ñ–Ω–æ—á–æ—é

. . .

**–Ü–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—è**

- $\beta_0$: –æ—á—ñ–∫—É–≤–∞–Ω–∞ $\text{Pay}$ –¥–ª—è —á–æ–ª–æ–≤—ñ–∫—ñ–≤ (_—Ç–æ–±—Ç–æ_, –∫–æ–ª–∏ $\text{Female} = 0$)
- $\beta_1$: –æ—á—ñ–∫—É–≤–∞–Ω–∞ —Ä—ñ–∑–Ω–∏—Ü—è –≤ $\text{Pay}$ –º—ñ–∂ –∂—ñ–Ω–∫–∞–º–∏ —Ç–∞ —á–æ–ª–æ–≤—ñ–∫–∞–º–∏
- $\beta_0 + \beta_1$: –æ—á—ñ–∫—É–≤–∞–Ω–∞ $\text{Pay}$ –¥–ª—è –∂—ñ–Ω–æ–∫

## –ö–∞—Ç–µ–≥–æ—Ä—ñ–∞–ª—å–Ω—ñ –∑–º—ñ–Ω–Ω—ñ

$y_i = \beta_0 + \beta_1 x_i + u_i$ –¥–ª—è –¥–≤—ñ–π–∫–æ–≤–æ—ó –∑–º—ñ–Ω–Ω–æ—ó $x_i = \{\color{#314f4f}{0}, \, \color{#e64173}{1}\}$

```{python}
#| label: cat-data
#| include: false

n = 5000

x = np.random.choice([0, 1], n, replace=True)
y = 3 + 7 * x + np.random.normal(0, 2, n)

cat_df = pd.DataFrame({'y': y, 'x': x})

X = sm.add_constant(cat_df['x'])
cat_reg = sm.OLS(cat_df['y'], X).fit()
```

```{python}
#| label: cat-plot-1
#| echo: false
#| fig-align: center

np.random.seed(12345)

custom_palette = ["darkslategrey", red_pink]

sns.stripplot(x='x', y='y', hue='x', palette=custom_palette,
              data=cat_df, marker='o', alpha=0.5, jitter=0.3, size=3, legend=False)

plt.grid(False)
plt.box(False)
plt.tick_params(left = False, right = False , labelleft = False , 
                labelbottom = False, bottom = False)
plt.xlabel('')
plt.ylabel('')
plt.show()
```

## –ö–∞—Ç–µ–≥–æ—Ä—ñ–∞–ª—å–Ω—ñ –∑–º—ñ–Ω–Ω—ñ

$y_i = \beta_0 + \beta_1 x_i + u_i$ –¥–ª—è –¥–≤—ñ–π–∫–æ–≤–æ—ó –∑–º—ñ–Ω–Ω–æ—ó $x_i = \{\color{#314f4f}{0}, \, \color{#e64173}{1}\}$

```{python}
#| label: cat-plot-2
#| echo: false
#| fig-align: center

np.random.seed(12345)

custom_palette = ["darkslategrey", red_pink]

sns.stripplot(x='x', y='y', hue='x', palette=custom_palette,
              data=cat_df, marker='o', alpha=0.5, jitter=0.3, size=3, legend=False)
plt.axhline(y=cat_reg.params[0], color="darkslategrey", linewidth=1)
plt.axhline(y=cat_reg.params[0] + cat_reg.params[1], color=red_pink, linewidth=1)
plt.annotate(r'$\hat{\beta}_0 = \overline{Group}_0$', xy=(0.4, -1 + cat_reg.params[0]), size=7, color="darkslategrey")
plt.annotate(r'$\hat{\beta}_0 + \hat{\beta}_1 = \overline{Group}_1$', xy=(0.3, 1 + cat_reg.params[0] + cat_reg.params[1]), size=7, color=red_pink)


plt.grid(False)
plt.box(False)
plt.tick_params(left = False, right = False , labelleft = False , 
                labelbottom = False, bottom = False)
plt.xlabel('')
plt.ylabel('')
plt.show()
```

## –í–∑–∞—î–º–æ–¥—ñ—ó

–í–∑–∞—î–º–æ–¥—ñ—ó –¥–æ–∑–≤–æ–ª—è—é—Ç—å –∑–º—ñ–Ω—é–≤–∞—Ç–∏ –≤–ø–ª–∏–≤ –æ–¥–Ω—ñ—î—ó –∑–º—ñ–Ω–Ω–æ—ó –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Ä—ñ–≤–Ω—è —ñ–Ω—à–æ—ó –∑–º—ñ–Ω–Ω–æ—ó.

**–ü—Ä–∏–∫–ª–∞–¥–∏**

1. –ß–∏ –∑–º—ñ–Ω—é—î—Ç—å—Å—è –≤–ø–ª–∏–≤ –Ω–∞–≤—á–∞–Ω–Ω—è –Ω–∞ –æ–ø–ª–∞—Ç—É –∑–∞ —Å—Ç–∞—Ç—Ç—é?

1. –ß–∏ –∑–º—ñ–Ω—é—î—Ç—å—Å—è –≤–ø–ª–∏–≤ —Å—Ç–∞—Ç—ñ –Ω–∞ –æ–ø–ª–∞—Ç—É –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Ä–∞—Å–∏?

1. –ß–∏ –∑–º—ñ–Ω—é—î—Ç—å—Å—è –≤–ø–ª–∏–≤ –Ω–∞–≤—á–∞–Ω–Ω—è –Ω–∞ –æ–ø–ª–∞—Ç—É –ø—Ä–∞—Ü—ñ –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ –¥–æ—Å–≤—ñ–¥—É?

## –í–∑–∞—î–º–æ–¥—ñ—ó

–†–∞–Ω—ñ—à–µ –º–∏ —Ä–æ–∑–≥–ª—è–¥–∞–ª–∏ –º–æ–¥–µ–ª—å, —è–∫–∞ –¥–æ–∑–≤–æ–ª—è–ª–∞ –∂—ñ–Ω–∫–∞–º —ñ —á–æ–ª–æ–≤—ñ–∫–∞–º –º–∞—Ç–∏ —Ä—ñ–∑–Ω—É –∑–∞—Ä–æ–±—ñ—Ç–Ω—É –ø–ª–∞—Ç—É, –∞–ª–µ –º–æ–¥–µ–ª—å –ø—Ä–∏–ø—É—Å–∫–∞–ª–∞, —â–æ –≤–ø–ª–∏–≤ –Ω–∞–≤—á–∞–Ω–Ω—è –Ω–∞ –æ–ø–ª–∞—Ç—É –ø—Ä–∞—Ü—ñ –±—É–¥–µ –æ–¥–Ω–∞–∫–æ–≤–∏–º –¥–ª—è –≤—Å—ñ—Ö:

$$ \text{Pay}_i = \beta_0 + \beta_1 \, \text{School}_i + \beta_2 \, \text{Female}_i + u_i $$

–∞–ª–µ –º–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ–º–æ –ø—Ä–∏–ø—É—Å—Ç–∏—Ç–∏, —â–æ–± –≤–ø–ª–∏–≤ –æ—Å–≤—ñ—Ç–∏ –≤—ñ–¥—Ä—ñ–∑–Ω—è–≤—Å—è –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Å—Ç–∞—Ç—ñ:

$$ \text{Pay}_i = \beta_0 + \beta_1 \, \text{School}_i + \beta_2 \, \text{Female}_i + \beta_3 \, \text{School}_i\times\text{Female}_i + u_i $$

## –í–∑–∞—î–º–æ–¥—ñ—ó {.smaller}

–ú–æ–¥–µ–ª—å, –∫–æ–ª–∏ –Ω–∞–≤—á–∞–Ω–Ω—è –≤ —à–∫–æ–ª—ñ –º–∞—î –æ–¥–Ω–∞–∫–æ–≤–∏–π –µ—Ñ–µ–∫—Ç –¥–ª—è –≤—Å—ñ—Ö (**<font color="#e64173">F</font>** —ñ **<font color="#314f4f">M</font>**):

```{python}
#| label: int-data
#| include: false

np.random.seed(12345)

n = 1000

beta0, beta1, beta2, beta3 = 20, 0.5, 10, 3

male = np.random.choice([True, False], n, replace=True)
school = np.random.uniform(3, 9, n) - 3 * male
pay = beta0 + beta1 * school + beta2 * male + np.random.normal(scale=7, size = n) + beta3 * male * school

int_df = pd.DataFrame({
  'male': male,
  'school': school,
  'pay': pay
})

reg_noint = smf.ols('pay ~ school + male', int_df).fit()
reg_int = smf.ols('pay ~ school + male + school:male', int_df).fit()
```

```{python}
#| label: int-plot-1
#| echo: false
#| fig-align: center

scatter_plot = sns.scatterplot(data=int_df, x='school', y='pay',
                               s=60, hue='male', alpha=0.4, marker='o', legend=False,
                               palette=sns.color_palette(["#e64173", '#314f4f']))
# abline_values = [ub0 + ub1 * i for i in omit_df['school']]
plt.axline((0, reg_noint.params[0] + reg_noint.params[1]), slope=reg_noint.params[2], color="#314f4f", linewidth=2)
plt.axline((0, reg_noint.params[0]), slope=reg_noint.params[2], color="#e64173", linewidth=2)

# Add horizontal and vertical lines
plt.axhline(0, color='black', linewidth=1)
plt.axvline(0, color='black', linewidth=1)

# Set x and y labels
plt.xlabel("Schooling")
plt.ylabel("Pay")
plt.grid(False)
plt.box(False)

plt.tick_params(left = False, right = False , labelleft = False , 
                labelbottom = False, bottom = False)

# Show the plot
plt.show()
```

## –í–∑–∞—î–º–æ–¥—ñ—ó {.smaller}

–ú–æ–¥–µ–ª—å, —É —è–∫—ñ–π –≤–ø–ª–∏–≤ —à–∫—ñ–ª—å–Ω–æ–≥–æ –Ω–∞–≤—á–∞–Ω–Ω—è –º–æ–∂–µ –≤—ñ–¥—Ä—ñ–∑–Ω—è—Ç–∏—Å—è –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Å—Ç–∞—Ç—ñ (**<font color="#e64173">F</font>** —ñ **<font color="#314f4f">M</font>**):

```{python}
#| label: int-plot-2
#| echo: false
#| fig-align: center

scatter_plot = sns.scatterplot(data=int_df, x='school', y='pay',
                               s=60, hue='male', alpha=0.4, marker='o', legend=False,
                               palette=sns.color_palette(["#e64173", '#314f4f']))
# abline_values = [ub0 + ub1 * i for i in omit_df['school']]
plt.axline((0, reg_noint.params[0] + reg_noint.params[1]), slope=reg_noint.params[2], color="#314f4f", linewidth=2, alpha=0.3)
plt.axline((0, reg_noint.params[0]), slope=reg_noint.params[2], color="#e64173", linewidth=2, alpha=0.3)
plt.axline((0, reg_int.params[0] + reg_int.params[1]), slope=reg_int.params[2] + reg_int.params[3], color="#314f4f", linewidth=2)
plt.axline((0, reg_int.params[0]), slope=reg_int.params[2], color="#e64173", linewidth=2)

# Add horizontal and vertical lines
plt.axhline(0, color='black', linewidth=1)
plt.axvline(0, color='black', linewidth=1)

# Set x and y labels
plt.xlabel("Schooling")
plt.ylabel("Pay")
plt.grid(False)
plt.box(False)

plt.tick_params(left = False, right = False , labelleft = False , 
                labelbottom = False, bottom = False)

# Show the plot
plt.show()
```

## –í–∑–∞—î–º–æ–¥—ñ—ó {.smaller}

–Ü–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—è –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç—ñ–≤ –º–æ–∂–µ –±—É—Ç–∏ –¥–µ—â–æ —Å–∫–ª–∞–¥–Ω–æ—é —É –∑–≤‚Äô—è–∑–∫—É –∑ –≤–∑–∞—î–º–æ–¥—ñ—è–º–∏, –∞–ª–µ –≥–æ–ª–æ–≤–Ω–µ ‚Äî —É–≤–∞–∂–Ω–æ –ø—Ä–æ–ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –º–∞—Ç–µ–º–∞—Ç–∏–∫—É.

$$ \text{Pay}_i = \beta_0 + \beta_1 \, \text{School}_i + \beta_2 \, \text{Female}_i + \beta_3 \, \text{School}_i\times\text{Female}_i + u_i $$

–û—á—ñ–∫—É–≤–∞–Ω–∞ –≤—ñ–¥–¥–∞—á–∞ –≤—ñ–¥ –¥–æ–¥–∞—Ç–∫–æ–≤–æ–≥–æ —Ä–æ–∫—É –Ω–∞–≤—á–∞–Ω–Ω—è –¥–ª—è –∂—ñ–Ω–æ–∫:

$$
\begin{aligned}
 \mathop{\boldsymbol{E}}\left[ \text{Pay}_i | \text{Female} \land \text{School} = \ell + 1 \right] -
    \mathop{\boldsymbol{E}}\left[ \text{Pay}_i | \text{Female} \land \text{School} = \ell \right] &= \\
 \mathop{\boldsymbol{E}}\left[ \beta_0 + \beta_1 (\ell+1) + \beta_2 + \beta_3 (\ell + 1) + u_i \right] -
    \mathop{\boldsymbol{E}}\left[ \beta_0 + \beta_1 \ell + \beta_2 + \beta_3 \ell + u_i  \right] &= \\
 \beta_1 + \beta_3
\end{aligned}
$$

. . .

–ü–æ–¥—ñ–±–Ω–∏–º —á–∏–Ω–æ–º $\beta_1$ –¥–∞—î –æ—á—ñ–∫—É–≤–∞–Ω—É –≤—ñ–¥–¥–∞—á—É –≤—ñ–¥ –¥–æ–¥–∞—Ç–∫–æ–≤–æ–≥–æ —Ä–æ–∫—É –Ω–∞–≤—á–∞–Ω–Ω—è –¥–ª—è —á–æ–ª–æ–≤—ñ–∫—ñ–≤. –¢–∞–∫–∏–º —á–∏–Ω–æ–º, $\beta_3$ –¥–∞—î **—Ä—ñ–∑–Ω–∏—Ü—é —É –≤—ñ–¥–¥–∞—á—ñ –≤—ñ–¥ –Ω–∞–≤—á–∞–Ω–Ω—è** –¥–ª—è –∂—ñ–Ω–æ–∫ —ñ —á–æ–ª–æ–≤—ñ–∫—ñ–≤.

## –õ–æ–≥-–ª—ñ–Ω—ñ–π–Ω–∞ —Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—è {.smaller}

–í –µ–∫–æ–Ω–æ–º—ñ—Ü—ñ –≤–∏ —á–∞—Å—Ç–æ –ø–æ–±–∞—á–∏—Ç–µ –∑–º—ñ–Ω–µ–Ω—É –∑–∞–ª–µ–∂–Ω—É –∑–º—ñ–Ω–Ω—É (–ª–æ–≥–∞—Ä–∏—Ñ–º—ñ—á–Ω—É) –∑ –ª—ñ–Ω—ñ–π–Ω–∏–º–∏ (–Ω–µ –ª–æ–≥–∞—Ä–∏—Ñ–º—ñ—á–Ω—É) –ø–æ—è—Å–Ω—é–≤–∞–ª—å–Ω–∏–º–∏ –∑–º—ñ–Ω–Ω–∏–º–∏, _–Ω–∞–ø—Ä–∏–∫–ª–∞–¥_,

$$ \log(\text{Pay}_i) = \beta_0 + \beta_1 \, \text{School}_i + u_i $$

–¶—è —Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—è –∑–º—ñ–Ω—é—î –Ω–∞—à—É —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—é –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç—ñ–≤ –Ω–∞—Ö–∏–ª—É.

**–Ü–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—è**

- –ó–±—ñ–ª—å—à–µ–Ω–Ω—è –Ω–∞—à–æ—ó –ø–æ—è—Å–Ω—é–≤–∞–ª—å–Ω–æ—ó –∑–º—ñ–Ω–Ω–æ—ó –Ω–∞ –æ–¥–Ω—É –æ–¥–∏–Ω–∏—Ü—é –∑–±—ñ–ª—å—à—É—î –∑–∞–ª–µ–∂–Ω—É –∑–º—ñ–Ω–Ω—É –ø—Ä–∏–±–ª–∏–∑–Ω–æ –Ω–∞ $\beta_1\times 100$ –≤—ñ–¥—Å–æ—Ç–∫—ñ–≤.

- *–ü—Ä–∏–∫–ª–∞–¥:* –î–æ–¥–∞—Ç–∫–æ–≤–∏–π —Ä—ñ–∫ –Ω–∞–≤—á–∞–Ω–Ω—è –∑–±—ñ–ª—å—à—É—î –ø–ª–∞—Ç–Ω—é –ø—Ä–∏–±–ª–∏–∑–Ω–æ –Ω–∞ 3 –≤—ñ–¥—Å–æ—Ç–∫–∏ (–¥–ª—è $\beta_1 = 0,03$).

## –õ–æ–≥-–ª—ñ–Ω—ñ–π–Ω–∞ —Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—è {.smaller}

**–í–∏–≤–µ–¥–µ–Ω–Ω—è**

–†–æ–∑–≥–ª—è–Ω–µ–º–æ –ª–æ–≥-–ª—ñ–Ω—ñ–π–Ω—É –º–æ–¥–µ–ª—å

$$ \log(y) = \beta_0 + \beta_1 \, x + u $$

—ñ –¥–∏—Ñ–µ—Ä–µ–Ω—Ü—ñ–∞–ª

$$ \dfrac{dy}{y} = \beta_1 dx $$

–¢–∞–∫–∏–º —á–∏–Ω–æ–º, –Ω–µ–∑–Ω–∞—á–Ω–∞ –∑–º—ñ–Ω–∞ –≤ $x$ (_—Ç–æ–±—Ç–æ_, $dx$) –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ $\beta_1 dx$ **–≤—ñ–¥—Å–æ—Ç–∫–æ–≤–æ—ó –∑–º—ñ–Ω–∏** –≤ $y$.

## –õ–æ–≥-–ª—ñ–Ω—ñ–π–Ω–∞ —Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—è {.smaller}

–û—Å–∫—ñ–ª—å–∫–∏ –ª–æ–≥–∞—Ä–∏—Ñ–º—ñ—á–Ω–æ-–ª—ñ–Ω—ñ–π–Ω–∞ —Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—è –º–∞—î —ñ–Ω—à—É —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—é, –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–µ—Ä–µ–∫–æ–Ω–∞—Ç–∏—Å—è, —â–æ –≤–æ–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –≤–∞—à–æ–º—É –ø—Ä–æ—Ü–µ—Å—É/–º–æ–¥–µ–ª—ñ –≥–µ–Ω–µ—Ä—É–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö.

$x$ –∑–º—ñ–Ω—é—î $y$ —É –∞–±—Å–æ–ª—é—Ç–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω–Ω—è—ó (_–Ω–∞–ø—Ä–∏–∫–ª–∞–¥_, –∑–±—ñ–ª—å—à–µ–Ω–Ω—è –Ω–∞ 3 –æ–¥–∏–Ω–∏—Ü—ñ) –∞–±–æ —É –≤—ñ–¥—Å–æ—Ç–∫–∞—Ö (_–Ω–∞–ø—Ä–∏–∫–ª–∞–¥_, –∑–±—ñ–ª—å—à–µ–Ω–Ω—è –Ω–∞ 10 –≤—ñ–¥—Å–æ—Ç–∫—ñ–≤)?

. . .

_–¢–æ–±—Ç–æ_, –≤–∏ –ø–æ–≤–∏–Ω–Ω—ñ –±—É—Ç–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ –µ–∫—Å–ø–æ–Ω–µ–Ω—Ü—ñ–∞–ª—å–Ω–∏–π –∑–≤‚Äô—è–∑–æ–∫ –º–∞—î —Å–µ–Ω—Å:

$$ \log(y_i) = \beta_0 + \beta_1 \, x_i + u_i \iff y_i = e^{\beta_0 + \beta_1 x_i + u_i} $$

## –õ–æ–≥-–ª—ñ–Ω—ñ–π–Ω–∞ —Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—è

```{python}
#| label: log-liner-plot
#| echo: false
#| fig-align: center

np.random.seed(12345)

n = 1000

x = np.random.uniform(0, 3, n)

ll_df = pd.DataFrame({
  'x': x,
  'y': np.exp(-100 + 0.75 * x + np.random.normal(0, 0.5, n))
})

sns.regplot(x='x', y='y', data=ll_df, lowess=True, scatter_kws={'color': "#314f4f", 'alpha': 0.3}, line_kws={'color': red_pink})
plt.axvline(x=0, color='black', linewidth=1)
plt.axhline(y=0, color='black', linewidth=1)
plt.grid(False)
plt.box(False)
plt.tick_params(left = False, right = False , labelleft = False , 
                labelbottom = False, bottom = False)
plt.xlabel('x')
plt.ylabel('y')
plt.show()
```

## –õ–æ–≥-–ª–æ–≥–∞—Ä–∏—Ñ–º—ñ—á–Ω–∞ —Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—è

–¢–∞–∫ —Å–∞–º–æ –µ–∫–æ–Ω–æ–º–µ—Ç—Ä–∏—Å—Ç–∏ —á–∞—Å—Ç–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å –ª–æ–≥–∞—Ä–∏—Ñ–º—ñ—á–Ω—ñ –º–æ–¥–µ–ª—ñ, –≤ —è–∫–∏—Ö –∑–∞–ª–µ–∂–Ω–∞ –∑–º—ñ–Ω–Ω–∞ –ª–æ–≥–∞—Ä–∏—Ñ–º—É—î—Ç—å—Å—è *—ñ* –ø—Ä–∏–Ω–∞–π–º–Ω—ñ –æ–¥–Ω–∞ –ø–æ—è—Å–Ω—é–≤–∞–ª—å–Ω–∞ –∑–º—ñ–Ω–Ω–∞ –ª–æ–≥–∞—Ä–∏—Ñ–º—É—î—Ç—å—Å—è

$$ \log(\text{Pay}_i) = \beta_0 + \beta_1 \, \log(\text{School}_i) + u_i $$

**–Ü–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—è:**

- –ó–±—ñ–ª—å—à–µ–Ω–Ω—è $x$ –Ω–∞ –æ–¥–∏–Ω –≤—ñ–¥—Å–æ—Ç–æ–∫ –ø—Ä–∏–∑–≤–µ–¥–µ –¥–æ –∑–º—ñ–Ω–∏ $y$ –Ω–∞ $\beta_1$ –≤—ñ–¥—Å–æ—Ç–∫—ñ–≤.
- –ß–∞—Å—Ç–æ —Ç—Ä–∞–∫—Ç—É—î—Ç—å—Å—è —è–∫ –µ–ª–∞—Å—Ç–∏—á–Ω—ñ—Å—Ç—å.

## –õ–æ–≥-–ª–æ–≥–∞—Ä–∏—Ñ–º—ñ—á–Ω–∞ —Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—è {.smaller}

**–í–∏–≤–µ–¥–µ–Ω–Ω—è**

–†–æ–∑–≥–ª—è–Ω–µ–º–æ –º–æ–¥–µ–ª—å log-log

$$ \log(y) = \beta_0 + \beta_1 \, \log(x) + u $$


—ñ –¥–∏—Ñ–µ—Ä–µ–Ω—Ü—ñ–∞–ª

$$ \dfrac{dy}{y} = \beta_1 \dfrac{dx}{x} $$

—è–∫–∏–π –≥–æ–≤–æ—Ä–∏—Ç—å, —â–æ –ø—Ä–∏ –∑–±—ñ–ª—å—à–µ–Ω–Ω—ñ $x$ –Ω–∞ –æ–¥–∏–Ω –≤—ñ–¥—Å–æ—Ç–æ–∫ –º–∏ –ø–æ–±–∞—á–∏–º–æ –∑–±—ñ–ª—å—à–µ–Ω–Ω—è $y$ –Ω–∞ $\beta_1$ –≤—ñ–¥—Å–æ—Ç–æ–∫. –Ø–∫ –µ–ª–∞—Å—Ç–∏—á–Ω—ñ—Å—Ç—å:

$$ \dfrac{dy}{dx} \dfrac{x}{y} = \beta_1 $$

## –õ–æ–≥-–ª—ñ–Ω—ñ–π–Ω–∞ —Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—è –∑ –±—ñ–Ω–∞—Ä–Ω–æ—é –∑–º—ñ–Ω–Ω–æ—é {.smaller}

::: {.callout-note icon="false"}
–Ø–∫—â–æ —É –≤–∞—Å —î –ª–æ–≥–∞—Ä–∏—Ñ–º—ñ—á–Ω–æ-–ª—ñ–Ω—ñ–π–Ω–∞ –º–æ–¥–µ–ª—å —ñ–∑ –¥–≤—ñ–π–∫–æ–≤–æ—é –∑–º—ñ–Ω–Ω–æ—é —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞, —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—è –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç–∞ –¥–ª—è —Ü—ñ—î—ó –∑–º—ñ–Ω–Ω–æ—ó –∑–º—ñ–Ω—é—î—Ç—å—Å—è.
:::

–†–æ–∑–≥–ª—è–Ω–µ–º–æ

$$ \log(y_i) = \beta_0 + \beta_1 x_1 + u_i $$

–¥–ª—è –¥–≤—ñ–π–∫–æ–≤–æ—ó –∑–º—ñ–Ω–Ω–æ—ó $x_1$.

–¢–µ–ø–µ—Ä —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—è $\beta_1$

- –ö–æ–ª–∏ $x_1$ –∑–º—ñ–Ω—é—î—Ç—å—Å—è –∑ 0 –Ω–∞ 1, $y$ –∑–º—ñ–Ω–∏—Ç—å—Å—è –Ω–∞ $100 \times \left( e^{\beta_1} -1 \right)$ –≤—ñ–¥—Å–æ—Ç–∫—ñ–≤.
- –ö–æ–ª–∏ $x_1$ –∑–º—ñ–Ω—é—î—Ç—å—Å—è –∑ 1 –Ω–∞ 0, $y$ –∑–º—ñ–Ω–∏—Ç—å—Å—è –Ω–∞ $100 \times \left( e^{-\beta_1} -1 \right)$ –≤—ñ–¥—Å–æ—Ç–∫—ñ–≤.

## –õ–æ–≥-–ª–æ–≥–∞—Ä–∏—Ñ–º—ñ—á–Ω–∞ —Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—è

```{python}
#| label: log-log-plot
#| echo: false
#| fig-align: center

np.random.seed(12345)

n = 1000

x = np.random.uniform(0, 10, n)
y = np.exp(3 * np.log(x) + np.random.normal(0, 0.5, n))

log_df = pd.DataFrame({
  'x': x,
  'y': y
})

sns.regplot(x='x', y='y', data=log_df, lowess=True, scatter_kws={'color': "#314f4f", 'alpha': 0.3}, line_kws={'color': red_pink})
plt.axvline(x=0, color='black', linewidth=1)
plt.axhline(y=0, color='black', linewidth=1)
plt.grid(False)
plt.box(False)
plt.tick_params(left = False, right = False , labelleft = False , 
                labelbottom = False, bottom = False)
plt.xlabel('x')
plt.ylabel('y')
plt.show()
```

## –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ñ –ø–∏—Ç–∞–Ω–Ω—è {.tiny .scrollable}

**–ó–∞–≥–∞–ª—å–Ω—ñ –ö–æ–Ω—Ü–µ–ø—Ü—ñ—ó —Ç–∞ –ö–æ—Ä–µ–ª—è—Ü—ñ—è**

1.  –©–æ —Ç–∞–∫–µ –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –∫–æ—Ä–µ–ª—è—Ü—ñ—ó —É —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–æ–º—É —Å–µ–Ω—Å—ñ? –Ø–∫—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –≤—ñ–Ω –º–æ–∂–µ –ø—Ä–∏–π–º–∞—Ç–∏?
2.  –ü–æ—è—Å–Ω—ñ—Ç—å —Ä—ñ–∑–Ω–∏—Ü—é –º—ñ–∂ –∫–æ–≤–∞—Ä—ñ–∞—Ü—ñ—î—é —Ç–∞ –∫–æ—Ä–µ–ª—è—Ü—ñ—î—é. –ß–æ–º—É –∫–æ—Ä–µ–ª—è—Ü—ñ—è —á–∞—Å—Ç–æ —î –±—ñ–ª—å—à –∑—Ä—É—á–Ω–æ—é –º—ñ—Ä–æ—é?
3.  –ù–∞–≤–µ–¥—ñ—Ç—å —Ñ–æ—Ä–º—É–ª—É –¥–ª—è –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç–∞ –∫–æ—Ä–µ–ª—è—Ü—ñ—ó –ü—ñ—Ä—Å–æ–Ω–∞.
4.  –Ø–∫ –ø–µ—Ä–µ–≤—ñ—Ä—è—î—Ç—å—Å—è –≥—ñ–ø–æ—Ç–µ–∑–∞ –ø—Ä–æ —Ç–µ, —â–æ –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –∫–æ—Ä–µ–ª—è—Ü—ñ—ó –¥–æ—Ä—ñ–≤–Ω—é—î –Ω—É–ª—é ($H_0: r = 0$)? –Ø–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫—Ä–∏—Ç–µ—Ä—ñ—é –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è?
5.  –Ø–∫—ñ –æ—Å–Ω–æ–≤–Ω—ñ —É–º–æ–≤–∏ (–ø—Ä–∏–ø—É—â–µ–Ω–Ω—è) –¥–ª—è –∫–æ—Ä–µ–∫—Ç–Ω–æ–≥–æ –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è t-–∫—Ä–∏—Ç–µ—Ä—ñ—é –°—Ç—å—é–¥–µ–Ω—Ç–∞ –ø—Ä–∏ –ø–µ—Ä–µ–≤—ñ—Ä—Ü—ñ –≥—ñ–ø–æ—Ç–µ–∑–∏ –ø—Ä–æ –∫–æ—Ä–µ–ª—è—Ü—ñ—é?
6.  –©–æ —ñ–ª—é—Å—Ç—Ä—É—é—Ç—å –ø—Ä–∏–∫–ª–∞–¥–∏ "–ö–≤–∞—Ä—Ç–µ—Ç –ï–Ω—Å–∫–æ–º–±–∞" —Ç–∞ "Datasaurus Dozen" —Å—Ç–æ—Å–æ–≤–Ω–æ –∫–æ—Ä–µ–ª—è—Ü—ñ–π–Ω–æ–≥–æ —Ç–∞ —Ä–µ–≥—Ä–µ—Å—ñ–π–Ω–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É?
7.  –©–æ —Ç–∞–∫–µ "—Ö–∏–±–Ω–∞ –∫–æ—Ä–µ–ª—è—Ü—ñ—è" (spurious correlation)? –ù–∞–≤–µ–¥—ñ—Ç—å –ø—Ä–∏–∫–ª–∞–¥ –∞–±–æ –ø–æ—è—Å–Ω—ñ—Ç—å —Å—É—Ç—å —è–≤–∏—â–∞.

**–ì–µ–Ω–µ—Ä–∞–ª—å–Ω–∞ –°—É–∫—É–ø–Ω—ñ—Å—Ç—å, –í–∏–±—ñ—Ä–∫–∞ —Ç–∞ –û—Å–Ω–æ–≤–∏ –†–µ–≥—Ä–µ—Å—ñ—ó**

8.  –ü–æ—è—Å–Ω—ñ—Ç—å —Ä—ñ–∑–Ω–∏—Ü—é –º—ñ–∂ –º–æ–¥–µ–ª–ª—é —Ä–µ–≥—Ä–µ—Å—ñ—ó –¥–ª—è –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ—ó —Å—É–∫—É–ø–Ω–æ—Å—Ç—ñ —Ç–∞ –º–æ–¥–µ–ª–ª—é —Ä–µ–≥—Ä–µ—Å—ñ—ó –Ω–∞ –æ—Å–Ω–æ–≤—ñ –≤–∏–±—ñ—Ä–∫–∏. –Ø–∫—ñ –ø–æ–∑–Ω–∞—á–µ–Ω–Ω—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –¥–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ —Ç–∞ –∑–∞–ª–∏—à–∫—ñ–≤ —É –∫–æ–∂–Ω–æ–º—É –≤–∏–ø–∞–¥–∫—É?
9.  –ß–æ–º—É –≤–∞–∂–ª–∏–≤–æ —Ä–æ–∑—Ä—ñ–∑–Ω—è—Ç–∏ –≥–µ–Ω–µ—Ä–∞–ª—å–Ω—É —Å—É–∫—É–ø–Ω—ñ—Å—Ç—å —Ç–∞ –≤–∏–±—ñ—Ä–∫—É –ø—Ä–∏ –ø–æ–±—É–¥–æ–≤—ñ —Ä–µ–≥—Ä–µ—Å—ñ–π–Ω–∏—Ö –º–æ–¥–µ–ª–µ–π? –©–æ —ñ–ª—é—Å—Ç—Ä—É—î —Å–∏–º—É–ª—è—Ü—ñ—è –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ –Ω–∞ —Å–ª–∞–π–¥–∞—Ö?
10. –©–æ —Ç–∞–∫–µ $\hat{y}_i$ —É –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ —Ä–µ–≥—Ä–µ—Å—ñ–π–Ω–æ—ó –º–æ–¥–µ–ª—ñ?

**–û—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è –ü–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –†–µ–≥—Ä–µ—Å—ñ—ó (–ú–ù–ö)**

11. –©–æ –æ–∑–Ω–∞—á–∞—î –∞–±—Ä–µ–≤—ñ–∞—Ç—É—Ä–∞ –ú–ù–ö (OLS)? –Ø–∫–∏–π –æ—Å–Ω–æ–≤–Ω–∏–π –ø—Ä–∏–Ω—Ü–∏–ø —Ü—å–æ–≥–æ –º–µ—Ç–æ–¥—É?
12. –Ø–∫—É –≤–µ–ª–∏—á–∏–Ω—É –º—ñ–Ω—ñ–º—ñ–∑—É—î –º–µ—Ç–æ–¥ –Ω–∞–π–º–µ–Ω—à–∏—Ö –∫–≤–∞–¥—Ä–∞—Ç—ñ–≤ (–ú–ù–ö) –¥–ª—è –∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è "–Ω–∞–π–∫—Ä–∞—â–æ—ó" –ª—ñ–Ω—ñ—ó —Ä–µ–≥—Ä–µ—Å—ñ—ó? –ù–∞–ø–∏—à—ñ—Ç—å —Ñ–æ—Ä–º—É–ª—É.
13. –ù–∞–≤–µ–¥—ñ—Ç—å —Ñ–æ—Ä–º—É–ª–∏ –¥–ª—è –æ—Ü—ñ–Ω–æ–∫ –ú–ù–ö $\hat{\beta}_0$ —Ç–∞ $\hat{\beta}_1$ —É –ø—Ä–æ—Å—Ç—ñ–π –ª—ñ–Ω—ñ–π–Ω—ñ–π —Ä–µ–≥—Ä–µ—Å—ñ—ó.
14. –Ø–∫—ñ –æ—Å–Ω–æ–≤–Ω—ñ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ –æ—Ü—ñ–Ω–æ–∫, –æ—Ç—Ä–∏–º–∞–Ω–∏—Ö –º–µ—Ç–æ–¥–æ–º –ú–ù–ö (–∑ —Ç–æ—á–∫–∏ –∑–æ—Ä—É –∑–º—ñ—â–µ–Ω–Ω—è —Ç–∞ –¥–∏—Å–ø–µ—Ä—Å—ñ—ó)? –©–æ —Ç–∞–∫–µ BLUE?

**–ü—Ä–∏–ø—É—â–µ–Ω–Ω—è –ú–ù–ö —Ç–∞ –ù–µ–≤–∏–∑–Ω–∞—á–µ–Ω—ñ—Å—Ç—å**

15. –ü–µ—Ä–µ–ª—ñ—á—ñ—Ç—å –∫–ª—é—á–æ–≤—ñ –ø—Ä–∏–ø—É—â–µ–Ω–Ω—è –º–µ—Ç–æ–¥—É –ú–ù–ö.
16. –ü–æ—è—Å–Ω—ñ—Ç—å –ø—Ä–∏–ø—É—â–µ–Ω–Ω—è –µ–∫–∑–æ–≥–µ–Ω–Ω–æ—Å—Ç—ñ ($\mathop{E}\left[ u \mid X \right] = 0$). –ß–æ–º—É –≤–æ–Ω–æ —î –≤–∞–∂–ª–∏–≤–∏–º?
17. –Ø–∫ –æ—Ü—ñ–Ω—é—î—Ç—å—Å—è –¥–∏—Å–ø–µ—Ä—Å—ñ—è –≤–∏–ø–∞–¥–∫–æ–≤–∏—Ö –∑–±—É—Ä–µ–Ω—å ($\sigma^2$) –Ω–∞ –æ—Å–Ω–æ–≤—ñ –≤–∏–±—ñ—Ä–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö?
18. –©–æ —Ç–∞–∫–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞ –ø–æ–º–∏–ª–∫–∞ –æ—Ü—ñ–Ω–∫–∏ –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç–∞ —Ä–µ–≥—Ä–µ—Å—ñ—ó ($\mathop{\hat{\text{SE}}} \left( \hat{\beta}_1 \right)$)? –©–æ –≤–æ–Ω–∞ –ø–æ–∫–∞–∑—É—î?
19. –í—ñ–¥ —á–æ–≥–æ –∑–∞–ª–µ–∂–∏—Ç—å –¥–∏—Å–ø–µ—Ä—Å—ñ—è (–∞ –æ—Ç–∂–µ, —ñ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞ –ø–æ–º–∏–ª–∫–∞) –æ—Ü—ñ–Ω–∫–∏ –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç–∞ –Ω–∞—Ö–∏–ª—É $\hat{\beta}_1$?

**–î–æ–≤—ñ—Ä—á—ñ –Ü–Ω—Ç–µ—Ä–≤–∞–ª–∏ —Ç–∞ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ì—ñ–ø–æ—Ç–µ–∑**

20. –Ø–∫ –±—É–¥—É—î—Ç—å—Å—è –¥–æ–≤—ñ—Ä—á–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç–∞ —Ä–µ–≥—Ä–µ—Å—ñ—ó $\beta_1$?
21. –Ø–∫ —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç—É—î—Ç—å—Å—è 95% –¥–æ–≤—ñ—Ä—á–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç–∞ $\beta_1$?
22. –Ø–∫ —Ñ–æ—Ä–º—É–ª—é—î—Ç—å—Å—è —Ç–∏–ø–æ–≤–∞ –Ω—É–ª—å–æ–≤–∞ –≥—ñ–ø–æ—Ç–µ–∑–∞ ($H_0$) –ø—Ä–∏ –ø–µ—Ä–µ–≤—ñ—Ä—Ü—ñ –∑–Ω–∞—á—É—â–æ—Å—Ç—ñ –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç–∞ —Ä–µ–≥—Ä–µ—Å—ñ—ó $\beta_1$? –Ø–∫–∞ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞ –≥—ñ–ø–æ—Ç–µ–∑–∞ ($H_a$)?
23. –Ø–∫ —Ä–æ–∑—Ä–∞—Ö–æ–≤—É—î—Ç—å—Å—è t-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –≥—ñ–ø–æ—Ç–µ–∑–∏ $H_0: \beta_1 = c$?
24. –Ø–∫ –ø—Ä–∏–π–º–∞—î—Ç—å—Å—è —Ä—ñ—à–µ–Ω–Ω—è –ø—Ä–æ –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è –Ω—É–ª—å–æ–≤–æ—ó –≥—ñ–ø–æ—Ç–µ–∑–∏ –Ω–∞ –æ—Å–Ω–æ–≤—ñ t-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∞–±–æ p-–∑–Ω–∞—á–µ–Ω–Ω—è?
25. –£ —è–∫–∏—Ö –≤–∏–ø–∞–¥–∫–∞—Ö –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è F-—Ç–µ—Å—Ç —É —Ä–µ–≥—Ä–µ—Å—ñ–π–Ω–æ–º—É –∞–Ω–∞–ª—ñ–∑—ñ? –ß–∏–º –≤—ñ–Ω –≤—ñ–¥—Ä—ñ–∑–Ω—è—î—Ç—å—Å—è –≤—ñ–¥ t-—Ç–µ—Å—Ç—É?

**–û—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è –Ø–∫–æ—Å—Ç—ñ –ú–æ–¥–µ–ª—ñ —Ç–∞ –Ü–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—è –ö–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç—ñ–≤**

26. –©–æ —Ç–∞–∫–µ –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –¥–µ—Ç–µ—Ä–º—ñ–Ω–∞—Ü—ñ—ó ($R^2$)? –©–æ –≤—ñ–Ω –ø–æ–∫–∞–∑—É—î?
27. –Ø–∫–∞ –æ—Å–Ω–æ–≤–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è $R^2$ –ø—Ä–∏ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—ñ –º–æ–¥–µ–ª–µ–π –∑ —Ä—ñ–∑–Ω–æ—é –∫—ñ–ª—å–∫—ñ—Å—Ç—é –Ω–µ–∑–∞–ª–µ–∂–Ω–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö?
28. –Ø–∫ —Å–∫–æ—Ä–∏–≥–æ–≤–∞–Ω–∏–π $R^2$ ($\overline{R}^2$) –≤–∏—Ä—ñ—à—É—î –ø—Ä–æ–±–ª–µ–º—É –∑–≤–∏—á–∞–π–Ω–æ–≥–æ $R^2$?
29. –Ø–∫ —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç—É—î—Ç—å—Å—è –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç $\beta_1$ —É –º–æ–¥–µ–ª—ñ $y = \beta_0 + \beta_1 x + u$, —è–∫—â–æ $x$ —Ç–∞ $y$ - –Ω–µ–ø–µ—Ä–µ—Ä–≤–Ω—ñ –∑–º—ñ–Ω–Ω—ñ?
30. –Ø–∫ –∑–º—ñ–Ω—é—î—Ç—å—Å—è —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—è $\beta_1$ —É –º–Ω–æ–∂–∏–Ω–Ω—ñ–π —Ä–µ–≥—Ä–µ—Å—ñ—ó $y = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + u$?
31. –Ø–∫ —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç—É—é—Ç—å—Å—è –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç–∏ $\beta_0$ —Ç–∞ $\beta_1$ —É –º–æ–¥–µ–ª—ñ $y = \beta_0 + \beta_1 D + u$, –¥–µ $D$ - —Ñ—ñ–∫—Ç–∏–≤–Ω–∞ (–±—ñ–Ω–∞—Ä–Ω–∞ 0/1) –∑–º—ñ–Ω–Ω–∞?
32. –©–æ –¥–æ–∑–≤–æ–ª—è—î –º–æ–¥–µ–ª—é–≤–∞—Ç–∏ –≤–∫–ª—é—á–µ–Ω–Ω—è –≤–∑–∞—î–º–æ–¥—ñ—ó –º—ñ–∂ –∑–º—ñ–Ω–Ω–∏–º–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, $x_1 \times x_2$)? –Ø–∫ —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç—É–≤–∞—Ç–∏ –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç–∏ –≤ –º–æ–¥–µ–ª—ñ –∑ –≤–∑–∞—î–º–æ–¥—ñ—î—é?
33. –Ø–∫ —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç—É—î—Ç—å—Å—è –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç $\beta_1$ —É –ª–æ–≥-–ª—ñ–Ω—ñ–π–Ω—ñ–π –º–æ–¥–µ–ª—ñ $\log(y) = \beta_0 + \beta_1 x + u$?
34. –Ø–∫ —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç—É—î—Ç—å—Å—è –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç $\beta_1$ —É –ª–æ–≥-–ª–æ–≥–∞—Ä–∏—Ñ–º—ñ—á–Ω—ñ–π –º–æ–¥–µ–ª—ñ $\log(y) = \beta_0 + \beta_1 \log(x) + u$?
35. –Ø–∫ —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç—É—î—Ç—å—Å—è –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç $\beta_1$ –¥–ª—è –±—ñ–Ω–∞—Ä–Ω–æ—ó –∑–º—ñ–Ω–Ω–æ—ó $x_1$ —É –ª–æ–≥-–ª—ñ–Ω—ñ–π–Ω—ñ–π –º–æ–¥–µ–ª—ñ $\log(y) = \beta_0 + \beta_1 x_1 + u$?

## –î–æ–¥–∞—Ç–∫–æ–≤—ñ –º–∞—Ç–µ—Ä—ñ–∞–ª–∏ {.scrollable}

- [Github: –∫–æ–¥ –ª–µ–∫—Ü—ñ—ó](https://github.com/Aranaur/aranaur.rbind.io/blob/main/lectures/asa/slides/2024/.00.qmd)
- [Correlation game](https://openintro.shinyapps.io/correlation_game/)
- [Building connections for A/B testing and linear regression](https://markeltsefon.medium.com/building-connections-for-a-b-testing-and-linear-regression-51130c492c52)
- [Spotify: How to Accurately Test Significance with Difference in Difference Models](https://engineering.atspotify.com/2023/09/how-to-accurately-test-significance-with-difference-in-difference-models/)

# –î—è–∫—É—é –∑–∞ —É–≤–∞–≥—É! {background-color="#eef3f8" .unnumbered .unlisted}

<br>
<br>

{{< iconify ic baseline-telegram >}} [@araprof](https://t.me/araprof)

{{< iconify mdi youtube >}} [@datamirosh](https://www.youtube.com/@datamirosh)

{{< iconify ion home >}} [aranaur.rbind.io](https://aranaur.rbind.io)

{{< iconify mdi github >}} [aranaur](https://github.com/Aranaur)

{{< iconify mdi envelope >}} <ihor.miroshnychenko@knu.ua>

{{< iconify mdi linkedin >}} [ihormiroshnychenko](https://www.linkedin.com/in/ihormiroshnychenko/)